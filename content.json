{"meta":{"title":"åŠªåŠ›ï¼Œå¥‹æ–—","subtitle":"è®°å½•å­¦ä¹ ","description":null,"author":"ç‹å°š","url":"https://shang.at","root":"/"},"pages":[{"title":"About","date":"2019-03-24T01:33:47.232Z","updated":"2019-03-24T01:33:47.232Z","comments":true,"path":"about/index.html","permalink":"https://shang.at/about/index.html","excerpt":"","text":"å¤§æ•°æ®å·¥ç¨‹å¸ˆä¸€æš é‚®ç®±ï¼š2823147532@qq.com æ­¤åšå®¢ä»…ä¸ºä¸ªäººå­¦ä¹ æ•°æ®ç»“æ„å’Œç®—æ³•çš„ä¸€ä¸ªç¬”è®°ï¼Œå°±æ˜¯æƒ³ç£ä¿ƒè‡ªå·±åšæŒå­¦ä¹ ã€‚ç¬”è®°å†…å®¹ä¸»è¦æ¥æºäºå…¶ä»–çš„åšå®¢å’Œè¯»å®Œåšå®¢åçš„è‡ªå·±çš„ä¸€ç‚¹æ€è€ƒ"},{"title":"Categories","date":"2020-06-29T17:14:30.000Z","updated":"2020-06-29T17:15:11.496Z","comments":true,"path":"categories/index.html","permalink":"https://shang.at/categories/index.html","excerpt":"","text":""},{"title":"Tags","date":"2020-06-29T17:14:30.000Z","updated":"2020-06-29T17:16:06.172Z","comments":true,"path":"tags/index.html","permalink":"https://shang.at/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"Python-collections","slug":"Python-collections","date":"2021-05-19T02:26:45.000Z","updated":"2021-05-19T02:27:10.936Z","comments":true,"path":"post/Python-collections/","link":"","permalink":"https://shang.at/post/Python-collections/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š https://docs.python.org/zh-cn/3.8/library/collections.html?highlight=counter#module-collections","categories":[],"tags":[]},{"title":"Yaml","slug":"Yaml","date":"2021-05-19T02:23:35.000Z","updated":"2021-05-19T02:25:25.619Z","comments":true,"path":"post/Yaml/","link":"","permalink":"https://shang.at/post/Yaml/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š https://einverne.github.io/post/2015/08/yaml.html https://www.jianshu.com/p/173c734b7281 pythonæ“ä½œyamlï¼šhttps://www.jianshu.com/p/eaa1bf01b3a6","categories":[],"tags":[]},{"title":"Scala-Any,AnyRef,AnyVal","slug":"Scala-Any-AnyRef-AnyVal","date":"2021-05-19T02:18:25.000Z","updated":"2021-05-27T07:36:09.299Z","comments":true,"path":"post/Scala-Any-AnyRef-AnyVal/","link":"","permalink":"https://shang.at/post/Scala-Any-AnyRef-AnyVal/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š https://my.oschina.net/cloudcoder/blog/856334 scalaä¸­çš„Noneå’Œnull","categories":[],"tags":[]},{"title":"Spark-è·å–DataFrameçš„å¤§å°","slug":"Spark-è·å–DataFrameçš„å¤§å°","date":"2021-05-19T02:14:29.000Z","updated":"2021-05-19T02:17:28.631Z","comments":true,"path":"post/Spark-è·å–DataFrameçš„å¤§å°/","link":"","permalink":"https://shang.at/post/Spark-è·å–DataFrameçš„å¤§å°/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š https://stackoverflow.com/questions/35008123/how-to-find-spark-rdd-dataframe-size https://stackoverflow.com/questions/49492463/compute-size-of-spark-dataframe-sizeestimator-gives-unexpected-results https://stackoverflow.com/questions/48064638/how-to-find-the-size-of-an-object-in-scala Sizeof in Scalaï¼šhttps://www.yannmoisan.com/sizeof-in-scala.html å†™çš„éå¸¸å¥½","categories":[],"tags":[]},{"title":"Spark-æ€§èƒ½ä¼˜åŒ–","slug":"Spark-æ€§èƒ½ä¼˜åŒ–","date":"2021-05-19T02:11:28.000Z","updated":"2021-05-19T02:11:34.957Z","comments":true,"path":"post/Spark-æ€§èƒ½ä¼˜åŒ–/","link":"","permalink":"https://shang.at/post/Spark-æ€§èƒ½ä¼˜åŒ–/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š https://www.cnblogs.com/dflmg/p/10430181.html","categories":[],"tags":[]},{"title":"Flink","slug":"Flinkå­¦ä¹ ","date":"2021-05-19T02:09:21.000Z","updated":"2021-05-21T09:43:34.369Z","comments":true,"path":"post/Flinkå­¦ä¹ /","link":"","permalink":"https://shang.at/post/Flinkå­¦ä¹ /","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š flinkä¸­äº‹ä»¶æ—¶é—´çš„ç†è§£ä¸¤ç§ä¸åŒçš„æäº¤jobçš„æ–¹æ³•executeå’ŒexecuteAsyncçš„åŒºåˆ« ä¸¤ç§ä¸åŒçš„Function Functionï¼šåªèƒ½æ‹¿åˆ°éœ€è¦å¤„ç†çš„æ•°æ® RichFunctionï¼šä¸æ­¢èƒ½æ‹¿åˆ°éœ€è¦å¤„ç†çš„æ•°æ®ï¼ŒåŒæ—¶ä¹Ÿèƒ½æ‹¿åˆ°ç³»ç»Ÿçš„è¿è¡Œæ—¶ä¸Šä¸‹æ–‡å¯¹è±¡ Flinkçš„å†…å­˜ç®¡ç†","categories":[],"tags":[]},{"title":"Scala-å¸¸ç”¨æ•°æ®ç»“æ„","slug":"Scala-å¸¸ç”¨æ•°æ®ç»“æ„","date":"2021-05-19T02:07:13.000Z","updated":"2021-05-26T16:42:47.657Z","comments":true,"path":"post/Scala-å¸¸ç”¨æ•°æ®ç»“æ„/","link":"","permalink":"https://shang.at/post/Scala-å¸¸ç”¨æ•°æ®ç»“æ„/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š mapï¼šhttps://www.cnblogs.com/suanec/p/5760446.html scala æ—¶é—´ï¼Œæ—¶é—´æ ¼å¼è½¬æ¢ï¼šhttps://blog.csdn.net/An1090239782/article/details/100590390 å®˜ç½‘çš„è§£è¯»","categories":[],"tags":[]},{"title":"Scala-å¹¶è¡Œé›†åˆ","slug":"Scala-å¹¶è¡Œé›†åˆ","date":"2021-05-19T02:03:27.000Z","updated":"2021-05-19T02:04:01.918Z","comments":true,"path":"post/Scala-å¹¶è¡Œé›†åˆ/","link":"","permalink":"https://shang.at/post/Scala-å¹¶è¡Œé›†åˆ/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š https://www.zhihu.com/question/23273115?sort=created https://stackoverflow.com/questions/17178201/parallel-iterator-in-scala https://github.com/tim-group/iterata","categories":[],"tags":[]},{"title":"Scala-å¹¶å‘ç¼–ç¨‹","slug":"Scala-å¹¶å‘ç¼–ç¨‹","date":"2021-05-19T02:02:22.000Z","updated":"2021-05-19T02:03:02.155Z","comments":true,"path":"post/Scala-å¹¶å‘ç¼–ç¨‹/","link":"","permalink":"https://shang.at/post/Scala-å¹¶å‘ç¼–ç¨‹/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š https://liam-blog.ml/2019/07/14/Scala-Concurrency-in-Practice-1/ https://stackoverflow.com/questions/34877487/how-to-use-synchronized-in-scala","categories":[],"tags":[]},{"title":"å·¥å…·ä½¿ç”¨-markdownæ–‡æ¡£","slug":"å·¥å…·ä½¿ç”¨-markdownæ–‡æ¡£","date":"2021-05-12T02:41:39.000Z","updated":"2021-05-31T03:29:44.120Z","comments":true,"path":"post/å·¥å…·ä½¿ç”¨-markdownæ–‡æ¡£/","link":"","permalink":"https://shang.at/post/å·¥å…·ä½¿ç”¨-markdownæ–‡æ¡£/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š æ¯”è¾ƒæœ‰ç”¨çš„ä½¿ç”¨æ–¹æ³•æŠ˜å  Program Structure Note that it is possible to cascade one set of time windows after another, so long as the timeframes are compatible (the second set of windows needs to have a duration that is a multiple of the first set). So you can have a initial set of hour-long windows that is keyed by the driverId and use this to create a stream of (endOfHourTimestamp, driverId, totalTips), and then follow this with another hour-long window (this window is not keyed) that finds the record from the first window with the maximum totalTips. åˆ†æ  åˆ†æ æµ‹è¯• å·¦ä¾§å†…å®¹ å³ä¾§å†…å®¹","categories":[],"tags":[]},{"title":"æ•°ä»“é¡¹ç›®åŠSparkåˆ†äº«","slug":"æ•°ä»“é¡¹ç›®åŠSparkåˆ†äº«","date":"2021-05-06T01:48:39.000Z","updated":"2021-06-03T07:55:58.085Z","comments":true,"path":"post/æ•°ä»“é¡¹ç›®åŠSparkåˆ†äº«/","link":"","permalink":"https://shang.at/post/æ•°ä»“é¡¹ç›®åŠSparkåˆ†äº«/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š ã€è®²ã€‘é¡¹ç›®ä»‹ç»è®¾è®¡æ¨¡å¼é¡¹ç›®æ¶æ„ - æ¨¡æ¿æ–¹æ³•çš„è®¾è®¡æ¨¡å¼ - æ¡†æ¶çš„é€šç”¨è®¾è®¡æ¨¡å¼ - ä¸»ä½“æµç¨‹è¿›è¡Œé™åˆ¶ï¼Œæš´éœ²å¿…è¦çš„æ–¹æ³•ç»™ç”¨æˆ·å®ç°ï¼Œç”¨æˆ·åªéœ€è¦å…³æ³¨å…·ä½“çš„ä¸šåŠ¡é€»è¾‘ï¼Œæ— é¡»å…³å¿ƒå…¶ä»–çš„æ‰§è¡Œç»†èŠ‚ æ•°ä»“é¡¹ç›®å‡ ä¸ªè§’è‰²æŠ½è±¡ - APPã€Taskã€Targetã€Datasourceå®ƒä»¬çš„å…³ç³» - å°±æ˜¯æ‰§è¡Œçš„å…·ä½“ç»†èŠ‚ ä¾èµ–ç®¡ç†ï¼šè§£æå’Œæ‰§è¡Œ æ‰§è¡Œæµç¨‹ï¼šä¸šåŠ¡é€»è¾‘ -&gt; ï¼ˆåˆå¹¶å°æ–‡ä»¶ï¼‰[åˆ¤æ–­æ˜¯å¦åˆ†åŒº] write to parquet é¡¹ç›®ä¼˜åŒ–ç‚¹ åˆ©ç”¨spark FIFOçš„é˜Ÿåˆ—æ¨¡å‹æé«˜èµ„æºåˆ©ç”¨ç‡(å¤šçº¿ç¨‹å¹¶å‘æäº¤job)ï¼Œé¿å…äº†ä¸€æ¬¡ä»…æäº¤ä¸€ä¸ªJobå¸¦æ¥çš„ èµ„æºæµªè´¹ï¼šå¦‚æœæ˜¯ä¸€æ¬¡ä»…æäº¤ä¸€ä¸ªJobï¼Œé‚£ä¹ˆå°±ç›®å‰çš„é¡¹ç›®æ¶æ„æ¥è¯´ï¼Œç›¸å½“äºäººä¸ºçš„å°†æ‰€æœ‰ä»»åŠ¡éƒ½ä¸²è¡Œèµ·æ¥äº†ï¼Œä¸€ä¸ªJobçš„æ‰§è¡Œå¯èƒ½åªéœ€è¦æå°‘çš„èµ„æºï¼Œä½†æ˜¯è¿™ç§æ¨¡å¼åˆæ²¡æœ‰å…¶ä»–çš„Jobå¯ä»¥è¿è¡Œï¼Œé‚£ä¹ˆå¤§éƒ¨åˆ†æ—¶é—´é›†ç¾¤çš„èµ„æºæ˜¯å¤„äºç©ºé—²çŠ¶æ€çš„ï¼Œå› æ­¤å°±ä¼šé€ æˆä¸€ç§èµ„æºçš„æµªè´¹ã€‚ æ—¶é—´æ¶ˆè€—ï¼šåŸå› æ˜¯å¦‚æœæ˜¯ä¸€æ¬¡ä»…æäº¤ä¸€ä¸ªJobï¼Œé‚£ä¹ˆæ¯æ¬¡æäº¤Jobï¼Œéƒ½è¦ç»å†sparké›†ç¾¤å¯åŠ¨çš„è¿‡ç¨‹ï¼Œè¿™ä¸€è¿‡ç¨‹æ˜¯å¾ˆè€—æ—¶çš„ï¼Œåœ¨ç›®å‰çš„æƒ…å†µä¸­ï¼Œsparké›†ç¾¤å¯åŠ¨çš„è¿‡ç¨‹å¯èƒ½æ¯”ä¸€ä¸ªJobè¿è¡Œçš„æ—¶é—´è¿˜è¦é•¿ã€‚ æ½œåœ¨çš„é—®é¢˜ï¼šä¸€ä¸ªJobçš„å¤±è´¥ä¼šå¯¼è‡´åç»­æ‰€æœ‰æœªæ‰§è¡ŒJobçš„å¤±è´¥ï¼Œä½†æ˜¯è¿™ä¸ªé—®é¢˜å¯¹äºæ‰¹å¤„ç†æ¥è¯´ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„é—®é¢˜ï¼Œå› ä¸ºå¯ä»¥ç›´æ¥é‡è·‘ä¸€æ¬¡æ‰¹å¤„ç†å°±å¯ä»¥äº†ï¼Œå¹¶ä¸ä¼šé€ æˆå¤ªå¤§çš„é—®é¢˜ã€‚ä½†æ˜¯è¿™ç§æƒ…å†µçš„å‡ºç°è¿˜æ˜¯ä¼šå¯¹å…¶ä¸‹æ¸¸çš„ä»»åŠ¡é€ æˆä¸€å®šçš„å½±å“ï¼Œä¼šå»¶è¿Ÿä¸‹æ¸¸ä»»åŠ¡çš„æ‰§è¡Œã€‚ é€ æˆè¿™ç±»é—®é¢˜çš„ä¸»è¦åŸå› æœ‰ä¸¤ç§ï¼š â€‹ ä»£ç çš„bugï¼šä»£ç ä¸Šçº¿å‰åº”è¯¥å……åˆ†æµ‹è¯•ï¼Œä¸Šçº¿ä¹‹åç«‹å³æ‰§è¡Œä¸€æ¬¡ç¡®ä¿æ²¡æœ‰é—®é¢˜ â€‹ ç³»ç»Ÿé—®é¢˜ï¼šç”±äºæ•°æ®è¶Šæ¥è¶Šå¤§ï¼Œå¯èƒ½æœ‰äº›é—®é¢˜ä¼šé€æ¸çš„æ˜¾éœ²å‡ºæ¥ï¼Œæ¯”å¦‚ä¸€äº›å†…å­˜æº¢å‡ºé—®é¢˜(ä¸‹é¢å°±ä¼šä»‹ç»ä¸€äº›ç±»ä¼¼çš„é—®é¢˜ï¼šæ¯”å¦‚autoBroadcasté€ æˆçš„OOMä»¥åŠcoalesceé€ æˆçš„OOM) Flinkå¦‚ä½•å®ç°å¹¶å‘æäº¤ä»»åŠ¡ - application mode &amp; executeAsync() éåˆ†åŒºè¡¨å°æ–‡ä»¶è‡ªåŠ¨åˆå¹¶ - æ ¹æ®hive matestoreè®°å½•æ•°æ®å¤§å°è¿›è¡Œä¼°ç®—æœ€åçš„æ–‡ä»¶æ•° - æœ€ç»ˆçš„æ–‡ä»¶æ•°å®é™…ä¸Šå°±æ˜¯æœ€åä¸€ä¸ªstageçš„åˆ†åŒºæ•° 12&gt; DESCRIBE EXTENDED databaseName.tableName&gt; ç¼“å­˜ç®¡ç† - æ‰“ç®—ä¼˜åŒ–çš„ç‚¹ - ä¸åŒçš„è¡¨å¯èƒ½ä¼šä¾èµ–äº†åŒæ ·çš„åŸºç¡€è¡¨ï¼Œå¸Œæœ›æ˜¯å¯ä»¥åªè¯»å–ä¸€æ¬¡åŸå§‹è¡¨ï¼Œåç»­å†æ¬¡ä½¿ç”¨è¯¥è¡¨åˆ™ä½¿ç”¨cacheçš„æ•°æ® - ç¼“å­˜ç®¡ç†ã€ç¼“å­˜é‡Šæ”¾ - åœ¨ç›®å‰ä¸æ”¹åŠ¨ä¸šåŠ¡ä»£ç çš„æƒ…å†µä¸‹å¾ˆéš¾å®ç° - è¿›ä¸€æ­¥æ€è€ƒä¸­ ã€è®²ã€‘ä»»åŠ¡è°ƒåº¦sparkçš„Schedulerå®˜æ–¹çš„è§£é‡Š å…³äºsparkä»»åŠ¡è°ƒåº¦ï¼Œå®é™…ä¸Šåˆ†ä¸ºä¸¤å±‚ï¼ˆä»¥ä¸‹é’ˆå¯¹åŸºäºyarnéƒ¨ç½²çš„sparké›†ç¾¤ï¼‰ã€‚ç¬¬ä¸€å±‚æ˜¯yarnçš„èµ„æºè°ƒåº¦å±‚ï¼Œç¬¬äºŒå±‚æ˜¯sparkçš„åº”ç”¨è°ƒåº¦å±‚ï¼Œå› æ­¤åˆ†ä¸ºä»¥ä¸‹ä¸¤ä¸ªæ–¹é¢ä»‹ç»ï¼š Scheduling Across Applicationsåº”ç”¨çº§åˆ«çš„è°ƒåº¦ è¯¥çº§åˆ«çš„è°ƒåº¦æ˜¯åŸºäºyarnè¿™æ ·çš„ä¸€ä¸ªç»Ÿä¸€çš„èµ„æºè°ƒåº¦å¹³å°è¿›è¡Œçš„ï¼Œæ‰€æœ‰åŸºäºyarnè¿è¡Œçš„åº”ç”¨éƒ½è¦éµå¾ªåŒæ ·çš„è°ƒåº¦ç­–ç•¥ï¼Œè¯¦ç»†ç†è§£Yarn Schedulerï¼Œå¯ä»¥é˜…è¯»ä¸€ä¸‹è¿™ç¯‡åšå®¢ã€‚è¿™é‡Œåªæ˜¯ç®€å•çš„ä»‹ç»ä¸€ä¸‹ï¼š å‡è®¾æˆ‘ä»¬é€šè¿‡spark-submitä»¥clusteræ¨¡å¼æäº¤çš„spark applicationåˆ°yarné›†ç¾¤ï¼Œå®é™…ä¸Šå°±æ˜¯å‘RMç”³è¯·äº†ä¸€ç³»åˆ—çš„èµ„æº(è¿™é‡Œä¼šéµå¾ªyarnçš„èµ„æºè°ƒåº¦è§„åˆ™)ï¼Œå¦‚æœä»»åŠ¡æäº¤æˆåŠŸï¼Œé‚£ä¹ˆéšåä¼šåœ¨yarné›†ç¾¤ä¸­å¯åŠ¨ä¸€ä¸ªsparkçš„å°é›†ç¾¤ï¼Œå…¶ä¸­å°±åŒ…å«äº†æˆ‘ä»¬æ‰€ç†Ÿæ‚‰çš„Driverã€Executorsï¼ŒDriverç«¯è¿è¡Œçš„å°±æ˜¯æˆ‘ä»¬æäº¤çš„jarçš„mainæ–¹æ³•ï¼Œåç»­çš„ä»»åŠ¡è°ƒåº¦å°±æ˜¯sparkè‡ªå·±è°ƒåº¦çš„äº†ã€‚ï¼ˆè¿™é‡Œä¸æ¶‰åŠè¿‡å¤šç»†èŠ‚ï¼Œå› ä¸ºç»†èŠ‚å®åœ¨å¤ªå¤šï¼Œå…³äºyarnå’Œspark on yarnçš„æ›´å¤šç»†èŠ‚ï¼Œå¯ä»¥é˜…è¯»ä¸‹è¿™ç¯‡åšå®¢ï¼‰ã€‚ Scheduling Within an ApplicationJobçº§åˆ«çš„è°ƒåº¦ï¼šFAIRã€FIFO è¿™é‡Œæ˜¯æˆ‘ä»¬è¦ä»‹ç»çš„é‡ç‚¹ã€‚ åœ¨ä¸€ä¸ªsparkçš„Applicationä¸­æ˜¯å…è®¸å¹¶è¡Œè¿è¡Œå¤šä¸ªJobçš„ï¼Œå‰ææ˜¯éœ€è¦åœ¨ä¸åŒçš„çº¿ç¨‹ä¸­æäº¤çš„ã€‚è¿™é‡Œæ‰€è¯´çš„Jobæ˜¯æŒ‡sparkä¸­çš„ä¸€ä¸ªactionç®—å­(æ¯”å¦‚collectï¼Œsaveç­‰)ã€‚ ä»€ä¹ˆæ˜¯Jobï¼Ÿ FIFOè¿™æ˜¯sparkå†…éƒ¨è°ƒåº¦Jobçš„é»˜è®¤ç­–ç•¥ï¼Œå³ï¼šç¬¬ä¸€ä¸ªè¢«æäº¤çš„Jobä¼šæœ‰ä½¿ç”¨é›†ç¾¤å…¨éƒ¨èµ„æºçš„ä¼˜å…ˆæƒï¼Œåˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š å¦‚æœå½“å‰JobæŠŠæ‰€æœ‰é›†ç¾¤èµ„æºéƒ½å ç”¨äº†ï¼Œé‚£ä¹ˆåç»­æäº¤çš„Jobåªèƒ½ç­‰å¾… å¦‚æœå½“å‰Jobä»…ä»…å ç”¨äº†é›†ç¾¤çš„ä¸€éƒ¨åˆ†èµ„æºï¼Œé›†ç¾¤è¿˜æœ‰ç©ºé—²èµ„æºï¼Œé‚£ä¹ˆåç»­æäº¤çš„ä»»åŠ¡å¯ä»¥ç«‹å³æ‰§è¡Œã€‚æ— è®ºä¸€ä¸ªApplicationä¸­å¹¶å‘æäº¤äº†å¤šå°‘ä¸ªJobï¼Œéƒ½æ˜¯è¿™æ ·çš„æ–¹å¼è°ƒåº¦ã€‚ åŠ¡å¿…ä»…ä»…åœ¨scala/javaè¯­è¨€ç¼–ç¨‹ä¸­ä½¿ç”¨å¹¶å‘Jobï¼Œä¸å»ºè®®åœ¨pySparkä¸­ä½¿ç”¨ï¼šConcurrent Jobs in PySpark Fair Sharingè¿™æ˜¯åœ¨spark0.8ç‰ˆæœ¬ä»¥åä¸Šçº¿çš„ç‰¹æ€§ï¼Œä¸»è¦ç”¨äºå¤šç§Ÿæˆ·ä½¿ç”¨åŒä¸€ä¸ªé›†ç¾¤çš„æƒ…å†µï¼Œä½¿å¾—å¤šä¸ªç§Ÿæˆ·éƒ½å¯ä»¥äº«ç”¨åˆ°é›†ç¾¤çš„èµ„æºï¼Œå³ä½¿å‰é¢æœ‰ä¸€ä¸ªå¾ˆå¤§çš„Jobåœ¨æ‰§è¡Œï¼Œåç»­æäº¤çš„ä»»åŠ¡ä¹Ÿèƒ½å¤Ÿåˆ†åˆ°ç›¸åº”çš„èµ„æºå»è¿è¡Œï¼Œä¿è¯è‰¯å¥½çš„å“åº”æ—¶é—´ å¦‚æœæƒ³ä½¿ç”¨Fair Schedulerï¼Œéœ€è¦ä½œå¦‚ä¸‹çš„é…ç½®æ‰è¡Œï¼š 123val conf = new SparkConf().setMaster(...).setAppName(...)conf.set(\"spark.scheduler.mode\", \"FAIR\")val sc = new SparkContext(conf) é™¤æ­¤ä»¥å¤–ï¼Œè¿˜éœ€è¦ä¸€äº›ç³»ç»Ÿé…ç½®ï¼šFair Scheduler Poolsï¼Œè¿™é‡Œæœ‰äº›æ¶‰åŠåˆ°è¿ç»´ç›¸å…³çš„äº†ï¼Œä¸æˆ‘ä»¬å®é™…å¼€å‘å…³ç³»ä¸æ˜¯å¾ˆå¤§ã€‚ æˆ‘ä»¬çš„Schedulerä¾èµ–ç®¡ç†æˆ‘ä»¬é¡¹ç›®ä¸­çš„DAG - ä»¥ä¸€ç§æ¯”è¾ƒç®€å•æ•°æ®ç»“æ„å®ç°äº†ä»»åŠ¡çš„ä¾èµ–å…³ç³»ï¼Œä¸‹å›¾æ˜¯æˆ‘ä»¬ä½¿ç”¨çš„æ•°æ®ç»“æ„çš„ç¤ºæ„å›¾ ä¼ªä»£ç å¦‚ä¸‹ï¼š 123456789101112class BaseTask &#123; def priority: Int = 100 private val prev: mu.HashSet[BaseTask] = mu.HashSet() def predecessors: Set[BaseTask] = prev.toSet private val next: mu.HashSet[BaseTask] = mu.HashSet() def successors: Set[BaseTask] = next.toSet def -&gt;(other: BaseTask): BaseTask = &#123; next += other other.prev += this other &#125;&#125; è§£è¯»ï¼šæ¯ä¸ªTaskæœ‰å‰é©±ç»“ç‚¹Seté›†åˆ(å‰é©±ä¾èµ–èŠ‚ç‚¹)å’Œåç»§èŠ‚ç‚¹Seté›†åˆ(ä¸‹æ¸¸èŠ‚ç‚¹) ä»»åŠ¡è°ƒåº¦å™¨ï¼š Schedulerç»´æŠ¤äº†ä»¥ä¸‹å››ä¸ªé˜Ÿåˆ—ï¼š å…¥åº¦ä¸º0çš„ä»»åŠ¡èŠ‚ç‚¹è¿›å…¥candidatesé˜Ÿåˆ—ï¼Œcandidatesæ˜¯ä¸€ä¸ªä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œå³é«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡ä¼šè¢«ä¼˜å…ˆæ‰§è¡Œ normalï¼šåˆå§‹åŒ–ä»»åŠ¡æ—¶æ‰€æœ‰ä»»åŠ¡éƒ½åœ¨è¿™ runningï¼šæ­£åœ¨è¿è¡Œçš„ä»»åŠ¡ failedï¼šæ‰§è¡Œå¤±è´¥çš„ä»»åŠ¡ã€‚ completedï¼šæ‰§è¡Œå®Œæˆçš„ä»»åŠ¡ schedulerä¼šè®¾ç½®ä¸€ä¸ªå¹¶è¡Œåº¦ï¼Œä¹Ÿå°±æ˜¯çº¿ç¨‹æ•° å½“ç„¶è¿™åªæ˜¯æ§åˆ¶äº†æˆ‘ä»¬åœ¨Driverå¯åŠ¨çš„çº¿ç¨‹æ•°ï¼Œå®ƒè¡¨ç¤ºæˆ‘ä»¬å¯ä»¥ä¸€æ¬¡å‘sparké›†ç¾¤æäº¤å¤šå°‘å¹¶å‘çš„ä»»åŠ¡ è‡³äºé›†ç¾¤èƒ½å¤Ÿä½¿ç”¨å¤šå°‘èµ„æºå»æ‰§è¡Œï¼Œé‚£æ˜¯é›†ç¾¤çš„èµ„æºè°ƒåº¦ï¼Œå®ƒåŒæ—¶å—åˆ°èƒ½å¤Ÿåˆ†é…ç»™åŒä¸€ä¸ªSparkSessionçš„èµ„æºé…ç½®(ç³»ç»Ÿçº§çš„é…ç½®ï¼Œå½“å‰appç”³è¯·çš„èµ„æºé…ç½®)å’Œå½“å‰é›†ç¾¤èµ„æºä½¿ç”¨æƒ…å†µçš„å½±å“ è¿™é‡Œçš„å¹¶è¡Œåº¦è®¾ç½®çš„æ€è·¯ï¼š 1ã€åœ¨å½“å‰çš„åº”ç”¨åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬çš„Driverç«¯åº”è¯¥å±äºIOå¯†é›†å‹çš„åº”ç”¨(Executorç«¯å±äºè®¡ç®—å¯†é›†å‹åº”ç”¨)ï¼Œæ‰€ä»¥Driverç«¯çš„çº¿ç¨‹å¤§å¤šæ•°æ—¶é—´ä¸æ˜¯èŠ±åœ¨CPUè¿ç®—ä¸Šé¢ï¼Œè€Œæ˜¯èŠ±åœ¨äº†ç­‰å¾…IO(ä¸»è¦æ˜¯ç½‘ç»œIO)ä¸Šï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥å°½å¯èƒ½å¤šçš„å¯åŠ¨ä¸€äº›çº¿ç¨‹ï¼Œå»æäº¤å°½å¯èƒ½å¤š(å½“ç„¶ä¸ä¼šéå¸¸å¤šï¼Œå¤ªå¤šå°±çœŸçš„æ˜¯æµªè´¹èµ„æºäº†)çš„Jobç»™sparkï¼Œè¿™å¯¹äºDriverç«¯å¹¶ä¸ä¼šæœ‰å¾ˆå¤§çš„å‹åŠ›ï¼Œå› æ­¤æˆ‘ä»¬æ ¹æ®å½“å‰å¯æäº¤Jobæ•°è®¾ç½®äº†ä¸€ä¸ªå¹¶è¡Œåº¦ï¼Œè€ƒè™‘åˆ°ä¸€äº›ç‰¹æ®Šæƒ…å†µ(å½“å‰ä»»åŠ¡ç»“æŸåï¼Œä¼šé‡Šæ”¾å¤šä¸ªä¸‹æ¸¸èŠ‚ç‚¹ï¼Œæ‰€ä»¥è‡³å°‘10ä¸ªå¹¶è¡Œåº¦ï¼ŒåŒæ—¶è€ƒè™‘ä¸€æ¬¡æ€§æäº¤å¤ªå¤šä»»åŠ¡ï¼Œåˆå› ä¸ºé›†ç¾¤èµ„æºå¹¶ä¸èƒ½ä¸€æ¬¡æ€§æ»¡è¶³ä¹Ÿå‡å°‘driverçš„ä¸€ç‚¹èµ„æºæ¶ˆè€—ï¼Œå¹¶è¡Œåº¦ä¸Šé™è®¾ä¸º20)ï¼Œæœ€åç¡®å®šçš„å¹¶è¡Œåº¦èŒƒå›´æ˜¯[10,20] 2ã€æ ¹æ®ä¸Šé¢çš„è®²è¿°ï¼Œæˆ‘ä»¬é‡‡ç”¨çš„æ˜¯sparké»˜è®¤çš„FIFOçš„è°ƒåº¦ç­–ç•¥ï¼Œæ‰€ä»¥å°±ç®—æˆ‘ä»¬ä¸€æ¬¡æ€§æäº¤å¤šä¸ªJOBï¼Œä¹Ÿä¸ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Œsparkä¼šæ ¹æ®å½“å‰é›†ç¾¤èµ„æºè‡ªåŠ¨çš„å¯åŠ¨ç›¸å…³çš„JOBè¿è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¸€æ¬¡æ€§æäº¤å¤šä¸ªJOBç»™sparkã€‚å®é™…ä¸Šè¿™æ ·èƒ½å¤Ÿæ›´åŠ å……åˆ†çš„åˆ©ç”¨é›†ç¾¤èµ„æº(ä¸€æ—¦æœ‰jobå®Œæˆï¼Œsparkç«‹é©¬å°±å¯ä»¥ä»é˜Ÿåˆ—ä¸­å–å‡ºæ¥ä¸€ä¸ªæ–°çš„jobæ‰§è¡Œ)ã€‚ è°ƒåº¦æ­¥éª¤ï¼š åœ¨ä¸»çº¿ç¨‹ä¸­ï¼Œåªç®¡å»é—®schedulerè¦å½“å‰å¯ä»¥æ‰§è¡Œçš„ä»»åŠ¡ï¼Œåªè¦æœ‰ä»»åŠ¡è¿”å›å°±ä¸æ–­çš„è¯¢é—®ï¼Œç›´åˆ°schedulerè¿”å›Noneï¼Œé‚£å°±æœ‰ä¸¤ä¸ªé—®é¢˜éœ€è¦è§£å†³ï¼š 1ã€æˆ‘ä»¬è®¾ç½®è¿‡å¹¶è¡Œæäº¤ä»»åŠ¡æ•°äº†ï¼Œè·å–çš„ä»»åŠ¡æ•°å¤§äºæˆ‘ä»¬è®¾ç½®çš„ä»»åŠ¡æ•°æ€ä¹ˆåŠ? 2ã€è¿™é‡Œä»»åŠ¡çš„ä¾èµ–æ˜¯æ€ä¹ˆè§£å†³çš„? 3ã€ä¼˜å…ˆçº§å¦‚ä½•å¤„ç†ï¼Ÿ 4ã€å¦‚æœä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå¤±è´¥äº†æ€ä¹ˆåŠ? é’ˆå¯¹ä»¥ä¸Šå››ä¸ªé—®é¢˜çš„è§£ç­”å¦‚ä¸‹ï¼š 1ã€å¾—åˆ°å¤šå‡ºæ¥çš„ä»»åŠ¡ä¼šè¢«æ”¾åˆ°çº¿ç¨‹æ± çš„é˜Ÿåˆ—ä¸­ï¼Œç­‰åˆ°ä¹‹å‰çš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œå°†çº¿ç¨‹å½’è¿˜ä¹‹åï¼Œä¼šè‡ªåŠ¨è°ƒåº¦æ‰§è¡Œã€‚è¿™æ˜¯çº¿ç¨‹æ± çš„ç­–ç•¥ 2ã€æˆ‘ä»¬ä¹‹å‰è¯´è¿‡ï¼Œæ˜¯å°†å…¥åº¦ä¸º0ä»»åŠ¡èŠ‚ç‚¹å–å‡ºæ”¾åˆ°candidatesé˜Ÿåˆ—ï¼Œå½“ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œé‚£ä¹ˆå°†å…¶ä»runningé˜Ÿåˆ—ä¸­åˆ é™¤ï¼ŒåŠ å…¥åˆ°completedé˜Ÿåˆ—ä¸­ï¼ŒåŒæ—¶å»æ›´æ–°å…¶åé©±ä»»åŠ¡èŠ‚ç‚¹å…¥åº¦å‡ä¸€ï¼Œå¹¶æ£€æŸ¥å…¶å…¥åº¦æ˜¯å¦ä¸º0ï¼Œå¦‚æœä¸º0ï¼Œåˆ™å°†å…¶æ”¾å…¥candidatesé˜Ÿåˆ—ã€‚ å¦‚æœå½“å‰è¯¢é—®æ—¶candidatesä¸ºç©ºäº†ï¼Œå¹¶ä¸èƒ½è¯´æ˜å·²ç»æ²¡æœ‰å€™é€‰ä»»åŠ¡äº†ï¼Œè¿˜å¯èƒ½æ˜¯ç”±äºå‰é©±ä»»åŠ¡éƒ½æ²¡æœ‰æ‰§è¡Œå®Œå¯¼è‡´è¿˜æ²¡æœ‰æ–°ä»»åŠ¡è¢«æ”¾å…¥ï¼Œæ­¤æ—¶ä¼šblockä½(candidates.wait())ï¼Œç›´åˆ°æœ‰æŸäº›ä»»åŠ¡æ‰§è¡Œå®Œæ¯•æ—¶æé†’(candidates.notify())ä¸»çº¿ç¨‹å¯ä»¥ç»§ç»­æ¢ç´¢candidates(å†æ¬¡åˆ¤æ–­candidates.nonEmpty)ï¼Œå¦‚æœæ­¤æ—¶candidatesä¸­åˆæœ‰äº†æ–°çš„ä»»åŠ¡ï¼Œé‚£ä¹ˆå°†ä»»åŠ¡å–å‡ºè¿”å›(ä»normalé˜Ÿåˆ—ä¸­åˆ é™¤ï¼ŒåŠ å…¥åˆ°runningé˜Ÿåˆ—) 3ã€æˆ‘ä»¬è¯´è¿‡candidatesæ˜¯ä¸€ä¸ªä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œå®ƒä¼šæ ¹æ®æ”¾å…¥çš„ä»»åŠ¡çš„ä¼˜å…ˆçº§è¿›è¡Œæ’åºï¼Œä½¿å¾—æˆ‘ä»¬æ¯æ¬¡ä»å…¶ä¸­å–çš„ä»»åŠ¡æ˜¯ä¼˜å…ˆçº§æœ€é«˜çš„ä»»åŠ¡ã€‚ä»candidatesä¸­å–åˆ°çš„ä»»åŠ¡æ”¾åˆ°çº¿ç¨‹æ± ä¸­æ˜¯ä¸€ä¸ªä¸²è¡Œçš„æ‰§è¡Œï¼Œå³å®ƒä¼šæ ¹æ®é€è¿›æ¥çš„ä»»åŠ¡çš„å…ˆåé¡ºåºä¾æ¬¡æ‰§è¡Œ(FIFO) 4ã€è¿™é‡Œæ¶‰åŠåˆ°ä¸€ä¸ªå¤±è´¥ä»»åŠ¡åº”è¯¥å¦‚ä½•å¤„ç†çš„é—®é¢˜ ä¸€æ—¦å¤±è´¥ï¼Œå°†æ•´ä¸ªappåœæ­¢ æŸä¸€ä¸ªä»»åŠ¡å¤±è´¥ï¼Œåªå°†å—åˆ°å…¶å½±å“çš„åé©±ä»»åŠ¡æ ‡è®°ä¸ºå¤±è´¥æ”¾åˆ°failedé˜Ÿåˆ—ã€‚å…¶ä»–ä»»åŠ¡ä¸å—å½±å“ç»§ç»­æ‰§è¡Œ æ˜æ˜¾åè€…æ›´å¥½ å¹¶å‘æ§åˆ¶å¤šçº¿ç¨‹ï¼Œå¹¶å‘ç®¡ç†ï¼ŒåŒæ­¥å¤„ç†(æœ€é‡è¦çš„ä¸€éƒ¨åˆ†ï¼Œå¦åˆ™ä¼šå‘ç”Ÿéš¾ä»¥debugçš„å¹¶å‘é—®é¢˜) åŒæ­¥å¤„ç†ä¸»è¦å°±æ˜¯æ§åˆ¶å¹¶å‘çš„çº¿ç¨‹å¯¹å…±äº«å˜é‡(å†…å­˜)çš„è®¿é—®ä¸æ“ä½œï¼Œæœ€å¸¸ç”¨çš„æ‰‹æ®µå°±æ˜¯åŠ é”ï¼Œç¡®ä¿åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿè®¿é—®å…±äº«å˜é‡ï¼ŒåŒæ—¶è¯¥çº¿ç¨‹å¯¹æ­¤å…±äº«å˜é‡çš„æ”¹å˜ï¼Œå½“è¯¥çº¿ç¨‹é‡Šæ”¾é”ä¹‹åï¼Œæ”¹å˜å¯¹å…¶ä»–çº¿ç¨‹æ˜¯ç«‹å³å¯è§çš„(å½“ç„¶è¿™æ˜¯ç¼–ç¨‹è¯­è¨€è‡ªåŠ¨æ”¯æŒçš„ç‰¹æ€§)ã€‚ å…·ä½“åŸºäºjavaè¯­è¨€å’Œscalaè¯­è¨€çš„å¹¶å‘æ§åˆ¶å°±ä¸å¤šè¯´äº†ï¼Œè¿™é‡Œçš„å†…å®¹éå¸¸å¤šã€‚ ã€è®²ã€‘sparkå¸¸è§çš„å¼‚å¸¸å¤„ç†å†…å­˜å¼‚å¸¸sparkçš„å†…å­˜ç®¡ç†Driverçš„å†…å­˜Driverçš„å†…å­˜ä¸»è¦æœ‰ä¸¤å— JVMè¿›ç¨‹è¿è¡Œæ‰€éœ€è¦çš„å†…å­˜ï¼Œæ¯”å¦‚DAGçš„ç”Ÿæˆã€ç½‘ç»œé€šä¿¡ã€ä»»åŠ¡è°ƒåº¦ æ•°æ®æ‰€å ç”¨çš„å†…å­˜ï¼Œä¸»è¦å°±æ˜¯ç”¨æˆ·æ‰‹åŠ¨collectçš„æ•°æ®ï¼Œä»¥åŠsparkå†…éƒ¨è‡ªå·±ä¼˜åŒ–collectåˆ°driverçš„æ•°æ®ï¼Œæ¯”å¦‚autoBroadcastã€‚åé¢ä¼šä»‹ç»è¿™ä¸­ä¼˜åŒ–æœ‰æ—¶å€™ä¼šå¯¼è‡´Driverçš„OOM Executorå†…å­˜sparkçš„å†…å­˜ç®¡ç†RESERVED_SYSTEM_MEMORY_BYTES 300M - è¿™æ˜¯ç³»ç»Ÿé¢„ç•™çš„æ”¯æŒç³»ç»Ÿè¿è¡Œçš„å†…å­˜ç©ºé—´ systemMemory - Runtime.getRuntime.maxMemory - é»˜è®¤æ˜¯JVMè¿›ç¨‹å¯åŠ¨çš„æ—¶å€™é€šè¿‡-XmxæŒ‡å®šçš„å€¼ minSystemMemory = reservedMemory * 1.5 å½“systemMemory&lt;minSystemMemoryæ—¶ï¼ŒDriveræ˜¯å¯åŠ¨ä¸èµ·æ¥çš„ï¼Œå¯¹åº”çš„å¯åŠ¨å‚æ•°æ˜¯ --driver-memoryï¼Œå¯¹åº”çš„æ˜¯spark.driver.memoryï¼Œé»˜è®¤æ˜¯1G å‚æ•°ï¼šspark.executor.memory executorMemory å½“å…¶å°äºminSystemMemoryæ—¶ï¼Œexecutoræ˜¯å¯åŠ¨ä¸èµ·æ¥çš„ï¼Œå¯¹åº”çš„å¯åŠ¨å‚æ•°ä¸º--executor-memoryï¼Œé»˜è®¤æ˜¯1G usableMemory = systemMemory - reservedMemory å‚æ•°ï¼šspark.memory.fraction 0.6 maxMemory = usableMemory * memoryFraction å‚æ•°ï¼šspark.memory.storageFraction 0.5 onHeapStorage = maxMemory * spark.memory.storageFraction onHeapExecution = maxMemory - onHeapStorage ä¸¾ä¸ªä¾‹å­ï¼šå‡è®¾è®¾ç½®spark.driver.memory=1G=1024M é‚£ä¹ˆDriverç«¯å®é™…ä¸Šèƒ½å¤Ÿç”¨äºexecutionå’Œstorageçš„å†…å­˜åªæœ‰(é»˜è®¤æƒ…å†µä¸‹)ï¼š(1024-300)*0.6=434.4M ä»¥ä¸Šè®²çš„æ˜¯onHeapçš„éƒ¨åˆ†ï¼Œåœ¨å®é™…sparkä¸­ï¼Œè¿˜å¯ä»¥ä½¿ç”¨offHeapå†…å­˜æ¥å¢åŠ æ‰§è¡Œçš„æ•ˆç‡ TODO:offHeapè¿™å—çš„è®¤çŸ¥è¿˜éœ€è¦æ‰“ç£¨ offHeapå’ŒonHeapçš„åŒºåˆ«åœ¨äºï¼Œåœ¨javaä¸­onHeapæ˜¯javaç®¡ç†çš„å†…å­˜ç©ºé—´ï¼Œä¼šè§¦å‘GCï¼Œä¼šæœ‰java Objectçš„é¢å¤–çš„å†…å­˜æ¶ˆè€—(æ¯”å¦‚è¯´å¯¹è±¡å¤´ï¼Œå†å°çš„å¯¹è±¡ï¼Œå¯¹è±¡å¤´ä¹Ÿä¼šå ç”¨12Bytes)ï¼Œè€ŒoffHeapæ˜¯ç›´æ¥å†…å­˜ç©ºé—´ï¼ŒoffHeapå†…å­˜å‚¨çš„å°±æ˜¯å­—èŠ‚æ•°ç»„ï¼Œçº¯æ•°æ®ï¼Œç›´æ¥å¯¹ç‰©ç†å†…å­˜çš„æ“ä½œï¼Œæ•ˆç‡ä¹Ÿä¼šæé«˜ Sparkå‚æ•°spark.executor.memoryOverheadä¸spark.memory.offHeap.sizeçš„åŒºåˆ« Sparkå†…å­˜ç©ºé—´ç®¡ç† 1org.apache.spark.SparkConf: The configuration key &apos;spark.yarn.executor.memoryOverhead&apos; has been deprecated as of Spark 2.3 and may be removed in the future. Please use the new key &apos;spark.executor.memoryOverhead&apos; instead. é™æ€å†…å­˜ç®¡ç† - StaticMemoryManager - å·²ç»ä¸æ˜¯é»˜è®¤é€‰é¡¹äº† å½“è®¾ç½®äº†spark.memory.storageFractionï¼Œé‚£ä¹ˆç”¨æˆ·executeçš„å†…å­˜å’Œç”¨äºstorageçš„å†…å­˜å¤§å°æ˜¯é™å®šæ­»çš„ï¼Œä»–ä»¬ä¸ä¼šæ ¹æ®å®é™…å†…å­˜ä½¿ç”¨æƒ…å†µåŠ¨æ€è°ƒæ•´ã€‚å³ç³»ç»Ÿå¾ˆå¯èƒ½å› ä¸ºæŸä¸€éƒ¨åˆ†çš„å†…å­˜ä¸è¶³è€Œå¼‚å¸¸é€€å‡º åŠ¨æ€å†…å­˜ç®¡ç† - UnifiedMemoryManager - æ˜¯è¾ƒæ–°ç‰ˆæœ¬çš„é»˜è®¤é€‰é¡¹ æ¯”å¦‚è¯´å½“æ²¡æœ‰å†…å­˜è¢«ä½¿ç”¨ä¸ºstorageï¼Œæˆ–å¾ˆå°‘è¢«ä½¿ç”¨ä¸ºstorageï¼ŒåŒæ—¶executeä¼šå ç”¨å¾ˆå¤šå†…å­˜çš„æ—¶å€™ï¼Œè¿™ä¸ªæ—¶å€™ç³»ç»Ÿä¼šè‡ªåŠ¨è°ƒæ•´executionå’Œstorageçš„æ¯”ä¾‹ã€‚spark.memory.storageFractionåªæ˜¯ä¸€ä¸ªåˆå§‹æ¯”ä¾‹ å†…å­˜åˆ©ç”¨ä¼šæ›´åŠ å……åˆ†ï¼Œæˆ‘ä»¬ä¹ŸåŸºæœ¬ä¸ç”¨æ‰‹åŠ¨è®¾ç½®ç›¸å…³çš„å‚æ•°ï¼Œä½¿ç”¨é»˜è®¤å°±å¥½ å¸¸è§å¼‚å¸¸driverå†…å­˜å¼‚å¸¸æœ€å¸¸å¯¼è‡´driverå†…å­˜æº¢å‡ºçš„é—®é¢˜æ˜¯collectç®—å­å¯¼è‡´å¤§é‡æ•°æ®æ¶Œå‘driverèŠ‚ç‚¹ï¼Œå°†å¯¼è‡´å†…å­˜æº¢å‡º å…¶ä¸­æœ‰ä¸€äº›æ˜¯ç”¨æˆ·çš„è¯¯æ“ä½œï¼Œæ¯”å¦‚åœ¨ä»£ç ä¸­å¯¹æ•°æ®é‡æ¯”è¾ƒå¤§çš„dfç›´æ¥è¿›è¡Œcollectæˆ–toPandas(æœ¬è´¨ä¸Šå°±æ˜¯collect)æ“ä½œã€‚ å»ºè®®ï¼šåœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹æ…ç”¨collectç±»å‹çš„æ“ä½œï¼Œå¦åˆ™å¯èƒ½ä¼šå‘ç”Ÿæ¯ç­æ€§çš„äº‹æƒ…ğŸ˜¯ è¿˜æœ‰ä¸€äº›æ˜¯sparkå†…éƒ¨ä¼˜åŒ–å¯¼è‡´çš„ï¼Œæ¯”å¦‚ä¸‹é¢å°†è¦ä»‹ç»çš„autoBroadcastã€‚ autoBroadcastå¯¼è‡´çš„Driverå†…å­˜æº¢å‡ºå®˜æ–¹è§£è¯» sparkä¼šå¯¹å°è¡¨è¿›è¡Œä¼˜åŒ–ï¼Œä½¿ç”¨å¹¿æ’­å˜é‡æ¥åŠ é€Ÿæ•°æ®çš„joinæ“ä½œã€‚æˆ‘ä»¬çŸ¥é“æ™®é€šçš„joinæ“ä½œå¿…ç„¶ä¼šå¯¼è‡´shuffleæ“ä½œï¼Œè¿™æ ·ä¼šå¯¼è‡´é›†ç¾¤å†…å¤§é‡çš„ç½‘ç»œæ•°æ®ä¼ è¾“ï¼Œå¯¼è‡´æ•ˆç‡æ€¥å‰§ä¸‹é™ï¼Œè€Œä¸”ä¼šå ç”¨ç½‘ç»œå¸¦å®½ã€‚ä½†æ˜¯å¦‚æœå‘ç”Ÿjoinçš„è¡¨è¾ƒå°ï¼Œé‚£ä¹ˆsparkä¼šè‡ªåŠ¨æ£€æµ‹å‡ºæ¥å¹¶ä¸”è¿›è¡Œå¹¿æ’­å¤„ç†ï¼Œä»è€Œæ‰§è¡Œmapjoinï¼Œå¯ä»¥æå¤§åœ°å‡å°ç½‘ç»œå¸¦å®½çš„å ç”¨ã€‚ ä½†æ˜¯autoBroadcastçš„é»˜è®¤å·¥ä½œåŸç†æ˜¯å°†å°è¡¨çš„æ•°æ®collectåˆ°driverï¼Œç„¶åä½¿ç”¨broadcastç®—å­è¿›è¡Œå¹¿æ’­æ“ä½œï¼Œå†…å­˜å¢åŠ çš„è®¡ç®—å…¬å¼ä¸ºï¼šspark.sql.autoBroadcastJoinThreshold * the number of broadcast table * 2ï¼Œå½“å¹¿æ’­ä»»åŠ¡æ¯”è¾ƒé¢‘ç¹çš„æ—¶å€™ï¼ŒDriveræœ‰å¯èƒ½å› ä¸ºOOMè€Œå¼‚å¸¸é€€å‡º è§£å†³æ–¹æ¡ˆï¼š 1ã€è°ƒæ•´spark.sql.autoBroadcastJoinThresholdï¼Œsparkä¼šå°†å¤§å°å°äºè¯¥å€¼çš„å°è¡¨è‡ªåŠ¨å¹¿æ’­ï¼Œè°ƒå°è¯¥å€¼ï¼Œå¯ä»¥è®©sparkä¸å¹¿æ’­æŸäº›è¡¨ã€‚ä½†æ˜¯å±äºæŒ‡æ ‡ä¸æ²»æœ¬ æˆ–è€…ç›´æ¥è®¾ç½®ä¸º-1å…³é—­autoBroadcaståŠŸèƒ½ 2ã€è°ƒæ•´driverå†…å­˜ï¼Œå¢åŠ driverå†…å­˜ï¼ŒæŸäº›åœºæ™¯ä¸‹å¯ç”¨ï¼Œå¯èƒ½æ¢åˆ°å¦ä¸€ä¸ªåœºæ™¯å°±ä¸å¯ç”¨äº†ï¼Œå› æ­¤éœ€è¦æ ¹æ®ä¸åŒçš„ä¸šåŠ¡åœºæ™¯è°ƒèŠ‚driverå†…å­˜ä»¥æ»¡è¶³autoBroadcastçš„è¦æ±‚ã€‚ 3ã€è®¾ç½®spark.sql.bigdata.useExecutorBroadcastä¸ºtrueï¼Œä½¿ç”¨Executorå¹¿æ’­ï¼Œå°†è¡¨æ•°æ®ç¼“å­˜åœ¨Executorä¸­ï¼Œè€Œä¸æ˜¯æ”¾åœ¨Driverä¹‹ä¸­ï¼Œå‡å°‘Spark Driverå†…å­˜çš„å‹åŠ›ã€‚driverä¸ç”¨å¤šåšè°ƒæ•´ ç»è¿‡spark2.4.2æµ‹è¯•ï¼Œå®Œå…¨æ²¡æœ‰æ•ˆæœï¼ï¼ï¼ coalesceå¯¼è‡´çš„å†…å­˜æº¢å‡ºSpark-error.log https://stackoverflow.com/questions/31610971/spark-repartition-vs-coalesce/65038141#65038141 https://stackoverflow.com/questions/31674530/write-single-csv-file-using-spark-csv https://stackoverflow.com/questions/38961251/java-lang-outofmemoryerror-unable-to-acquire-100-bytes-of-memory-got-0 test coalesce(1)ã€coalesce(2)ã€ repartition(1) joinä¹‹åæ‰§è¡Œcoalesceã€filterä¹‹åæ‰§è¡Œcoalesceéƒ½ä¼š å¦‚æœcoalesceä¹‹å‰æ²¡æœ‰shuffleçš„æ“ä½œï¼Œç›´æ¥è°ƒç”¨coalesce(1)ï¼Œå¯èƒ½ä¼šå¯¼è‡´Executor OOMï¼Œå› ä¸ºcoalesceæ“ä½œä¸ä¼šè§¦å‘è®¡ç®—æ“ä½œï¼Œå¦‚æœå®ƒä¹‹å‰æ²¡æœ‰shuffleæ“ä½œï¼Œsparkä¸ä¼šæ‰§è¡Œä»»ä½•çš„è®¡ç®—ï¼Œç›´æ¥å°†åŸå§‹æ•°æ®åŠ è½½åˆ°ä¸€ä¸ªExecutorä¸Šï¼Œæ‰ä¼šå¼€å§‹æ‰§è¡Œè®¡ç®—ï¼Œè¿™æ ·çš„è¯ï¼Œå®é™…ä¸ŠExecutorä¸Šå°±æœ‰å¯èƒ½å‘ç”ŸOOM æ¯”å¦‚ï¼š 123For instance: load().map(â€¦).filter(â€¦).coalesce(1).save()translates to: load().coalesce(1).map(â€¦).filter(â€¦).save() Spark - repartition() vs coalesce()ï¼šhttps://stackoverflow.com/questions/31610971/spark-repartition-vs-coalesce/65038141#65038141 æ•°æ®å€¾æ–œä¸»è¦ä½“ç°åœ¨ç»å¤§å¤šæ•°taskæ‰§è¡Œå¾—éƒ½éå¸¸å¿«ï¼Œä¸ªåˆ«taskæ‰§è¡Œå¾ˆæ…¢ï¼Œæ‹–æ…¢æ•´ä¸ªä»»åŠ¡çš„æ‰§è¡Œè¿›ç¨‹ï¼Œç”šè‡³å¯èƒ½å› ä¸ºæŸä¸ªtaskå¤„ç†çš„æ•°æ®é‡è¿‡å¤§è€Œçˆ†å‡ºOOMé”™è¯¯ã€‚ shuffleæ“ä½œä¸­éœ€è¦å°†å„ä¸ªèŠ‚ç‚¹ä¸Šç›¸åŒçš„keyæ‹‰å–åˆ°æŸä¸€ä¸ªèŠ‚ç‚¹ä¸Šçš„ä¸€ä¸ªtaskå¤„ç†ï¼Œå¦‚æœæŸä¸ªkeyå¯¹åº”çš„æ•°æ®é‡ç‰¹åˆ«å¤§ï¼Œå°±ä¼šå‘ç”Ÿæ•°æ®å€¾æ–œã€‚ 4.3.1 åˆ†ææ•°æ®åˆ†å¸ƒ å¦‚æœæ˜¯Spark SQLä¸­çš„group byã€joinè¯­å¥å¯¼è‡´çš„æ•°æ®å€¾æ–œï¼Œå¯ä»¥ä½¿ç”¨SQLåˆ†ææ‰§è¡ŒSQLä¸­çš„è¡¨çš„keyåˆ†å¸ƒæƒ…å†µï¼›å¦‚æœæ˜¯Spark RDDæ‰§è¡Œshuffleç®—å­å¯¼è‡´çš„æ•°æ®å€¾æ–œï¼Œå¯ä»¥åœ¨Sparkä½œä¸šä¸­åŠ å…¥åˆ†æKeyåˆ†å¸ƒçš„ä»£ç ï¼Œä½¿ç”¨countByKey()ç»Ÿè®¡å„ä¸ªkeyå¯¹åº”çš„è®°å½•æ•°ã€‚ 4.3.2 æ•°æ®å€¾æ–œçš„è§£å†³æ–¹æ¡ˆ è¿™é‡Œå‚è€ƒç¾å›¢æŠ€æœ¯åšå®¢ä¸­ç»™å‡ºçš„å‡ ä¸ªæ–¹æ¡ˆã€‚ 1ï¼‰é’ˆå¯¹hiveè¡¨ä¸­çš„æ•°æ®å€¾æ–œï¼Œå¯ä»¥å°è¯•é€šè¿‡hiveè¿›è¡Œæ•°æ®é¢„å¤„ç†ï¼Œå¦‚æŒ‰ç…§keyè¿›è¡Œèšåˆï¼Œæˆ–æ˜¯å’Œå…¶ä»–è¡¨joinï¼ŒSparkä½œä¸šä¸­ç›´æ¥ä½¿ç”¨é¢„å¤„ç†åçš„æ•°æ®ã€‚ 2ï¼‰å¦‚æœå‘ç°å¯¼è‡´å€¾æ–œçš„keyå°±å‡ ä¸ªï¼Œè€Œä¸”å¯¹è®¡ç®—æœ¬èº«çš„å½±å“ä¸å¤§ï¼Œå¯ä»¥è€ƒè™‘è¿‡æ»¤æ‰å°‘æ•°å¯¼è‡´å€¾æ–œçš„key 3ï¼‰è®¾ç½®å‚æ•°spark.sql.shuffle.partitionsï¼Œæé«˜shuffleæ“ä½œçš„å¹¶è¡Œåº¦ï¼Œå¢åŠ shuffle read taskçš„æ•°é‡ï¼Œé™ä½æ¯ä¸ªtaskå¤„ç†çš„æ•°æ®é‡ 4ï¼‰é’ˆå¯¹RDDæ‰§è¡ŒreduceByKeyç­‰èšåˆç±»ç®—å­æˆ–æ˜¯åœ¨Spark SQLä¸­ä½¿ç”¨group byè¯­å¥æ—¶ï¼Œå¯ä»¥è€ƒè™‘ä¸¤é˜¶æ®µèšåˆæ–¹æ¡ˆï¼Œå³å±€éƒ¨èšåˆ+å…¨å±€èšåˆã€‚ç¬¬ä¸€é˜¶æ®µå±€éƒ¨èšåˆï¼Œå…ˆç»™æ¯ä¸ªkeyæ‰“ä¸Šä¸€ä¸ªéšæœºæ•°ï¼Œæ¥ç€å¯¹æ‰“ä¸Šéšæœºæ•°çš„æ•°æ®æ‰§è¡ŒreduceByKeyç­‰èšåˆæ“ä½œï¼Œç„¶åå°†å„ä¸ªkeyçš„å‰ç¼€å»æ‰ã€‚ç¬¬äºŒé˜¶æ®µå…¨å±€èšåˆå³æ­£å¸¸çš„èšåˆæ“ä½œã€‚ 5ï¼‰é’ˆå¯¹ä¸¤ä¸ªæ•°æ®é‡éƒ½æ¯”è¾ƒå¤§çš„RDD/hiveè¡¨è¿›è¡Œjoinçš„æƒ…å†µï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªRDD/hiveè¡¨çš„å°‘æ•°keyå¯¹åº”çš„æ•°æ®é‡è¿‡å¤§ï¼Œå¦ä¸€ä¸ªæ¯”è¾ƒå‡åŒ€æ—¶ï¼Œå¯ä»¥å…ˆåˆ†ææ•°æ®ï¼Œå°†æ•°æ®é‡è¿‡å¤§çš„å‡ ä¸ªkeyç»Ÿè®¡å¹¶æ‹†åˆ†å‡ºæ¥å½¢æˆä¸€ä¸ªå•ç‹¬çš„RDDï¼Œå¾—åˆ°çš„ä¸¤ä¸ªRDD/hiveè¡¨åˆ†åˆ«å’Œå¦ä¸€ä¸ªRDD/hiveè¡¨åšjoinï¼Œå…¶ä¸­keyå¯¹åº”æ•°æ®é‡è¾ƒå¤§çš„é‚£ä¸ªè¦è¿›è¡Œkeyå€¼éšæœºæ•°æ‰“æ•£å¤„ç†ï¼Œå¦ä¸€ä¸ªæ— æ•°æ®å€¾æ–œçš„RDD/hiveè¡¨è¦1å¯¹nè†¨èƒ€æ‰©å®¹nå€ï¼Œç¡®ä¿éšæœºåŒ–åkeyå€¼ä»ç„¶æœ‰æ•ˆã€‚ 6ï¼‰é’ˆå¯¹joinæ“ä½œçš„RDDä¸­æœ‰å¤§é‡çš„keyå¯¼è‡´æ•°æ®å€¾æ–œï¼Œå¯¹æœ‰æ•°æ®å€¾æ–œçš„æ•´ä¸ªRDDçš„keyå€¼åšéšæœºæ‰“æ•£å¤„ç†ï¼Œå¯¹å¦ä¸€ä¸ªæ­£å¸¸çš„RDDè¿›è¡Œ1å¯¹nè†¨èƒ€æ‰©å®¹ï¼Œæ¯æ¡æ•°æ®éƒ½ä¾æ¬¡æ‰“ä¸Š0~nçš„å‰ç¼€ã€‚å¤„ç†å®Œåå†æ‰§è¡Œjoinæ“ä½œ sparkçš„å¸¸è§ä¼˜åŒ–æ­£ç¡®ä½¿ç”¨æ•°æ®ç¼“å­˜cacheï¼šé»˜è®¤ç¼“å­˜çº§åˆ«æ˜¯StorageLevel.MEMORY_AND_DISKï¼Œä¸èƒ½æ›´æ”¹ persistï¼šå¯ä»¥æ‰‹åŠ¨æŒ‡å®šç¼“å­˜çº§åˆ«ï¼Œç›´æ¥è°ƒç”¨persist()ï¼Œæ•ˆæœå’Œcache()ä¸€æ · mapjoinæ‰‹åŠ¨broadcastmapjoin &amp; autoBroadcast joinä¼˜åŒ–ï¼Œsparkä¼šé»˜è®¤å°†å°è¡¨å¹¿æ’­ï¼ŒæŒ‰ç…§å¦‚ä¸‹çš„å‚æ•°è®¾ç½®ï¼Œæ»¡è¶³æ¡ä»¶å°±ä¼šå¹¿æ’­ å‚æ•°ä¼˜åŒ–ï¼š spark.sql.broadcastTimeoutï¼šbroadcastçš„åŠ å¤§è¶…æ—¶çš„æ—¶é—´é™åˆ¶ spark.sql.autoBroadcastJoinThresholdï¼šé»˜è®¤æ˜¯10Mï¼Œå¤§å°ä½äºè¯¥å‚æ•°è®¾ç½®çš„é˜ˆå€¼æ—¶ï¼Œä¼šè¢«å¹¿æ’­ï¼Œä½†æ˜¯é»˜è®¤çš„BroadCastJoinä¼šå°†å°è¡¨çš„å†…å®¹ï¼Œå…¨éƒ¨æ”¶é›†åˆ°Driverä¸­ï¼Œå¯¼è‡´Driverå‹åŠ›å˜å¤§ spark.sql.bigdata.useExecutorBroadcastï¼šè®¾ç½®ä¸ºtrueæ—¶ï¼Œä½¿ç”¨Executorå¹¿æ’­ï¼Œå°†è¡¨æ•°æ®ç¼“å­˜åœ¨Executorä¸­ï¼Œè€Œä¸æ˜¯æ”¾åœ¨Driverä¹‹ä¸­ï¼Œå‡å°‘Spark Driverå†…å­˜çš„å‹åŠ›ã€‚ åœ¨joinä¸­ä½¿ç”¨orè¿æ¥å…³é”®å­—ï¼Œä¼šå¯¼è‡´ç¬›å¡å°”ç§¯çš„äº§ç”ŸCartesianProduct(å½“joinå¤šä¸ªè¡¨)|BroadcastNestedLoopJoin(åªjoinä¸€ä¸ªtable)ï¼Œæ•…ä¸å»ºè®®è¿™æ ·åšã€‚ æœ¬åœ°åŒ–çº§åˆ«ä»…åšäº†è§£ï¼Œç›®å‰é¡¹ç›®ä¸­æ²¡æœ‰å‘ç°å¾ˆæ˜æ˜¾çš„è¿™æ–¹é¢çš„é—®é¢˜å¯¼è‡´çš„æ•ˆç‡ä½ä¸‹ PROCESS_LOCALï¼š taskè¦è®¡ç®—çš„æ•°æ®åœ¨æœ¬è¿›ç¨‹ï¼ˆExecutorï¼‰çš„å†…å­˜ä¸­ã€‚ NODE_LOCALï¼š Â·taskæ‰€è®¡ç®—çš„æ•°æ®åœ¨æœ¬èŠ‚ç‚¹æ‰€åœ¨çš„ç£ç›˜ä¸Š taskæ‰€è®¡ç®—çš„æ•°æ®åœ¨æœ¬èŠ‚ç‚¹å…¶ä»–Executorè¿›ç¨‹çš„å†…å­˜ä¸­ã€‚ NO_PREF taskæ‰€è®¡ç®—çš„æ•°æ®åœ¨å…³ç³»å‹æ•°æ®åº“ä¸­ï¼Œå¦‚mysqlã€‚ RACK_LOCAL taskæ‰€è®¡ç®—çš„æ•°æ®åœ¨åŒæœºæ¶çš„ä¸åŒèŠ‚ç‚¹çš„ç£ç›˜æˆ–è€…Executorè¿›ç¨‹çš„å†…å­˜ä¸­ ANY è·¨æœºæ¶ã€‚ Sparkä¸­ä»»åŠ¡è°ƒåº¦æ—¶ï¼ŒTaskScheduleråœ¨åˆ†å‘ä¹‹å‰éœ€è¦ä¾æ®æ•°æ®çš„ä½ç½®æ¥åˆ†å‘ï¼Œæœ€å¥½å°†taskåˆ†å‘åˆ°æ•°æ®æ‰€åœ¨çš„èŠ‚ç‚¹ä¸Šï¼Œå¦‚æœTaskScheduleråˆ†å‘çš„taskåœ¨é»˜è®¤3sä¾ç„¶æ— æ³•æ‰§è¡Œçš„è¯ï¼ŒTaskSchedulerä¼šé‡æ–°å‘é€è¿™ä¸ªtaskåˆ°ç›¸åŒçš„Executorä¸­å»æ‰§è¡Œï¼Œä¼šé‡è¯•5æ¬¡ï¼Œå¦‚æœä¾ç„¶æ— æ³•æ‰§è¡Œï¼Œé‚£ä¹ˆTaskSchedulerä¼šé™ä½ä¸€çº§æ•°æ®æœ¬åœ°åŒ–çš„çº§åˆ«å†æ¬¡å‘é€taskã€‚ å¦‚ä¸Šå›¾ä¸­ï¼Œä¼šå…ˆå°è¯•1,PROCESS_LOCALæ•°æ®æœ¬åœ°åŒ–çº§åˆ«ï¼Œå¦‚æœé‡è¯•5æ¬¡æ¯æ¬¡ç­‰å¾…3s,ä¼šé»˜è®¤è¿™ä¸ªExecutorè®¡ç®—èµ„æºæ»¡äº†ï¼Œé‚£ä¹ˆä¼šé™ä½ä¸€çº§æ•°æ®æœ¬åœ°åŒ–çº§åˆ«åˆ°2ï¼ŒNODE_LOCAL,å¦‚æœè¿˜æ˜¯é‡è¯•5æ¬¡æ¯æ¬¡ç­‰å¾…3sè¿˜æ˜¯å¤±è´¥ï¼Œé‚£ä¹ˆè¿˜æ˜¯ä¼šé™ä½ä¸€çº§æ•°æ®æœ¬åœ°åŒ–çº§åˆ«åˆ°3ï¼ŒRACK_LOCALã€‚è¿™æ ·æ•°æ®å°±ä¼šæœ‰ç½‘ç»œä¼ è¾“ï¼Œé™ä½äº†æ‰§è¡Œæ•ˆç‡ã€‚ â‘  å¦‚ä½•æé«˜æ•°æ®æœ¬åœ°åŒ–çš„çº§åˆ«ï¼Ÿ å¯ä»¥å¢åŠ æ¯æ¬¡å‘é€taskçš„ç­‰å¾…æ—¶é—´ï¼ˆé»˜è®¤éƒ½æ˜¯3sï¼‰ï¼Œå°†3så€æ•°è°ƒå¤§ï¼Œ ç»“åˆWEBUIæ¥è°ƒèŠ‚ï¼š â€¢ spark.locality.wait â€¢ spark.locality.wait.process â€¢ spark.locality.wait.node â€¢ spark.locality.wait.rack æ³¨æ„ï¼šç­‰å¾…æ—¶é—´ä¸èƒ½è°ƒå¤§å¾ˆå¤§ï¼Œè°ƒæ•´æ•°æ®æœ¬åœ°åŒ–çš„çº§åˆ«ä¸è¦æœ¬æœ«å€’ç½®ï¼Œè™½ç„¶æ¯ä¸€ä¸ªtaskçš„æœ¬åœ°åŒ–çº§åˆ«æ˜¯æœ€é«˜äº†ï¼Œä½†æ•´ä¸ªApplicationçš„æ‰§è¡Œæ—¶é—´åè€ŒåŠ é•¿ã€‚ â‘¡ å¦‚ä½•æŸ¥çœ‹æ•°æ®æœ¬åœ°åŒ–çš„çº§åˆ«ï¼Ÿ é€šè¿‡æ—¥å¿—æˆ–è€…WEBUI å¢é‡è®¡ç®—ä»£æ›¿å…¨é‡è®¡ç®—å¦‚ä½•ä½¿ç”¨å¢é‡è¡¨æ¥ä¼˜åŒ–æ¯æ¬¡å…¨é‡æ•°æ®çš„è·‘æ‰¹ - æ‹¿æˆ‘ä»¬çš„adså±‚çš„ä¸€äº›è¡¨ä¸ºä¾‹æ¥è¯´ ä»€ä¹ˆæ ·çš„æ•°æ®é€‚åˆä½¿ç”¨å¢é‡è®¡ç®—æ¥ä»£æ›¿å…¨é‡è®¡ç®—å‘¢ï¼Ÿè®¡ç®—ç»“æœä¸ä¼šå› ä¸ºæ—¶é—´è·¨åº¦çš„å˜åŒ–è€Œæ”¹å˜ï¼Œå›ºå®šçš„æ—¶é—´èŒƒå›´çš„æ•°æ®è®¡ç®—ç»“æœä¸ä¼šå—åˆ°åç»­æ•°æ®çš„å½±å“ è¿™ä¸ªå°±éœ€è¦å…·ä½“é—®é¢˜å…·ä½“åˆ†æäº†ï¼Œé€šè¿‡å¢é‡è®¡ç®—æ¥ä»£æ›¿å…¨é‡è®¡ç®—å¯ä»¥æå¤§çš„å¢å¤§æ‰§è¡Œæ•ˆç‡ å…¶ä»–ä»£ç çº§åˆ«çš„ä¼˜åŒ– ä¸‰ç±»ç­›é€‰ Partition Filtersï¼šä½¿ç”¨åˆ†åŒºå­—æ®µè¿‡æ»¤ï¼Œå®Œå…¨è·³è¿‡ç‰¹å®šçš„å­è·¯å¾„ Pushed Filtersï¼šæ¨ªå‘å‡å°‘å­˜å‚¨ä¸Aparkä¹‹é—´çš„æ•°æ®ä¼ è¾“ï¼Œæ¯”å¦‚ğŸ‘†è¯´çš„åŸºäºæ—¶é—´æˆ³å­—æ®µä½¿ç”¨Pushed Filtersä¼˜åŒ– 123456789101112-- timestampç±»å‹çš„å­—æ®µcreate_timestamp between CONCAT(add_months(last_day(from_utc_timestamp(now(), 'Asia/Jakarta')), -7),' ','17:00:00') AND CONCAT(date_sub(to_date(from_utc_timestamp(now(), 'Asia/Jakarta')), 1), ' 16:59:59.999')-- long ç±»å‹çš„å­—æ®µcreate_timestamp&lt;=cast(to_utc_timestamp(now(), 'Asia/Jakarta') as long)*1000-- å…¶ä»–åº”ç”¨åœºæ™¯ï¼šå–å½“æœˆçš„æ•°æ®ï¼Œæœˆåˆçœ‹ä¸Šä¸€ä¸ªæ•´æœˆcreate_timestamp between if( day(to_date(from_utc_timestamp(now(), 'Asia/Jakarta')))&lt;&gt;1, concat(to_date(date_sub(date_trunc('MM', to_date(from_utc_timestamp(now(), 'Asia/Jakarta'))), 1)), ' 17:00:00'), concat(to_date(date_sub(date_trunc('MM', date_sub(to_date(from_utc_timestamp(now(), 'Asia/Jakarta')), 1)), 1)), ' 17:00:00')) AND concat(date_add(to_date(from_utc_timestamp(now(), 'Asia/Jakarta')), -1), ' 16:59:59.999') Projection Pushdownï¼šåªæŸ¥è¯¢ä½¿ç”¨åˆ°çš„å­—æ®µï¼Œé¿å…ä½¿ç”¨*ï¼Œçºµå‘å‡å°‘å­˜å‚¨ä¸Sparkä¹‹é—´çš„æ•°æ®ä¼ è¾“ è´Ÿè½½å‡è¡¡ é¿å…æ•°æ®å€¾æ–œ é¿å…ä½¿ç”¨é«˜é¢‘è¯æˆ–è€…nullå€¼è¾ƒå¤šçš„å­—æ®µåˆ†ç»„ç»Ÿè®¡ å¦‚æœä¸å¾—å·²è¦å¤„ç†è´Ÿè½½æåº¦ä¸å‡è¡¡æ•°æ®ï¼Œé¦–å…ˆå¤„ç†å‡è¡¡æ•°æ®ï¼Œç„¶åç‰¹ä¾‹å¤„ç†ä¸å‡è¡¡æ•°æ® å¦‚ä½•å¿«æ·çš„æŸ¥çœ‹sparkçš„æ‰§è¡Œè®¡åˆ’spark web uiçš„SQLé€‰é¡¹ - å¯ä»¥æŸ¥çœ‹ä¸€ä¸ªå…·ä½“çš„å®ä¾‹ æˆ–è€…è°ƒç”¨df.explain()æ–¹æ³•å³å¯æ‰“å°å‡ºæ¥sparkçš„æ‰§è¡Œè®¡åˆ’ã€‚ sparkä¸­çš„äº”ç§joinç­–ç•¥Broadcast Hash Join -&gt; Shuffle Hash Join -&gt; Sort Merge Join -&gt;Cartesian Product Join -&gt; Broadcast Nested Loop Joinhttps://blog.csdn.net/a934079371/article/details/108591314https://www.cnblogs.com/jmx-bigdata/p/14021183.html æ²‰æ€ï¼šjoinä¸­çš„ä¸€ä¸ªorå°±å¯èƒ½å¼•å‘æœ€ä½æ•ˆçš„æ‰§è¡Œï¼Œorè¿æ¥æ˜¯éç­‰å€¼è¿æ¥ï¼Œæ‰€ä»¥ææœ‰å¯èƒ½ä¼šèµ°Cartesian Product Join æˆ–è€… Broadcast Nested Loop Joinï¼Œå³ä¼šè¿›è¡Œæ•ˆç‡æå·®çš„åŒé‡forå¾ªç¯ï¼Œæ¥è¿›è¡Œæ•°æ®åŒ¹é… æ‰€ä»¥ï¼Œæˆ‘ä»¬åœ¨åšè¡¨å…³è”çš„æ—¶å€™ï¼Œä¸€å®šè¦è€ƒè™‘åˆ°æ˜¯å¦æœ‰å°è¡¨å¯ä»¥è¿›è¡Œå¹¿æ’­ï¼Œæœ€ä¼˜çš„ç­–ç•¥æ˜¯Broadcast Hash Joinï¼Œå®ƒä¼šå°†å°è¡¨å¹¿æ’­åˆ°æ‰€æœ‰çš„Executorä¸Šï¼Œç„¶ååœ¨Executorä¸Šæ‰§è¡ŒHash Join Hash Joinï¼šå¯¹äºæ¯ä¸ªShuffleä¹‹åçš„åˆ†åŒºï¼Œä¼šå°†å°è¡¨çš„åˆ†åŒºæ•°æ®æ„å»ºæˆä¸€ä¸ªHash tableï¼Œç„¶åæ ¹æ®join keyä¸å¤§è¡¨çš„åˆ†åŒºæ•°æ®è®°å½•è¿›è¡ŒåŒ¹é…ã€‚ ã€è®²ã€‘å¤§æ•°æ®é›†çš„é«˜æ•ˆå¤„ç†map vs mapPartitionmapï¼šapply func for each Rowï¼Œæ¯ä¸€è¡Œéƒ½ä¼šè°ƒç”¨ä¸€æ¬¡funcå‡½æ•°ï¼Œä¼ é€’ç»™funcå‡½æ•°çš„å‚æ•°æ˜¯Row(æˆ–è€…ä¸€ä¸ªcase classå¯¹è±¡)ï¼Œç»“æœè¿”å›ä¸€ä¸ªæ–°Row(æˆ–è€…ä¸€ä¸ªè‡ªå®šä¹‰çš„case classå¯¹è±¡)ã€‚ mapPartitionï¼šapply func for each partitionï¼Œå¯¹æ¯ä¸€ä¸ªåˆ†åŒºè°ƒç”¨ä¸€æ¬¡funcå‡½æ•°ï¼Œä¼ é€’ç»™funcå‡½æ•°çš„å‚æ•°æ˜¯Iterator[Row] (æˆ–è€…Iterator[case class])è¿­ä»£å™¨ï¼Œç»“æœè¿”å›çš„ä¹Ÿæ˜¯ä¸€ä¸ªè¿­ä»£å™¨ã€‚ mapPartitionç›¸æ¯”äºmapçš„ä¼˜åŠ¿ï¼š å‡å°‘äº†CPUè°ƒç”¨å‡½æ•°çš„æ¬¡æ•° å¦‚æœéœ€è¦è¿æ¥å¤–éƒ¨ç¯å¢ƒï¼Œä½¿ç”¨å®ƒå¯ä»¥å‡å°‘è¿æ¥çš„åˆ›å»º æ¯”å¦‚ä¸€äº›å¯ä»¥åˆ†æ•£åœ¨é›†ç¾¤å†…éƒ¨è¿›è¡Œçš„ä»»åŠ¡ï¼Œæ¯”å¦‚è§£å¯† æ¯”å¦‚è¦åœ¨å¤„ç†çš„è¿‡ç¨‹è¯»å–ä¸€äº›å¤–éƒ¨ä»‹è´¨çš„æ•°æ®ï¼Œæ¯”å¦‚mysqlæˆ–redis å› ä¸ºä¸€æ¬¡æ€§è¦å‡ºä¸€ä¸ªåˆ†åŒºçš„æ•°æ®ï¼Œæ‰€ä»¥å¯èƒ½å¯¼è‡´Executorçš„OOMï¼Œè¿™è¦åœ¨åˆ†åŒºæ•°ä¸Executorå†…å­˜ä¹‹é—´åšæƒè¡¡ã€‚ä¸€èˆ¬æƒ…å†µä¸‹åœ¨èµ„æºå……è¶³çš„æƒ…å†µä¸‹ä½¿ç”¨mapPartitionä¼šæ¯”ä½¿ç”¨mapæ•ˆç‡è¦é«˜ mapç›¸æ¯”äºmapPartitionçš„ä¼˜åŠ¿ï¼š ä¸ä¼šå¯¼è‡´OOMï¼Œå› ä¸ºä¸€æ¬¡åªå¤„ç†ä¸€æ¡è®°å½• å†™æ³•ç®€å•ï¼Œæ˜“äºç†è§£ https://blog.csdn.net/high2011/article/details/79384159 https://blog.csdn.net/weixin_39043567/article/details/89916221 foreach vs foreachPartitionä¸map vs mapPartitionä¸€æ · toLocalIteratorstoLocalIetator()çš„å·¥ä½œåŸç†ç±»ä¼¼äºpythonä¸­çš„itertools.chain(*iterables)ï¼Œç±»ä¼¼äºä¸‹é¢çš„æ–¹å¼ï¼š 12345def chain(*iterables): # chain('ABC', 'DEF') --&gt; A B C D E F for it in iterables: for element in it: yield element å®ƒæ˜¯å°†æ‰€æœ‰çš„partitionå½¢æˆä¸€ä¸ªç±»ä¼¼äºIetatorçš„å½¢å¼ï¼Œä½¿ç”¨çš„æ—¶å€™ï¼Œsparkä¼šå°†æ•°æ®æ•°æ®ä¸€éƒ¨åˆ†ä¸€éƒ¨åˆ†çš„ä»excutorç«¯æ”¶é›†åˆ°driverç«¯(ä»sparkuiä¸Šä¹Ÿå¯ä»¥çœ‹å‡ºæ¥)ï¼Œå¹¶ä¸ä¼šä¸€æ¬¡æ€§å°†æ‰€æœ‰partitionçš„æ•°æ®å…¨é‡æ”¶é›†åˆ°driverç«¯ï¼Œå¯¼è‡´driverç«¯çš„OOMï¼Œè¿™ä¹Ÿæ˜¯ä¸€ç§å¯¼å‡ºå¤§é‡æ•°æ®æ—¶å€™çš„é€‰æ‹©ï¼Œä½†æ˜¯æ•°æ®éœ€è¦ç»å†ä¸€ä¸ªä»excutorå‘driverä¼ è¾“çš„è¿‡ç¨‹ï¼Œæ‰€æœ‰partitionéƒ½æ˜¯ä¸²è¡Œçš„è¿›è¡Œæ•°æ®ä¼ è¾“ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯æ¯”è¾ƒè´¹æ—¶çš„ã€‚ä¸€ä¸ªä½¿ç”¨æ¡ˆä¾‹å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233import shutildef _mkdir(base_dir, filename, delete=False): path = os.path.join(base_dir, filename) if os.path.exists(path) and delete: shutil.rmtree(path, True) if not os.path.exists(path): os.makedirs(path) return pathimport csvdef to_csv(df:DataFrame, filename, threshold=1000000, base_dir='result/'): row_num = 0 index = 0 csvwrite = None csvfile = None first = True for val in df.toLocalIterator():# print(type(val.asDict()))# print(val.asDict())# print([v for k,v in val.asDict().items()]) if first or row_num&gt;=threshold: print(filename + ' write ' + str(index) + '...' + str(threshold*index)) file_path = _mkdir(base_dir, filename, first) csvfile = open(os.path.join(file_path, filename+'_%04d.csv' % index), 'w', buffering=4096) csvwrite = csv.writer(csvfile) index += 1 row_num = 0 first = False csvwrite.writerow(val) csvfile.flush() row_num += 1 ä½¿ç”¨sparkè¿‡ç¨‹ä¸­çš„ä¸€äº›å°Tipssparkä¸­çš„map-struct-arrayå…³äºsparkä¸­çš„mapã€structã€arrayçš„ä¸€äº›æ“ä½œ é¦–å…ˆåˆ›å»ºä¸€ä¸ªdataframe 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263import org.apache.spark.sql.expressions.UserDefinedFunctionimport org.apache.spark.sql.functions._import org.apache.spark.sql.&#123;DataFrame, Row, SparkSession&#125;val sparkConf = new SparkConfsparkConf.set(\"spark.maxRemoteBlockSizeFetchToMem\", 1024 * 1024 * 256 toString)sparkConf.set(\"spark.sql.sources.partitionOverwriteMode\", \"dynamic\")sparkConf.set(\"spark.master\", \"local[*]\")lazy val spark: SparkSession = &#123; SparkSession.builder() .config(sparkConf) .appName(appName) .enableHiveSupport() .getOrCreate()&#125;import spark.implicits._case class TestStruct(f1: String, f2: String)def testUdf: UserDefinedFunction = udf((a: String) =&gt; &#123; List(TestStruct(a, \"f1\"), TestStruct(s\"$a.00\", \"f2\"))&#125;)def testUdf1: UserDefinedFunction = udf((a: String) =&gt; &#123; TestStruct(a, \"f1\")&#125;)def testUdf2: UserDefinedFunction = udf((a: String) =&gt; &#123; Map(\"key\" -&gt; a, \"key1\" -&gt; a)&#125;)val lines: List[(String, Int, Int, Map[String, String])] = List( Tuple4(\"a\", 1, 2, Map(\"a\" -&gt; \"3\", \"c\" -&gt; \"a\")), Tuple4(\"b\", 11, 22, Map(\"a\" -&gt; \"33\", \"c\" -&gt; \"aa\")), Tuple4(\"c\", 111, 2222, Map(\"a\" -&gt; \"3333\", \"c\" -&gt; \"aaa\")))lines.toDF( \"f1\", \"f2\", \"f3\", \"extra\" ).withColumn( \"struct_array\", testUdf('f1) ).withColumn( \"map\", testUdf2('f1) ).withColumn( \"struct\", testUdf1('f1) ).withColumn( \"extra_a\", $\"extra.a\" ).withColumn( \"extra_c\", $\"extra.c\" ).withColumn( \"extra_d\", $\"extra.d\" ).withColumn( \"struct_array_f1\", $\"struct_array.f1\" ).withColumn( \"struct_f1\", $\"struct.f1\" ).withColumn( \"struct_f2\", expr(\"struct['f2']\") ).withColumn( \"struct_array0\", expr(\"struct_array[0]\") ).withColumn( \"struct_array0_f1\", expr(\"struct_array[0].f1\") ) æ‰“å°ä¸Šè¿°dataframeçš„schemaå¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728root |-- f1: string (nullable = true) |-- f2: integer (nullable = true) |-- f3: integer (nullable = true) |-- extra: map (nullable = true) | |-- key: string | |-- value: string (valueContainsNull = true) |-- struct_array: array (nullable = true) | |-- element: struct (containsNull = true) | | |-- f1: string (nullable = true) | | |-- f2: string (nullable = true) |-- map: map (nullable = true) | |-- key: string | |-- value: string (valueContainsNull = true) |-- struct: struct (nullable = true) | |-- f1: string (nullable = true) | |-- f2: string (nullable = true) |-- extra_a: string (nullable = true) |-- extra_c: string (nullable = true) |-- extra_d: string (nullable = true) |-- struct_array_f1: array (nullable = true) | |-- element: string (containsNull = true) |-- struct_f1: string (nullable = true) |-- struct_f2: string (nullable = true) |-- struct_array0: struct (nullable = true) | |-- f1: string (nullable = true) | |-- f2: string (nullable = true) |-- struct_array0_f1: string (nullable = true) è¯»å–è¿™ä¸ªè¡¨æ•°æ®ï¼Œæ‰“å°å‡ºæ¥å¦‚ä¸‹ï¼š ç»“è®ºï¼š mapç»“æ„çš„æ•°æ®å¦‚æœæƒ³ä½¿ç”¨colæˆ–è€…$æ“ä½œç¬¦å–valueï¼Œå¯ä»¥ç›´æ¥é€šè¿‡.å–åˆ°å¯¹åº”çš„å€¼ï¼Œå¦‚æœmapä¸­æ²¡æœ‰å¯¹åº”çš„keyï¼Œåˆ™è¿”å›Noneï¼› ä¸èƒ½ä½¿ç”¨ç±»ä¼¼col(&quot;extra[&#39;a&#39;]&quot;)æˆ–è€…\"extra['a']\"`çš„æ–¹å¼å–`value`ï¼Œä¹Ÿå¯ä»¥æƒ³è±¡ï¼š`col`æˆ–è€…`æ“ä½œç¬¦æœ€ç»ˆè¿”å›çš„æ˜¯ä¸€ä¸ªColumnå¯¹è±¡ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªè´§çœŸä»·å®çš„Columnï¼Œä¸æ˜¯é‚£ç§éœ€è¦è®¡ç®—å¾—æ¥çš„Column è¦æƒ³ä½¿ç”¨extra[&#39;a&#39;]çš„å½¢å¼å–å€¼ï¼Œéœ€è¦ä½¿ç”¨expræ“ä½œç¬¦ï¼Œå¦‚expr(&quot;extra[&#39;a&#39;]&quot;)ï¼Œé¡¾åæ€ä¹‰ï¼Œexpræ¥å—çš„æ˜¯ä¸€ä¸ªè¯­å¥ï¼Œå®ƒä¼šè§£é‡Šå¹¶æ‰§è¡Œå®ƒï¼Œè¿”å›ä¸€ä¸ªColumn structç»“æ„çš„å­—æ®µï¼Œå–æ³•å’Œmapç»“æ„åŸºæœ¬ä¸€è‡´ï¼Œä½†æ˜¯äººä¸€ä¸Šæ¥å°±ä¼šæƒ³åˆ°ç”¨.æ¥å–å€¼ï¼Œè€Œä¸æ˜¯ç”¨[&#39;a&#39;]çš„æ–¹å¼æ¥å–å€¼ï¼Œæ˜¯å› ä¸ºå®ƒæ˜¯ä¸€ä¸ªå®šä¹‰æ¸…æ™°çš„ç»“æ„ä½“ï¼Œå­—æ®µå®šä¹‰æ¸…æ™°ï¼Œä½†æ˜¯expr(struct[&#39;f2&#39;])è¿™ç§å–å€¼æ–¹å¼æ˜¯å¯ä»¥çš„ å¯¹äºä¸€ä¸ªarrayç±»å‹çš„å­—æ®µï¼Œå¦‚æœæƒ³è¦å–ç¬¬iä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆå¿…é¡»è¦ä½¿ç”¨expræ“ä½œç¬¦ï¼Œæ¯”å¦‚ï¼šstruct_array[0]æˆ–struct_array[0].f1 å¦‚æœarrayçš„æ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œå–å€¼æ—¶ä¸éœ€è¦è€ƒè™‘å–å“ªä¸€ä¸ªï¼Œç›´æ¥ä½¿ç”¨.å–æŸä¸ªå­—æ®µï¼Œåˆ™è¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹åº”çš„å­—æ®µçš„arrayï¼Œæ¯”å¦‚ï¼šstruct_array.f1 åœ¨sparkSQLä¸­ä¸éœ€è¦å¿Œè®³ä»¥ä¸Šæ‰€æœ‰çš„é—®é¢˜ï¼Œæƒ³æ€ä¹ˆå–å°±æ€ä¹ˆå–ï¼Œå› ä¸ºå®ƒæœ¬èº«å°±æ˜¯ä¸€ä¸ªexprï¼Œä»–å¯ä»¥å…¼å®¹æ‰€æœ‰çš„æƒ…å†µ^_^ æ„å¤–æ”¶è·ï¼š å¦‚æœä½¿ç”¨scalaæ¥ç¼–å†™sparkçš„ç¨‹åºï¼Œé‚£ä¹ˆåˆ›å»ºmapå’Œstructç±»å‹çš„å­—æ®µï¼Œå°±ååˆ†ç®€å•äº†ã€‚åˆ›å»ºä¸€ä¸ªudfï¼Œç„¶åbalalaä¸€é€šï¼Œudfè¿”å›çš„æ˜¯case classå°±ä¼šå½¢æˆä¸€ä¸ªstructç±»å‹çš„å­—æ®µï¼Œudfè¿”å›çš„æ˜¯ä¸€ä¸ªMapå°±ä¼šå½¢æˆä¸€ä¸ªmapç±»å‹çš„å­—æ®µï¼Œæ¯”å¦‚ä¸Šé¢çš„testUdf2ã€testUdf1ã€testUdf åŒæ—¶ä¹Ÿå¯ä»¥ä½¿ç”¨org.apache.spark.sql.functionsä¸­çš„mapå’Œstructæ–¹æ³•åˆ›å»ºmapæˆ–è€…struct sparkä¸­å¦‚ä½•å¤„ç†jsonæ•°æ®æœ‰ä»¥ä¸‹çš„json 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869&#123; \"status\": \"0x0000\", \"msg\": \"æ‰§è¡ŒæˆåŠŸ\", \"result\": \"é€šè¿‡\", \"score\": \"0\", \"engineName\": \"credit_unit_salim\", \"versionCode\": \"20200702credit_salim\", \"versionId\": 356307673651200, \"engineId\": 355251417716736, \"outputFields\": [ &#123; \"code\": \"return_reason\", \"name\": \"è¾“å‡ºæ‰“å›åŸå› \", \"value\": \"null\" &#125;, &#123; \"code\": \"deny_days\", \"name\": \"è¾“å‡ºæ‹’ç»å¤©æ•°\", \"value\": \"0\" &#125;, &#123; \"code\": \"deny_reason\", \"name\": \"è¾“å‡ºæ‹’ç»åŸå› \", \"value\": \"null\" &#125;, &#123; \"code\": \"decision\", \"name\": \"è¾“å‡ºå†³ç­–\", \"value\": \"forward_manual\" &#125;, &#123; \"code\": \"limit\", \"name\": \"è¾“å‡ºæˆä¿¡é¢åº¦\", \"value\": \"0\" &#125;, &#123; \"code\": \"cash_limit\", \"name\": \"ç°é‡‘è´·æ¬¾é¢åº¦\", \"value\": \"0\" &#125; ], \"inputFields\": [ &#123; \"indo_id_check\": \"DEDY DWI SETYAWAN\", \"indo_identical_accuracy_ktp\": \"-2.0\", \"indo_mobile_number_approving\": \"1\", \"indo_name_diff_id_check\": \"0\", \"indo_name_diff_ocr\": \"1\", \"indo_nik_approving\": \"1\", \"indo_nik_diff_employee_nik\": \"0\", \"indo_nik_diff_ocr\": \"1\", \"indo_ocr_name\": \"DEDY DWI SEVYAWAN\", \"indo_ocr_nik\": \"3525051812850002\", \"indo_reject_his_nik\": \"0\", \"indo_reject_his_tel\": \"0\", \"åŒä¸€ä¸ªç”³è¯·ä¸‹returnæ¬¡æ•°\": \"0\" &#125; ], \"outputFieldInfo\": [ &#123; \"è¾“å‡ºæ‰“å›åŸå› \": \"null\", \"è¾“å‡ºæ‹’ç»å¤©æ•°\": \"0\", \"è¾“å‡ºæ‹’ç»åŸå› \": \"null\", \"è¾“å‡ºå†³ç­–\": \"forward_manual\", \"è¾“å‡ºæˆä¿¡é¢åº¦\": \"0\", \"ç°é‡‘è´·æ¬¾é¢åº¦\": \"0\" &#125; ]&#125; sqlç‰ˆæœ¬å–jsonä¸­çš„arrayï¼Œarrayçš„æ¯ä¸ªå…ƒç´ ä½œä¸ºä¸€ä¸ªmapç»“æ„ 12345678910111213spark.sql(\"\"\"select from_json(data, 'array&lt;map&lt;string,string&gt;&gt;') rfrom ( select json_tuple(json, 'inputFields') data) t\"\"\").printSchema()root |-- r: array (nullable = true) | |-- element: map (containsNull = true) | | |-- key: string | | |-- value: string (valueContainsNull = true) array&lt;map&lt;string,string&gt;&gt;è¿™ä¸ªæ˜¯å¦‚ä½•å¾—æ¥çš„å‘¢ï¼Ÿæ˜¯è¿™æ ·çš„ï¼Œå¯ä»¥ä½¿ç”¨schema_of_jsonå‡½æ•°æ¥è·å–ä¸€ä¸ªjsonçš„ç»“æ„æ˜¯æ€æ ·çš„ã€‚ 12345spark.sql(\"\"\"select schema_of_json(json)\"\"\").toPandas()#array&lt;struct&lt;indo_id_check:string,indo_identical_accuracy_ktp:string,indo_mobile_number_approving:string,indo_name_diff_id_check:string,indo_name_diff_ocr:string,indo_nik_approving:string,indo_nik_diff_employee_nik:string,indo_nik_diff_ocr:string,indo_ocr_name:string,indo_ocr_nik:string,indo_reject_his_nik:string,indo_reject_his_tel:string,åŒä¸€ä¸ªç”³è¯·ä¸‹returnæ¬¡æ•°:string&gt;&gt; ä½†æ˜¯é€šè¿‡ä¸Šè¿°æ–¹å¼å¾—åˆ°çš„ç»“æœä¸èƒ½ç›´æ¥æ‹¿æ¥ç”¨ï¼Œéœ€è¦åšä¸€äº›å˜å½¢ï¼šå¦‚æœarrayçš„æ¯ä¸ªå…ƒç´ çš„å­—æ®µéƒ½æ˜¯å›ºå®šçš„ï¼Œé‚£ä¹ˆå¯ä»¥å°†arrayçš„å…ƒç´ å®šä¹‰ä¸ºä¸€ä¸ªstructï¼Œä½†æ˜¯æˆ‘ä»¬çš„éœ€æ±‚ä¸­çš„æ•°æ®ï¼Œarrayçš„æ¯ä¸ªå…ƒç´ çš„å­—æ®µæ˜¯ä¸å›ºå®šçš„ï¼Œä¸”æˆ‘ä»¬æ²¡æœ‰å°†å…¶å­—æ®µéƒ½ç©·ä¸¾å‡ºæ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±æŠŠå®ƒå®šä¹‰ä¸ºä¸€ä¸ªmapç±»å‹çš„ï¼Œåç»­å°†å®ƒä½¿ç”¨explode_outerå±•å¼€å†è¿›è¡Œå¤„ç†ã€‚é€šè¿‡æŸ¥è¯¢sparkçš„apiï¼Œå¯ä»¥çŸ¥é“MapTypeçš„æ„é€ æ–¹æ³•éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«ä¸ºkeyçš„Typeå’Œvalueçš„Typeï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨æœ€é€šç”¨çš„Stringç±»å‹ä»£æ›¿äº† pyspark 1234567891011from pyspark.sql.functions import *from pyspark.sql.types import *schema = ArrayType(MapType(StringType(), StringType()))spark.sql(\"\"\"select json_tuple(json, 'inputFields') items\"\"\").withColumn( 'items', from_json('items', schema)).toPandas() 123456789101112131415161718192021222324252627282930313233343536373839spark.sql(\"\"\"select json_tuple(json, 'inputFields') items-- from atome_id_mysql_snapshot_ruleengine.t_result_catalog limit 1\"\"\").withColumn( 'items', from_json('items', schema)).withColumn( 'item', explode('items')).withColumn( 'keys', map_keys('item')).withColumn( 'values', map_values('item')).withColumn( 'k_v', arrays_zip('keys', 'values')).withColumn( 'kv', explode_outer('k_v')).printSchema()root |-- items: array (nullable = true) | |-- element: map (containsNull = true) | | |-- key: string | | |-- value: string (valueContainsNull = true) |-- item: map (nullable = true) | |-- key: string | |-- value: string (valueContainsNull = true) |-- keys: array (nullable = true) | |-- element: string (containsNull = true) |-- values: array (nullable = true) | |-- element: string (containsNull = true) |-- k_v: array (nullable = true) | |-- element: struct (containsNull = false) | | |-- keys: string (nullable = true) | | |-- values: string (nullable = true) |-- kv: struct (nullable = true) | |-- keys: string (nullable = true) | |-- values: string (nullable = true) 123456789101112131415df = spark.sql(\"\"\"select json_tuple(json, 'inputFields') items\"\"\").withColumn( 'items', from_json('items', schema)).withColumn( 'item', explode('items'))# df.printSchema()# df.select(expr(\"posexplode(d)\")).printSchemadf.select(expr('explode(item)')).toPandas() # å°†map å±•å¼€ posexplodeä¼šå¤šä¸€ä¸ªposçš„å­—æ®µ key value 0 indo_id_check DEDY DWI SETYAWAN 1 indo_identical_accuracy_ktp -2.0 2 indo_mobile_number_approving 1 3 indo_name_diff_id_check 0 4 indo_name_diff_ocr 1 5 indo_nik_approving 1 6 indo_nik_diff_employee_nik 0 7 indo_nik_diff_ocr 1 8 indo_ocr_name DEDY DWI SEVYAWAN 9 indo_ocr_nik 3525051812850002 10 indo_reject_his_nik 0 11 indo_reject_his_tel 0 12 åŒä¸€ä¸ªç”³è¯·ä¸‹returnæ¬¡æ•° 0 å¦‚ä½•ç†è§£import spark.implicits._åœ¨åˆæœŸä½¿ç”¨sparkçš„æ—¶å€™ï¼Œå¤§å®¶éƒ½ä¼šé‡è§ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„å†™æ³•import spark.implicits._ è¿™é‡Œé¢åŒ…å«äº†å››ä¸ªå…³é”®å­—ï¼šimportã€sparkã€implicitsã€_ importå’Œ_å®é™…ä¸Šæ˜¯Scalaä¸­åŒ…å¼•å…¥çš„å†™æ³•ï¼Œè¡¨ç¤ºå¼•å…¥æŒ‡å®šåŒ…å†…çš„æ‰€æœ‰æˆå‘˜ æœ¬æ–‡ä¸»è¦æƒ³è®°å½•ä¸€ä¸‹å¦å¤–ä¸¤ä¸ªå…³é”®å­—ï¼šsparkã€implicits å…³é”®å­—ä¸€ï¼šspark sparkåœ¨è¿™é‡Œæ˜¯è¿™æ ·äº§ç”Ÿçš„ï¼š 12345val conf: SparkConf = new SparkConf().setMaster(\"local\").setAppName(\"test\")val spark: SparkSession = SparkSession .builder() .config(conf) .getOrCreate() é‚£ä¹ˆè¿™å°±ä¼šæœ‰ç‚¹è®©äººå¥‡æ€ªçš„åœ°æ–¹äº†ï¼Œåœ¨scalaä¸­importåˆ°åº•æ˜¯å¦‚ä½•å·¥ä½œçš„å‘¢ï¼Ÿä¸ºä»€ä¹ˆå¯ä»¥importä¸€ä¸ªå®ä¾‹å¯¹è±¡å‘¢ï¼Ÿ ç»è¿‡æŸ¥è¯¢å‘ç°ï¼Œscalaç¡®å®èƒ½å¤Ÿå¯¼å…¥è¿è¡Œæ—¶å¯¹è±¡å®ä¾‹çš„æˆå‘˜ï¼Œä¸¾ä¾‹å¦‚ä¸‹ï¼š 1234567891011121314151617181920scala&gt; case class User(name:String, age:Int)defined class Userscala&gt; val a=User(\"zzz\",39)a: User = User(zzz,39)scala&gt; println(\"%s's age is %d\" format (a.name, a.age))zzz's age is 39scala&gt; import a._import a._scala&gt; println(\"%s's age is %d\" format (name, age))zzz's age is 39scala&gt; nameres3: String = zzzscala&gt; ageres4: Int = 39 å®šä¹‰äº†ä¸€ä¸ªcase class Userï¼Œç„¶åæ‰§è¡Œäº†ä¸€æ¬¡import a._ï¼Œç„¶åå‘ç°å¯ä»¥ç›´æ¥ä½¿ç”¨aå®ä¾‹å¯¹è±¡çš„å±æ€§å˜é‡ï¼Œè€Œä¸éœ€è¦åŠ a.çš„å‰ç¼€ã€‚ é‚£ä¹ˆä¸ºä»€ä¹ˆåœ¨sparkä¸­éœ€è¦è¿™ä¹ˆåšå‘¢ï¼Ÿæˆ‘ä»¬ç‚¹è¿›å»spark.implicitsï¼Œä¼šå‘ç°æºç æ˜¯è¿™æ ·çš„ï¼š 12345class SparkSession &#123; object implicits extends SQLImplicits with Serializable &#123; protected override def _sqlContext: SQLContext = SparkSession.this.sqlContext &#125;&#125; implicitsæ˜¯SparkSessionçš„ä¸€ä¸ªå†…éƒ¨å•ä¾‹å¯¹è±¡ï¼Œå®ƒæœ‰ä¸€ä¸ª_sqlContextçš„å‡½æ•°ï¼Œç”¨äºè·å–SQLContextï¼Œä½†æ˜¯å®ƒå¿…é¡»è°ƒç”¨å½“å‰æ­£åœ¨è¿è¡Œçš„SparkSessionå®ä¾‹ï¼Œé€šè¿‡è°ƒç”¨å®ƒçš„sqlContextå±æ€§æ¥è·å–ã€‚æºç ä¸­çš„SparkSession.thiså®é™…ä¸Šæ˜¯è°ƒç”¨äº†SparkSession classçš„ä¼´ç”Ÿå¯¹è±¡çš„.thisï¼Œè¿™ä¸ªthiså®é™…ä¸Šå°±æ˜¯æ­£åœ¨è¿è¡Œçš„SparkSessionå®ä¾‹ã€‚ å…·ä½“çš„éšå¼è½¬æ¢éƒ½å¯ä»¥åœ¨org.apache.spark.sql.SQLImplicitsä¸­çœ‹åˆ° è¿™é‡Œå®é™…ä¸Šæ˜¯scalaä¸­classä¸ä¼´ç”Ÿå¯¹è±¡çš„çˆ±æ¨çº ç¼ ä»¥åŠimportå…³é”®å­—çš„ä½¿ç”¨æŠ€å·§ ä¸‹é¢ç»™å‡ºä¸€ä¸ªæµ‹è¯•æ¡ˆä¾‹ï¼š 1234567891011121314151617181920212223// TestObject.scalaclass TestObject(name: String, age: Int) &#123; val user: User = new User(name, age) object innerObj &#123; val user1: User = TestObject.this.user def say(name: String) &#123; println(s\"$&#123;name&#125; innerObj say TestObject.this = $&#123;TestObject.this&#125;\") &#125; &#125; def say2(): Unit = &#123; println(s\"TestObject say2 TestObject.this = $&#123;TestObject.this&#125;\") &#125;&#125;object TestObject &#123;&#125; 1234567// User.scalaclass User(name: String, age: Int) &#123; def say(): Unit = &#123; println(\"%s's age is %d\" format(name, age)) &#125;&#125; 123456789101112131415161718192021222324252627// Test.scalaobject Test &#123; def main(args: Array[String]): Unit = &#123; val testObject = new TestObject(\"sfa\", 12) println(s\"testObject = $testObject\") // a testObject.say2() // b println(s\"testObject.user = $&#123;testObject.user&#125;\") // c import testObject.innerObj._ println(s\"user1 = $user1\") // d say(\"testObject\") // e println(\"------------------------------\")// val testObject1 = new TestObject(\"abc\", 24)// println(s\"testObject1 = $testObject1\")// testObject1.say2()// println(s\"testObject1.user = $&#123;testObject1.user&#125;\")// import testObject1.innerObj._//// println(s\"testObject1 user1 = $user1\")// say(\"testObject1\") &#125;&#125; æ‰“å°ç»“æœå¦‚ä¸‹ï¼š 123456testObject = com.msb.bigdata.scala.test_object.TestObject@5702b3b1TestObject say2 TestObject.this = com.msb.bigdata.scala.test_object.TestObject@5702b3b1testObject.user = com.msb.bigdata.scala.test_object.User@192b07fduser1 = com.msb.bigdata.scala.test_object.User@192b07fdtestObject innerObj say TestObject.this = com.msb.bigdata.scala.test_object.TestObject@5702b3b1------------------------------ é€šè¿‡æ‰“å°ç»“æœå¯ä»¥çœ‹åˆ°ï¼š aã€bã€eä¸‰å¤„æ‰“å°çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡å®ä¾‹ï¼Œæ‰€ä»¥å¯ä»¥æ–­å®šåœ¨class TestObjectçš„å†…éƒ¨ä¸­å¦‚æœè°ƒç”¨äº†TestObject.thiså®é™…ä¸Šæ˜¯æŒ‡å‘çš„æ­£åœ¨è¿è¡Œä¸­çš„testObjectå¯¹è±¡ TestObject.thisåªèƒ½åœ¨class TestObjectçš„å†…éƒ¨è°ƒç”¨ï¼Œä¸èƒ½åœ¨å¤–éƒ¨è°ƒç”¨ Test.scalaä¸­æ³¨æ‰çš„é‚£ä¸€éƒ¨åˆ†ï¼Œè¿™ä¸€å¥import testObject1.innerObj._ä¼šåœ¨ç¼–è¯‘æœŸé—´æŠ¥é”™ï¼Œå¦‚ä¸‹ 1234567891011Error:(29, 36) reference to user1 is ambiguous;it is imported twice in the same scope byimport testObject1.innerObj._and import testObject.innerObj._ println(s&quot;testObject1 user1 Error:(30, 5) reference to say is ambiguous;it is imported twice in the same scope byimport testObject1.innerObj._and import testObject.innerObj._ say(&quot;testObject1&quot;)= $user1&quot;) import å®ä¾‹å¯¹è±¡çš„è¡Œä¸ºä¸èƒ½è¢«å¤šæ¬¡ä½¿ç”¨ï¼Œè¯´çš„æ˜¯user1å˜é‡å’Œsayå‡½æ•°è¢«é‡å¤importåœ¨åŒä¸€ä¸ªä½œç”¨åŸŸå†…ï¼Œå¼•å‘äº†æ­§ä¹‰ åœ¨sparké‚£é‡Œï¼Œä¸å…è®¸ä»¥ä¸‹çš„å†™æ³•ï¼š 1234567891011121314151617181920212223242526272829303132333435object lesson02_sql_api01_1 &#123; def main(args: Array[String]): Unit = &#123; val conf: SparkConf = new SparkConf().setMaster(\"local\").setAppName(\"test\") val session: SparkSession = SparkSession .builder() .config(conf) .getOrCreate() import session.implicits._ println(session) val session1: SparkSession = SparkSession .builder() .config(conf) .getOrCreate() println(session1) import session1.implicits._ val dataDF: DataFrame = List( \"hello world\", \"hello world\", \"hello msb\", \"hello world\", \"hello world\", \"hello spark\", \"hello world\", \"hello spark\" ).toDF(\"line\") dataDF.show() &#125;&#125;// import session.implicits._ å’Œ import session1.implicits._å¯ä»¥åŒæ—¶å‡ºç°ï¼Œä½†æ˜¯å¦‚æœç”¨åˆ°äº†å…¶ä¸­çš„éšå¼è½¬æ¢ï¼Œå°±ä¼šæŠ¥é”™ï¼Œä¸€èˆ¬ä¹Ÿæ²¡äººä¼šè¿™ä¹ˆå†™ å°†Test.scalaæ›¿æ¢æˆå¦‚ä¸‹çš„å†™æ³•ï¼š 1234567891011121314151617181920212223242526272829object Test &#123; def main(args: Array[String]): Unit = &#123; val testObject = new TestObject(\"sfa\", 12) println(s\"testObject = $testObject\") // a testObject.say2() // b println(s\"testObject.user = $&#123;testObject.user&#125;\") // c import testObject.innerObj._ println(s\"user1 = $user1\") // d say(\"testObject\") // e println(\"------------------------------\") val testObject1 = new TestObject(\"abc\", 24) println(s\"testObject1 = $testObject1\") testObject1.say2() println(s\"testObject1.user = $&#123;testObject1.user&#125;\")// import testObject1.innerObj._//// println(s\"testObject1 user1 = $user1\")// say(\"testObject1\") println(s\"testObject.innerObj.user1 = $&#123;testObject.innerObj.user1&#125;\") println(s\"testObject.innerObj.say = $&#123;testObject.innerObj.say(\"testObject1\")&#125;\") &#125;&#125; æ‰“å°ç»“æœå¦‚ä¸‹ï¼š 123456789101112testObject = com.msb.bigdata.scala.test_object.TestObject@5702b3b1TestObject say2 TestObject.this = com.msb.bigdata.scala.test_object.TestObject@5702b3b1testObject.user = com.msb.bigdata.scala.test_object.User@192b07fduser1 = com.msb.bigdata.scala.test_object.User@192b07fdtestObject innerObj say TestObject.this = com.msb.bigdata.scala.test_object.TestObject@5702b3b1------------------------------testObject1 = com.msb.bigdata.scala.test_object.TestObject@64bfbc86TestObject say2 TestObject.this = com.msb.bigdata.scala.test_object.TestObject@64bfbc86testObject1.user = com.msb.bigdata.scala.test_object.User@64bf3bbftestObject1.innerObj.user1 = com.msb.bigdata.scala.test_object.User@64bf3bbftestObject1 innerObj say TestObject.this = com.msb.bigdata.scala.test_object.TestObject@64bfbc86testObject1.innerObj.say = () æˆ‘ä»¬ä¼šå‘ç°ï¼Œå°±æ²¡é—®é¢˜äº†ã€‚è€Œä¸”testObject1çš„InnerObjectè°ƒç”¨çš„TestObject.thiså®é™…ä¸Šæ˜¯æŒ‡å‘çš„testObject1å¯¹è±¡ã€‚ å…³é”®å­—äºŒï¼šimplicits import spark.implicits._ä¸­çš„implicitså…³é”®å­—å®é™…ä¸Šæ˜¯SparkSessionçš„å†…éƒ¨objectï¼Œå®ƒç»§æ‰¿äº†SQLImplicits 123object implicits extends SQLImplicits with Serializable &#123; protected override def _sqlContext: SQLContext = SparkSession.this.sqlContext&#125; org.apache.spark.sql.SQLImplicitsï¼šA collection of implicit methods for converting common Scala objects into Datasets. ä»ä»¥ä¸Šçš„æ¡ˆä¾‹ä¸­å¯ä»¥å¾—åˆ°ï¼š SparkSession.thisæ˜¯å½“å‰è¿è¡Œçš„SparkSessionå®ä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®ä¾‹å¯¹è±¡å°†SparkSessionçš„å†…éƒ¨objectå¼•å…¥è¿›æ¥ã€‚è¿™é‡Œä¸ºä»€ä¹ˆä¸€å®šè¦ä½¿ç”¨SparkSessionå®ä¾‹çš„è¿™ç§æ–¹å¼å¼•å…¥éšå¼è½¬æ¢å‘¢ï¼Ÿæ ¹æ®æºç å¯ä»¥çŸ¥é“ï¼Œåœ¨è¿›è¡Œéšå¼è½¬æ¢çš„æ—¶å€™éœ€è¦ç”¨åˆ°sqlContextï¼Œå®ƒæ˜¯sparkSessionçš„ä¸€ä¸ªå±æ€§ï¼Œåªæœ‰åœ¨SparkSessionåˆ›å»ºå®Œæˆä¹‹åï¼Œå®ƒæ‰æœ‰å€¼ã€‚ å¯ä»¥çœ‹åˆ°åœ¨org.apache.spark.sql.SQLImplicitsä¸­è¿™é‡Œç”¨åˆ°äº†_sqlContextå¯¹è±¡ 12345678910111213141516/** * Creates a [[Dataset]] from an RDD. * * @since 1.6.0 */implicit def rddToDatasetHolder[T : Encoder](rdd: RDD[T]): DatasetHolder[T] = &#123; DatasetHolder(_sqlContext.createDataset(rdd))&#125;/** * Creates a [[Dataset]] from a local Seq. * @since 1.6.0 */implicit def localSeqToDatasetHolder[T : Encoder](s: Seq[T]): DatasetHolder[T] = &#123; DatasetHolder(_sqlContext.createDataset(s))&#125; ä»org.apache.spark.sql.SQLImplicitsä¸­ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å‡ ä¸ªéå¸¸æ¼‚äº®çš„éšå¼è½¬æ¢ï¼Œå¦‚ä¸‹ï¼š 12345678910111213141516/** * Converts $\"col name\" into a [[Column]]. * * @since 2.0.0 */implicit class StringToColumn(val sc: StringContext) &#123; def $(args: Any*): ColumnName = &#123; new ColumnName(sc.s(args: _*)) &#125;&#125;/** * An implicit conversion that turns a Scala `Symbol` into a [[Column]]. * @since 1.3.0 */implicit def symbolToColumn(s: Symbol): ColumnName = new ColumnName(s.name) è¿™å°±æ˜¯æˆ‘ä»¬å¹³æ—¶å¯ä»¥ç›´æ¥ä¸‹å¦‚ä¸‹çš„è„šæœ¬çš„å…³é”®æ‰€åœ¨ï¼š 1df.select(\"a\", \"b\", $\"c\", $\"d\"+1, 'e, 'f) why create SparkSession\\what is SparkSessionClient - Driver 1ã€ç¬¬ä¸€ä¸ªå±æ€§å°±æ˜¯ï¼šsparkContext ä¸€ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ æ˜¯ç”¨æˆ·ç«¯ç¨‹åºä¸sparké›†ç¾¤æ²Ÿé€š(é€šä¿¡)çš„æ¡¥æ¢ï¼šæäº¤ä»»åŠ¡ã€ç›‘æ§ä»»åŠ¡ã€ä»»åŠ¡è°ƒåº¦ï¼Œæ”¯æŒsparkåˆ†å¸ƒå¼çš„æ ¸å¿ƒï¼Œè¿™é‡Œé¢è¦è®²çš„å†…å®¹å°±å¤ªå¤šäº†ï¼Œ 2ã€æä¾›æ‰§è¡Œspark sqlçš„å…¥å£ 3ã€æä¾›tableæ–¹æ³• ç›´æ¥è¯»å–hiveè¡¨ 4ã€å°è£…äº†ä¸€ç³»åˆ—åˆ›å»ºDataFrameçš„æ–¹æ³• ä»€ä¹ˆæ˜¯DataFrameï¼štype DataFrame = Dataset[Row] æ‰€ä»¥è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬æ¯ä¸ªapplicationéƒ½è¦å…ˆåˆ›å»ºä¸€SparkSessionæˆ–è€…sparkContextçš„åŸå› äº†ã€‚å…·ä½“ç»†èŠ‚æš‚æ—¶æ— æ³•å±•å¼€ï¼Œå¯¹äºä¸ç†è§£ä¸ºä»€ä¹ˆè¦åˆ›å»ºè¿™ä¸ªå¯¹è±¡çš„åŒå­¦æ¥è¯´ï¼Œç†è§£åˆ°è¿™é‡Œå°±å¤Ÿäº† çª—å£å‡½æ•°ä»€ä¹ˆæ˜¯çª—å£å‡½æ•°ï¼Ÿåº”è¯¥å¦‚ä½•ç†è§£å¼€çª—æ“ä½œï¼Ÿ çª—å£å‡½æ•°æ˜¯å¯¹ä¸€ç»„å…·æœ‰ç›¸åŒkeyçš„æ•°æ®(partition by)ï¼Œæ ¹æ®ç‰¹å®šçš„å­—æ®µé¡ºåº(order by)åšçš„ä¸€ä¸ªç‰¹æ®Šçš„å¤„ç†ï¼Œæ—¢ç„¶æ˜¯çª—å£ï¼Œé‚£ä¹ˆé™¤äº†å¯ä»¥é™å®šæ ¹æ®å“ªä¸ªkeyåˆ†ç»„ï¼Œæ ¹æ®å“ªä¸ªå­—æ®µæ’åºï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é™å®šçª—å£çš„å¤§å°(rows betweenæˆ–è€… range between) å¼€çª—æ“ä½œï¼Œå®é™…ä¸Šæ˜¯ä»åˆ’åˆ†å¥½çš„çª—å£å†…çš„æå–ä¸€äº›å…³é”®ä¿¡æ¯ï¼Œæ¯”å¦‚ï¼šä¸€ä¸ªçª—å£å†…çš„é¡ºåº(row_number)ï¼Œç»Ÿè®¡å€¼(maxã€minã€mean)ï¼Œç¬¬ä¸€ä¸ªå€¼(first)ï¼Œæœ€åä¸€ä¸ªå€¼(last)ï¼›ä»¥åŠä¸€äº›ç‰¹æ®Šä¿¡æ¯ï¼Œæ¯”å¦‚ï¼šå–çª—å£å†…å½“å‰è¡Œçš„å‰nè¡Œæ•°æ®(lag)ï¼Œå–çª—å£å†…å½“å‰è¡Œçš„ånè¡Œ(lead)ç­‰ æ³¨æ„ï¼Œå¼€çª—æ“ä½œä¸ä¼šå‡å°‘æ•°æ®é‡ çª—å£å‡½æ•°é€‚åˆä»€ä¹ˆæ ·çš„åœºæ™¯ ç±»ä¼¼äºè§åˆ°ä»¥ä¸‹çš„ä¸€äº›åœºæ™¯ï¼Œå°±å¯ä»¥è€ƒè™‘ä½¿ç”¨çª—å£å‡½æ•°ï¼Œéœ€è¦åˆ†ç»„ï¼Œ[éœ€è¦ç»„å†…æ’åºï¼Œ]åŒæ—¶åˆä¸èƒ½å‡å°‘åˆ—çš„æ•°é‡(å…¶ä»–çš„åˆ—åº”è¯¥ä¿æŒä¸å˜) å–ç”¨æˆ·çš„ç¬¬1æ¡è®¢å•ï¼Œ row_number() over(partition by user_id order by create_timestamp) = 1 ç»™æ¯ä¸ªç”¨æˆ·çš„è®¢å•æŒ‰ç…§åˆ›å»ºæ—¶é—´åŠ ä¸ªåºå·ï¼Œrow_number() over(partition by user_id order by create_timestamp) éœ€è¦åˆ¤æ–­ç”¨æˆ·ä»å“ªä¸ªé¡µé¢è¿‡æ¥çš„ï¼Œæ ¹æ®ç›®å‰æˆ‘ä»¬çš„åŸ‹ç‚¹ç»“æ„ï¼Œå°±å¯ä»¥ï¼š ç¦»å¼€ä¸Šä¸€ä¸ªé¡µé¢ï¼šlast_pageï¼ŒLeavePage è¿›å…¥å½“å‰é¡µé¢ï¼šcurrent_pageï¼ŒPageEvent ä¸¥æ ¼æƒ…å†µï¼ŒåŸ‹ç‚¹æ‰“ç‚¹çš„æ—¶å€™ä¸€å®šä¼šæŒ‰ç…§å…ˆç¦»å¼€å†è¿›å…¥ï¼Œä¸”è¿™ä¸¤è€…ä¹‹é—´å†æ²¡æœ‰å…¶ä»–çš„actionå‘ç”Ÿï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥ 1select current_page, lag(last_page) over(partition by user_id order by timestamp) last_page from ... ä½†æ˜¯å‘¢ï¼Œé€šå¸¸æƒ…å†µä¸‹è¿™ç§æƒ…å†µæ˜¯ä¸å¯èƒ½ä¸€ç›´ä¿æŒçš„ï¼Œç”±äºå„ç§æ‰“ç‚¹çš„é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€€ä¸€æ­¥åˆ¤æ–­ï¼Œåªè¦ä¿è¯è¿›å…¥å½“å‰é¡µé¢å‰ä¸€å®šæœ‰ä¸€ä¸ªç¦»å¼€ä¸Šä¸€ä¸ªé¡µé¢çš„actionï¼Œå°±å¯ä»¥äº†ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸ªè¦æ±‚ï¼ŒåŸ‹ç‚¹ä¸èƒ½æ¼æ‰ï¼Œå¦åˆ™ä¹Ÿæ— æ³•è¿›è¡Œåˆ¤æ–­äº†ã€‚å¯ä»¥è¿™æ ·åš 1select current_page, last(if(action='LeavePage' last_page, null), true) over(partition by user_id order by timestamp) last_page from ... trueè¡¨ç¤ºåªè¿”å›æœ€åä¸€ä¸ªä¸ä¸ºç©ºçš„last_page å°†æŸä¸ªå€¼è¾å°„åˆ°çª—å£å†…çš„æ‰€æœ‰è®°å½•ä¸Š çª—å£å‡½æ•°ä¸åˆ†ç»„èšåˆå‡½æ•°çš„åŒºåˆ« çª—å£å‡½æ•°ä¸ä¼šå‡å°‘æ•°æ®é‡ï¼Œå®ƒçš„ç»“æœæ˜¯æŠŠä»ç‰¹å®šçª—å£æå–çš„ä¿¡æ¯æ”¾åˆ°ä¸€ä¸ªæ–°åˆ—ä¸Š åˆ†ç»„èšåˆå‡½æ•°ï¼Œä¼šç›¸åº”çš„å‡å°‘æ•°æ®é‡ï¼Œæœ€ç»ˆçš„ç»“æœåªä¼šä¿ç•™è¢«åˆ†ç»„çš„å­—æ®µä»¥åŠèšåˆçš„å­—æ®µ çª—å£çš„å¤§å°å¦‚ä½•è®¾å®šï¼Ÿ çª—å£å¤§å°æœ‰ä¸¤ç§æ–¹å¼å¯ä»¥è®¾å®š å­çª—å£éœ€è¦æŒ‡å®šä¸€ä¸ªè¾¹ç•Œï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼š ROWS between CURRENT ROW | UNBOUNDED PRECEDING | [num] PRECEDING AND UNBOUNDED FOLLOWING | [num] FOLLOWING| CURRENT ROW RANGE between [num] PRECEDING AND [num] FOLLOWING çª—å£çš„å«ä¹‰ ROWSæ˜¯ç‰©ç†çª—å£ï¼Œä»è¡Œæ•°ä¸Šæ§åˆ¶çª—å£çš„å°ºå¯¸çš„ï¼Œè¡¨ç¤ºåœ¨å½“å‰è¡Œçš„å‰ååç§»é‡ï¼Œè¾ƒå¥½ç†è§£ã€‚RANGEæ˜¯é€»è¾‘çª—å£ï¼Œä»åˆ—å€¼ä¸Šæ§åˆ¶çª—å£çš„å°ºå¯¸ï¼Œè¡¨ç¤ºæ ¹æ®å½“å‰åˆ—å€¼çš„å‰ååç§»é‡ï¼Œæ˜¯ä¸å½“å‰åˆ—çš„å…·ä½“å€¼æŒ‚é’©çš„ï¼ï¼ï¼ æ¯”å¦‚ï¼šrange between 4 preceding AND 7 followingï¼Œæè¿°çš„æ˜¯ï¼šå¦‚æœå½“å‰å€¼ä¸º10çš„è¯å°±å–å‰åçš„å€¼åœ¨6åˆ°17ä¹‹é—´çš„æ•°æ®ã€‚ å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼šhttps://blog.csdn.net/qq_42374697/article/details/115109386 çª—å£å‡½æ•°çš„ä¸€äº›é»˜è®¤æƒ…å†µ 123sum(1) over(partition by shop_id order by date)-- æœ‰order by å…³é”®å­—ï¼Œæ’åºçš„æ—¶å€™ ä¼šæœ‰ç©ºå€¼åœ¨å‰è¿˜æ˜¯åœ¨åä¹‹åˆ†ï¼Œé»˜è®¤æ˜¯ NULLS FIRSTï¼Œçª—å£å¤§å°ä¸ºRANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROWï¼Œå¦‚ä¸‹sum(CAST(1 AS BIGINT)) OVER (PARTITION BY shop_id ORDER BY date ASC NULLS FIRST RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) ä¸ NULLS FIRSTå¯¹åº”çš„æ˜¯NULLS LAST 123sum(1) over(partition by shop_id)-- ä¸åŠ order by å…³é”®å­—ï¼Œå®é™…ä¸Šrow betweenä¸ºUNBOUNDED PRECEDING AND UNBOUNDED FOLLOWINGï¼Œå¦‚ä¸‹sum(CAST(1 AS BIGINT)) OVER (PARTITION BY shop_id ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) å¸¸ç”¨çš„joinå‡½æ•°ä»‹ç» outerï¼Œfullï¼Œfull outerï¼šå…¨è¿ leftï¼Œleft outerï¼šå·¦è¿ rightï¼Œright outerï¼šå³è¿ innerï¼Œä¸å†™ï¼šè¿”å›joinDF1å’ŒjoinDF2åˆå¹¶çš„rowsï¼Œå¦‚æœjoinDF2ä¸­æœ‰å¤šæ¡è®°å½•å¯¹åº”äºjoinDF1çš„åŒä¸€æ¡è®°å½•ï¼Œé‚£ä¹ˆè¿”å›çš„row numberä¼šå¤§äºjoinDF1çš„row number left antiï¼šè¿‡æ»¤å‡ºjoinDF1ä¸­joinDF2æ²¡æœ‰çš„éƒ¨åˆ†ï¼Œåªè¿”å›joinDF1ä¸­çš„rows left semiï¼šè¿‡æ»¤å‡ºjoinDF1ä¸­å’ŒjoinDF2å…±æœ‰çš„éƒ¨åˆ†ï¼Œåªè¿”å›joinDF1ä¸­çš„rows left antiå’Œleft semiåœ¨æŸäº›åœºæ™¯ä¸‹ä¹Ÿä¼šç»å¸¸ç”¨åˆ° å¦‚ä½•è°ƒè¯•ä½¿ç”¨Scalaç¼–å†™çš„Sparkç¨‹åºkey pointsï¼šset(â€œspark.masterâ€, â€œlocal[*]â€) ç”±äºspark taskæ˜¯è¿è¡Œåœ¨é›†ç¾¤çš„executorèŠ‚ç‚¹ä¸Šï¼Œå¦‚æœåœ¨æŸä¸ªå…·ä½“çš„æ­¥éª¤æƒ³é€šè¿‡æ‰“å°ä¸€äº›æ•°æ®æ¥è°ƒè¯•ç¨‹åºï¼Œæ˜¯ä¸å¯èƒ½çš„ï¼Œé™¤éä½ å¯ä»¥è¿›å…¥åˆ°çœŸæ­£æ‰§è¡Œå¯¹åº”taskçš„executorèŠ‚ç‚¹ï¼Œå»çœ‹å®ƒçš„logã€‚ æ‰€ä»¥å¦‚æœæƒ³è¦è°ƒè¯•sparkç¨‹åºï¼Œåªèƒ½åœ¨localæ¨¡å¼ï¼ŒåŒæ—¶ï¼Œä¸ºäº†å¢åŠ è°ƒè¯•çš„æ•ˆç‡ï¼Œå¯ä»¥é€‚é‡çš„ç¼©å‡æ•°æ®é‡ï¼Œæ¯”å¦‚ä½ è¦åœ¨ä¸€ä¸ªå¾ˆå¤§çš„æ—¥å¿—æ•°æ®ä¸Šæµ‹è¯•é€»è¾‘ï¼Œé‚£ä¹ˆä½ å¯ä»¥åªè¯»å–å…¶ä¸­ä¸€ä¸ªåˆ†åŒºã€‚ localæ¨¡å¼çš„æ—¶å€™ï¼ŒDriverç«¯ä¼šæ‰®æ¼”Executorçš„è§’è‰²ï¼Œæ‰€ä»¥æ˜¯å¯ä»¥çœ‹åˆ°ä½ æ‰“å°çš„ä¿¡æ¯çš„ã€‚ ã€è®²ã€‘Sparkçš„è®¾è®¡åŸç†åˆ†å¸ƒå¼ã€å‡½æ•°é—­åŒ…ï¼ˆæ˜¯å¦å¯åºåˆ—åŒ–ï¼‰ã€é«˜é˜¶å‡½æ•°ï¼ˆå‡½æ•°å¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°ï¼‰å‡½æ•°å¼ç¼–ç¨‹ï¼Œä¸‹é¢çš„ä»‹ç»ä¸­ä½ å°†ä¼šå¾ˆæ˜æ˜¾çš„æ„Ÿå—åˆ° RDDA Resilient Distributed Dataset (RDD) å¼¹æ€§[ä»…ä»‹ç»]åˆ†å¸ƒå¼[ä»…ä»‹ç»]æ•°æ®é›†[è®²] What is RDD? A list of partitions - åˆ†åŒºè®¡ç®— A function for computing each split - æ¯ä¸ªRDDéƒ½å«æœ‰ä¸€ä¸ªå¯¹å½“å‰RDDè¿›è¡Œå¤„ç†çš„æ–¹æ³• A list of dependencies on other RDDs - è¿™é‡Œå°±æ˜¯æˆ‘ä»¬åé¢è¦è¯´çš„å®½çª„ä¾èµ–ï¼Œå³ä¸Šä¸‹æ¸¸RDDæ˜¯å¦‚ä½•æ˜ å°„çš„ a Partitioner for key-value RDDs (e.g. to say that the RDD is hash-partitioned) - åˆ†åŒºçš„ç­–ç•¥ a list of preferred locations to compute each split on (e.g. block locations for an HDFS file) - è®¡ç®—å‘æ•°æ®ç§»åŠ¨ çš„æ€æƒ³ ç¦»çº¿ä¸å®æ—¶è®¡ç®—çš„åŒºåˆ«ï¼š ç¦»çº¿è®¡ç®—ï¼Œæ˜¯æ•°æ®å·²ç»å­˜æ”¾åœ¨æŸä¸ªä½ç½®ï¼Œæ‰€ä»¥å¦‚æœåœ¨æ•°æ®æ‰€åœ¨çš„èŠ‚ç‚¹å¯åŠ¨è®¡ç®—ï¼Œé‚£ä¹ˆå¯ä»¥å‡å°‘ç½‘ç»œIOçš„æ¶ˆè€—ï¼Œæé«˜è®¡ç®—æ•ˆç‡ï¼Œè¿™æ˜¯ç¦»çº¿è®¡ç®—å¹³å°åº”è¯¥æœ‰çš„ä¼˜åŒ–ç­–ç•¥ å®æ—¶è®¡ç®—ï¼šæ•°æ®æœªçŸ¥ï¼Œæºæºä¸æ–­çš„äº§ç”Ÿï¼Œä¸€èˆ¬éƒ½ä¼šä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­æ‹¿åˆ°å¯¹åº”çš„æ•°æ®ï¼Œç„¶åå°†æ•°æ®èµ°ä¸€éæµå¼å¤„ç†ï¼Œè¿™ä¸ªæ—¶å€™æ•°æ®å…·ä½“å­˜åœ¨çš„èŠ‚ç‚¹å·²ç»ä¸æ˜¯é›†ç¾¤ä¸­çš„datanodeï¼Œä¸€èˆ¬æ˜¯æ•°æ®è®¡ç®—å¼•æ“ä¸»åŠ¨å»æ¶ˆæ¯é˜Ÿåˆ—æ‹‰å–æ•°æ®ï¼Œæ‰€ä»¥æ­¤æ—¶å°±æ˜¯æ•°æ®å‘è®¡ç®—ç§»åŠ¨ Spark ä¸Flinkçš„åŒºåˆ«ï¼š sparkçš„shuffleè¿‡ç¨‹æ˜¯é‡‡ç”¨ä¸‹æ¸¸stageä¸»åŠ¨æ‹‰å–ä¸Šæ¸¸stageçš„ç»“æœæ•°æ®ï¼Œpullæ¨¡å¼ Flinkæ˜¯å°†ä¸Šæ¸¸ç»“æœæ•°æ®ä¸»åŠ¨æ¨ç»™ä¸‹æ¸¸çš„å¤„ç†èŠ‚ç‚¹ï¼Œpushæ¨¡å¼ï¼Œæ‰€ä»¥å®ƒåœ¨å¤„ç†æµå¼æ•°æ®çš„æ—¶å€™æ›´åŠ æœ‰æ•ˆï¼Œæ›´åƒæ˜¯æ°´æµä¸€æ ·æµç•… Resilient - å¼¹æ€§ï¼šæ”¯æŒæ•°æ®ç»“æœcacheï¼Œcheckpointï¼Œå¯ä»¥å¾ˆé«˜æ•ˆçš„è‡ªå®šä¹‰ä¸åŒçš„ç¼“å­˜ç‚¹ï¼ŒåŠ é€Ÿä»»åŠ¡çš„æ‰§è¡Œæ•ˆç‡ Distributed - åˆ†å¸ƒå¼ï¼šæ‰€æœ‰ç”¨æˆ·ç¼–å†™çš„ç¨‹åºéƒ½ä¸æ˜¯åœ¨Driverè¿è¡Œ(localæ¨¡å¼é™¤å¤–)ï¼Œéƒ½æ˜¯åœ¨é›†ç¾¤ä¸­çš„executorä¸Šè¿è¡Œçš„ï¼Œå¯¹å…¨é‡æ•°æ®é›†è¿›è¡Œåˆ†åŒºå¤„ç†ï¼Œå¯ä»¥åœ¨å¤§é‡çš„executorèŠ‚ç‚¹ä¸Šè¿›è¡Œå¹¶è¡Œå¤„ç† Dataset - æ•°æ®é›†ï¼šæ”¯æŒæ•°æ®é›†çš„æ‰€æœ‰æ“ä½œï¼Œé’ˆå¯¹RDDçš„æ“ä½œï¼Œå®é™…ä¸Šå°±å’Œé’ˆå¯¹äºä¸€ä¸ªæœ¬åœ°çš„æ•°æ®é›†æ“ä½œé‚£ä¹ˆç®€å•ï¼Œç›´è§‚ã€‚æ”¯æŒçš„æ“ä½œæ¯”å¦‚ä¸‹é¢æ‰€ç¤ºï¼š DataSeté‡‡ç”¨çš„æ˜¯åŸºäºè¿­ä»£å™¨æ¨¡å¼çš„ä¸°å¯Œå®ç°æ¨¡å¼å¯ä»¥æœ‰æ¯”è¾ƒç›´è§‚çš„äº†è§£ã€‚ Resilient å’ŒDistributed éœ€è¦ç»“åˆSparkContextè®²è§£ï¼Œè¿™é‡Œé¢çš„å†…å®¹æ›´åŠ å¤æ‚ï¼Œå°±å…ˆä¸è®²è§£äº†ã€‚ Iteratoræ¨¡å¼ä»€ä¹ˆæ˜¯è¿­ä»£å™¨æ¨¡å¼ï¼Œè¿­ä»£å™¨æœ¬èº«ä¸åŒ…å«æ•°æ®ï¼Œå®ƒåŒ…å«çš„è®¿é—®æ•°æ®çš„æ–¹å¼ï¼Œå®ƒä¸»è¦æœ‰ä¸¤ä¸ªæ–¹æ³•hasNextå’Œnextæ–¹æ³•ã€‚ hasNextç”¨æ¥è¯¢é—®é›†åˆä¸­æ˜¯å¦è¿˜æœ‰æ•°æ®å¯ä¾›è®¿é—®ï¼Œnextç”¨æ¥å®é™…è·å–æ•°æ®ï¼Œä½¿ç”¨è¿­ä»£å™¨æ¨¡å¼ï¼Œå¯ä»¥åšåˆ°ï¼Œæ•°æ®ä»å§‹è‡³ç»ˆåªæœ‰ä¸€ä»½(ä¸­é—´è¿‡ç¨‹ä¸­è¢«cacheçš„ä¸ç®—)ã€‚ scalaç‰ˆæœ¬çš„è¿­ä»£å™¨æ¨¡å¼ä½¿ç”¨scalaç¼–å†™äº†ä¸€æ®µwordcountçš„ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415object TestIterator &#123; def main(args: Array[String]): Unit = &#123; val listStr = List( \"hello world\", \"hello msb\", \"good idea\" ) val flatMap: List[String] = listStr.flatMap((x: String) =&gt; x.split(\" \")) flatMap.foreach(println) val mapList: List[(String, Int)] = flatMap.map((_, 1)) mapList.foreach(println) &#125;&#125; åˆ†æä¸€ä¸‹ä¸Šé¢ç¨‹åºçš„æ‰§è¡Œè¿‡ç¨‹ï¼š åˆ›å»ºlistStrå¯¹è±¡ listStrè°ƒç”¨flatMapï¼Œä½œç”¨æ˜¯å°†listStrçš„æ¯ä¸ªå…ƒç´ ä½¿ç”¨ç©ºæ ¼åˆ†éš”ï¼Œç„¶ååˆå¹¶æˆä¸€ä¸ªå¤§çš„list ç»§ç»­è°ƒç”¨mapï¼Œå°†æ¯ä¸ªå…ƒç´ è½¬æ¢æˆä¸€ä¸ª[String,Int]çš„äºŒå…ƒç»„ æ‰“å°ç»“æœ ä»¥ä¸Šä»£ç æœ‰ä¸€ä¸ªè‡´å‘½çš„é—®é¢˜ï¼šåœ¨æ•°æ®é‡éå¸¸çš„çš„æ—¶å€™ï¼Œä¼šæ€¥å‰§çš„æ¶ˆè€—å†…å­˜ç©ºé—´ã€‚ä¸ºä»€ä¹ˆï¼Ÿç®€å•åˆ†æä¸‹ï¼šç¬¬ä¸€æ­¥ç©ºé—´å¤æ‚åº¦ä¸ºO(N)ï¼Œç¬¬äºŒæ­¥åˆç”Ÿæˆäº†ä¸€ä¸ªå…¨æ–°çš„List[String]å¯¹è±¡ï¼Œåˆæ˜¯O(N)çš„ç©ºé—´å¤æ‚åº¦ï¼Œç¬¬ä¸‰æ­¥ä¸­åˆç”Ÿæˆäº†ä¸€ä¸ªList[(String,Int)]å¯¹è±¡ï¼Œç©ºé—´å¤æ‚åº¦ä¾ç„¶æ˜¯O(N)ã€‚é€šè¿‡åˆ†æå¯çŸ¥ï¼Œåœ¨æ•°æ®ç»Ÿè®¡çš„è¿‡ç¨‹ä¸­ï¼Œè²Œä¼¼å¹¶æ²¡æœ‰å¿…è¦å°†ä¸­é—´è¿‡ç¨‹çš„æ•°æ®å­˜å‚¨ä¸‹æ¥ï¼Œä¸ä½†å ç”¨ç©ºé—´ï¼Œè¿˜æ²¡æœ‰ä»»ä½•ç”¨å¤„ã€‚ äºæ˜¯ï¼Œæˆ‘ä»¬æƒ³åˆ°äº†ä¸€ç§è®¾è®¡æ¨¡å¼-è¿­ä»£å™¨æ¨¡å¼ã€‚è¿­ä»£å™¨æ¨¡å¼åœ¨å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªæŒ‡é’ˆï¼Œå®é™…ä¸Šå¹¶ä¸ä¼šå­˜å‚¨æ•°æ®ï¼Œåœ¨éå†æ•°æ®é›†çš„æ—¶å€™ï¼Œä¸æ–­çš„æ¶ˆè€—å½“å‰æŒ‡é’ˆã€‚ ç°åœ¨å¼€å§‹å¤ä¹ ä¸€ä¸‹è¿­ä»£å™¨æ¨¡å¼ è¿­ä»£å™¨ä¸€å®šæœ‰ä¸¤ä¸ªæ–¹æ³•ï¼š 12345public interface Iterator&lt;E&gt; &#123; //Element E //Type T //Key K //Value V boolean hasNext(); // æ˜¯å¦è¿˜æœ‰ä¸‹ä¸€ä¸ªå…ƒç´  E next(); // è·å–ä¸‹ä¸€ä¸ªå…ƒç´ &#125; é›†åˆç±»ä¸€å®šæœ‰ä¸€ä¸ªè¿”å›è¿­ä»£å™¨çš„å‡½æ•° 123456public interface Collection&lt;E&gt; &#123; void add(E o); int size(); Iterator iterator();&#125; å…·ä½“çš„é›†åˆç±»å®ç°Collectionæ¥å£ 1234567891011121314151617181920212223242526272829303132333435363738394041class ArrayList&lt;E&gt; implements Collection&lt;E&gt; &#123; E[] objects = (E[]) new Object[10]; private int index = 0; public void add(E o) &#123; if (index == objects.length) &#123; E[] newObjects = (E[]) new Object[objects.length * 2]; System.arraycopy(objects, 0, newObjects, 0, objects.length); objects = newObjects; &#125; objects[index] = o; index++; &#125; public int size() &#123; return index; &#125; @Override public Iterator&lt;E&gt; iterator() &#123; return new ArrayListIterator(); &#125; private class ArrayListIterator&lt;E&gt; implements Iterator&lt;E&gt; &#123; private int currentIndex = 0; @Override public boolean hasNext() &#123; if (currentIndex &gt;= index) return false; return true; &#125; @Override public E next() &#123; E o = (E) objects[currentIndex]; currentIndex++; return o; &#125; &#125;&#125; å¯ä»¥å‘ç°ï¼Œè¿­ä»£å™¨ä¸­ä¸ä¼šå­˜æ•°æ®ï¼Œåªæ˜¯ä¿å­˜äº†ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘å½“å‰éå†åˆ°äº†å“ªä¸€ä¸ªç´¢å¼•ï¼Œåªæœ‰çœŸæ­£å¼€å§‹éå†çš„æ—¶å€™ï¼ŒæŒ‡é’ˆæ‰ä¼šå¼€å§‹ç§»åŠ¨ï¼Œå¹¶ä¸”æ²¡æœ‰å›é€€çš„æ–¹æ³•ï¼Œå³è¿­ä»£å™¨åªèƒ½éå†ä¸€æ¬¡(å¦æœ‰è®¾è®¡çš„é™¤å¤–)ã€‚ è§£å†³æ–¹æ¡ˆ ä½¿ç”¨è¿­ä»£å™¨å®ç°ä¸Šé¢çš„åŠŸèƒ½ 123456789101112131415161718192021object TestIterator &#123; def main(args: Array[String]): Unit = &#123; val listStr = List( \"hello world\", \"hello msb\", \"good idea\" ) val iter: Iterator[String] = listStr.iterator //ä»€ä¹ˆæ˜¯è¿­ä»£å™¨ï¼Œä¸ºä»€ä¹ˆä¼šæœ‰è¿­ä»£å™¨æ¨¡å¼ï¼Ÿ è¿­ä»£å™¨é‡Œä¸å­˜æ•°æ®ï¼ val iterFlatMap = iter.flatMap((x: String) =&gt; x.split(\" \")) // iterFlatMap.foreach(println) // ä¸­é€”ä¸èƒ½æ‰“å°ï¼Œå¦åˆ™åç»­å°±è¯»å–ä¸åˆ°æ•°æ®äº† val iterMapList = iterFlatMap.map((_, 1)) while (iterMapList.hasNext) &#123; val tuple: (String, Int) = iterMapList.next() println(tuple) &#125; //1.listStrçœŸæ­£çš„æ•°æ®é›†ï¼Œæœ‰æ•°æ®çš„ //2.iter.flatMap æ²¡æœ‰å‘ç”Ÿè®¡ç®—ï¼Œè¿”å›äº†ä¸€ä¸ªæ–°çš„è¿­ä»£å™¨ &#125;&#125; åˆ†æï¼šåŸºäºè¿­ä»£å™¨çš„æ–¹æ¡ˆä¸­ï¼Œé™¤äº†listSträ¸­å­˜å‚¨äº†æ•°æ®ï¼Œä¸­é—´çš„è¿‡ç¨‹ä¸­åªæœ‰è®¡ç®—é€»è¾‘æ²¡æœ‰å­˜å‚¨æ•°æ®(faltMapä¼šæœ‰ä¸€ç‚¹å°‘å°‘çš„æ•°æ®ç¼“å†²å­˜å‚¨)ã€‚è¿™å’Œsparkä¸­çš„ç®—å­çš„æ€æƒ³ä¸€æ ·å•Šï¼Œä¹Ÿå¯ä»¥è¯´sparkæ˜¯å€Ÿé‰´äº†è¿­ä»£å™¨çš„ç¼–ç¨‹æ¨¡å¼ã€‚ Sparkçš„transformationç®—å­ï¼šç±»æ¯”è¿™é‡Œçš„flatMap/map Sparkçš„actionç®—å­ï¼šç±»æ¯”è¿™é‡Œçš„foreach å…³äºscalaä¸­flatMapã€mapã€foreachçš„è¿‡ç¨‹åˆ†æ iter = listStr.iterator 12345678def iterator: Iterator[A] = new AbstractIterator[A] &#123; var these = self def hasNext: Boolean = !these.isEmpty def next(): A = if (hasNext) &#123; val result = these.head; these = these.tail; result &#125; else Iterator.empty.next()&#125; iteratorè¿”å›çš„æ˜¯ä¸€ä¸ªAbstractIteratorå¯¹è±¡ï¼Œé‡å†™äº†hasNextå’Œnextå‡½æ•°ï¼š hasNextï¼šè°ƒç”¨listStrçš„isEmptyæ–¹æ³•ï¼Œå¦‚æœä¸ºç©ºåˆ™è¿”å›false nextï¼š å…ˆæ£€æµ‹æ˜¯å¦æœ‰å…ƒç´ ï¼Œæœ‰çš„è¯è¿”å›listStrçš„å¤´ç»“ç‚¹ï¼Œå¹¶ä¸”ç§»åŠ¨theseåˆ°å‰©ä½™éƒ¨åˆ†çš„å¤´éƒ¨ï¼› å¦åˆ™è¿”å›ç©ºã€‚æŒ‰ç†è¯´ä¸ä¼šä¸ºç©ºï¼Œå› ä¸ºéƒ½æ˜¯å…ˆåˆ¤æ–­äº†hasNextä¸ºtrueæ‰ä¼šè°ƒç”¨next iterFlatMap = iter.flatMap((x:String) =&gt; x.split(â€œ â€œ)) 1234567891011121314def flatMap[B](f: A =&gt; GenTraversableOnce[B]): Iterator[B] = new AbstractIterator[B] &#123; private var cur: Iterator[B] = empty private def nextCur() &#123; cur = f(self.next()).toIterator &#125; def hasNext: Boolean = &#123; // Equivalent to cur.hasNext || self.hasNext &amp;&amp; &#123; nextCur(); hasNext &#125; // but slightly shorter bytecode (better JVM inlining!) while (!cur.hasNext) &#123; if (!self.hasNext) return false nextCur() &#125; true &#125; def next(): B = (if (hasNext) cur else empty).next()&#125; flatMapè¿”å›çš„ä¹Ÿæ˜¯ä¸€ä¸ªAbstractIteratorï¼Œä¹Ÿé‡å†™äº†hasNextå’Œnextå‡½æ•°ï¼š å®ƒåœ¨è¿™é‡Œç»´æŠ¤äº†ä¸€ä¸ªcurçš„å°è¿­ä»£å™¨ï¼Œä¹‹æ‰€ä»¥è¯´å°ï¼Œæ˜¯å› ä¸ºå®ƒä¼šç¼“å­˜ä¸Šä¸€ä¸ªè°ƒç”¨èŠ‚ç‚¹çš„ä¸€æ¡è®°å½•ç»è¿‡få¤„ç†ä¹‹åçš„ç»“æœ hasNextï¼šé‡ç‚¹çœ‹è¿™ä¸ªå‡½æ•° è¿™é‡Œä¼šå…ˆåˆ¤æ–­curæ˜¯å¦æœ‰å…ƒç´ ï¼Œæœ‰çš„è¯ç›´æ¥è¿”å›trueï¼› å¦åˆ™çš„è¯ï¼Œè°ƒç”¨çˆ¶ç±»çš„hasNextï¼Œåˆ¤æ–­æ˜¯å¦è¿˜æœ‰å€¼ï¼Œæ²¡æœ‰çš„è¯ï¼Œè¿”å›falseï¼› å¦åˆ™çš„è¯è°ƒç”¨çˆ¶ç±»çš„nextè·å–ä¸€æ¡æ–°çš„è®°å½•ï¼Œå¹¶äº¤ç»™å¤„ç†å‡½æ•°få¤„ç†ï¼Œå¤„ç†å®Œä¹‹åäº¤ç»™curç¼“å­˜èµ·æ¥ nextï¼šå¦‚æœæœ‰å€¼ï¼Œåˆ™ç›´æ¥ä»curä¸­å–å€¼ï¼Œè€Œä¸”æ°¸è¿œéƒ½åªä»curä¸­å–å€¼ iterMapList = iterFlatMap.map((_, 1)) 1234def map[B](f: A =&gt; B): Iterator[B] = new AbstractIterator[B] &#123; def hasNext = self.hasNext def next() = f(self.next())&#125; mapè¿”å›çš„ä¹Ÿæ˜¯ä¸€ä¸ªAbstractIteratorï¼Œä¹Ÿé‡å†™äº†hasNextå’Œnextå‡½æ•°ï¼Œä¸è¿‡ä»–è¿™é‡Œçš„é€»è¾‘æ¯”è¾ƒç®€å•äº†ï¼Œå› ä¸ºmapåªæ˜¯å®Œæˆäº†ä¸€ä¸ªæ˜ å°„çš„è¿‡ç¨‹ iterMapList.foreach(println) æ‰“å°æ”¶å·¥ã€‚ é€šè¿‡è§£æsparkçš„wordcountç¨‹åºç†è§£è¿­ä»£å™¨æ¨¡å¼ä»¥ä¸‹æ˜¯æœ€ç²¾ç®€çš„ä¸€ä¸ªsparkçš„å…¥é—¨ç¨‹åºä»£ç ï¼šç»Ÿè®¡ä¸€ä¸ªæ–‡ä»¶çš„å•è¯æ•°é‡ 1234567val conf = new SparkConf()conf.setAppName(\"wordcount\")conf.setMaster(\"local\") //å•å‡»æœ¬åœ°è¿è¡Œval sc = new SparkContext(conf)val fileRDD: RDD[String] = sc.textFile(\"testdata.txt\")fileRDD.flatMap( _.split(\" \") ).map((_,1)).reduceByKey( _+_ ).foreach(println) ä¸‹é¢æ ¹æ®è¿™ä¸ªç¨‹åºè¯¦ç»†è§£è¯»ä¸€ä¸‹sparkçš„æ‰§è¡ŒåŸç†ï¼š è¡Œ1-4åˆ›å»ºä¸Šä¸‹æ–‡å¯¹è±¡ è¡Œ6åˆ›å»ºç¬¬ä¸€ä¸ªrdd è¡Œ7é€šè¿‡pipelineçš„apiæ–¹å¼ç»„è£…æˆ‘ä»¬çš„ä¸šåŠ¡é€»è¾‘ ä¸»è¦è§£è¯»è¡Œ6å’Œè¡Œçš„7æ‰€å‘ç”Ÿçš„äº‹æƒ… sc.textFile(â€œtestdata.txtâ€) Read a text file from HDFS, a local file system (available on all nodes), or any Hadoop-supported file system URI, and return it as an RDD of Strings. å¾—åˆ°ä¸€ä¸ªHadoopRDDï¼Œè´´æºçš„RDDï¼Œå¯ä»¥ç”¨æ¥è¯»å–æ•°æ®ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªæ•°æ®æºçš„iterator flatMap 12345 // def flatMap[U: ClassTag](f: T =&gt; TraversableOnce[U]): RDD[U] = withScope &#123; val cleanF = sc.clean(f) new MapPartitionsRDD[U, T](this, (context, pid, iter) =&gt; iter.flatMap(cleanF)) &#125; flatMapä¼šè¿”å›ä¸€ä¸ªMapPartitionsRDDï¼Œä»–çš„æ„é€ æ–¹æ³•ä¸­æœ‰ä¸¤ä¸ªå‚æ•°ï¼šthiså’Œä¸€ä¸ªfuncï¼Œthisè¡¨ç¤ºå½“å‰å¯¹è±¡ï¼Œfuncæ˜¯ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œå®ƒè°ƒåŒ…è£…äº†æˆ‘ä»¬ä¼ é€’è¿›å»çš„å‡½æ•°ï¼Œè¿™å…¶å®å°±æ˜¯ä¸€ä¸ªé—­åŒ…ï¼Œæœ€ç»ˆè¿™ä¸ªå‡½æ•°æ˜¯ä½œç”¨åœ¨ä¸€ä¸ªæœ¬åœ°(executorä¸Š)çš„scalaçš„iteratorä¸Š è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªå‡½æ•°è°ƒç”¨sc.clean(f)ï¼Œè¿™é‡Œå°±æ˜¯æˆ‘ä»¬ä¸Šé¢æ‰€è¯´çš„é—­åŒ…æ£€æŸ¥ï¼Œå› ä¸ºsparkç¨‹åºæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„ï¼Œæˆ‘ä»¬è¿™é‡Œå®šä¹‰çš„å‡½æ•°å®é™…ä¸Šå¹¶ä¸æ˜¯åœ¨æˆ‘ä»¬çš„è¿™å°æœºå™¨ä¸Šè¿è¡Œçš„ï¼Œè€Œæ˜¯ä¼šåœ¨é›†ç¾¤ä¸­çš„ä»»æ„Executorä¸Šè¿è¡Œï¼Œæ‰€ä»¥sparkå°±éœ€è¦å°†å…¶åºåˆ—åŒ–ç„¶åä¼ è¾“åˆ°å…¶ä»–çš„Executorä¸Šï¼Œç„¶ååœ¨Executorä¸Šåœ¨ååºåˆ—åŒ–å‡ºæ¥æ‰§è¡Œï¼Œå¦‚æœä½ ä¼ é€’çš„fä¸èƒ½å¤Ÿè¢«åºåˆ—åŒ–ï¼Œé‚£ä¹ˆå°±ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸org.apache.spark.SparkException: Task not serializableï¼Œç¨‹åºç›´æ¥é€€å‡ºã€‚ cleançš„è¿‡ç¨‹éœ€è¦åšçš„äº‹æƒ…å¦‚ä¸‹ï¼š removes unreferenced variables in $outerâ€™sï¼Œå»é™¤æœªè¢«ä½¿ç”¨çš„å˜é‡ updates REPL variablesï¼Œç›´æ¥å¡«å……è®¡ç®—ç»“æœ æ‰€ä»¥å¦‚æœä½ å®šä¹‰çš„ä¸€äº›fï¼Œå¼•ç”¨äº†mapå¤–éƒ¨ä¸å¯åºåˆ—åŒ–çš„å¯¹è±¡å°±ä¼šæŠ¥ä¸å¯åºåˆ—åŒ–çš„å¼‚å¸¸ã€‚ å…³äºé—­åŒ…çš„çŸ¥è¯†ç‚¹å¯ä»¥çœ‹ä¸‹è¿™ä¸ªæ–‡ç« ï¼šhttps://blog.csdn.net/qq_26838315/article/details/114700368 map 12345 // def map[U: ClassTag](f: T =&gt; U): RDD[U] = withScope &#123; val cleanF = sc.clean(f) new MapPartitionsRDD[U, T](this, (context, pid, iter) =&gt; iter.map(cleanF)) &#125; åŒç†å¦‚ä¸Š reduceByKey 1234 // def reduceByKey(partitioner: Partitioner, func: (V, V) =&gt; V): RDD[(K, V)] = self.withScope &#123; combineByKeyWithClassTag[V]((v: V) =&gt; v, func, func, partitioner) &#125; reduceByKeyï¼Œæ˜¯ä¸€ä¸ªèšåˆç±»çš„ç®—å­ï¼Œä¼šå¼•å‘shuffleè¡Œä¸ºï¼Œå®ƒå†…éƒ¨å®é™…ä¸Šæ˜¯è°ƒç”¨äº†combineByKeyï¼Œäº†è§£è¿‡hadoopçš„MRç¨‹åºçš„è¯ï¼Œæˆ‘ä»¬å°±ä¼šçŸ¥é“ï¼Œcombineåœ¨MRä¸­æ˜¯ä¸€é¡¹ä¼˜åŒ–ç‚¹ï¼Œå³ä¼šåœ¨mapç«¯è¿›è¡Œæ•°æ®çš„é¢„èšåˆï¼Œå¯ä»¥å‡å°‘éœ€è¦ç½‘ç»œä¼ è¾“çš„æ•°æ®é‡ï¼Œæå¤§ç¨‹åº¦çš„å‡å°‘å¸¦å®½çš„ä½¿ç”¨ï¼Œæé«˜æ•ˆç‡ã€‚ reduceæ“ä½œï¼Œéœ€è¦è€ƒè™‘ä¸‰ç§æƒ…å†µ ç¬¬ä¸€æ¡æ•°æ®æ€ä¹ˆæ”¾ åç»­æ•°æ®æ€ä¹ˆæ”¾ åœ¨å¤§æ•°æ®é‡çš„æƒ…å†µä¸‹ï¼Œå¿…ç„¶ä¼šå‘ç”Ÿæ•°æ®æº¢å†™ï¼Œé‚£ä¹ˆå°±ä¼šæ¶‰åŠæº¢å†™æ•°æ®çš„åˆå¹¶ æ‰€ä»¥combineByKeyéœ€è¦ä¸‰ä¸ªå‡½æ•°ï¼Œåˆ†åˆ«å¯¹åº”ä»¥ä¸Šä¸‰ç§æƒ…å†µ createCombiner: V =&gt; C Væ˜¯è¾“å…¥çš„åŸå§‹æ•°æ®ç±»å‹ï¼ŒCæ˜¯è¾“å‡ºæ•°æ®ç±»å‹ã€‚å¯è§ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æ•°æ®åšä¸€äº›å˜æ¢æ“ä½œ mergeValue: (C, V) =&gt; C Væ˜¯è¾“å…¥çš„åŸå§‹æ•°æ®ç±»å‹ï¼ŒCæ˜¯è¾“å‡ºæ•°æ®ç±»å‹ã€‚è¿™ä¸ªå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å·²ç»èšåˆè¿‡çš„å†å²ç»“æœï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ–°è¿›æ¥çš„æ•°æ®ï¼Œæœ€ç»ˆè¾“å‡ºä¸€ä¸ªç»“æœ mergeCombiners: (C, C) =&gt; C è¿™é‡Œæ˜¯å¯¹æº¢å†™æ–‡ä»¶çš„åˆå¹¶ï¼Œæ‰€ä»¥æ•°æ®ç±»å‹éƒ½æ˜¯è¾“å‡ºçš„æ•°æ®ç±»å‹ã€‚ 12345678910111213 // def combineByKeyWithClassTag[C]( createCombiner: V =&gt; C, mergeValue: (C, V) =&gt; C, mergeCombiners: (C, C) =&gt; C, partitioner: Partitioner, mapSideCombine: Boolean = true, serializer: Serializer = null)(implicit ct: ClassTag[C]): RDD[(K, C)] = self.withScope &#123; new ShuffledRDD[K, V, C](self, partitioner) .setSerializer(serializer) .setAggregator(aggregator) .setMapSideCombine(mapSideCombine) &#125; è¿™é‡Œå°±éœ€è¦åŒºåˆ†reduceByKeyä¸groupByKeyçš„åŒºåˆ«äº†ã€‚ groupByKeyåº•å±‚ä¹Ÿæ˜¯è°ƒç”¨çš„combineByKeyWithClassTagï¼Œä½†æ˜¯æŠŠmapSideCombineå‚æ•°è®¾ç½®ä¸ºäº†falseï¼Œå³é»˜è®¤ä¸å¼€å¯mapçš„é¢„èšåˆ foreach 1234def foreach(f: T =&gt; Unit): Unit = withScope &#123; val cleanF = sc.clean(f) sc.runJob(this, (iter: Iterator[T]) =&gt; iter.foreach(cleanF))&#125; actionç®—å­ï¼Œè°ƒç”¨runJobæäº¤Jobï¼Œè§¦å‘è®¡ç®—é€»è¾‘ ä»è¿™ä¸ªè¿‡ç¨‹ä¸­å¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬æ¯æ¬¡è°ƒç”¨çš„ç®—å­ï¼Œå¹¶ä¸ä¼šè§¦å‘è®¡ç®—ï¼Œè€Œæ˜¯åˆ›å»ºäº†ä¸€ä¸ªä¸ªçš„RDDå¯¹è±¡ï¼Œç›´åˆ°æˆ‘ä»¬è°ƒç”¨äº†actionç®—å­ã€‚ ç®€å•ä»‹ç»ä¸€ä¸‹ä¸Šé¢è¿™å¹…å›¾ï¼š è¿™å¹…å›¾ä¸€å…±æœ‰ä¸¤ä¸ªå±‚æ¬¡ï¼š ç¬¬ä¸€å±‚ï¼šapiå±‚ apiå±‚å°±æ˜¯sparkæš´éœ²ç»™æˆ‘ä»¬çš„ç¼–ç¨‹æ¥å£ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¹³æ—¶æ‰€å†™çš„rdd.map.filter.flatMapç­‰ç­‰ï¼Œè¯·æ³¨æ„ï¼Œæˆ‘ä»¬è¿™é‡Œå†™çš„è¿™äº›åªæ˜¯å‘sparkå£°æ˜äº†ä¸€ç³»åˆ—çš„ä¾èµ–å…³ç³»ä»¥åŠï¼Œæˆ‘ä»¬æƒ³åœ¨jobè¿è¡Œæ—¶å¯¹æ¯æ¡æ•°æ®å®æ–½çš„å…·ä½“æ“ä½œï¼Œåœ¨è¿™ä¸ªæ—¶å€™ï¼Œsparkå¹¶ä¸ä¼šç«‹åˆ»å»æ‰§è¡Œæˆ‘ä»¬çš„é€»ã€‚ ç¬¬äºŒå±‚ï¼špipelineå±‚ è¿™é‡Œæ˜¯sparkä¾æ®æˆ‘ä»¬ç»„è£…çš„ä¸šåŠ¡é€»è¾‘ï¼Œåœ¨åº•å±‚æ„é€ çš„ä¸€æ¡å®Œæ•´çš„æ•°æ®ç®¡é“ï¼Œå½“é‡åˆ°actionç®—å­ï¼Œè§¦å‘äº†runJobï¼Œé‚£ä¹ˆsparkå°±ä¼šæŠŠä»¥ä¸Šæ‰€æœ‰çš„é€»è¾‘åˆ†å‘åˆ°é›†ç¾¤çš„ExecutorèŠ‚ç‚¹ä¸Šï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæ•°æ®å¤„ç†çš„é€»è¾‘æ‰çœŸæ­£çš„å¼€å§‹è¿è¡Œ å®½çª„ä¾èµ–Dependency NarrowDependency - çª„ä¾èµ– OneToOneDependency åˆ†åŒºçš„å¯¹åº”å…³ç³»ï¼Œä¸Šæ¸¸RDDçš„åˆ†åŒºä¸€ä¸€æ˜ å°„åˆ°ä¸‹æ¸¸RDD RDDçš„æ•°é‡ä¸å˜ å¸¸è§æ“ä½œï¼šmapï¼Œfilter RangeDependency ä¸Šæ¸¸RDDå’Œä¸‹æ¸¸RDDçš„å¯¹åº”å…³ç³»æ˜¯å¤šå¯¹ä¸€ï¼Œåˆ†åŒºæ€»æ•°ä¸å˜ï¼Œå¸¸è§æ“ä½œï¼šunion ä¸Šæ¸¸å¤šä¸ªRDDçš„åˆ†åŒºå½¢æˆä¸‹æ¸¸çš„ä¸€ä¸ªåˆ†åŒºï¼Œå¸¸è§æ“ä½œï¼šcoalesce ShuffleDependency - å®½ä¾èµ– ä¸‹æ¸¸RDDçš„åˆ†åŒºæ•°æ®æ¥è‡ªäºä¸Šæ¸¸RDDæ‰€æœ‰åˆ†åŒºçš„éƒ¨åˆ†æ•°æ® ä¸€ä¸ªRDDï¼šåˆ†ç»„èšåˆæ“ä½œ å¤šä¸ªRDDå½¢æˆä¸€ä¸ªRDDï¼šjoin å¯¹æŸä¸ªRDDæ‰‹åŠ¨åˆ†åŒºï¼šrepartition shuffleï¼šå®é™…ä¸Šå°±æ˜¯äººç±»æƒ¯ç”¨çš„æ€è€ƒæ¨¡å¼ï¼Œä½ çš„æ•°æ®æ˜¯å¦éœ€è¦æŒ‰ç…§ä¸€ä¸ªkeyä¸ºä¸€ç»„è¿›è¡Œæ“ä½œã€‚ åŒ…æ‹¬ç»Ÿè®¡ç›¸åŒkeyçš„è®°å½•æ•°ã€æœ€å¤§æœ€å°ç­‰èšåˆæŒ‡æ ‡ åšæ•°æ®çš„å…³è”-å°†ç›¸åŒkeyçš„æ•°æ®æ”¾åˆ°ä¸€èµ·è€ƒè™‘ Partitionä»€ä¹ˆæ˜¯åˆ†åŒºï¼Ÿåˆ†åŒºæœ‰ä»€ä¹ˆä½œç”¨(å¹¶è¡Œåº¦)ï¼Œåˆ†åŒºä¸Taskçš„å…³ç³» åˆ†åŒºæ˜¯sparkå¹¶è¡Œè®¡ç®—çš„æ ¸å¿ƒï¼Œä¹Ÿå°±æ˜¯è¯´ä¸åŒåˆ†åŒºçš„æ•°æ®å¯ä»¥å¹¶è¡Œçš„è¢«å¤„ç†ï¼Œæé«˜æ‰§è¡Œæ•ˆç‡ã€‚ ä¸€ä¸ªåˆ†åŒºå¯¹åº”äº†ä¸€ä¸ªå…·ä½“çš„å¯æ‰§è¡Œçš„taskï¼Œè¿™é‡Œæ‰€è¯´çš„å¹¶è¡Œå¤„ç†ï¼Œå®é™…ä¸Šå°±æ˜¯å¤šä¸ªthreadå¹¶å‘çš„è¿›è¡Œ åˆ†åŒºä¸æ–‡ä»¶çš„å…³ç³»? åˆå§‹åˆ†åŒºæ•°è²Œä¼¼æ˜¯ä¸ç¡®å®šçš„ï¼Œä»–ä¼šæ ¹æ®åŸå§‹æ•°æ®æ–‡ä»¶çš„å¤§å°ï¼ŒDataFrameå’ŒDatasetçš„apiæ˜¯ç»è¿‡Catalyst optimizerä¼˜åŒ–çš„ï¼Œæ‰€ä»¥åˆå§‹åˆ†åŒºæ•°æ˜¯ç»è¿‡ä¼˜åŒ–è®¡ç®—å¾—æ¥çš„ã€‚è¿™ä¸€èˆ¬ä¸æ˜¯æˆ‘ä»¬æ‰€æ‹…å¿ƒçš„ã€‚ ä»€ä¹ˆæ—¶å€™éœ€è¦é‡åˆ†åŒºï¼Ÿ é‡åˆ°shuffleçš„æ—¶å€™ï¼Œå°±ä¼šè¿›è¡Œé‡åˆ†åŒº æ‰‹åŠ¨è¿›è¡Œé‡åˆ†åŒºï¼Œä»¥å¸Œæœ›èƒ½è§£å†³æ•°æ®å€¾æ–œï¼Œ æ‰‹åŠ¨è¿›è¡Œé‡åˆ†åŒºï¼Œä»¥å¸Œæœ›å‡å°‘è¾“å‡ºçš„æ–‡ä»¶æ•° ä»€ä¹ˆæ˜¯shuffleï¼Œshuffleçš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿ shuffleæ˜¯æ˜¯åœ¨è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œå¯¹æ•°æ®æŒ‰ç…§æŸç§è§„åˆ™è¿›è¡Œæ··æ´—çš„è¿‡ç¨‹ï¼Œä»–çš„ç›®æ ‡æ˜¯å°†å…·æœ‰ç›¸åŒç‰¹å¾çš„æ•°æ®é›†ä¸­åˆ°ä¸€èµ·ï¼Œä»¥ä¾¿äºå¯¹ä»–ä»¬è¿›è¡Œèšåˆä»¥åŠå…³è”ç­‰æ“ä½œ æœ¬è´¨å…¶å®å°±æ˜¯æ ¹æ®æŸç§ç­–ç•¥è¿›è¡Œé‡åˆ†åŒºï¼Œè¿™é‡Œçš„ç­–ç•¥æœ€å¤šçš„å°±æ˜¯æ ¹æ®ç‰¹å®šå­—æ®µè¿›è¡Œhashå–æ¨¡ï¼Œè®¡ç®—å‡ºæ¯ä¸€æ¡è®°å½•åº”è¯¥å±äºçš„åˆ†åŒºå· é‡åˆ†åŒºçš„æ“ä½œæœ‰å“ªäº›ï¼šrepartition&amp;coalesceï¼Œä»–ä»¬ä¹‹é—´æœ‰ä»€ä¹ˆå·®å¼‚ï¼Ÿä»€ä¹ˆæ—¶å€™è¯¥ç”¨repartitionï¼Œä»€ä¹ˆæ—¶å€™è¯¥ç”¨coalesceï¼Ÿ æ­¤å¤„çš„coalesceä¸functionsä¸­çš„coalesceæ˜¯ä¸ä¸€æ ·çš„å“¦ å¯ä»¥å‚è€ƒcoalesceå¯¼è‡´çš„å†…å­˜æº¢å‡ºè¿™é‡Œçš„å›ç­” å…·ä½“æ¡ˆä¾‹åˆ†æï¼š ä¸å¯¹åŸå§‹æ•°æ®æºåšä»»åŠ¡å¤„ç†ï¼Œæˆ–è€…åšä¸€äº›æ˜ å°„ç±»çš„å¤„ç†ï¼Œç›´æ¥å†™å…¥ç›®æ ‡è·¯å¾„ï¼Œä¼šäº§ç”Ÿå¤šå°‘æ–‡ä»¶ï¼Ÿå¦‚æœæœ‰åˆ†åŒºå­—æ®µï¼Œä¼šäº§ç”Ÿå¤šå°‘æ–‡ä»¶ï¼Ÿå°æ–‡ä»¶æ•°å¾ˆå¤šå¯¹äºé›†ç¾¤ä¼šæœ‰æ€æ ·çš„å½±å“ï¼Ÿå¦‚ä½•å‡å°‘å°æ–‡ä»¶çš„æ•°é‡ï¼Ÿ ç»“æœæ–‡ä»¶æ•°å’ŒåŸå§‹åˆ†åŒºæ•°æ˜¯ä¸€æ ·çš„ æ¯ä¸ªåˆ†åŒºçš„æ–‡ä»¶æ•°éƒ½ä¼šå’ŒåŸå§‹åˆ†åŒºæ•°æ˜¯ä¸€æ ·çš„ é’ˆå¯¹äºHDFSæ¥è¯´ï¼Œå°æ–‡ä»¶å¤ªå¤šä¼šå¯¹NameNodeèŠ‚ç‚¹é€ æˆè¾ƒå¤§çš„å‹åŠ›ï¼Œå› ä¸ºNameNodeèŠ‚ç‚¹éœ€è¦ç®¡ç†é›†ç¾¤æ–‡ä»¶å—çš„å…ƒæ•°æ®ã€‚åŒæ—¶åˆ·æ–°hive matestoreçš„æ•ˆç‡ä¹Ÿä¼šå˜æ…¢ å¯ä»¥ä½¿ç”¨æˆ‘ä»¬ä¸Šé¢è¯´çš„é‡åˆ†åŒºæ“ä½œï¼Œé‚£ä¹ˆå…·ä½“ä½¿ç”¨repartitionè¿˜æ˜¯coalesceè¿˜æ˜¯éœ€è¦è§†å…·ä½“æƒ…å†µè€Œå®šçš„ã€‚å¦‚æœè¦è¿›è¡Œé‡åˆ†åŒºçš„dataframeå‰é¢å·²ç»ç»è¿‡äº†ï¼Œcoalesceæ˜¯æŸäº›æƒ…å†µä¸‹æ•ˆç‡è¾ƒrepartitionè¦é«˜ã€‚ RDDä¸DataFrame[DataSet]çš„åŒºåˆ«æ˜¯ä»€ä¹ˆRDDå¤„ç†çš„æ•°æ®éƒ½æ˜¯æ²¡æœ‰å…·ä½“schemaçš„ï¼Œè¾ƒä¸ºåº•å±‚ï¼ŒåŸºäºRDDå¼€å‘å°±å¿…é¡»è¦éå¸¸æ¸…æ¥šæ¯æ¬¡è¦å¤„ç†çš„é‚£ä¸€æ¡è®°å½•çš„æ¯ä¸ªä½ç½®çš„æ•°æ®çš„å«ä¹‰æ˜¯ä»€ä¹ˆ DataFrameæˆ–è€…DataSetæ˜¯æœ‰å…·ä½“schemaçš„RDDçš„å®ç°ï¼Œå®ƒåŸºäºRDDçš„åŸºç¡€ä¹‹ä¸Šç»™æˆ‘ä»¬æä¾›äº†æ›´åŠ å‹å¥½çš„ä½¿ç”¨RDDçš„æ–¹å¼ï¼Œå®ƒåœ¨åº•å±‚çš„æ•°æ®ä¸å…·ä½“çš„schemaä¹‹é—´åšäº†ä¸€ä¸ªè½¬åŒ–ï¼Œè®©ç”¨æˆ·åœ¨ä½¿ç”¨çš„æ—¶å€™çœ‹åˆ°çš„æ˜¯å…·ä½“schemaä¿¡æ¯ï¼Œä½¿ç”¨è€…å¯ä»¥ä¸ç”¨æ“å¿ƒæ¯æ¬¡æ“ä½œæ•°æ®è¿˜è¦æ‹…å¿ƒæˆ‘è¦å¤„ç†çš„å½“å‰å­—æ®µçš„å«ä¹‰æ˜¯å¦æ˜¯æˆ‘æ‰€éœ€è¦çš„ã€‚ ã€è®²ã€‘Sparkæ¡†æ¶å‡ ä¸ªè§’è‰²èµ„æºå±‚ï¼šMasterã€Workerè®¡ç®—å±‚ï¼šClientã€Driverã€Executor å­˜å‚¨å±‚ï¼šHdfsæˆ–è€…S3 éƒ¨ç½²æ¨¡å¼standalonemasterã€worker ä¸»ä»æ¶æ„ - ä¸»è¦æ˜¯è´Ÿè´£èµ„æºè°ƒåº¦åªæ”¯æŒclientæ¨¡å¼ï¼šDriverè¿è¡Œåœ¨æœ¬åœ° - mainæ–¹æ³•è¿è¡Œåœ¨æœ¬åœ° - clientä¸Driveréƒ½åœ¨æœ¬åœ° yarnhdfsï¼šNameNodeã€DataNode ResourceManagerã€NodeManagerã€ApplicationMastersparkçš„æ‰€æœ‰è§’è‰²éƒ½æ˜¯è¿è¡Œåœ¨NodeManagerä¸Šï¼Œæ¯ä¸ªè§’è‰²å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªJVMè¿›ç¨‹ï¼Œæ‰€æœ‰è¿›ç¨‹éƒ½æ˜¯è¿è¡Œåœ¨NodeManagerèŠ‚ç‚¹ä¸Šçš„Containeré‡Œé¢ Containeræ˜¯å¯¹ä¸€ç»„èµ„æºçš„æŠ½è±¡ï¼ŒåŒ…æ‹¬å†…å­˜ã€CPUã€ç£ç›˜ï¼Œç½‘ç»œç­‰èµ„æºï¼Œä½†æ˜¯æ²¡æœ‰åšåˆ°CPUçš„éš”ç¦»ï¼Œæ‰€æœ‰è¿›ç¨‹éƒ½æ˜¯å…±äº«çš„å®¿ä¸»æœºçš„CPUappMaster(Container)-Driverã€Executor(Container)åˆ©ç”¨yarnçš„èµ„æºè°ƒåº¦ç®€åŒ–äº†sparkè‡ªèº«çš„èŒèƒ½ï¼Œmasterä¸éœ€è¦è‡ªå·±ç»´æŠ¤é›†ç¾¤ä¸­çš„èµ„æºä½¿ç”¨æƒ…å†µï¼Œåªè´Ÿè´£æ¥æ”¶clientæäº¤çš„ä»»åŠ¡ yarnæ˜¯ä¸€ä¸ªé€šç”¨çš„èµ„æºè°ƒåº¦å¹³å°ï¼Œå¾ˆå¤šåº”ç”¨éƒ½å¯ä»¥è¿è¡Œåœ¨yarnä¸Šï¼Œå› æ­¤ï¼Œyarnç®¡ç†çš„é›†ç¾¤èµ„æºæ˜¯ä¸€ç§æ›´åŠ å¹¿æ³›çš„èµ„æºï¼Œä¸æ­¢sparkè¿™ä¸€ç§åº”ç”¨æ‰€å ç”¨çš„èµ„æºã€‚è¿™æ ·ä¸€æ¥å¯ä»¥æ›´åŠ å……åˆ†çš„åˆ©ç”¨æ•´ä¸ªé›†ç¾¤çš„èµ„æºã€‚åŒç†ä¸€äº›å…¶ä»–çš„èµ„æºè°ƒåº¦å¹³å°ï¼Œå¦‚k8sç­‰ä¹Ÿæ˜¯ä¸€æ ·çš„é“ç† æ”¯æŒclientå’Œclusteræ¨¡å¼clusterï¼šDriverä¼šè¿è¡Œåœ¨æ€¥ç¾¤ä¼—çš„ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹ä¸Š - clientåœ¨æ‰§è¡Œspark-submitçš„èŠ‚ç‚¹ - è¿™ç§æ¨¡å¼æ— æ³•è¿›è¡Œæ‰“å°å½¢å¼çš„debugï¼Œé™¤éé›†ç¾¤ä¸­å¯ä»¥çœ‹åˆ°è¿è¡ŒDriverçš„é‚£ä¸ªèŠ‚ç‚¹çš„æ—¥å¿— k8s&amp;Mesosç•¥ Sparkä¸­çš„ä¸€äº›æ¦‚å¿µ Term Meaning Application User program built on Spark. Consists of a driver program and executors on the cluster. Application jar A jar containing the userâ€™s Spark application. In some cases users will want to create an â€œuber jarâ€ containing their application along with its dependencies. The userâ€™s jar should never include Hadoop or Spark libraries, however, these will be added at runtime. Driver program The process running the main() function of the application and creating the SparkContext Cluster manager An external service for acquiring resources on the cluster (e.g. standalone manager, Mesos, YARN) Deploy mode Distinguishes where the driver process runs. In â€œclusterâ€ mode, the framework launches the driver inside of the cluster. In â€œclientâ€ mode, the submitter launches the driver outside of the cluster. Worker node Any node that can run application code in the cluster Executor A process launched for an application on a worker node, that runs tasks and keeps data in memory or disk storage across them. Each application has its own executors. Task A unit of work that will be sent to one executor Job A parallel computation consisting of multiple tasks that gets spawned in response to a Spark action (e.g. save, collect); youâ€™ll see this term used in the driverâ€™s logs. Stage Each job gets divided into smaller sets of tasks called stages that depend on each other (similar to the map and reduce stages in MapReduce); youâ€™ll see this term used in the driverâ€™s logs. job+stage+task æ˜¯é€»è¾‘ä¸Šçš„æ¦‚å¿µ ä¸€ä¸ªJobä¼šæ ¹æ®rddçš„dependencyå…³ç³»è¢«åˆ‡åˆ†æˆä¸åŒçš„stage(é‡åˆ°å®½ä¾èµ–å°±ä¼šåˆ‡åˆ†stage)ï¼Œæ¯ä¸ªstageä¼šæ ¹æ®åˆ†åŒºå™¨(partitioner)å¹¶ç»“åˆç³»ç»Ÿçš„å¹¶è¡Œåº¦è®¡ç®—å‡ºå¯¹åº”çš„åˆ†åŒºæ•°ï¼Œæ¯ä¸ªåˆ†åŒºå®é™…ä¸Šå¯ä»¥è¿è¡Œä¸€ä¸ªtaskï¼Œæ‰€ä»¥ä¸€ä¸ªstageåŒ…å«äº†ä¸€ç»„task executor + thread æ˜¯ç‰©ç†ä¸Šçš„æ¦‚å¿µ å…·ä½“çš„taskæ˜¯è¿è¡Œåœ¨executorä¸Šçš„ä¸€ä¸ªçº¿ç¨‹ä¸Šï¼Œæ‰€ä»¥æˆ‘ä»¬è®¾ç½®çš„ä¸€ä¸ªexecutorçš„coreså†³å®šäº†æ¯ä¸ªexecutoræœ€å¤šå¯ä»¥å¹¶è¡Œå¤šå°‘ä¸ªthreadï¼Œä¹Ÿå°±æ˜¯å¹¶è¡Œå¤šå°‘ä¸ªtask æ‰€ä»¥æˆ‘ä»¬æ‰èƒ½åœ¨sparkçš„web uiçš„Executorsä¸€æ ä¸­çœ‹åˆ°å¦‚ä¸Šå›¾çš„è¡¨ç¤ºï¼šæˆ‘ä»¬ä¼šå‘ç°æœ‰ä¸¤åˆ— Coreså’ŒActive Tasksï¼Œå°±æ˜¯å¯¹åº”äº†æˆ‘ä¸Šé¢è¯´çš„é‚£å¥è¯ã€‚ Spark2.4æ–°ç‰¹æ€§spark2.4æ–°å¢äº†ä¸€äº›ç‰¹æ€§ï¼Œå¯ä»¥è®©spark SQLæ›´åŠ çµæ´»ä½¿ç”¨ï¼Œå¯ä»¥ä»å®˜ç½‘æ–‡æ¡£ä¸Šæœç´¢Since: 2.4.0ï¼Œä¸‹é¢ç½—åˆ—ä¸€äº› array array_sort array_union arrays_overlap arrays_zip array_distinct array_except array_intersect array_join array_max array_min array_position array_remove array_repeat exists filter flatten shuffle slice array&amp;map element_at map map_concat map_from_arrays map_from_entries sequence sequence lambda transform zip_with aggregateï¼šè¿™ä¸ªå‡½æ•°å¾ˆæœ‰ç”¨ï¼Œæˆ‘ä»¬å‘ç°æ–°ç‰¹æ€§é‡Œé¢å¹¶æ²¡æœ‰æä¾›array_sumçš„æ–¹æ³•ï¼Œä½¿ç”¨è¿™ä¸ªæ–¹æ³•å°±å¯ä»¥å®ç°ğŸ˜ƒ ä»¥ä¸Šè¿™äº›æ–°çš„ç‰¹æ€§ï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™éå¸¸æ–¹ä¾¿ï¼Œå¤§å®¶å¯ä»¥åœ¨è‡ªå·±çš„åº”ç”¨åœºæ™¯ä¸‹å°½å¯èƒ½çš„å°è¯•ï¼Œæœ‰äº›å‡½æ•°ç»„åˆèµ·æ¥å¯ä»¥äº§ç”Ÿå¾ˆå¼ºå¤§çš„æ•ˆæœå“¦ã€‚æ¯”å¦‚ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªç»„åˆä½¿ç”¨sequenceã€transformã€explodeæ–¹æ³•å®ç°çš„ä¸€ä¸ªè‡ªåŠ¨ç”Ÿæˆæ—¥æœŸåºåˆ—çš„æ–¹å¼ã€‚ åœ¨æŸäº›åœºæ™¯ä¸‹éå¸¸å¥½ç”¨ï¼šç³»ç»Ÿä¸­æ²¡æœ‰æ—¥æœŸè¡¨ï¼Œä½†æ˜¯æˆ‘ä»¬åˆéœ€è¦ä¸€ä¸ªæ—¥æœŸåºåˆ—æ¥è¿›è¡Œç±»ä¼¼äºcross joinçš„æ“ä½œï¼Œå¯ä»¥ç›´æ¥é€šè¿‡è¿™äº›æ–°ç‰¹æ€§ç›´æ¥å®ç°ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061-- schema:-- date: æ—¥æœŸ-- year: å¹´ä»½-- month: æœˆä»½-- week1: å‘¨çš„ç¬¬ä¸€å¤©(start from Monday)-- week2: å‘¨çš„ç¬¬ä¸€å¤©(start from Sunday)-- quarter: å­£åº¦-- today: ä»Šå¤©çš„day_of_month-- is_curr_month: æ˜¯å¦ä¸ºå½“æœˆ-- day ç»´åº¦SELECT date[0] date, date[1] year, date[2] month, date[3] week1, date[4] quarter, date[5] week2 , date[6] next_month, date[7] last_month, date[8] today, date[9] is_curr_monthfrom ( SELECT explode( transform( sequence( date_sub(from_utc_timestamp(now(), 'Asia/Jakarta'), 7 * 52 + dayofweek(from_utc_timestamp(now(), 'Asia/Jakarta')) - 1), date_add(to_date(from_utc_timestamp(now(), 'Asia/Jakarta')), -1), interval 1 day ), x -&gt; array( x, to_date(date_trunc('YEAR', x)), to_date(date_trunc('MM', x)), to_date(date_trunc('WEEK', x)), to_date(date_trunc('QUARTER', x)), to_date(date_sub(next_day(x, 'Sun'), 7)), add_months(to_date(date_trunc('MM', x)), 1), add_months(to_date(date_trunc('MM', x)), -1), string(day(to_date(from_utc_timestamp(now(), 'Asia/Jakarta')))), string(to_date(date_trunc('MM', x))==date_trunc('MM', to_date(from_utc_timestamp(now(), 'Asia/Jakarta')))) ) ) ) date) tmp-- week ç»´åº¦ SELECT EXPLODE( SEQUENCE( date_sub(from_utc_timestamp(now(), 'Asia/Jakarta'), 60), date_add(to_date(from_utc_timestamp(now(), 'Asia/Jakarta')), -1), INTERVAL 1 WEEK ) )-- month ç»´åº¦select tmp.d[0] date from ( SELECT EXPLODE( transform( SEQUENCE( to_date('2018-09-30'), add_months(to_date(from_utc_timestamp(now(), 'Asia/Jakarta')), 1), INTERVAL 1 MONTH ), x -&gt; array( if(date_trunc('MM', x)=date_trunc('MM', to_date(from_utc_timestamp(now(), 'Asia/Jakarta'))), date_add(to_date(from_utc_timestamp(now(), 'Asia/Jakarta')), -1), x) ) ) ) d) tmp Sparkå¯åŠ¨å‚æ•°å¯ä»¥é€šè¿‡SparkConfé…ç½®å‚æ•°ï¼š spark.driver.memory spark.executor.memory spark.executor.cores spark.yarn.executor.memoryOverhead spark.executor.memoryOverhead spark.sql.shuffle.partitions spark.default.parallelism spark.port.maxRetries spark.sql.legacy.parser.havingWithoutGroupByAsWhere spark.maxRemoteBlockSizeFetchToMem spark.sql.sources.partitionOverwriteMode spark.dynamicAllocation.maxExecutors spark.sql.autoBroadcastJoinThreshold spark.master spark.ui.killEnabled sparkå¯åŠ¨å‚æ•°çš„ä¼˜å…ˆçº§ï¼šSparkConf &gt; spark-submit æˆ– spark-shell &gt;spark-defaults.conf","categories":[],"tags":[]},{"title":"Pythonå­¦ä¹ -é«˜çº§å‡½æ•°","slug":"Pythonå­¦ä¹ -é«˜çº§å‡½æ•°","date":"2021-05-03T23:16:09.000Z","updated":"2021-05-03T23:34:51.912Z","comments":true,"path":"post/Pythonå­¦ä¹ -é«˜çº§å‡½æ•°/","link":"","permalink":"https://shang.at/post/Pythonå­¦ä¹ -é«˜çº§å‡½æ•°/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š map1map(func, *iterables) --&gt; map object Make an iterator that computes the function using arguments from each of the iterables. Stops when the shortest iterable is exhausted. reduce12from functools import reducereduce(function, sequence[, initial]) -&gt; value Apply a function of two arguments cumulatively to the items of a sequence, from left to right, so as to reduce the sequence to a single value. For example, reduce(lambda x, y: x+y, [1, 2, 3, 4, 5]) calculates ((((1+2)+3)+4)+5). If initial is present, it is placed before the items of the sequence in the calculation, and serves as a default when the sequence is empty. filter1filter(function or None, iterable) --&gt; filter object sum1sum(iterable, start=0, /) åˆ—è¡¨å«æœ‰å­åˆ—è¡¨å±•å¼€æˆä¸€ä¸ªåˆ—è¡¨ï¼Œåˆ—è¡¨çš„æ‰å¹³åŒ– 1234listA = [['a'], ['b'], ['c', 'd']] listA1 = sum(listA, []) # ['a', 'b', 'c', 'd'] æˆ–è€…ä½¿ç”¨reduceä¹Ÿæ˜¯å¯ä»¥çš„ï¼š 12345from functools import reducea=[[1,2,3],[4,5,],[6]]a=reduce(lambda x,y:x+y,a)a# [1, 2, 3, 4, 5, 6]","categories":[],"tags":[]},{"title":"Sparkå­¦ä¹ -udf","slug":"Sparkå­¦ä¹ -udf","date":"2021-04-27T02:45:15.000Z","updated":"2021-05-21T10:03:08.428Z","comments":true,"path":"post/Sparkå­¦ä¹ -udf/","link":"","permalink":"https://shang.at/post/Sparkå­¦ä¹ -udf/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š sparkçš„udfåº”è¯¥å¦‚ä½•ä½¿ç”¨ï¼Ÿ å£°æ˜çš„ä½ç½®ä¸å¯¹ä¼šä¸ä¼šæœ‰ä»€ä¹ˆå½±å“ï¼Ÿ sparkä¸­çš„é—­åŒ…(closure-cleaned) 123456789101112131415161718192021222324252627282930313233Helper method to clean the given closure in place.The mechanism is to traverse the hierarchy of enclosing closures and null out anyreferences along the way that are not actually used by the starting closure, but arenevertheless included in the compiled anonymous classes. Note that it is unsafe tosimply mutate the enclosing closures in place, as other code paths may depend on them.Instead, we clone each enclosing closure and set the parent pointers accordingly.By default, closures are cleaned transitively. This means we detect whether enclosingobjects are actually referenced by the starting one, either directly or transitively,and, if not, sever these closures from the hierarchy. In other words, in addition tonulling out unused field references, we also null out any parent pointers that referto enclosing objects not actually needed by the starting closure. We determinetransitivity by tracing through the tree of all methods ultimately invoked by theinner closure and record all the fields referenced in the process.For instance, transitive cleaning is necessary in the following scenario: class SomethingNotSerializable &#123; def someValue = 1 def scope(name: String)(body: =&gt; Unit) = body def someMethod(): Unit = scope(&quot;one&quot;) &#123; def x = someValue def y = 2 scope(&quot;two&quot;) &#123; println(y + 1) &#125; &#125; &#125;In this example, scope &quot;two&quot; is not serializable because it references scope &quot;one&quot;, whichreferences SomethingNotSerializable. Note that, however, the body of scope &quot;two&quot; does notactually depend on SomethingNotSerializable. This means we can safely null out the parentpointer of a cloned scope &quot;one&quot; and set it the parent of scope &quot;two&quot;, such that scope &quot;two&quot;no longer references SomethingNotSerializable transitively åŒ¿åå‡½æ•° - lambdaå‡½æ•°","categories":[],"tags":[]},{"title":"Sparkå­¦ä¹ -map-struct-array","slug":"Sparkå­¦ä¹ -map-struct-array","date":"2021-04-26T02:50:00.000Z","updated":"2021-04-26T03:38:35.509Z","comments":true,"path":"post/Sparkå­¦ä¹ -map-struct-array/","link":"","permalink":"https://shang.at/post/Sparkå­¦ä¹ -map-struct-array/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š å…³äºsparkä¸­çš„mapã€structã€arrayçš„ä¸€äº›æ“ä½œ é¦–å…ˆåˆ›å»ºä¸€ä¸ªdataframe 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263import org.apache.spark.sql.expressions.UserDefinedFunctionimport org.apache.spark.sql.functions._import org.apache.spark.sql.&#123;DataFrame, Row, SparkSession&#125;val sparkConf = new SparkConfsparkConf.set(\"spark.maxRemoteBlockSizeFetchToMem\", 1024 * 1024 * 256 toString)sparkConf.set(\"spark.sql.sources.partitionOverwriteMode\", \"dynamic\")sparkConf.set(\"spark.master\", \"local[*]\")lazy val spark: SparkSession = &#123; SparkSession.builder() .config(sparkConf) .appName(appName) .enableHiveSupport() .getOrCreate()&#125;import spark.implicits._case class TestStruct(f1: String, f2: String)def testUdf: UserDefinedFunction = udf((a: String) =&gt; &#123; List(TestStruct(a, \"f1\"), TestStruct(s\"$a.00\", \"f2\"))&#125;)def testUdf1: UserDefinedFunction = udf((a: String) =&gt; &#123; TestStruct(a, \"f1\")&#125;)def testUdf2: UserDefinedFunction = udf((a: String) =&gt; &#123; Map(\"key\" -&gt; a, \"key1\" -&gt; a)&#125;)val lines: List[(String, Int, Int, Map[String, String])] = List( Tuple4(\"a\", 1, 2, Map(\"a\" -&gt; \"3\", \"c\" -&gt; \"a\")), Tuple4(\"b\", 11, 22, Map(\"a\" -&gt; \"33\", \"c\" -&gt; \"aa\")), Tuple4(\"c\", 111, 2222, Map(\"a\" -&gt; \"3333\", \"c\" -&gt; \"aaa\")))lines.toDF( \"f1\", \"f2\", \"f3\", \"extra\" ).withColumn( \"struct_array\", testUdf('f1) ).withColumn( \"map\", testUdf2('f1) ).withColumn( \"struct\", testUdf1('f1) ).withColumn( \"extra_a\", $\"extra.a\" ).withColumn( \"extra_c\", $\"extra.c\" ).withColumn( \"extra_d\", $\"extra.d\" ).withColumn( \"struct_array_f1\", $\"struct_array.f1\" ).withColumn( \"struct_f1\", $\"struct.f1\" ).withColumn( \"struct_f2\", expr(\"struct['f2']\") ).withColumn( \"struct_array0\", expr(\"struct_array[0]\") ).withColumn( \"struct_array0_f1\", expr(\"struct_array[0].f1\") ) æ‰“å°ä¸Šè¿°dataframeçš„schemaå¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728root |-- f1: string (nullable = true) |-- f2: integer (nullable = true) |-- f3: integer (nullable = true) |-- extra: map (nullable = true) | |-- key: string | |-- value: string (valueContainsNull = true) |-- struct_array: array (nullable = true) | |-- element: struct (containsNull = true) | | |-- f1: string (nullable = true) | | |-- f2: string (nullable = true) |-- map: map (nullable = true) | |-- key: string | |-- value: string (valueContainsNull = true) |-- struct: struct (nullable = true) | |-- f1: string (nullable = true) | |-- f2: string (nullable = true) |-- extra_a: string (nullable = true) |-- extra_c: string (nullable = true) |-- extra_d: string (nullable = true) |-- struct_array_f1: array (nullable = true) | |-- element: string (containsNull = true) |-- struct_f1: string (nullable = true) |-- struct_f2: string (nullable = true) |-- struct_array0: struct (nullable = true) | |-- f1: string (nullable = true) | |-- f2: string (nullable = true) |-- struct_array0_f1: string (nullable = true) è¯»å–è¿™ä¸ªè¡¨æ•°æ®ï¼Œæ‰“å°å‡ºæ¥å¦‚ä¸‹ï¼š ç»“è®ºï¼š mapç»“æ„çš„æ•°æ®å¦‚æœæƒ³ä½¿ç”¨colæˆ–è€…$æ“ä½œç¬¦å–valueï¼Œå¯ä»¥ç›´æ¥é€šè¿‡.å–åˆ°å¯¹åº”çš„å€¼ï¼Œå¦‚æœmapä¸­æ²¡æœ‰å¯¹åº”çš„keyï¼Œåˆ™è¿”å›Noneï¼› ä¸èƒ½ä½¿ç”¨ç±»ä¼¼col(&quot;extra[&#39;a&#39;]&quot;)æˆ–è€…\"extra['a']\"`çš„æ–¹å¼å–`value`ï¼Œä¹Ÿå¯ä»¥æƒ³è±¡ï¼š`col`æˆ–è€…`æ“ä½œç¬¦æœ€ç»ˆè¿”å›çš„æ˜¯ä¸€ä¸ªColumnå¯¹è±¡ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªè´§çœŸä»·å®çš„Columnï¼Œä¸æ˜¯é‚£ç§éœ€è¦è®¡ç®—å¾—æ¥çš„Column è¦æƒ³ä½¿ç”¨extra[&#39;a&#39;]çš„å½¢å¼å–å€¼ï¼Œéœ€è¦ä½¿ç”¨expræ“ä½œç¬¦ï¼Œå¦‚expr(&quot;extra[&#39;a&#39;]&quot;)ï¼Œé¡¾åæ€ä¹‰ï¼Œexpræ¥å—çš„æ˜¯ä¸€ä¸ªè¯­å¥ï¼Œå®ƒä¼šè§£é‡Šå¹¶æ‰§è¡Œå®ƒï¼Œè¿”å›ä¸€ä¸ªColumn structç»“æ„çš„å­—æ®µï¼Œå–æ³•å’Œmapç»“æ„åŸºæœ¬ä¸€è‡´ï¼Œä½†æ˜¯äººä¸€ä¸Šæ¥å°±ä¼šæƒ³åˆ°ç”¨.æ¥å–å€¼ï¼Œè€Œä¸æ˜¯ç”¨[&#39;a&#39;]çš„æ–¹å¼æ¥å–å€¼ï¼Œæ˜¯å› ä¸ºå®ƒæ˜¯ä¸€ä¸ªå®šä¹‰æ¸…æ™°çš„ç»“æ„ä½“ï¼Œå­—æ®µå®šä¹‰æ¸…æ™°ï¼Œä½†æ˜¯expr(struct[&#39;f2&#39;])è¿™ç§å–å€¼æ–¹å¼æ˜¯å¯ä»¥çš„ å¯¹äºä¸€ä¸ªarrayç±»å‹çš„å­—æ®µï¼Œå¦‚æœæƒ³è¦å–ç¬¬iä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆå¿…é¡»è¦ä½¿ç”¨expræ“ä½œç¬¦ï¼Œæ¯”å¦‚ï¼šstruct_array[0]æˆ–struct_array[0].f1 å¦‚æœarrayçš„æ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œå–å€¼æ—¶ä¸éœ€è¦è€ƒè™‘å–å“ªä¸€ä¸ªï¼Œç›´æ¥ä½¿ç”¨.å–æŸä¸ªå­—æ®µï¼Œåˆ™è¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹åº”çš„å­—æ®µçš„arrayï¼Œæ¯”å¦‚ï¼šstruct_array.f1 åœ¨sparkSQLä¸­ä¸éœ€è¦å¿Œè®³ä»¥ä¸Šæ‰€æœ‰çš„é—®é¢˜ï¼Œæƒ³æ€ä¹ˆå–å°±æ€ä¹ˆå–ï¼Œå› ä¸ºå®ƒæœ¬èº«å°±æ˜¯ä¸€ä¸ªexprï¼Œä»–å¯ä»¥å…¼å®¹æ‰€æœ‰çš„æƒ…å†µ^_^ æ„å¤–æ”¶è·ï¼š å¦‚æœä½¿ç”¨scalaæ¥ç¼–å†™sparkçš„ç¨‹åºï¼Œé‚£ä¹ˆåˆ›å»ºmapå’Œstructç±»å‹çš„å­—æ®µï¼Œå°±ååˆ†ç®€å•äº†ã€‚åˆ›å»ºä¸€ä¸ªudfï¼Œç„¶åbalalaä¸€é€šï¼Œudfè¿”å›çš„æ˜¯case classå°±ä¼šå½¢æˆä¸€ä¸ªstructç±»å‹çš„å­—æ®µï¼Œudfè¿”å›çš„æ˜¯ä¸€ä¸ªMapå°±ä¼šå½¢æˆä¸€ä¸ªmapç±»å‹çš„å­—æ®µï¼Œæ¯”å¦‚ä¸Šé¢çš„testUdf2ã€testUdf1ã€testUdf","categories":[],"tags":[]},{"title":"Sparkå­¦ä¹ -å¼‚å¸¸åˆ†æ","slug":"Sparkå­¦ä¹ -å¼‚å¸¸åˆ†æ","date":"2021-04-22T00:16:02.000Z","updated":"2021-05-19T02:55:33.037Z","comments":true,"path":"post/Sparkå­¦ä¹ -å¼‚å¸¸åˆ†æ/","link":"","permalink":"https://shang.at/post/Sparkå­¦ä¹ -å¼‚å¸¸åˆ†æ/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š broadcastå¼•å‘çš„OOMSpark-error.log coalesce å¼•å‘çš„OOMSpark-error.log https://stackoverflow.com/questions/31610971/spark-repartition-vs-coalesce/65038141#65038141 https://stackoverflow.com/questions/31674530/write-single-csv-file-using-spark-csv https://stackoverflow.com/questions/38961251/java-lang-outofmemoryerror-unable-to-acquire-100-bytes-of-memory-got-0 test coalesce(1) coalesce(2) repartition(1) joinä¹‹åæ‰§è¡Œcoalesceã€filterä¹‹åæ‰§è¡Œcoalesceéƒ½ä¼š Spark - repartition() vs coalesce()ï¼šhttps://stackoverflow.com/questions/31610971/spark-repartition-vs-coalesce/65038141#65038141 æŸ¥çœ‹æ‰§è¡Œè®¡åˆ’çš„å¥½åœ°æ–¹spark web uiçš„ SQL é¡µ Task not serializablewhat is java.io.NotSerializableExceptionï¼Ÿand whyï¼Ÿand whenï¼Ÿ","categories":[],"tags":[]},{"title":"Pythonæ•°æ®åˆ†æ-matplotlibå­¦ä¹ ","slug":"Pythonæ•°æ®åˆ†æ-matplotlibå­¦ä¹ ","date":"2021-04-14T22:58:12.000Z","updated":"2021-04-14T23:19:47.528Z","comments":true,"path":"post/Pythonæ•°æ®åˆ†æ-matplotlibå­¦ä¹ /","link":"","permalink":"https://shang.at/post/Pythonæ•°æ®åˆ†æ-matplotlibå­¦ä¹ /","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š æ¡ˆä¾‹matplotlibç”»ç­‰é«˜çº¿å›¾1234567891011121314151617181920212223import numpy as npimport pandas as pdimport matplotlib.pyplot as plt# è®¡ç®—x,yåæ ‡å¯¹åº”çš„é«˜åº¦å€¼def f(x, y): return (1-x/2+x**5+y**3) * np.exp(-x**2-y**2)# ç”Ÿæˆx,yçš„æ•°æ®n = 256x = np.linspace(-3, 3, n)y = np.linspace(-3, 3, n)# æŠŠx,yæ•°æ®ç”Ÿæˆmeshç½‘æ ¼çŠ¶çš„æ•°æ®ï¼Œå› ä¸ºç­‰é«˜çº¿çš„æ˜¾ç¤ºæ˜¯åœ¨ç½‘æ ¼çš„åŸºç¡€ä¸Šæ·»åŠ ä¸Šé«˜åº¦å€¼X, Y = np.meshgrid(x, y)# å¡«å……ç­‰é«˜çº¿plt.contourf(X, Y, f(X, Y), 20, cmap=plt.cm.hot)# æ·»åŠ ç­‰é«˜çº¿C = plt.contour(X, Y, f(X, Y), 20)plt.clabel(C, inline=True, fontsize=12)# æ˜¾ç¤ºå›¾è¡¨plt.show() ä½¿ç”¨ GridSpec ç»˜åˆ¶éå‡åŒ€å­å›¾1234567891011121314151617181920212223242526272829303132333435# å›¾çš„æ¯”ä¾‹å¤§å°ä¸åŒä½†æ²¡æœ‰è·¨è¡Œæˆ–è·¨åˆ—fig = plt.figure(figsize=(6, 6))spec = fig.add_gridspec(nrows=2, ncols=2, width_ratios=[5,1], height_ratios=[1,5])fig.suptitle('æ•°æ®çš„æ•£ç‚¹å›¾å’Œè¾¹é™…åˆ†å¸ƒ', size=20)# ç»˜åˆ¶ç¬¬ä¸€ä¸ªxè½´ä¸Šçš„ç›´æ–¹å›¾ax = fig.add_subplot(spec[0,0])ax.hist(data[0])ax.xaxis.set_visible(False) # éšè—xåæ ‡è½´æ˜¾ç¤ºax.yaxis.set_visible(False) # éšè—yåæ ‡è½´æ˜¾ç¤º# éšè—è¾¹æ¡†for loc in ['top', 'right', 'bottom', 'left']: ax.spines[loc].set_visible(False)# ax.spines['top'].set_visible(False)# ax.spines['right'].set_visible(False)# ax.spines['bottom'].set_visible(False)# ax.spines['left'].set_visible(False)# ç»˜åˆ¶æ•£ç‚¹å›¾ax = fig.add_subplot(spec[1,0])ax.scatter(data[0], data[1])ax.grid(True) # æ·»åŠ ç½‘æ ¼æ˜¾ç¤º# ç»˜åˆ¶yè½´ä¸Šçš„ç›´æ–¹å›¾ax = fig.add_subplot(spec[1,1])ax.hist(data[1], orientation='horizontal') # orientationè®¾ç½®æ°´å¹³æ˜¾ç¤ºï¼Œé»˜è®¤æ˜¯å‚ç›´æ˜¾ç¤ºçš„ax.xaxis.set_visible(False) # éšè—xåæ ‡è½´æ˜¾ç¤ºax.yaxis.set_visible(False) # éšè—yåæ ‡è½´æ˜¾ç¤º# éšè—è¾¹æ¡†for loc in ['top', 'right', 'bottom', 'left']: ax.spines[loc].set_visible(False)fig.tight_layout() 1234567891011121314151617181920212223242526272829# å›¾ä¸ºè·¨åˆ—æˆ–è·¨è¡ŒçŠ¶æ€fig = plt.figure(figsize=(6, 6))spec = fig.add_gridspec(nrows=6, ncols=6, width_ratios=[1,1,1,1,1,1], height_ratios=[1,1,1,1,1,1])fig.suptitle('æ•°æ®çš„æ•£ç‚¹å›¾å’Œè¾¹é™…åˆ†å¸ƒ', size=20)ax = fig.add_subplot(spec[0,0:5])ax.hist(data[0])ax.xaxis.set_visible(False)ax.yaxis.set_visible(False)for loc in ['top', 'right', 'bottom', 'left']: ax.spines[loc].set_visible(False)# ax.spines['top'].set_visible(False)# ax.spines['right'].set_visible(False)# ax.spines['bottom'].set_visible(False)# ax.spines['left'].set_visible(False)ax = fig.add_subplot(spec[1:5,0:5])ax.scatter(data[0], data[1])ax.grid(True)ax = fig.add_subplot(spec[1:5,5])ax.hist(data[1], orientation='horizontal')ax.xaxis.set_visible(False)ax.yaxis.set_visible(False)for loc in ['top', 'right', 'bottom', 'left']: ax.spines[loc].set_visible(False)fig.tight_layout()","categories":[{"name":"Pythonæ•°æ®åˆ†æ","slug":"Pythonæ•°æ®åˆ†æ","permalink":"https://shang.at/categories/Pythonæ•°æ®åˆ†æ/"}],"tags":[{"name":"Matplotlib","slug":"Matplotlib","permalink":"https://shang.at/tags/Matplotlib/"}]},{"title":"Pythonæ•°æ®åˆ†æ-numpyå­¦ä¹ ","slug":"Pythonæ•°æ®åˆ†æ-numpyå­¦ä¹ ","date":"2021-04-14T22:50:01.000Z","updated":"2021-04-14T22:56:22.990Z","comments":true,"path":"post/Pythonæ•°æ®åˆ†æ-numpyå­¦ä¹ /","link":"","permalink":"https://shang.at/post/Pythonæ•°æ®åˆ†æ-numpyå­¦ä¹ /","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š np.newaxis åŠŸèƒ½:åœ¨è¡Œä¸Šæˆ–åˆ—ä¸Šæ–°å¢ä¸€ä¸ªç»´åº¦ 12345678910111213141516171819202122a=np.array([1,2,3,4,5])print(a.shape)print (a)#(5,)#[1 2 3 4 5]a=np.array([1,2,3,4,5])aa=a[:,np.newaxis]print(aa.shape)print (aa)#(5, 1)#[[1]#[2]#[3]#[4]#[5]]a=np.array([1,2,3,4,5])aa=a[np.newaxis,:]print(aa.shape)print (aa)#(1, 5)","categories":[{"name":"Pythonæ•°æ®åˆ†æ","slug":"Pythonæ•°æ®åˆ†æ","permalink":"https://shang.at/categories/Pythonæ•°æ®åˆ†æ/"}],"tags":[{"name":"Numpy","slug":"Numpy","permalink":"https://shang.at/tags/Numpy/"}]},{"title":"Scalaå­¦ä¹ -ç¼–ç¨‹Tips-ç±»å‹è½¬æ¢","slug":"Scalaå­¦ä¹ -ç¼–ç¨‹Tips-ç±»å‹è½¬æ¢","date":"2021-04-14T08:42:26.000Z","updated":"2021-04-14T08:47:14.800Z","comments":true,"path":"post/Scalaå­¦ä¹ -ç¼–ç¨‹Tips-ç±»å‹è½¬æ¢/","link":"","permalink":"https://shang.at/post/Scalaå­¦ä¹ -ç¼–ç¨‹Tips-ç±»å‹è½¬æ¢/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š å¦‚æœå®ä¾‹åŒ–äº†å­ç±»çš„å¯¹è±¡ï¼Œä½†æ˜¯å°†å…¶èµ‹äºˆäº†çˆ¶ç±»ç±»å‹çš„å˜é‡ï¼Œåœ¨åç»­çš„è¿‡ç¨‹ä¸­ï¼Œåˆéœ€è¦å°†çˆ¶ç±»ç±»å‹çš„å˜é‡è½¬æ¢ä¸ºå­ç±»ç±»å‹çš„å˜é‡ï¼Œåº”è¯¥å¦‚ä½•åšï¼Ÿ Ã˜ é¦–å…ˆï¼Œéœ€è¦ä½¿ç”¨isInstanceOf åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ºæŒ‡å®šç±»çš„å¯¹è±¡ï¼Œå¦‚æœæ˜¯çš„è¯ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ asInstanceOf å°†å¯¹è±¡è½¬æ¢ä¸ºæŒ‡å®šç±»å‹ï¼› Ã˜ æ³¨æ„ï¼šp.isInstanceOf[XX] åˆ¤æ–­ p æ˜¯å¦ä¸º XX å¯¹è±¡çš„å®ä¾‹ï¼›p.asInstanceOf[XX] æŠŠ p è½¬æ¢æˆ XX å¯¹è±¡çš„å®ä¾‹ Ã˜ æ³¨æ„ï¼šå¦‚æœæ²¡æœ‰ç”¨isInstanceOf å…ˆåˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ºæŒ‡å®šç±»çš„å®ä¾‹ï¼Œå°±ç›´æ¥ç”¨ asInstanceOf è½¬æ¢ï¼Œåˆ™å¯èƒ½ä¼šæŠ›å‡ºå¼‚å¸¸ï¼› Ã˜ æ³¨æ„ï¼šå¦‚æœå¯¹è±¡æ˜¯ nullï¼Œåˆ™isInstanceOf ä¸€å®šè¿”å› falseï¼Œ asInstanceOf ä¸€å®šè¿”å› nullï¼› Ã˜ Scalaä¸Javaç±»å‹æ£€æŸ¥å’Œè½¬æ¢ Scala Java obj.isInstanceOf[C] obj instanceof C obj.asInstanceOf[C] (C)obj classOf[C] C.class Ã˜ ä¸¾ä¾‹è¯´æ˜ï¼š 123456789101112131415161718package cn.itcast.extends_democlass Person3 &#123;&#125;class Student3 extends Person3object Student3&#123; def main (args: Array[String] ) &#123; val p: Person3 = new Student3 var s: Student3 = null //å¦‚æœå¯¹è±¡æ˜¯ nullï¼Œåˆ™ isInstanceOf ä¸€å®šè¿”å› false println (s.isInstanceOf[Student3]) // åˆ¤æ–­ p æ˜¯å¦ä¸º Student3 å¯¹è±¡çš„å®ä¾‹ if (p.isInstanceOf[Student3] ) &#123; //æŠŠ p è½¬æ¢æˆ Student3 å¯¹è±¡çš„å®ä¾‹ s = p.asInstanceOf[Student3] &#125; println (s.isInstanceOf[Student3] ) &#125;&#125; Scalaä¸­getClass å’Œ classOfÃ˜ isInstanceOf èƒ½åˆ¤æ–­å‡ºå¯¹è±¡æ˜¯å¦ä¸ºæŒ‡å®šç±»ä»¥åŠå…¶å­ç±»çš„å¯¹è±¡ï¼Œè€Œä¸èƒ½ç²¾ç¡®çš„åˆ¤æ–­å‡ºï¼Œå¯¹è±¡å°±æ˜¯æŒ‡å®šç±»çš„å¯¹è±¡ï¼› Ã˜ å¦‚æœè¦æ±‚ç²¾ç¡®åœ°åˆ¤æ–­å‡ºå¯¹è±¡å°±æ˜¯æŒ‡å®šç±»çš„å¯¹è±¡ï¼Œé‚£ä¹ˆå°±åªèƒ½ä½¿ç”¨ getClass å’Œ classOf äº†ï¼› Ã˜ p.getClass å¯ä»¥ç²¾ç¡®åœ°è·å–å¯¹è±¡çš„ç±»ï¼ŒclassOf[XX]å¯ä»¥ç²¾ç¡®çš„è·å–ç±»ï¼Œç„¶åä½¿ç”¨ == æ“ä½œç¬¦å³å¯åˆ¤æ–­ï¼› Ã˜ ä¸¾ä¾‹è¯´æ˜ï¼š 123456789101112131415package cn.itcast.extends_democlass Person4 &#123;&#125;class Student4 extends Person4object Student4&#123; def main(args: Array[String]) &#123; val p:Person4=new Student4 //åˆ¤æ–­pæ˜¯å¦ä¸ºPerson4ç±»çš„å®ä¾‹ println(p.isInstanceOf[Person4])//true //åˆ¤æ–­pçš„ç±»å‹æ˜¯å¦ä¸ºPerson4ç±» println(p.getClass == classOf[Person4])//false //åˆ¤æ–­pçš„ç±»å‹æ˜¯å¦ä¸ºStudent4ç±» println(p.getClass == classOf[Student4])//true &#125;&#125;","categories":[],"tags":[]},{"title":"Scalaå­¦ä¹ -ç¼–ç¨‹Tips-å¼‚å¸¸å¤„ç†","slug":"Scalaå­¦ä¹ -ç¼–ç¨‹Tips-å¼‚å¸¸å¤„ç†","date":"2021-04-12T09:33:21.000Z","updated":"2021-05-12T02:41:49.935Z","comments":true,"path":"post/Scalaå­¦ä¹ -ç¼–ç¨‹Tips-å¼‚å¸¸å¤„ç†/","link":"","permalink":"https://shang.at/post/Scalaå­¦ä¹ -ç¼–ç¨‹Tips-å¼‚å¸¸å¤„ç†/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š 0.å¼‚å¸¸å¤„ç†æ¥çœ‹çœ‹ä¸‹é¢ä¸€æ®µä»£ç  123456789 def main(args: Array[String]): Unit = &#123; val i = 10 / 0 println(\"ä½ å¥½ï¼\") &#125;Exception in thread \"main\" java.lang.ArithmeticException: / by zero at ForDemo$.main(ForDemo.scala:3) at ForDemo.main(ForDemo.scala) æ‰§è¡Œç¨‹åºï¼Œå¯ä»¥çœ‹åˆ°scalaæŠ›å‡ºäº†å¼‚å¸¸ï¼Œè€Œä¸”æ²¡æœ‰æ‰“å°å‡ºæ¥â€ä½ å¥½â€ã€‚è¯´æ˜ç¨‹åºå‡ºç°é”™è¯¯åå°±ç»ˆæ­¢äº†ã€‚ é‚£æ€ä¹ˆè§£å†³è¯¥é—®é¢˜å‘¢ï¼Ÿ åœ¨scalaä¸­ï¼Œå¯ä»¥ä½¿ç”¨å¼‚å¸¸å¤„ç†æ¥è§£å†³è¿™ä¸ªé—®é¢˜ 1.æ•è·å¼‚å¸¸è¯­æ³•æ ¼å¼ 12345678910try &#123; // ä»£ç &#125;catch &#123; case ex:å¼‚å¸¸ç±»å‹1 =&gt; // ä»£ç  case ex:å¼‚å¸¸ç±»å‹2 =&gt; // ä»£ç &#125;finally &#123; // ä»£ç &#125; å°–å«æç¤ºï¼š Scalaä¸­æ•æ‰å¼‚å¸¸çš„catchå­å¥ï¼Œè¯­æ³•ä¸å…¶ä»–è¯­è¨€ä¸­ä¸å¤ªä¸€æ ·ã€‚åœ¨Scalaé‡Œï¼Œå€Ÿç”¨äº†æ¨¡å¼åŒ¹é…çš„æ€æƒ³æ¥åšå¼‚å¸¸çš„åŒ¹é…ï¼Œå› æ­¤ï¼Œåœ¨catchçš„ä»£ç é‡Œï¼Œæ˜¯ä¸€ç³»åˆ—caseå­—å¥ tryä¸­çš„ä»£ç æ˜¯æˆ‘ä»¬ç¼–å†™çš„ä¸šåŠ¡å¤„ç†ä»£ç  åœ¨catchä¸­è¡¨ç¤ºå½“å‡ºç°æŸä¸ªå¼‚å¸¸æ—¶ï¼Œéœ€è¦æ‰§è¡Œçš„ä»£ç  åœ¨finallyä¸­ï¼Œæ˜¯ä¸ç®¡æ˜¯å¦å‡ºç°å¼‚å¸¸éƒ½ä¼šæ‰§è¡Œçš„ä»£ç  ç¤ºä¾‹è¯´æ˜ ä½¿ç”¨try..catchæ¥æ•è·é™¤é›¶å¼‚å¸¸ å‚è€ƒä»£ç  123456789101112131415161718192021222324package com.robot.scalademoobject _08ObjectDemo &#123; def main(args: Array[String]): Unit = &#123; try &#123; val i = 10 / 0 println(\"ä½ å¥½ï¼\") &#125; catch &#123; //case ex: Exception =&gt; println(ex.getMessage) // / by zero case ex:Exception =&gt; ex.printStackTrace() //è°ƒç”¨è‡ªå¸¦æ–¹æ³•æ‰“å°,caseåªæ‰§è¡Œä¸€ä¸ªã€‚ &#125; finally &#123; println(\"æˆ‘ä¸€å®šä¼šæ‰§è¡Œï¼Œä¸ç®¡å¼‚å¸¸ä¸Šé¢å‘ç”Ÿäº†ä»€ä¹ˆ\") &#125; &#125;&#125;/*** java.lang.ArithmeticException: / by zero at com.robot.scalademo._08ObjectDemo$.main(_08ObjectDemo.scala:7) at com.robot.scalademo._08ObjectDemo.main(_08ObjectDemo.scala) æˆ‘ä¸€å®šä¼šæ‰§è¡Œï¼Œä¸ç®¡å¼‚å¸¸ä¸Šé¢å‘ç”Ÿäº†ä»€ä¹ˆ */ 2.æŠ›å‡ºå¼‚å¸¸æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ä¸€ä¸ªæ–¹æ³•ä¸­ï¼ŒæŠ›å‡ºå¼‚å¸¸ã€‚è¯­æ³•æ ¼å¼å’ŒJavaç±»ä¼¼ï¼Œä½¿ç”¨throw new Exception... ç¤ºä¾‹è¯´æ˜ åœ¨mainæ–¹æ³•ä¸­æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ å‚è€ƒä»£ç  12345678910111213141516171819202122232425262728293031//scalaä¸»åŠ¨æŠ›å‡ºå¼‚å¸¸package com.robot.scalademoobject _08ObjectDemo &#123; def main(args: Array[String]): Unit = &#123; throw new Exception(\"è¿™æ˜¯ä¸€ä¸ªå¼‚å¸¸\") &#125;&#125;/***Exception in thread \"main\" java.lang.Exception: è¿™æ˜¯ä¸€ä¸ªå¼‚å¸¸ at com.robot.scalademo._08ObjectDemo$.main(_08ObjectDemo.scala:6) at com.robot.scalademo._08ObjectDemo.main(_08ObjectDemo.scala) *///2.Scalaæ•è·ä¸»åŠ¨æŠ›å‡ºçš„å¼‚å¸¸package com.robot.scalademoobject _08ObjectDemo &#123; def main(args: Array[String]): Unit =&#123; try &#123; throw new Exception(\"è¿™æ˜¯ä¸€ä¸ªå¼‚å¸¸\") &#125;catch &#123; case ex:Exception =&gt; print(\"å“ˆå“ˆï¼Œè¢«æˆ‘æ•è·äº†\") &#125; &#125;&#125;/***å“ˆå“ˆï¼Œè¢«æˆ‘æ•è·äº† */ å°–å«æç¤ºï¼šæ³¨æ„åœ¨scalaä¸éœ€è¦åœ¨æ–¹æ³•ä¸Šå£°æ˜è¦æŠ›å‡ºçš„å¼‚å¸¸ï¼Œå®ƒå·²ç»è§£å†³äº†å†Javaä¸­è¢«è®¤ä¸ºæ˜¯è®¾è®¡å¤±è´¥çš„æ£€æŸ¥å‹å¼‚å¸¸ã€‚ 12345&lt;details&gt;&lt;summary&gt;&lt;strong&gt;Program Structure&lt;/strong&gt;&lt;/summary&gt;Note that it is possible to cascade one set of time windows after another, so long as the timeframes are compatible (the second set of windows needs to have a duration that is a multiple of the first set). So you can have a initial set of hour-long windows that is keyed by the `driverId` and use this to create a stream of `(endOfHourTimestamp, driverId, totalTips)`, and then follow this with another hour-long window (this window is not keyed) that finds the record from the first window with the maximum `totalTips`.&lt;/details&gt;","categories":[],"tags":[]},{"title":"Scalaå­¦ä¹ -ç¼–ç¨‹Tips-ç‰¹æ®Šç¬¦å·æ“ä½œç¬¦","slug":"Scalaå­¦ä¹ -ç¼–ç¨‹Tips-ç‰¹æ®Šç¬¦å·æ“ä½œç¬¦","date":"2021-04-12T06:07:30.000Z","updated":"2021-04-12T23:19:40.060Z","comments":true,"path":"post/Scalaå­¦ä¹ -ç¼–ç¨‹Tips-ç‰¹æ®Šç¬¦å·æ“ä½œç¬¦/","link":"","permalink":"https://shang.at/post/Scalaå­¦ä¹ -ç¼–ç¨‹Tips-ç‰¹æ®Šç¬¦å·æ“ä½œç¬¦/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š æ‘˜è¦ï¼šæœ¬æ–‡æ±‡æ€»åœ¨ scala ä¸­é‡åˆ°å„ç§ç¬¦å·æ“ä½œç¬¦ã€‚ æ¨¡å¼åŒ¹é…ä¸­ä½¿ç”¨ @è¿™ä¸ª @ çš„ä¸»è¦åŠŸèƒ½æ˜¯åœ¨æ¨¡å¼åŒ¹é…ä¸­ï¼ŒåŒ¹é…åˆ°ä¸€ä¸ªæ¨¡å¼åï¼Œä½†æ˜¯åœ¨å¤„ç†è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨å¯¹è±¡æœ¬èº«è€Œä¸æ˜¯åŒ¹é…åçš„å…ƒç´ ã€‚ æ¡ˆä¾‹1ï¼šåŒ¹é… Some()å‚è€ƒè¯¥ Overflow å›ç­” å½“æˆ‘ä»¬åŒ¹é…å¯¹è±¡æ˜¯å¦ä¸º Some(x) çš„æ—¶å€™ï¼Œå¦‚æœæ²¡æœ‰ @ é‚£ä¹ˆæœ€åæˆ‘ä»¬åœ¨åŒ¹é…ä¸­çš„å€¼å°†æ˜¯ Some(x) ä¸­çš„ xï¼Œ è€Œå¦‚æœåŠ å…¥ @ï¼Œé‚£ä¹ˆæœ€ååŒ¹é…çš„å°†ä¼šæ˜¯ Some(x) It enables one to bind a matched pattern to a variable. Consider the following, for instance: 1val o: Option[Int] = Some(2) You can easily extract the content: 1234o match &#123; case Some(x) =&gt; println(x) case None =&gt;&#125; But what if you wanted not the content of Some, but the option itself? That would be accomplished with this: 1234o match &#123; case x @ Some(_) =&gt; println(x) case None =&gt;&#125; Note that @ can be used at any level, not just at the top level of the matching. æ¡ˆä¾‹2ï¼šAPI åŒ¹é… Request123456789def intent = &#123; case req @ GET(Path(Seg(\"api\" :: \"user\" :: IntPathElement(userId) :: Nil))) =&gt; val f = (userManager ? FindUserById(userId)) respond(f, req) case req @ GET(Path(Seg(\"api\" :: \"user\" :: Nil))) &amp; Params(EmailParam(email)) =&gt; val f = (userManager ? FindUserByEmail(email)) respond(f, req) &#125; åœ¨å¤„ç† request è¯·æ±‚çš„æ—¶å€™ï¼Œéœ€è¦åŒ¹é…è¯·æ±‚çš„è·¯å¾„ï¼Œç„¶åè¿˜éœ€è¦ç›´æ¥ä½¿ç”¨ requetã€‚ ä¸‹åˆ’çº¿ _ çš„ä½¿ç”¨åœºæ™¯import é€šé…ç¬¦1import org.apache.spark.SparkContext._ é›†åˆæ“ä½œæŒ‡ä»£æ¯ä¸€ä¸ªå…ƒç´ åœ¨æ‰€æœ‰çš„é›†åˆæ“ä½œä¸­éƒ½å¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿æŒ‡ä»£é›†åˆå†…å®¹ã€‚å½“å‰çš„é›†åˆæ“ä½œåªæœ‰ä¸€ä¸ªå‚æ•°æ—¶ï¼Œå¯ä»¥ä½¿ç”¨_æ¥ä»£æ›¿ï¼Œä¸ç”¨éè¦èµ·ä¸€ä¸ªåˆ«å 123456object Sample &#123; def main (args: Array[String])&#123; val newArry= (1 to 10).map(_*2) println(newArry) &#125;&#125; åœ¨ä¸€ä¸ª Array aä¸­ç­›å‡ºå¶æ•°ï¼Œå¹¶ä¹˜ä»¥2 1a.filter(_%2==0).map(2*_) æ¨¡å¼åŒ¹é…ä½¿ç”¨ä¸»è¦ç”¨äºåŒ¹é…é€šé…çš„æƒ…å½¢ 123456789Some(5) match &#123; case Some(_) =&gt; println(\"Yes\") &#125;match &#123; case List(1,_,_) =&gt; \" a list with three element and the first element is 1\" case List(_*) =&gt; \" a list with zero or more elements \" case Map[_,_] =&gt; \" matches a map with any key type and any value type \" case _ =&gt; &#125;val (a, _) = (1, 2)for (_ &lt;- 1 to 10) å…¶ä»–æ¡ˆä¾‹ 12val m = Map(1 -&gt; 2,2 -&gt; 4)for ((k,_) &lt;- m) println(k) //å¦‚æœä¸éœ€è¦æ‰€æœ‰éƒ¨ä»¶ï¼Œ åˆ™åœ¨ä¸éœ€è¦çš„éƒ¨ä»¶ä½¿ç”¨_ï¼› æœ¬ä¾‹åªå–key,å› æ­¤åœ¨valueå¤„ç”¨_ å˜é‡åˆå§‹åŒ–ä¸º null123456object Sample &#123; var name:String=_ def main (args: Array[String])&#123; name=\"hello world\" println(name)&#125; åœ¨è¿™é‡Œï¼Œname ä¹Ÿå¯ä»¥å£°æ˜ä¸º nullï¼Œä¾‹ï¼švar name:String=nullã€‚è¿™é‡Œçš„ä¸‹åˆ’çº¿å’Œ null çš„ä½œç”¨æ˜¯ä¸€æ ·çš„ã€‚ :_* å‚æ•°åºåˆ—å¤„ç†:_* ä½œä¸ºä¸€ä¸ªæ•´ä½“ï¼Œå‘Šè¯‰ç¼–è¯‘å™¨ä½ å¸Œæœ›å°†æŸä¸ªå‚æ•°å½“ä½œå‚æ•°åºåˆ—å¤„ç†ï¼ ä¾‹å¦‚ï¼Œå½“å‡½æ•°æ¥æ”¶çš„å‚æ•°ä¸å®šé•¿çš„æ—¶å€™ï¼Œå‡å¦‚ä½ æƒ³è¾“å…¥ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªé˜Ÿåˆ—ååŠ å…¥â€œ:_*â€ï¼Œå› æ­¤ï¼Œè¿™é‡Œçš„â€œ1 to 5â€ä¹Ÿå¯ä»¥æ”¹å†™ä¸ºï¼šâ€œSeq(1,2,3,4,5)â€ã€‚ 1234567891011object Sample &#123; def main (args: Array[String])=&#123; val result=sum(1 to 5:_*) println(result) &#125; def sum(parms:Int*)=&#123; var result=0 for(parm &lt;- parms)result+=parm result &#125;&#125; å…ƒç»„è®¿é—®æˆå‘˜åœ¨å…ƒç»„ä¸­ï¼Œå¯ä»¥ç”¨æ–¹æ³•_1, _2, _3è®¿é—®ç»„å‘˜ã€‚å¦‚ a._2ã€‚å…¶ä¸­ç‚¹æ“ä½œç¬¦å¯ä»¥ç”¨ç©ºæ ¼æ›¿ä»£ï¼Œä¹Ÿå°±æ˜¯ a _2ã€‚ 1234567object Sample &#123; def main (args: Array[String])=&#123; val value=(1,2) println(value._1) println(value _2) &#125;&#125; åŒ¿åå‡½æ•° =&gt;è¿™ä¸ªæ¯”è¾ƒç®€å•ï¼Œå› ä¸º Java8 çš„ Lambda å·²ç»å¹¿æ³›ä½¿ç”¨ã€‚ =&gt; åŒ¿åå‡½æ•°ï¼ˆAnonymous Functionsï¼‰ï¼š è¡¨ç¤ºåˆ›å»ºä¸€ä¸ªå‡½æ•°å®ä¾‹ã€‚ æ¯”å¦‚ï¼š(x: Int) =&gt; x + 1 å’Œå¦‚ä¸‹JAVAæ–¹æ³•è¡¨ç¤ºçš„å«ä¹‰ä¸€æ ·ï¼š 123public int function(int x)&#123; return x+1;&#125; å¯ä»¥è¿™ä¹ˆç†è§£ï¼š =&gt;å·¦è¾¹ æ˜¯è¾“å…¥å‚æ•°ï¼Œ: åé¢ Int æ˜¯å‚æ•°ç±»å‹ =&gt;å³è¾¹ å½“ä½œå‡½æ•°ä½“, ç±»ä¼¼åŒ¿åå‡½æ•°çš„ {} æ¨¡å¼åŒ¹é…ä¸­é…åˆ case12345678val bools = Seq(true, false)for (bool &lt;- bools) &#123; bool match &#123; case true =&gt; println(\"Got heads\") case false =&gt; println(\"Got tails\") &#125;&#125; é›†åˆéå† &lt;-ç®€å•è¯´è¿™æ˜¯ä¸€ä¸ªé›†åˆéå†çš„æ–¹æ³•ï¼š 1234var list = Array(1,2,3,4)for (aa &lt;- list) &#123; printf(aa+\" \")&#125; ä½†æ˜¯åœ¨ for æ¨å¯¼å¼ä¸­ï¼Œè¿™ä¸ªç¬¦å·è¡¨ç¤ºç”Ÿæˆå™¨ï¼Œå…¶è§£é‡Šæ¯”å¾ªç¯æ›´åŠ å¤æ‚ï¼Œæ˜¯ä¸€ä¸ª scala çš„è¯­æ³•ç³–ï¼Œæœ€åä¼šè¢«è§£é‡Šä¸ºä¸€ç³»åˆ—çš„å®¹å™¨æ“ä½œï¼šmap å’Œ flatMap ç­‰ã€‚å‚è€ƒå¦ä¸€ç¯‡è¯¦ç»†ä»‹ç» Scala For æ¨å¯¼å¼çš„æ–‡ç« ã€‚ é›†åˆæ‹¼æ¥ ++= --= ç­‰æ“ä½œå‚è€ƒå®˜æ–¹é›†åˆ Set æ–‡æ¡£ ++= ç”¨äºæ‹¼æ¥å®¹å™¨ï¼Œè€Œ += ç”¨äºæ‹¼æ¥å…ƒç´ ã€‚ WHAT IT IS WHAT IT DOES åŠ æ³•ï¼š xs += x æŠŠå…ƒç´  x æ·»åŠ åˆ°é›†åˆ xs ä¸­ã€‚è¯¥æ“ä½œæœ‰å‰¯ä½œç”¨ï¼Œå®ƒä¼šè¿”å›å·¦æ“ä½œç¬¦ï¼Œè¿™é‡Œæ˜¯ xs è‡ªèº«ã€‚ xs += (x, y, z) æ·»åŠ æŒ‡å®šçš„å…ƒç´ åˆ°é›†åˆ xs ä¸­ï¼Œå¹¶è¿”å› xs æœ¬èº«ã€‚ï¼ˆåŒæ ·æœ‰å‰¯ä½œç”¨ï¼‰ xs ++= ys æ·»åŠ é›†åˆ ys ä¸­çš„æ‰€æœ‰å…ƒç´ åˆ°é›†åˆ xs ä¸­ï¼Œå¹¶è¿”å› xs æœ¬èº«ã€‚ï¼ˆè¡¨è¾¾å¼æœ‰å‰¯ä½œç”¨ï¼‰ xs add x æŠŠå…ƒç´  x æ·»åŠ åˆ°é›†åˆ xs ä¸­ï¼Œå¦‚é›†åˆ xs ä¹‹å‰æ²¡æœ‰åŒ…å« xï¼Œè¯¥æ“ä½œè¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚ ç§»é™¤ï¼š xs -= x ä»é›†åˆ xs ä¸­åˆ é™¤å…ƒç´  xï¼Œå¹¶è¿”å› xs æœ¬èº«ã€‚ï¼ˆè¡¨è¾¾å¼æœ‰å‰¯ä½œç”¨ï¼‰ xs -= (x, y, z) ä»é›†åˆ xs ä¸­åˆ é™¤æŒ‡å®šçš„å…ƒç´ ï¼Œå¹¶è¿”å› xs æœ¬èº«ã€‚ï¼ˆè¡¨è¾¾å¼æœ‰å‰¯ä½œç”¨ï¼‰ xs --= ys ä»é›†åˆ xs ä¸­åˆ é™¤æ‰€æœ‰å±äºé›†åˆ ys çš„å…ƒç´ ï¼Œå¹¶è¿”å› xs æœ¬èº«ã€‚ï¼ˆè¡¨è¾¾å¼æœ‰å‰¯ä½œç”¨ï¼‰ xs remove x ä»é›†åˆ xs ä¸­åˆ é™¤å…ƒç´  x ã€‚å¦‚ä¹‹å‰ xs ä¸­åŒ…å«äº† x å…ƒç´ ï¼Œè¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚ xs retain p åªä¿ç•™é›†åˆ xs ä¸­æ»¡è¶³æ¡ä»¶ p çš„å…ƒç´ ã€‚ xs.clear() åˆ é™¤é›†åˆ xs ä¸­çš„æ‰€æœ‰å…ƒç´ ã€‚ æ›´æ–°ï¼š xs(x) = b ï¼ˆ åŒ xs.update(x, b) ï¼‰å‚æ•° b ä¸ºå¸ƒå°”ç±»å‹ï¼Œå¦‚æœå€¼ä¸º true å°±æŠŠå…ƒç´ xåŠ å…¥é›†åˆ xsï¼Œå¦åˆ™ä»é›†åˆ xs ä¸­åˆ é™¤ xã€‚ å…‹éš†ï¼š xs.clone äº§ç”Ÿä¸€ä¸ªä¸ xs å…·æœ‰ç›¸åŒå…ƒç´ çš„å¯å˜é›†åˆã€‚ å†’å·æ“ä½œç¬¦:::è¿ç®—ç¬¦ä¸‰ä¸ªå†’å·è¡¨ç¤ºListçš„è¿æ¥æ“ä½œï¼Œæ¯”å¦‚ï¼š 123val a = List(1,2)val b = List(3,4)val c = a:::b //c=List(1,2,3,4) ::ä¸¤ä¸ªå†’å·ä¸¤ä¸ªå†’å·è¡¨ç¤ºæ™®é€šå…ƒç´ ä¸Listçš„è¿æ¥æ“ä½œï¼Œæ¯”å¦‚ï¼š 123val a=1 val b=List(66,88) val c = 1::b //c=List(1,66,88) å…ƒç»„æ“ä½œ -&gt;scalaä¸­å…ƒç»„å«ä¹‰ï¼š å…ƒç»„æ˜¯ä¸åŒç±»å‹çš„å€¼èšé›†çº¿ç¨‹çš„åˆ—è¡¨é€šè¿‡å°†å¤šä¸ªå€¼ä½¿ç”¨å°æ‹¬å·æ‹¬èµ·æ¥ï¼Œå³è¡¨ç¤ºå…ƒç»„ scalaä¸­å…ƒç»„ä¸æ•°ç»„åŒºåˆ« æ•°ç»„ä¸­å…ƒç´  æ•°æ®ç±»å‹å¿…é¡»ä¸€æ ·ï¼Œä½†æ˜¯å…ƒç»„æ•°æ®ç±»å‹å¯ä»¥ä¸åŒã€‚ 123456val first = (1,2,3) // å®šä¹‰ä¸‰å…ƒå…ƒç»„val one = 1val two = 2val three = one -&gt; twoprintln(three) // æ„é€ äºŒå…ƒå…ƒç»„println(three._2) // è®¿é—®äºŒå…ƒå…ƒç»„ä¸­ç¬¬äºŒä¸ªå€¼ ä¸Šä¸‹ç•Œçº¦æŸç¬¦ &lt;: ä¸ &gt;:è¿™å¯¹ç¬¦å·ä¸ªäººè§‰å¾—æ˜¯é‡Œé¢æœ€å¥½ç†è§£çš„äº†ï¼Œè¿™å¯¹ç¬¦å·ç”¨äºå†™èŒƒå‹ç±»/å‡½æ•°æ—¶çº¦æŸèŒƒå‹ç±»å‹ã€‚ 123456def using[A &lt;: Closeable, B](closeable: A) (getB: A =&gt; B): B = try &#123; getB(closeable) &#125; finally &#123; closeable.close() &#125; ä¾‹å­ä¸­ A &lt;: Closeable(java.io.Cloaseable) çš„æ„æ€å°±æ˜¯ä¿è¯ç±»å‹å‚æ•° A æ˜¯ Closeable çš„å­ç±»ï¼ˆå«æœ¬ç±»ï¼‰ã€‚è¯­æ³•â€œA &lt;: Bâ€œå®šä¹‰äº†Bä¸ºAçš„ä¸Šç•Œï¼›åŒç†ç›¸åçš„ A &gt;: B çš„æ„æ€å°±æ˜¯Aæ˜¯Bçš„è¶…ç±»ï¼ˆå«æœ¬ç±»ï¼‰ï¼Œå®šä¹‰äº†Bä¸ºAçš„ä¸‹ç•Œã€‚å…¶å® &lt;: å’Œ &gt;: å°±ç­‰ä»·äºjavaèŒƒå‹ç¼–ç¨‹ä¸­çš„ extendsï¼Œsuperã€‚ åå˜ä¸é€†å˜ç¬¦å·+Tï¼Œ -Tâ€œåå˜â€æ˜¯æŒ‡èƒ½å¤Ÿä½¿ç”¨ä¸åŸå§‹æŒ‡å®šçš„æ´¾ç”Ÿç±»å‹ç›¸æ¯”ï¼Œæ´¾ç”Ÿç¨‹åº¦æ›´å¤§çš„ç±»å‹ã€‚e.g. String =&gt; AnyRef â€œé€†å˜â€åˆ™æ˜¯æŒ‡èƒ½å¤Ÿä½¿ç”¨æ´¾ç”Ÿç¨‹åº¦æ›´å°çš„ç±»å‹ã€‚e.g. AnyRef =&gt; String ã€+Tã€‘è¡¨ç¤ºåå˜ï¼Œã€-Tã€‘è¡¨ç¤ºé€†å˜ å‚è€ƒ ã€ŠScala ç¨‹åºè®¾è®¡ç¬¬2ç‰ˆã€‹ 2.13 æŠ½è±¡ç±»å‹å’Œå‚æ•°åŒ–ç±»å‹ï¼š Scala æ”¯æŒå‚æ•°åŒ–ç±»å‹ï¼Œä¸ Java ä¸­çš„æ³›å‹ååˆ†ç±»ä¼¼ã€‚è¿™ä¸¤ä¸ªæœ¯è¯­ï¼Œä½† Scala ç¤¾åŒºä¸­å¤šä½¿ç”¨â€œå‚æ•°åŒ–ç±»å‹â€ï¼Œ Java ç¤¾åŒºä¸­å¸¸ç”¨æ³›å‹ä¸€è¯ã€‚ï¼‰åœ¨è¯­æ³•ä¸Šï¼Œ Java ä½¿ç”¨å°–æ‹¬å·ï¼ˆ &lt;â€¦ &gt;ï¼‰ï¼Œè€Œ Scala ä½¿ç”¨æ–¹æ‹¬å·ï¼ˆ [â€¦ ]ï¼‰ï¼Œå› ä¸ºåœ¨ Scala ä¸­ &lt; å’Œ &gt; å¸¸ç”¨ä½œæ–¹æ³•åã€‚ ä¾‹å¦‚ï¼Œå­—ç¬¦ä¸²åˆ—è¡¨å¯ä»¥å£°æ˜å¦‚ä¸‹ï¼š 1val strings: List[String] = List(\"one\", \"two\", \"three\") ç”±äºæˆ‘ä»¬å¯ä»¥åœ¨é›†åˆ List[A] ä¸­ä½¿ç”¨ä»»ä½•ç±»å‹ä½œä¸ºç±»å‹ Aï¼Œè¿™ç§ç‰¹æ€§è¢«ç§°ä¸ºå‚æ•°å¤šæ€ã€‚åœ¨æ–¹æ³• List çš„é€šç”¨å®ç°ä¸­ï¼Œå…è®¸ä½¿ç”¨ä»»ä½•ç±»å‹çš„å®ä¾‹ä½œä¸º List çš„å…ƒç´ ã€‚ A ä¹‹å‰çš„ + è¡¨ç¤ºï¼šå¦‚æœ B æ˜¯ A çš„å­ç±»ï¼Œåˆ™ List[B] ä¹Ÿæ˜¯ List[A] çš„å­ç±»å‹ï¼Œè¿™è¢«ç§°ä¸ºåç±»å‹ã€‚åç±»å‹å¾ˆç¬¦åˆç›´è§‰ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªå‡½æ•° f(list: List[Any])ï¼Œé‚£ä¹ˆä¼ é€’ List[String] ç»™è¿™ä¸ªå‡½æ•°ï¼Œä¹Ÿåº”è¯¥èƒ½æ­£å¸¸å·¥ä½œã€‚ å¦‚æœç±»å‹å‚æ•°å‰æœ‰ -ï¼Œåˆ™è¡¨ç¤ºå¦ä¸€ç§å…³ç³»ï¼šå¦‚æœ B æ˜¯ A çš„å­ç±»å‹ï¼Œä¸” Foo[A] è¢«å£°æ˜ä¸º Foo[-A]ï¼Œåˆ™ Foo[B] æ˜¯ Foo[A] çš„çˆ¶ç±»å‹ï¼ˆç§°ä¸ºé€†ç±»å‹ï¼‰ã€‚è¿™ä¸€æœºåˆ¶æ²¡é‚£ä¹ˆç¬¦åˆç›´è§‰ï¼Œæˆ‘ä»¬å°†åœ¨å‚æ•°åŒ–ç±»å‹ä¸­ä¸å‚æ•°åŒ–ç±»å‹çš„å…¶ä»–ç»†èŠ‚ä¸€èµ·è§£é‡Šè¿™ä¸€ç‚¹ã€‚ Scala è¿˜æ”¯æŒå¦ä¸€ç§è¢«ç§°ä¸ºâ€œæŠ½è±¡ç±»å‹â€çš„æŠ½è±¡æœºåˆ¶ï¼Œå®ƒå¯ä»¥è¿ç”¨åœ¨è®¸å¤šå‚æ•°åŒ–ç±»å‹ä¸­ï¼Œä¹Ÿèƒ½å¤Ÿè§£å†³è®¾è®¡ä¸Šçš„é—®é¢˜ã€‚ç„¶è€Œï¼Œå°½ç®¡ä¸¤ç§æœºåˆ¶æœ‰æ‰€é‡åˆï¼Œä½†å¹¶ä¸å†—ä½™ï¼Œä¸¤ç§æœºåˆ¶å¯¹ä¸åŒçš„è®¾è®¡é—®é¢˜å„æœ‰ä¼˜åŠ¿ä¸ä¸è¶³ã€‚ view bounds(è§†ç•Œ) ä¸ &lt;%&lt;%çš„æ„æ€æ˜¯â€œview boundsâ€(è§†ç•Œ)ï¼Œå®ƒæ¯”&lt;:é€‚ç”¨çš„èŒƒå›´æ›´å¹¿ï¼Œé™¤äº†æ‰€æœ‰çš„å­ç±»å‹ï¼Œè¿˜å…è®¸éšå¼è½¬æ¢è¿‡å»çš„ç±»å‹ 1def method [A &lt;% B](arglist): R = ... ç­‰ä»·äº 1def method [A](arglist)(implicit viewAB: A =&gt; B): R = ... è¡¨ç¤º A å¯ä»¥è§†ä¸ºç±»å‹ B æ¡ˆä¾‹2ï¼š è§†ç•Œï¼Œå°±åƒç±»å‹è¾¹ç•Œï¼Œè¦æ±‚å­˜åœ¨ä¸€ä¸ªèƒ½å¤Ÿå°†æŸç±»å‹è½¬æ¢ä¸ºæŒ‡å®šç±»å‹çš„å‡½æ•°ã€‚ä½ å¯ä»¥ä½¿ç”¨ &lt;% æŒ‡å®šç±»å‹é™åˆ¶ï¼Œä¾‹å¦‚ï¼š 12scala&gt; class Container[A &lt;% Int] &#123; def addIt(x: A) = 123 + x &#125;defined class Container è¿™æ˜¯è¯´ A å¿…é¡»â€œå¯è¢«è§†ä½œâ€ Int ã€‚è®©æˆ‘ä»¬è¯•è¯•ã€‚ 12345678910scala&gt; (new Container[String]).addIt(\"123\")res11: Int = 246scala&gt; (new Container[Int]).addIt(123) res12: Int = 246scala&gt; (new Container[Float]).addIt(123.2F)&lt;console&gt;:8: error: could not find implicit value for evidence parameter of type (Float) =&gt; Int (new Container[Float]).addIt(123.2) ^ &lt;% é™¤äº†æ–¹æ³•ä½¿ç”¨ä¹‹å¤–ï¼Œclasså£°æ˜ç±»å‹å‚æ•°æ—¶ä¹Ÿå¯ä½¿ç”¨ï¼š 12scala&gt; class A[T &lt;% Int]defined class A ä½†æ— æ³•å¯¹traitçš„ç±»å‹å‚æ•°ä½¿ç”¨ &lt;%ï¼Œ 12scala&gt; trait A[T &lt;% Int]&lt;console&gt;:1: error: traits cannot have type parameters with context bounds `: ...' nor view bounds `&lt;% ...' å¹¿ä¹‰ç±»å‹çº¦æŸç¬¦å· =:=, &lt;:&lt;, &lt;%&lt;æ–¹æ³•å¯ä»¥é€šè¿‡éšå¼å‚æ•°æ‰§è¡Œæ›´å¤æ‚çš„ç±»å‹é™åˆ¶ã€‚ä¾‹å¦‚ï¼ŒList æ”¯æŒå¯¹æ•°å­—å†…å®¹æ‰§è¡Œ sumï¼Œä½†å¯¹å…¶ä»–å†…å®¹å´ä¸è¡Œã€‚å¯æ˜¯ Scala çš„æ•°å­—ç±»å‹å¹¶ä¸éƒ½å…±äº«ä¸€ä¸ªè¶…ç±»ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨T &lt;: Numberã€‚ç›¸åï¼Œè¦ä½¿ä¹‹èƒ½å·¥ä½œï¼ŒScalaçš„mathåº“å¯¹é€‚å½“çš„ç±»å‹T å®šä¹‰äº†ä¸€ä¸ªéšå«çš„ Numeric[T]ã€‚ ç„¶ååœ¨ List å®šä¹‰ä¸­ä½¿ç”¨å®ƒï¼š 1sum[B &gt;: A](implicit num: Numeric[B]): B å¦‚æœä½ è°ƒç”¨ List(1,2).sum()ï¼Œä½ å¹¶ä¸éœ€è¦ä¼ å…¥ä¸€ä¸ª num å‚æ•°ï¼›å®ƒæ˜¯éšå¼è®¾ç½®çš„ã€‚ä½†å¦‚æœä½ è°ƒç”¨ List(&quot;whoop&quot;).sum()ï¼Œå®ƒä¼šæŠ±æ€¨æ— æ³•è®¾ç½® numã€‚ åœ¨æ²¡æœ‰è®¾å®šé™Œç”Ÿçš„å¯¹è±¡ä¸º Numeric çš„æ—¶å€™ï¼Œæ–¹æ³•å¯èƒ½ä¼šè¦æ±‚æŸç§ç‰¹å®šç±»å‹çš„â€œè¯æ®â€ã€‚è¿™æ—¶å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ç±»å‹-å…³ç³»è¿ç®—ç¬¦ï¼š A =:= B A å¿…é¡»å’Œ Bç›¸ç­‰A &lt;:&lt; B A å¿…é¡»æ˜¯ Bçš„å­ç±»A &lt;%&lt; B A å¿…é¡»å¯ä»¥è¢«çœ‹åšæ˜¯ B ï¼ˆå¦‚æœä½ åœ¨å°è¯•ä½¿ç”¨ &lt;:&lt; æˆ–è€… &lt;%&lt; çš„æ—¶å€™å‡ºé”™äº†ï¼Œé‚£è¯·æ³¨æ„è¿™äº›ç¬¦å·åœ¨ Scala 2.10 ä¸­è¢«ç§»é™¤äº†ã€‚Scala School é‡Œçš„ä¾‹å­ä»…èƒ½åœ¨ Scala 2.9.x ä¸‹æ­£å¸¸å·¥ä½œã€‚ä½ å¯ä»¥ä½¿ç”¨æ–°ç‰ˆæœ¬çš„ Scalaï¼Œä½†å¯èƒ½ä¼šé‡åˆ°é”™è¯¯ã€‚ï¼‰ 123456789101112131415scala&gt; class Container[A](value: A) &#123; def addIt(implicit evidence: A =:= Int) = 123 + value &#125;defined class Containerscala&gt; (new Container(123)).addItres11: Int = 246scala&gt; (new Container(\"123\")).addIt&lt;console&gt;:10: error: could not find implicit value for parameter evidence: =:=[java.lang.String,Int]// ç±»ä¼¼åœ°ï¼Œæ ¹æ®ä¹‹å‰çš„éšå¼è½¬æ¢ï¼Œæˆ‘ä»¬å¯ä»¥å°†çº¦æŸæ”¾æ¾ä¸ºå¯è§†æ€§ï¼šscala&gt; class Container[A](value: A) &#123; def addIt(implicit evidence: A &lt;%&lt; Int) = 123 + value &#125;defined class Containerscala&gt; (new Container(\"123\")).addItres15: Int = 246 å­—ç¬¦ä¸²æ’å€¼ s&quot;$c&quot;å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼šå­—ç¬¦ä¸²æ’å€¼ s å­—ç¬¦ä¸²æ’å€¼å™¨1234val name=\"James\"println(s\"Hello,$name\") //Hello,James æ­¤ä¾‹ä¸­ï¼Œ$nameåµŒå¥—åœ¨ä¸€ä¸ªå°†è¢«så­—ç¬¦ä¸²æ’å€¼å™¨å¤„ç†çš„å­—ç¬¦ä¸²ä¸­ã€‚æ’å€¼å™¨çŸ¥é“åœ¨è¿™ä¸ªå­—ç¬¦ä¸²çš„è¿™ä¸ªåœ°æ–¹åº”è¯¥æ’å…¥è¿™ä¸ªnameå˜é‡çš„å€¼ï¼Œä»¥ä½¿è¾“å‡ºå­—ç¬¦ä¸²ä¸ºHello,Jamesã€‚ä½¿ç”¨sæ’å€¼å™¨ï¼Œåœ¨è¿™ä¸ªå­—ç¬¦ä¸²ä¸­å¯ä»¥ä½¿ç”¨ä»»ä½•åœ¨å¤„ç†èŒƒå›´å†…çš„åå­—ã€‚ println(s\"1+1=$&#123;1+1&#125;\") //å°†ä¼šè¾“å‡ºå­—ç¬¦ä¸²1+1=2ã€‚ä»»ä½•è¡¨è¾¾å¼éƒ½å¯ä»¥åµŒå…¥åˆ°$&#123;&#125;ä¸­ã€‚ f æ’å€¼å™¨åœ¨ä»»ä½•å­—ç¬¦ä¸²å­—é¢å‰åŠ ä¸Š fï¼Œå°±å¯ä»¥ç”Ÿæˆç®€å•çš„æ ¼å¼åŒ–ä¸²ï¼ŒåŠŸèƒ½ç›¸ä¼¼äºå…¶ä»–è¯­è¨€ä¸­çš„ printf å‡½æ•°ã€‚å½“ä½¿ç”¨ f æ’å€¼å™¨çš„æ—¶å€™ï¼Œæ‰€æœ‰çš„å˜é‡å¼•ç”¨éƒ½åº”å½“åè·Ÿä¸€ä¸ªprintf-styleæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œå¦‚%dã€‚çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š 123456789101112val height=1.9dval name=\"James\"println(f\"$name%s is $height%2.2f meters tall\")//James is 1.90 meters tall f æ’å€¼å™¨æ˜¯ç±»å‹å®‰å…¨çš„ã€‚å¦‚æœè¯•å›¾å‘åªæ”¯æŒ int çš„æ ¼å¼åŒ–ä¸²ä¼ å…¥ä¸€ä¸ªdouble å€¼ï¼Œç¼–è¯‘å™¨åˆ™ä¼šæŠ¥é”™ã€‚ä¾‹å¦‚ï¼šval height:Double=1.9dscala&gt;f\"$height%4d\"&lt;console&gt;:9: error: type mismatch; found : Double required: Int f\"$height%4d\" ^ f æ’å€¼å™¨åˆ©ç”¨äº†javaä¸­çš„å­—ç¬¦ä¸²æ•°æ®æ ¼å¼ã€‚è¿™ç§ä»¥%å¼€å¤´çš„æ ¼å¼åœ¨ raw æ’å€¼å™¨é™¤äº†å¯¹å­—é¢å€¼ä¸­çš„å­—ç¬¦ä¸åšç¼–ç å¤–ï¼Œraw æ’å€¼å™¨ä¸ s æ’å€¼å™¨åœ¨åŠŸèƒ½ä¸Šæ˜¯ç›¸åŒçš„ã€‚å¦‚ä¸‹æ˜¯ä¸ªè¢«å¤„ç†è¿‡çš„å­—ç¬¦ä¸²ï¼š 123456789scala&gt;s\"a\\nb\"res0:String=ab // è¿™é‡Œï¼Œs æ’å€¼å™¨ç”¨å›è½¦ä»£æ›¿äº†\\nã€‚è€Œrawæ’å€¼å™¨å´ä¸ä¼šå¦‚æ­¤å¤„ç†ã€‚scala&gt;raw\"a\\nb\"res1:String=a\\nb // å½“ä¸æƒ³è¾“å…¥\\nè¢«è½¬æ¢ä¸ºå›è½¦çš„æ—¶å€™ï¼Œraw æ’å€¼å™¨æ˜¯éå¸¸å®ç”¨çš„ã€‚ Akka ç›¸å…³ç‰¹æ®Šå­—ç¬¦send !12345case ArticleBody(uri, body) =&gt; //If we get the parsed article back, then we've just parsed it cacheActor ! SetRequest(uri, body) //Cache it as we just parsed it senderRef ! body context.stop(self) ask ?1val future = pongActor ? \"unknown\" å‚è€ƒæ–‡ç« æµ…è°ˆ Scala ä¸­ä¸‹åˆ’çº¿çš„ç”¨é€” Scalaä¸­çš„ä¸‹åˆ’çº¿åˆ°åº•æœ‰å¤šå°‘ç§åº”ç”¨åœºæ™¯ ç»†æ•°Scalaä¸‹åˆ’çº¿â€œ_â€çš„ç”¨æ³• scalaä¸­å¸¸ç”¨ç‰¹æ®Šç¬¦å· ã€Scalaä¸€ã€‘Scalaå„ç§ç¬¦å·çš„å«ä¹‰ Scalaå„ç§å¸¸è§çš„ç¬¦å·å°ç»“ Scalaä¸­ç¬¦å·è¯­æ³•ç³– scalaä¸€äº›ç¬¦å·å«ä¹‰æ€»ç»“","categories":[],"tags":[]},{"title":"Scalaå­¦ä¹ -0-4-ä¼´ç”Ÿå¯¹è±¡","slug":"Scalaå­¦ä¹ -0-4-ä¼´ç”Ÿå¯¹è±¡","date":"2021-04-12T02:19:06.000Z","updated":"2021-04-12T03:54:07.123Z","comments":true,"path":"post/Scalaå­¦ä¹ -0-4-ä¼´ç”Ÿå¯¹è±¡/","link":"","permalink":"https://shang.at/post/Scalaå­¦ä¹ -0-4-ä¼´ç”Ÿå¯¹è±¡/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š class Cå®šä¹‰äº†ä¸€ä¸ªç±»ï¼Œå°±å’Œjavaå’ŒC++ä¸­ä¸€æ ·ã€‚A class is a definition, a description. It defines a type in terms of methods and composition of other types. object Oåˆ›å»ºäº†ä¸€ä¸ªå•ä¾‹(singleton)å¯¹è±¡Oï¼Œå®ƒæ˜¯ä¸€ä¸ªåŒ¿åç±»çš„å®ä¾‹å¯¹è±¡ï¼›å¯ä»¥ç”¨objectæ¥æ‰¿è½½é™æ€å˜é‡å’Œé™æ€æ–¹æ³•ã€‚é™æ€æ–¹æ³•å’Œé™æ€å˜é‡æ˜¯æŒ‡é‚£äº›ä¸ä»»ä½•ç±»éƒ½æ²¡æœ‰å…³è”çš„æ–¹æ³•å’Œå‚æ•°ï¼Œä»–ä»¬ä¸éœ€è¦ä¾èµ–ç±»çš„åˆå§‹åŒ–å¯ä»¥å®Œå…¨ç‹¬ç«‹å­˜åœ¨ An object is a singleton â€” an instance of a class which is guaranteed to be unique. For every object in the code, an anonymous class is created, which inherits from whatever classes you declared object to implement. This class cannot be seen from Scala source code â€” though you can get at it through reflection. object O extends Tçš„å†™æ³•æ˜¯åˆ›å»ºäº†ä¸€ä¸ªtrait Tçš„ä¸€ä¸ªå®ä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä»»ä½•éœ€è¦ä¼ å…¥Tçš„åœ°æ–¹ä¼ å…¥O å¦‚æœæœ‰ä¸€ä¸ªclass Cï¼Œé‚£ä¹ˆobject Cå°±æ˜¯class Cçš„ä¼´ç”Ÿå¯¹è±¡(companion object)ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ä¼´ç”Ÿå¯¹è±¡å¹¶ä¸æ˜¯class Cçš„ä¸€ä¸ªå®ä¾‹ Also see Scala documentation for object and class. objectä½œä¸ºé™æ€æˆå‘˜çš„å®¿ä¸»é€šå¸¸ï¼Œä½ å¯èƒ½éœ€è¦ä¸€ä¸ªåŒ…å«é™æ€æˆå‘˜çš„objectï¼Œä»¥ä¾¿ä½ å¯ä»¥ä¸ç”¨åˆå§‹åŒ–å¯¹è±¡å®ä¾‹å°±å¯ä»¥ç›´æ¥è®¿é—®è¿™äº›æˆå‘˜ï¼Œè¿™å’Œjavaä¸­staticæ–¹æ³•ç±»ä¼¼ã€‚æ¯”å¦‚ 123object A &#123; def twice(i: Int): Int = 2*i&#125; ä½ å¯ä»¥ç›´æ¥é€šè¿‡A.twice(2)å»è°ƒç”¨è¯¥æ–¹æ³• å¦‚æœtwiceè¢«å£°æ˜åœ¨classé‡Œé¢ï¼Œé‚£ä¹ˆä½ éœ€è¦å…ˆåˆå§‹åŒ–ç±»å®ä¾‹ 123456class A() &#123; def twice(i: Int): Int = 2 * i&#125;val a = new A()a.twice(2) å¯ä»¥çœ‹å‡ºï¼Œåˆå§‹åŒ–Aå®ä¾‹å®Œå…¨æ˜¯æ²¡æœ‰å¿…è¦çš„ï¼Œå› ä¸ºtwiceä¸éœ€è¦ä»»ä½•ä¾èµ–äºç±»å®ä¾‹çš„æ•°æ® objectä½œä¸ºç‰¹æ®Šçš„å‘½åå®ä¾‹ä½ ä¹Ÿå¯ä»¥å°†objectçœ‹åšæ˜¯æŸäº›ç‰¹æ®Šçš„classæˆ–è€…traitçš„å®ä¾‹å¯¹è±¡ã€‚è¿™ä¸ªæ—¶å€™ä½ çš„objectéœ€è¦æ‰©å±•æŸäº›traitä»¥æˆä¸ºå…¶å­ç±»çš„å®ä¾‹ã€‚ 123object A extends B with C &#123; ...&#125; è¿™ä¸ªå£°æ˜é¦–å…ˆå£°æ˜äº†ä¸€ä¸ªæ‹“å±•äº†Bå’ŒCçš„åŒ¿å(ä¸å¯è®¿é—®)ç±»ï¼Œå¹¶å®ä¾‹åŒ–åä¸ºAçš„æ­¤ç±»çš„å•ä¸ªå®ä¾‹ è¿™æ„å‘³ç€å¯ä»¥å°†Aä¼ é€’ç»™æœŸæœ›å¯¹è±¡ç±»å‹ä¸ºBæˆ–Cæˆ–B with Cå‡½æ•°ã€‚ objecté¢å¤–çš„ç‰¹å¾å®˜æ–¹æ–‡æ¡£ï¼šofficial documentation ä¼´ç”Ÿå¯¹è±¡ä¸­å¯ä»¥æä¾›ä¸€ä¸ªå·¥å‚æ–¹æ³•æ¥åˆ›å»ºå¯¹åº”çš„classå®ä¾‹ 12345678910class Email(val username: String, val domainName: String)object Email &#123; def fromString(emailString: String): Option[Email] = &#123; emailString.split('@') match &#123; case Array(a, b) =&gt; Some(new Email(a, b)) case _ =&gt; None &#125; &#125;&#125; def apply(...)ï¼šå¦‚æœclass Açš„ä¼´ç”Ÿå¯¹è±¡object Aå®šä¹‰äº†applyæ–¹æ³•ï¼Œé‚£ä¹ˆåˆ›å»ºAå®ä¾‹çš„æ—¶å€™å¯ä»¥ç›´æ¥è¿™ä¹ˆå†™A(...)ï¼Œå³çœç•¥å…³é”®å­—new apply æ–¹æ³•å°±åƒä¸€ä¸ªæ„é€ å™¨ï¼Œæ¥å—å‚æ•°ç„¶ååˆ›å»ºä¸€ä¸ªå®ä¾‹å¯¹è±¡ def unapply(...)å…è®¸åˆ›å»ºè‡ªå®šä¹‰æ¨¡å¼åŒ¹é…æå–å™¨(extractors) unapply æ–¹æ³•æ¥å—ä¸€ä¸ªå®ä¾‹å¯¹è±¡ç„¶åè¿”å›æœ€åˆåˆ›å»ºå®ƒæ‰€ç”¨çš„å‚æ•° 12345678910111213141516171819import scala.util.Randomobject CustomerID &#123; // ç‰¹åˆ«æ³¨æ„è¿™é‡Œï¼šapplyæ–¹æ³•è¿”å›æ˜¯ä¸€ä¸ªStringç±»å‹çš„å¯¹è±¡ def apply(name: String) = s\"$name--$&#123;Random.nextLong&#125;\" // æ‰€ä»¥è¿™é‡Œunapplyæ–¹æ³•æ¥æ”¶çš„æ˜¯ä¸€ä¸ªStringç±»å‹çš„å¯¹è±¡ def unapply(customerID: String): Option[String] = &#123; val stringArray: Array[String] = customerID.split(\"--\") if (stringArray.tail.nonEmpty) Some(stringArray.head) else None &#125;&#125;val customer1ID = CustomerID(\"Sukyoung\") // ç­‰ä»·äºCustomerID.apply(\"Sukyoung\")customer1ID match &#123; case CustomerID(name) =&gt; println(name) // ç­‰ä»·äºCustomerID.unapply(customer2ID) case _ =&gt; println(\"Could not extract a CustomerID\")&#125; 1234val customer2ID = CustomerID(\"Nico\")// ç­‰ä»·äº val name = CustomerID.unapply(customer2ID).getval CustomerID(name) = customer2ID println(name) // prints Nico unapply æ–¹æ³•çš„è¿”å›å€¼åº”å½“ç¬¦åˆä¸‹é¢çš„æŸä¸€æ¡ï¼š å¦‚æœåªæ˜¯ç”¨æ¥åˆ¤æ–­çœŸå‡ï¼Œå¯ä»¥è¿”å›ä¸€ä¸ª Boolean ç±»å‹çš„å€¼ã€‚ä¾‹å¦‚ case even()ã€‚ å¦‚æœåªæ˜¯ç”¨æ¥æå–å•ä¸ª T ç±»å‹çš„å€¼ï¼Œå¯ä»¥è¿”å› Option[T]ã€‚ å¦‚æœä½ æƒ³è¦æå–å¤šä¸ªå€¼ï¼Œç±»å‹åˆ†åˆ«ä¸º T1,...,Tnï¼Œå¯ä»¥æŠŠå®ƒä»¬æ”¾åœ¨ä¸€ä¸ªå¯é€‰çš„å…ƒç»„ä¸­ Option[(T1,...,Tn)]ã€‚ æœ‰æ—¶ï¼Œè¦æå–çš„å€¼çš„æ•°é‡ä¸æ˜¯å›ºå®šçš„ï¼Œå› æ­¤æˆ‘ä»¬æƒ³æ ¹æ®è¾“å…¥æ¥è¿”å›éšæœºæ•°é‡çš„å€¼ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ç”¨ unapplySeq æ–¹æ³•æ¥å®šä¹‰æå–å™¨ï¼Œæ­¤æ–¹æ³•è¿”å› Option[Seq[T]]ã€‚å¸¸è§çš„ä¾‹å­æœ‰ï¼Œç”¨ case List(x, y, z) =&gt; æ¥è§£æ„ä¸€ä¸ªåˆ—è¡¨ Listï¼Œä»¥åŠç”¨ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ Regex æ¥åˆ†è§£ä¸€ä¸ªå­—ç¬¦ä¸² Stringï¼Œä¾‹å¦‚ case r(name, remainingFields @ _*) =&gt;ã€‚ å¦‚æœä½œä¸ºä¸€ä¸ªclass Cçš„ä¼´ç”Ÿå¯¹è±¡å­˜åœ¨ï¼Œé‚£ä¹ˆobjectåœ¨è§£æéšå¼å‚æ•°(implicit parameters)æ—¶å°†ä¼šæ‰®æ¼”ç‰¹æ®Šçš„è§’è‰²ã€‚scalaåœ¨æœç´¢éšå¼è½¬æ¢æ—¶æœ‰ä¸€ä¸ªæœç´¢çš„scopeï¼Œä¸Cæœ‰å…³çš„æ‰€æœ‰ç±»å‹çš„ä¼´ç”Ÿå¯¹è±¡éƒ½åœ¨æœç´¢çš„èŒƒå›´å†…ã€‚","categories":[],"tags":[]},{"title":"æœºå™¨å­¦ä¹ -ç‰¹å¾å·¥ç¨‹ä¸ç›¸å…³æ€§åˆ†æ","slug":"æœºå™¨å­¦ä¹ -ç‰¹å¾å·¥ç¨‹ä¸ç›¸å…³æ€§åˆ†æ","date":"2021-02-28T02:37:26.000Z","updated":"2021-02-28T02:38:26.144Z","comments":true,"path":"post/æœºå™¨å­¦ä¹ -ç‰¹å¾å·¥ç¨‹ä¸ç›¸å…³æ€§åˆ†æ/","link":"","permalink":"https://shang.at/post/æœºå™¨å­¦ä¹ -ç‰¹å¾å·¥ç¨‹ä¸ç›¸å…³æ€§åˆ†æ/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š","categories":[{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"https://shang.at/categories/æœºå™¨å­¦ä¹ /"}],"tags":[{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"https://shang.at/tags/æœºå™¨å­¦ä¹ /"}]},{"title":"æœºå™¨å­¦ä¹ -æ•°æ®æ¢ç´¢æµç¨‹","slug":"æœºå™¨å­¦ä¹ -æ•°æ®æ¢ç´¢æµç¨‹","date":"2021-02-27T08:02:38.000Z","updated":"2021-02-27T08:06:13.658Z","comments":true,"path":"post/æœºå™¨å­¦ä¹ -æ•°æ®æ¢ç´¢æµç¨‹/","link":"","permalink":"https://shang.at/post/æœºå™¨å­¦ä¹ -æ•°æ®æ¢ç´¢æµç¨‹/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š","categories":[{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"https://shang.at/categories/æœºå™¨å­¦ä¹ /"}],"tags":[{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"https://shang.at/tags/æœºå™¨å­¦ä¹ /"}]},{"title":"Sparkå­¦ä¹ -jsonæ•°æ®æ“ä½œ","slug":"Sparkå­¦ä¹ -jsonæ•°æ®æ“ä½œ","date":"2021-02-07T07:03:49.000Z","updated":"2021-02-07T08:18:11.048Z","comments":true,"path":"post/Sparkå­¦ä¹ -jsonæ•°æ®æ“ä½œ/","link":"","permalink":"https://shang.at/post/Sparkå­¦ä¹ -jsonæ•°æ®æ“ä½œ/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š æœ‰ä»¥ä¸‹çš„json 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869&#123; \"status\": \"0x0000\", \"msg\": \"æ‰§è¡ŒæˆåŠŸ\", \"result\": \"é€šè¿‡\", \"score\": \"0\", \"engineName\": \"credit_unit_salim\", \"versionCode\": \"20200702credit_salim\", \"versionId\": 356307673651200, \"engineId\": 355251417716736, \"outputFields\": [ &#123; \"code\": \"return_reason\", \"name\": \"è¾“å‡ºæ‰“å›åŸå› \", \"value\": \"null\" &#125;, &#123; \"code\": \"deny_days\", \"name\": \"è¾“å‡ºæ‹’ç»å¤©æ•°\", \"value\": \"0\" &#125;, &#123; \"code\": \"deny_reason\", \"name\": \"è¾“å‡ºæ‹’ç»åŸå› \", \"value\": \"null\" &#125;, &#123; \"code\": \"decision\", \"name\": \"è¾“å‡ºå†³ç­–\", \"value\": \"forward_manual\" &#125;, &#123; \"code\": \"limit\", \"name\": \"è¾“å‡ºæˆä¿¡é¢åº¦\", \"value\": \"0\" &#125;, &#123; \"code\": \"cash_limit\", \"name\": \"ç°é‡‘è´·æ¬¾é¢åº¦\", \"value\": \"0\" &#125; ], \"inputFields\": [ &#123; \"indo_id_check\": \"DEDY DWI SETYAWAN\", \"indo_identical_accuracy_ktp\": \"-2.0\", \"indo_mobile_number_approving\": \"1\", \"indo_name_diff_id_check\": \"0\", \"indo_name_diff_ocr\": \"1\", \"indo_nik_approving\": \"1\", \"indo_nik_diff_employee_nik\": \"0\", \"indo_nik_diff_ocr\": \"1\", \"indo_ocr_name\": \"DEDY DWI SEVYAWAN\", \"indo_ocr_nik\": \"3525051812850002\", \"indo_reject_his_nik\": \"0\", \"indo_reject_his_tel\": \"0\", \"åŒä¸€ä¸ªç”³è¯·ä¸‹returnæ¬¡æ•°\": \"0\" &#125; ], \"outputFieldInfo\": [ &#123; \"è¾“å‡ºæ‰“å›åŸå› \": \"null\", \"è¾“å‡ºæ‹’ç»å¤©æ•°\": \"0\", \"è¾“å‡ºæ‹’ç»åŸå› \": \"null\", \"è¾“å‡ºå†³ç­–\": \"forward_manual\", \"è¾“å‡ºæˆä¿¡é¢åº¦\": \"0\", \"ç°é‡‘è´·æ¬¾é¢åº¦\": \"0\" &#125; ]&#125; sqlç‰ˆæœ¬å–jsonä¸­çš„arrayï¼Œarrayçš„æ¯ä¸ªå…ƒç´ ä½œä¸ºä¸€ä¸ªmapç»“æ„12345678910111213spark.sql(\"\"\"select from_json(data, 'array&lt;map&lt;string,string&gt;&gt;') rfrom ( select json_tuple(json, 'inputFields') data) t\"\"\").printSchema()root |-- r: array (nullable = true) | |-- element: map (containsNull = true) | | |-- key: string | | |-- value: string (valueContainsNull = true) array&lt;map&lt;string,string&gt;&gt;è¿™ä¸ªæ˜¯å¦‚ä½•å¾—æ¥çš„å‘¢ï¼Ÿæ˜¯è¿™æ ·çš„ï¼Œå¯ä»¥ä½¿ç”¨schema_of_jsonå‡½æ•°æ¥è·å–ä¸€ä¸ªjsonçš„ç»“æ„æ˜¯æ€æ ·çš„ã€‚ 12345spark.sql(\"\"\"select schema_of_json(json)\"\"\").toPandas()#array&lt;struct&lt;indo_id_check:string,indo_identical_accuracy_ktp:string,indo_mobile_number_approving:string,indo_name_diff_id_check:string,indo_name_diff_ocr:string,indo_nik_approving:string,indo_nik_diff_employee_nik:string,indo_nik_diff_ocr:string,indo_ocr_name:string,indo_ocr_nik:string,indo_reject_his_nik:string,indo_reject_his_tel:string,åŒä¸€ä¸ªç”³è¯·ä¸‹returnæ¬¡æ•°:string&gt;&gt; ä½†æ˜¯é€šè¿‡ä¸Šè¿°æ–¹å¼å¾—åˆ°çš„ç»“æœä¸èƒ½ç›´æ¥æ‹¿æ¥ç”¨ï¼Œéœ€è¦åšä¸€äº›å˜å½¢ï¼šå¦‚æœarrayçš„æ¯ä¸ªå…ƒç´ çš„å­—æ®µéƒ½æ˜¯å›ºå®šçš„ï¼Œé‚£ä¹ˆå¯ä»¥å°†arrayçš„å…ƒç´ å®šä¹‰ä¸ºä¸€ä¸ªstructï¼Œä½†æ˜¯æˆ‘ä»¬çš„éœ€æ±‚ä¸­çš„æ•°æ®ï¼Œarrayçš„æ¯ä¸ªå…ƒç´ çš„å­—æ®µæ˜¯ä¸å›ºå®šçš„ï¼Œä¸”æˆ‘ä»¬æ²¡æœ‰å°†å…¶å­—æ®µéƒ½ç©·ä¸¾å‡ºæ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±æŠŠå®ƒå®šä¹‰ä¸ºä¸€ä¸ªmapç±»å‹çš„ï¼Œåç»­å°†å®ƒä½¿ç”¨explode_outerå±•å¼€å†è¿›è¡Œå¤„ç†ã€‚é€šè¿‡æŸ¥è¯¢sparkçš„apiï¼Œå¯ä»¥çŸ¥é“MapTypeçš„æ„é€ æ–¹æ³•éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«ä¸ºkeyçš„Typeå’Œvalueçš„Typeï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨æœ€é€šç”¨çš„Stringç±»å‹ä»£æ›¿äº† pyspark1234567891011from pyspark.sql.functions import *from pyspark.sql.types import *schema = ArrayType(MapType(StringType(), StringType()))spark.sql(\"\"\"select json_tuple(json, 'inputFields') items\"\"\").withColumn( 'items', from_json('items', schema)).toPandas() 123456789101112131415161718192021222324252627282930313233343536373839spark.sql(\"\"\"select json_tuple(json, 'inputFields') items-- from atome_id_mysql_snapshot_ruleengine.t_result_catalog limit 1\"\"\").withColumn( 'items', from_json('items', schema)).withColumn( 'item', explode('items')).withColumn( 'keys', map_keys('item')).withColumn( 'values', map_values('item')).withColumn( 'k_v', arrays_zip('keys', 'values')).withColumn( 'kv', explode_outer('k_v')).printSchema()root |-- items: array (nullable = true) | |-- element: map (containsNull = true) | | |-- key: string | | |-- value: string (valueContainsNull = true) |-- item: map (nullable = true) | |-- key: string | |-- value: string (valueContainsNull = true) |-- keys: array (nullable = true) | |-- element: string (containsNull = true) |-- values: array (nullable = true) | |-- element: string (containsNull = true) |-- k_v: array (nullable = true) | |-- element: struct (containsNull = false) | | |-- keys: string (nullable = true) | | |-- values: string (nullable = true) |-- kv: struct (nullable = true) | |-- keys: string (nullable = true) | |-- values: string (nullable = true) 123456789101112131415df = spark.sql(\"\"\"select json_tuple(json, 'inputFields') items\"\"\").withColumn( 'items', from_json('items', schema)).withColumn( 'item', explode('items'))# df.printSchema()# df.select(expr(\"posexplode(d)\")).printSchemadf.select(expr('explode(item)')).toPandas() # å°†map å±•å¼€ posexplodeä¼šå¤šä¸€ä¸ªposçš„å­—æ®µ key value 0 indo_id_check DEDY DWI SETYAWAN 1 indo_identical_accuracy_ktp -2.0 2 indo_mobile_number_approving 1 3 indo_name_diff_id_check 0 4 indo_name_diff_ocr 1 5 indo_nik_approving 1 6 indo_nik_diff_employee_nik 0 7 indo_nik_diff_ocr 1 8 indo_ocr_name DEDY DWI SEVYAWAN 9 indo_ocr_nik 3525051812850002 10 indo_reject_his_nik 0 11 indo_reject_his_tel 0 12 åŒä¸€ä¸ªç”³è¯·ä¸‹returnæ¬¡æ•° 0 Spark SQLé›†åˆæ•°æ®ç±»å‹array\\mapçš„å–å€¼æ–¹å¼","categories":[{"name":"Sparkå­¦ä¹ ","slug":"Sparkå­¦ä¹ ","permalink":"https://shang.at/categories/Sparkå­¦ä¹ /"}],"tags":[{"name":"jsonæ•°æ®æ“ä½œ","slug":"jsonæ•°æ®æ“ä½œ","permalink":"https://shang.at/tags/jsonæ•°æ®æ“ä½œ/"}]},{"title":"æ“ä½œç³»ç»Ÿ","slug":"æ“ä½œç³»ç»Ÿ","date":"2021-02-01T02:21:35.000Z","updated":"2021-02-01T03:00:38.252Z","comments":true,"path":"post/æ“ä½œç³»ç»Ÿ/","link":"","permalink":"https://shang.at/post/æ“ä½œç³»ç»Ÿ/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š æ±‡ç¼–è¯­è¨€æ±‡ç¼–è¯­è¨€çš„æœ¬è´¨ï¼šæœºå™¨è¯­è¨€çš„åŠ©è®°ç¬¦ï¼Œå®ƒå°±æ˜¯æœºå™¨è¯­è¨€ æ±‡ç¼–çš„æ‰§è¡Œè¿‡ç¨‹ï¼š è®¡ç®—æœºé€šç”µ-ã€‹CPUè¯»å–å†…å­˜ä¸­å›ºå®šä½ç½®çš„ç¨‹åºï¼ˆç”µä¿¡å·è¾“å…¥ï¼‰-ã€‹æ—¶é’Ÿå‘ç”Ÿå™¨ä¸æ–­éœ‡è¡é€šæ–­ç”µ-ã€‹æ¨åŠ¨CPUå†…éƒ¨ä¸€æ­¥ä¸€æ­¥æ‰§è¡Œï¼ˆæ‰§è¡Œå¤šå°‘æ­¥å–å†³äºæŒ‡ä»¤éœ€è¦çš„æ—¶é’Ÿå‘¨æœŸï¼‰-ã€‹è®¡ç®—å®Œæˆ-ã€‹å†™å›ï¼ˆç”µä¿¡å·ï¼‰-ã€‹å†™ç»™æ˜¾å¡è¾“å‡ºï¼ˆsoutï¼Œæˆ–è€…å›¾å½¢ï¼‰ è®¡ç®—æœºçš„ç»„æˆå†¯è¯ºä¾æ›¼ä½“ç³»ç»“æ„ï¼šè®¡ç®—å™¨ï¼Œæ§åˆ¶å™¨ï¼Œä¸»å­˜å‚¨å™¨ï¼Œè¾“å…¥è®¾å¤‡ï¼Œè¾“å‡ºè®¾å¤‡ è®¡ç®—æœºæœ‰ä¸€ä¸ªä¸»æ¿ï¼Œå®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªé›†æˆç”µè·¯æ¿ï¼Œä¸Šé¢æœ‰å¾ˆå¤šæ’æ§½ï¼ŒCPUã€å†…å­˜ã€ç£ç›˜æ§åˆ¶å™¨ã€ç£ç›˜ã€æ˜¾å¡ã€ç½‘å¡é©±åŠ¨éƒ½å¯ä»¥æ’åœ¨ä¸Šé¢ï¼Œä¸€æ—¦æ’ä¸Šï¼Œæ•´ä½“å°±ç»„æˆäº†ä¸€ä¸ªè¿é€šçš„ç”µè·¯çŠ¶æ€ 32ä½ã€64ä½è¡¨ç¤ºçš„æ˜¯CPUä¸€æ¬¡æ€§å¯ä»¥è¯»å–çš„ä½æ•°ï¼Œå¯„å­˜å™¨å¯ä»¥å­˜å‚¨çš„ä½æ•° CPUçš„åŸºæœ¬ç»„æˆPCï¼šProgram Counter ç¨‹åºè®¡æ•°å™¨ è®°å½•å½“å‰æŒ‡ä»¤åœ°å€ Registersï¼šæš‚æ—¶å­˜å‚¨CPUè®¡ç®—éœ€è¦ç”¨åˆ°çš„æ•°æ® ALUï¼šArithmetic &amp; Logic Unit è¿ç®—å•å…ƒ CUï¼šControl Unit æ§åˆ¶å•å…ƒ MMUï¼šMemory Management Unit å†…å­˜ç®¡ç†å•å…ƒ cacheï¼š","categories":[{"name":"æ“ä½œç³»ç»Ÿ","slug":"æ“ä½œç³»ç»Ÿ","permalink":"https://shang.at/categories/æ“ä½œç³»ç»Ÿ/"}],"tags":[{"name":"æ“ä½œç³»ç»Ÿ","slug":"æ“ä½œç³»ç»Ÿ","permalink":"https://shang.at/tags/æ“ä½œç³»ç»Ÿ/"}]},{"title":"å¤§æ•°æ®-zookeeper","slug":"å¤§æ•°æ®-zookeeper","date":"2021-01-14T11:26:42.000Z","updated":"2021-01-14T11:31:29.312Z","comments":true,"path":"post/å¤§æ•°æ®-zookeeper/","link":"","permalink":"https://shang.at/post/å¤§æ•°æ®-zookeeper/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š 1ã€clientå‘é›†ç¾¤è¯·æ±‚åˆ›å»ºä¸€ä¸ªèŠ‚ç‚¹ï¼Œé›†ç¾¤å†…éƒ¨ä¼šç»è¿‡ä¸¤é˜¶æ®µçš„æäº¤ï¼ŒåŠæ•°é€šè¿‡ï¼Œæ‰èƒ½æœ€ç»ˆåˆ›å»ºæˆåŠŸï¼Œç¬¬ä¸€é˜¶æ®µæ˜¯å†™ç£ç›˜æ—¥å¿—ï¼Œç¬¬äºŒé˜¶æ®µæ˜¯åœ¨å†…å­˜ä¸­åˆ›å»ºèŠ‚ç‚¹ã€‚çœ‹ä¸Šå»å¾ˆå¤æ‚ï¼Œä¸ºä»€ä¹ˆzké›†ç¾¤è¿˜èƒ½å¾ˆå¿«é€Ÿçš„å“åº”ï¼Ÿ 2ã€leaderæŒ‚æ‰ä¹‹åï¼Œå¦‚æœæœ‰èŠ‚ç‚¹çš„Zxidä¸æ˜¯æœ€å¤§çš„ï¼Œé‚£ä¹ˆé€‰ä¸¾äº†æ–°çš„leaderä¹‹åï¼Œè¯¥èŠ‚ç‚¹çš„Zxidå¦‚ä½•æ›´æ–° 3ã€å¦‚æœä¸€ä¸ªclientè¯·æ±‚æ•°æ®çš„followerï¼Œè¯¥followerè¿”å›çš„æ•°æ®å¦‚ä½•ä¿è¯æ˜¯æœ€æ–°çš„","categories":[{"name":"å¤§æ•°æ®","slug":"å¤§æ•°æ®","permalink":"https://shang.at/categories/å¤§æ•°æ®/"}],"tags":[{"name":"zookeeper","slug":"zookeeper","permalink":"https://shang.at/tags/zookeeper/"}]},{"title":"Mysqlå­¦ä¹ -ä¼˜åŒ–æ¡ˆä¾‹","slug":"Mysqlå­¦ä¹ -ä¼˜åŒ–æ¡ˆä¾‹","date":"2020-12-18T02:22:47.000Z","updated":"2021-02-18T09:03:56.877Z","comments":true,"path":"post/Mysqlå­¦ä¹ -ä¼˜åŒ–æ¡ˆä¾‹/","link":"","permalink":"https://shang.at/post/Mysqlå­¦ä¹ -ä¼˜åŒ–æ¡ˆä¾‹/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š åœ¨è¿›è¡Œä¼˜åŒ–æ¡ˆä¾‹ä¹‹å‰ï¼Œå…ˆçœ‹ä¸€ä¸‹å‡ ä¸ªæ¦‚å¿µï¼šç´¢å¼•ã€èšé›†ç´¢å¼•ã€æ™®é€šç´¢å¼•ã€å›è¡¨æŸ¥è¯¢ã€ç´¢å¼•è¦†ç›– æ¦‚å¿µæ•°æ®åº“è¡¨ç»“æ„ï¼š 123456create table user ( id int primary key, name varchar(20), sex varchar(5), index(name))engine=innodb; å¤šæŸ¥è¯¢äº†ä¸€ä¸ªå±æ€§ï¼Œä¸ºä½•æ£€ç´¢è¿‡ç¨‹å®Œå…¨ä¸åŒï¼Ÿ ä»€ä¹ˆæ˜¯å›è¡¨æŸ¥è¯¢ï¼Ÿ ä»€ä¹ˆæ˜¯ç´¢å¼•è¦†ç›–ï¼Ÿ å¦‚ä½•å®ç°ç´¢å¼•è¦†ç›–ï¼Ÿ å“ªäº›åœºæ™¯ï¼Œå¯ä»¥åˆ©ç”¨ç´¢å¼•è¦†ç›–æ¥ä¼˜åŒ–SQLï¼Ÿ è¿™äº›ï¼Œè¿™æ˜¯ä»Šå¤©è¦åˆ†äº«çš„å†…å®¹ã€‚ ç”»å¤–éŸ³ï¼šæœ¬æ–‡è¯•éªŒåŸºäºMySQL5.6-InnoDBã€‚ ä¸€ã€ä»€ä¹ˆæ˜¯å›è¡¨æŸ¥è¯¢ï¼Ÿ è¿™å…ˆè¦ä»InnoDBçš„ç´¢å¼•å®ç°è¯´èµ·ï¼ŒInnoDBæœ‰ä¸¤å¤§ç±»ç´¢å¼•ï¼š èšé›†ç´¢å¼•(clustered index) æ™®é€šç´¢å¼•(secondary index) InnoDBèšé›†ç´¢å¼•å’Œæ™®é€šç´¢å¼•æœ‰ä»€ä¹ˆå·®å¼‚ï¼Ÿ InnoDBèšé›†ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜å‚¨è¡Œè®°å½•ï¼Œå› æ­¤ï¼Œ InnoDBå¿…é¡»è¦æœ‰ï¼Œä¸”åªæœ‰ä¸€ä¸ªèšé›†ç´¢å¼•ï¼š ï¼ˆ1ï¼‰å¦‚æœè¡¨å®šä¹‰äº†PKï¼Œåˆ™PKå°±æ˜¯èšé›†ç´¢å¼•ï¼› ï¼ˆ2ï¼‰å¦‚æœè¡¨æ²¡æœ‰å®šä¹‰PKï¼Œåˆ™ç¬¬ä¸€ä¸ªnot NULL uniqueåˆ—æ˜¯èšé›†ç´¢å¼•ï¼› ï¼ˆ3ï¼‰å¦åˆ™ï¼ŒInnoDBä¼šåˆ›å»ºä¸€ä¸ªéšè—çš„row-idä½œä¸ºèšé›†ç´¢å¼•ï¼› ç”»å¤–éŸ³ï¼šæ‰€ä»¥PKæŸ¥è¯¢éå¸¸å¿«ï¼Œç›´æ¥å®šä½è¡Œè®°å½•ã€‚ InnoDBæ™®é€šç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜å‚¨ä¸»é”®å€¼ã€‚ ç”»å¤–éŸ³ï¼šæ³¨æ„ï¼Œä¸æ˜¯å­˜å‚¨è¡Œè®°å½•å¤´æŒ‡é’ˆï¼ŒMyISAMçš„ç´¢å¼•å¶å­èŠ‚ç‚¹å­˜å‚¨è®°å½•æŒ‡é’ˆã€‚ ä¸¾ä¸ªæ —å­ï¼Œä¸å¦¨è®¾æœ‰è¡¨ï¼š t(id PK, name KEY, sex, flag); ç”»å¤–éŸ³ï¼šidæ˜¯èšé›†ç´¢å¼•ï¼Œnameæ˜¯æ™®é€šç´¢å¼•ã€‚ è¡¨ä¸­æœ‰å››æ¡è®°å½•ï¼š 1, shenjian, m, A 3, zhangsan, m, A 5, lisi, m, A 9, wangwu, f, B ä¸¤ä¸ªB+æ ‘ç´¢å¼•åˆ†åˆ«å¦‚ä¸Šå›¾ï¼š ï¼ˆ1ï¼‰idä¸ºPKï¼Œèšé›†ç´¢å¼•ï¼Œå¶å­èŠ‚ç‚¹å­˜å‚¨è¡Œè®°å½•ï¼› ï¼ˆ2ï¼‰nameä¸ºKEYï¼Œæ™®é€šç´¢å¼•ï¼Œå¶å­èŠ‚ç‚¹å­˜å‚¨PKå€¼ï¼Œå³idï¼› æ—¢ç„¶ä»æ™®é€šç´¢å¼•æ— æ³•ç›´æ¥å®šä½è¡Œè®°å½•ï¼Œé‚£æ™®é€šç´¢å¼•çš„æŸ¥è¯¢è¿‡ç¨‹æ˜¯æ€ä¹ˆæ ·çš„å‘¢ï¼Ÿ é€šå¸¸æƒ…å†µä¸‹ï¼Œéœ€è¦æ‰«ç ä¸¤éç´¢å¼•æ ‘ã€‚ ä¾‹å¦‚ï¼š 1select * from t where name='lisi' æ˜¯å¦‚ä½•æ‰§è¡Œçš„å‘¢ï¼Ÿ å¦‚ç²‰çº¢è‰²è·¯å¾„ï¼Œéœ€è¦æ‰«ç ä¸¤éç´¢å¼•æ ‘ï¼š ï¼ˆ1ï¼‰å…ˆé€šè¿‡æ™®é€šç´¢å¼•å®šä½åˆ°ä¸»é”®å€¼id=5ï¼› ï¼ˆ2ï¼‰åœ¨é€šè¿‡èšé›†ç´¢å¼•å®šä½åˆ°è¡Œè®°å½•ï¼› è¿™å°±æ˜¯æ‰€è°“çš„å›è¡¨æŸ¥è¯¢ï¼Œå…ˆå®šä½ä¸»é”®å€¼ï¼Œå†å®šä½è¡Œè®°å½•ï¼Œå®ƒçš„æ€§èƒ½è¾ƒæ‰«ä¸€éç´¢å¼•æ ‘æ›´ä½ã€‚ äºŒã€ä»€ä¹ˆæ˜¯ç´¢å¼•è¦†ç›–(Covering index)ï¼Ÿ é¢ï¼Œæ¥¼ä¸»å¹¶æ²¡æœ‰åœ¨MySQLçš„å®˜ç½‘æ‰¾åˆ°è¿™ä¸ªæ¦‚å¿µã€‚ ç”»å¤–éŸ³ï¼šæ²»å­¦ä¸¥è°¨å§ï¼Ÿ å€Ÿç”¨ä¸€ä¸‹SQL-Serverå®˜ç½‘çš„è¯´æ³•ã€‚ MySQLå®˜ç½‘ï¼Œç±»ä¼¼çš„è¯´æ³•å‡ºç°åœ¨explainæŸ¥è¯¢è®¡åˆ’ä¼˜åŒ–ç« èŠ‚ï¼Œå³explainçš„è¾“å‡ºç»“æœExtraå­—æ®µä¸ºUsing indexæ—¶ï¼Œèƒ½å¤Ÿè§¦å‘ç´¢å¼•è¦†ç›–ã€‚ ä¸ç®¡æ˜¯SQL-Serverå®˜ç½‘ï¼Œè¿˜æ˜¯MySQLå®˜ç½‘ï¼Œéƒ½è¡¨è¾¾äº†ï¼šåªéœ€è¦åœ¨ä¸€æ£µç´¢å¼•æ ‘ä¸Šå°±èƒ½è·å–SQLæ‰€éœ€çš„æ‰€æœ‰åˆ—æ•°æ®ï¼Œæ— éœ€å›è¡¨ï¼Œé€Ÿåº¦æ›´å¿«ã€‚ ä¸‰ã€å¦‚ä½•å®ç°ç´¢å¼•è¦†ç›–ï¼Ÿ å¸¸è§çš„æ–¹æ³•æ˜¯ï¼šå°†è¢«æŸ¥è¯¢çš„å­—æ®µï¼Œå»ºç«‹åˆ°è”åˆç´¢å¼•é‡Œå»ã€‚ ä»æ˜¯ä¹‹å‰ä¸­çš„ä¾‹å­ï¼š 123456create table user ( id int primary key, name varchar(20), sex varchar(5), index(name))engine=innodb; ç¬¬ä¸€ä¸ªSQLè¯­å¥ï¼š 1select id,name from user where name='shenjian' èƒ½å¤Ÿå‘½ä¸­nameç´¢å¼•ï¼Œç´¢å¼•å¶å­èŠ‚ç‚¹å­˜å‚¨äº†ä¸»é”®idï¼Œé€šè¿‡nameçš„ç´¢å¼•æ ‘å³å¯è·å–idå’Œnameï¼Œæ— éœ€å›è¡¨ï¼Œç¬¦åˆç´¢å¼•è¦†ç›–ï¼Œæ•ˆç‡è¾ƒé«˜ã€‚ ç”»å¤–éŸ³ï¼ŒExtraï¼šUsing indexã€‚ ç¬¬äºŒä¸ªSQLè¯­å¥ï¼š 1select id,name,sex from user where name='shenjian' èƒ½å¤Ÿå‘½ä¸­nameç´¢å¼•ï¼Œç´¢å¼•å¶å­èŠ‚ç‚¹å­˜å‚¨äº†ä¸»é”®idï¼Œä½†sexå­—æ®µå¿…é¡»å›è¡¨æŸ¥è¯¢æ‰èƒ½è·å–åˆ°ï¼Œä¸ç¬¦åˆç´¢å¼•è¦†ç›–ï¼Œéœ€è¦å†æ¬¡é€šè¿‡idå€¼æ‰«ç èšé›†ç´¢å¼•è·å–sexå­—æ®µï¼Œæ•ˆç‡ä¼šé™ä½ã€‚ ç”»å¤–éŸ³ï¼ŒExtraï¼šUsing index conditionã€‚ å¦‚æœæŠŠ(name)å•åˆ—ç´¢å¼•å‡çº§ä¸ºè”åˆç´¢å¼•(name, sex)å°±ä¸åŒäº†ã€‚ 123456create table user ( id int primary key, name varchar(20), sex varchar(5), index(name, sex))engine=innodb; å¯ä»¥çœ‹åˆ°ï¼š 12select id,name... where name='shenjian';select id,name,sex ... where name='shenjian' éƒ½èƒ½å¤Ÿå‘½ä¸­ç´¢å¼•è¦†ç›–ï¼Œæ— éœ€å›è¡¨ã€‚ ç”»å¤–éŸ³ï¼ŒExtraï¼šUsing indexã€‚ å››ã€å“ªäº›åœºæ™¯å¯ä»¥åˆ©ç”¨ç´¢å¼•è¦†ç›–æ¥ä¼˜åŒ–SQLï¼Ÿ åœºæ™¯1ï¼šå…¨è¡¨countæŸ¥è¯¢ä¼˜åŒ– åŸè¡¨ä¸ºï¼š user(PK id, name, sex)ï¼› ç›´æ¥ï¼š 1select count(name) from user; ä¸èƒ½åˆ©ç”¨ç´¢å¼•è¦†ç›–ã€‚ æ·»åŠ ç´¢å¼•ï¼š 1alter table user add key(name); å°±èƒ½å¤Ÿåˆ©ç”¨ç´¢å¼•è¦†ç›–ææ•ˆã€‚ åœºæ™¯2ï¼šåˆ—æŸ¥è¯¢å›è¡¨ä¼˜åŒ– 1select id,name,sex ... where name='shenjian' è¿™ä¸ªä¾‹å­ä¸å†èµ˜è¿°ï¼Œå°†å•åˆ—ç´¢å¼•(name)å‡çº§ä¸ºè”åˆç´¢å¼•(name, sex)ï¼Œå³å¯é¿å…å›è¡¨ã€‚ åœºæ™¯3ï¼šåˆ†é¡µæŸ¥è¯¢ 1select id,name,sex ... order by name limit 500,100 å°†å•åˆ—ç´¢å¼•(name)å‡çº§ä¸ºè”åˆç´¢å¼•(name, sex)ï¼Œä¹Ÿå¯ä»¥é¿å…å›è¡¨ã€‚ ä¼˜åŒ–æ¡ˆä¾‹","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://shang.at/categories/Mysql/"}],"tags":[{"name":"mysqlä¼˜åŒ–","slug":"mysqlä¼˜åŒ–","permalink":"https://shang.at/tags/mysqlä¼˜åŒ–/"}]},{"title":"Mysqlå­¦ä¹ -ç´¢å¼•","slug":"Mysqlå­¦ä¹ -ç´¢å¼•","date":"2020-12-15T01:48:57.000Z","updated":"2020-12-15T08:56:13.741Z","comments":true,"path":"post/Mysqlå­¦ä¹ -ç´¢å¼•/","link":"","permalink":"https://shang.at/post/Mysqlå­¦ä¹ -ç´¢å¼•/","excerpt":"ç®€ä»‹ï¼šå”¯ä¸€ç´¢å¼•ï¼ˆunique indexï¼‰å’Œéå”¯ä¸€ç´¢å¼•ï¼ˆæ™®é€šç´¢å¼•ï¼‰ï¼ˆindexï¼‰ åŒºåˆ«","text":"ç®€ä»‹ï¼šå”¯ä¸€ç´¢å¼•ï¼ˆunique indexï¼‰å’Œéå”¯ä¸€ç´¢å¼•ï¼ˆæ™®é€šç´¢å¼•ï¼‰ï¼ˆindexï¼‰ åŒºåˆ« å¦‚æœåœ¨ä¸€ä¸ªåˆ—ä¸ŠåŒæ—¶å»ºå”¯ä¸€ç´¢å¼•å’Œæ™®é€šç´¢å¼•çš„è¯ï¼Œmysqlä¼šè‡ªåŠ¨é€‰æ‹©å”¯ä¸€ç´¢å¼•ã€‚ è°·æ­Œä¸€ä¸‹ï¼š å”¯ä¸€ç´¢å¼•å’Œæ™®é€šç´¢å¼•ä½¿ç”¨çš„ç»“æ„éƒ½æ˜¯B-tree,æ‰§è¡Œæ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(log n)ã€‚ è¡¥å……ä¸‹æ¦‚å¿µï¼š 1ã€æ™®é€šç´¢å¼•(éå”¯ä¸€ç´¢å¼•) æ™®é€šç´¢å¼•ï¼ˆç”±å…³é”®å­—KEYæˆ–INDEXå®šä¹‰çš„ç´¢å¼•ï¼‰çš„å”¯ä¸€ä»»åŠ¡æ˜¯åŠ å¿«å¯¹æ•°æ®çš„è®¿é—®é€Ÿåº¦ã€‚å› æ­¤ï¼Œåº”è¯¥åªä¸ºé‚£äº›æœ€ç»å¸¸å‡ºç°åœ¨æŸ¥è¯¢æ¡ä»¶ï¼ˆWHEREcolumn=ï¼‰æˆ–æ’åºæ¡ä»¶ï¼ˆORDERBYcolumnï¼‰ä¸­çš„æ•°æ®åˆ—åˆ›å»ºç´¢å¼•ã€‚åªè¦æœ‰å¯èƒ½ï¼Œå°±åº”è¯¥é€‰æ‹©ä¸€ä¸ªæ•°æ®æœ€æ•´é½ã€æœ€ç´§å‡‘çš„æ•°æ®åˆ—ï¼ˆå¦‚ä¸€ä¸ªæ•´æ•°ç±»å‹çš„æ•°æ®åˆ—ï¼‰æ¥åˆ›å»ºç´¢å¼•ã€‚ 2ã€å”¯ä¸€ç´¢å¼• æ™®é€šç´¢å¼•å…è®¸è¢«ç´¢å¼•çš„æ•°æ®åˆ—åŒ…å«é‡å¤çš„å€¼ã€‚æ¯”å¦‚è¯´ï¼Œå› ä¸ºäººæœ‰å¯èƒ½åŒåï¼Œæ‰€ä»¥åŒä¸€ä¸ªå§“ååœ¨åŒä¸€ä¸ªâ€œå‘˜å·¥ä¸ªäººèµ„æ–™â€æ•°æ®è¡¨é‡Œå¯èƒ½å‡ºç°ä¸¤æ¬¡æˆ–æ›´å¤šæ¬¡ã€‚ å¦‚æœèƒ½ç¡®å®šæŸä¸ªæ•°æ®åˆ—å°†åªåŒ…å«å½¼æ­¤å„ä¸ç›¸åŒçš„å€¼ï¼Œåœ¨ä¸ºè¿™ä¸ªæ•°æ®åˆ—åˆ›å»ºç´¢å¼•çš„æ—¶å€™å°±åº”è¯¥ç”¨å…³é”®å­—UNIQUEæŠŠå®ƒå®šä¹‰ä¸ºä¸€ä¸ªå”¯ä¸€ç´¢å¼•ã€‚è¿™ä¹ˆåšçš„å¥½å¤„ï¼šä¸€æ˜¯ç®€åŒ–äº†MySQLå¯¹è¿™ä¸ªç´¢å¼•çš„ç®¡ç†å·¥ä½œï¼Œè¿™ä¸ªç´¢å¼•ä¹Ÿå› æ­¤è€Œå˜å¾—æ›´æœ‰æ•ˆç‡ï¼›äºŒæ˜¯MySQLä¼šåœ¨æœ‰æ–°è®°å½•æ’å…¥æ•°æ®è¡¨æ—¶ï¼Œè‡ªåŠ¨æ£€æŸ¥æ–°è®°å½•çš„è¿™ä¸ªå­—æ®µçš„å€¼æ˜¯å¦å·²ç»åœ¨æŸä¸ªè®°å½•çš„è¿™ä¸ªå­—æ®µé‡Œå‡ºç°è¿‡äº†ï¼›å¦‚æœæ˜¯ï¼ŒMySQLå°†æ‹’ç»æ’å…¥é‚£æ¡æ–°è®°å½•ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå”¯ä¸€ç´¢å¼•å¯ä»¥ä¿è¯æ•°æ®è®°å½•çš„å”¯ä¸€æ€§ã€‚äº‹å®ä¸Šï¼Œåœ¨è®¸å¤šåœºåˆï¼Œäººä»¬åˆ›å»ºå”¯ä¸€ç´¢å¼•çš„ç›®çš„å¾€å¾€ä¸æ˜¯ä¸ºäº†æé«˜è®¿é—®é€Ÿåº¦ï¼Œè€Œåªæ˜¯ä¸ºäº†é¿å…æ•°æ®å‡ºç°é‡å¤ã€‚ ä¸»é”®ç´¢å¼•ä¸»é”®ç´¢å¼•æ˜¯å”¯ä¸€ç´¢å¼•çš„ç‰¹æ®Šç±»å‹ã€‚æ•°æ®åº“è¡¨é€šå¸¸æœ‰ä¸€åˆ—æˆ–åˆ—ç»„åˆï¼Œå…¶å€¼ç”¨æ¥å”¯ä¸€æ ‡è¯†è¡¨ä¸­çš„æ¯ä¸€è¡Œã€‚è¯¥åˆ—ç§°ä¸ºè¡¨çš„ä¸»é”®ã€‚åœ¨æ•°æ®åº“å…³ç³»å›¾ä¸­ä¸ºè¡¨å®šä¹‰ä¸€ä¸ªä¸»é”®å°†è‡ªåŠ¨åˆ›å»ºä¸»é”®ç´¢å¼•ï¼Œä¸»é”®ç´¢å¼•æ˜¯å”¯ä¸€ç´¢å¼•çš„ç‰¹æ®Šç±»å‹ã€‚ä¸»é”®ç´¢å¼•è¦æ±‚ä¸»é”®ä¸­çš„æ¯ä¸ªå€¼æ˜¯å”¯ä¸€çš„ã€‚å½“åœ¨æŸ¥è¯¢ä¸­ä½¿ç”¨ä¸»é”®ç´¢å¼•æ—¶ï¼Œå®ƒè¿˜å…è®¸å¿«é€Ÿè®¿é—®æ•°æ®ã€‚ å®ƒä»¬çš„ä¸€äº›æ¯”è¾ƒï¼š(1)å¯¹äºä¸»å¥/unique constraint ï¼Œ oracle/sql server/mysqlç­‰éƒ½ä¼šè‡ªåŠ¨å»ºç«‹å”¯ä¸€ç´¢å¼•ï¼›(2)ä¸»é”®ä¸ä¸€å®šåªåŒ…å«ä¸€ä¸ªå­—æ®µï¼Œæ‰€ä»¥å¦‚æœä½ åœ¨ä¸»é”®çš„å…¶ä¸­ä¸€ä¸ªå­—æ®µå»ºå”¯ä¸€ç´¢å¼•è¿˜æ˜¯å¿…è¦çš„ï¼›(3)ä¸»å¥å¯ä½œå¤–å¥ï¼Œå”¯ä¸€ç´¢å¼•ä¸å¯ï¼›(4)ä¸»å¥ä¸å¯ä¸ºç©ºï¼Œå”¯ä¸€ç´¢å¼•å¯ï¼›(5)ä¸»å¥ä¹Ÿå¯æ˜¯å¤šä¸ªå­—æ®µçš„ç»„åˆï¼›(6)ä¸»é”®ä¸å”¯ä¸€ç´¢å¼•ä¸åŒçš„æ˜¯ï¼ša.æœ‰not nullå±æ€§ï¼›b.æ¯ä¸ªè¡¨åªèƒ½æœ‰ä¸€ä¸ªã€‚ 3. å®ä¾‹ï¼š ç´¢å¼•çš„ä½œç”¨æ˜¯â€œæ’åˆ—å¥½æ¬¡åºï¼Œä½¿å¾—æŸ¥è¯¢æ—¶å¯ä»¥å¿«é€Ÿæ‰¾åˆ°â€ ã€‹å”¯ä¸€ç´¢å¼•ï¼šè¢«ç´¢å¼•çš„å­—æ®µç»„åˆï¼Œå…¶æ•°æ®åœ¨å…¨è¡¨ä¸­å”¯ä¸€ã€‚å¦‚ä¸‹è¡¨ä¸­ï¼Œä¸ºâ€™å­¦å·â€˜å»ºç´¢å¼•ï¼šå­¦å· å§“å-â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”001 å¼ ä¸‰002 æå›› ã€‹éå”¯ä¸€ç´¢å¼•ï¼šæ•°æ®å¯ä»¥ä¸å”¯ä¸€ã€‚å¦‚ä¸‹è¡¨ä¸­ï¼Œä¸ºScoreå»ºç´¢å¼•ï¼Œä¸å¯å”¯ä¸€ï¼š Score | Name-â€”â€”â€”â€”â€”â€”â€”â€”â€”-98 å¼ ä¸‰98 æå››96 ç‹äº” -â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”- CREATE INDEX è¯­å¥ç”¨äºåœ¨è¡¨ä¸­åˆ›å»ºç´¢å¼•ã€‚ åœ¨ä¸è¯»å–æ•´ä¸ªè¡¨çš„æƒ…å†µä¸‹ï¼Œç´¢å¼•ä½¿æ•°æ®åº“åº”ç”¨ç¨‹åºå¯ä»¥æ›´å¿«åœ°æŸ¥æ‰¾æ•°æ®ã€‚ ç´¢å¼•æ‚¨å¯ä»¥åœ¨è¡¨ä¸­åˆ›å»ºç´¢å¼•ï¼Œä»¥ä¾¿æ›´åŠ å¿«é€Ÿé«˜æ•ˆåœ°æŸ¥è¯¢æ•°æ®ã€‚ ç”¨æˆ·æ— æ³•çœ‹åˆ°ç´¢å¼•ï¼Œå®ƒä»¬åªèƒ½è¢«ç”¨æ¥åŠ é€Ÿæœç´¢/æŸ¥è¯¢ã€‚ æ³¨é‡Šï¼šæ›´æ–°ä¸€ä¸ªåŒ…å«ç´¢å¼•çš„è¡¨éœ€è¦æ¯”æ›´æ–°ä¸€ä¸ªæ²¡æœ‰ç´¢å¼•çš„è¡¨æ›´å¤šçš„æ—¶é—´ï¼Œè¿™æ˜¯ç”±äºç´¢å¼•æœ¬èº«ä¹Ÿéœ€è¦æ›´æ–°ã€‚å› æ­¤ï¼Œç†æƒ³çš„åšæ³•æ˜¯ä»…ä»…åœ¨å¸¸å¸¸è¢«æœç´¢çš„åˆ—ï¼ˆä»¥åŠè¡¨ï¼‰ä¸Šé¢åˆ›å»ºç´¢å¼•ã€‚ SQL CREATE INDEX è¯­æ³•åœ¨è¡¨ä¸Šåˆ›å»ºä¸€ä¸ªç®€å•çš„ç´¢å¼•ã€‚å…è®¸ä½¿ç”¨é‡å¤çš„å€¼ï¼š 1CREATE INDEX index_name ON table_name (column_name) æ³¨é‡Šï¼šâ€column_nameâ€ è§„å®šéœ€è¦ç´¢å¼•çš„åˆ—ã€‚ SQL CREATE UNIQUE INDEX è¯­æ³•åœ¨è¡¨ä¸Šåˆ›å»ºä¸€ä¸ªå”¯ä¸€çš„ç´¢å¼•ã€‚å”¯ä¸€çš„ç´¢å¼•æ„å‘³ç€ä¸¤ä¸ªè¡Œä¸èƒ½æ‹¥æœ‰ç›¸åŒçš„ç´¢å¼•å€¼ã€‚ 1CREATE UNIQUE INDEX index_name ON table_name (column_name) CREATE INDEX å®ä¾‹æœ¬ä¾‹ä¼šåˆ›å»ºä¸€ä¸ªç®€å•çš„ç´¢å¼•ï¼Œåä¸º â€œPersonIndexâ€ï¼Œåœ¨ Person è¡¨çš„ LastName åˆ—ï¼š 1CREATE INDEX PersonIndex ON Person (LastName) å¦‚æœæ‚¨å¸Œæœ›ä»¥é™åºç´¢å¼•æŸä¸ªåˆ—ä¸­çš„å€¼ï¼Œæ‚¨å¯ä»¥åœ¨åˆ—åç§°ä¹‹åæ·»åŠ ä¿ç•™å­— DESCï¼š 1CREATE INDEX PersonIndex ON Person (LastName DESC) å‡å¦‚æ‚¨å¸Œæœ›ç´¢å¼•ä¸æ­¢ä¸€ä¸ªåˆ—ï¼Œæ‚¨å¯ä»¥åœ¨æ‹¬å·ä¸­åˆ—å‡ºè¿™äº›åˆ—çš„åç§°ï¼Œç”¨é€—å·éš”å¼€ï¼š 1CREATE INDEX PersonIndex ON Person (LastName, FirstName) Drop INDEX å®ä¾‹ drop index idx_name on db; From: http://blog.chinaunix.net/uid-30041424-id-5680256.html https://zhidao.baidu.com/question/456499708168710645.html http://www.cnblogs.com/ymj0906/p/4240856.html ç´¢å¼•é”®çš„å”¯ä¸€æ€§ï¼ˆ1/4ï¼‰ï¼šå †è¡¨ä¸Šçš„å”¯ä¸€ä¸éå”¯ä¸€éèšé›†ç´¢å¼•çš„åŒºåˆ« http://www.cnblogs.com/woodytu/p/4560478.html å”¯ä¸€ç´¢å¼•å’Œéå”¯ä¸€ç´¢å¼•çš„åŒºåˆ«ç®€æ http://www.cnblogs.com/Joe-T/p/3573672.html http://www.w3school.com.cn/sql/sql_create_index.asp","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://shang.at/categories/Mysql/"}],"tags":[{"name":"ç´¢å¼•","slug":"ç´¢å¼•","permalink":"https://shang.at/tags/ç´¢å¼•/"}]},{"title":"Pythonå­¦ä¹ -æ­£åˆ™","slug":"Pythonå­¦ä¹ -æ­£åˆ™","date":"2020-12-08T10:18:33.000Z","updated":"2020-12-08T10:19:14.366Z","comments":true,"path":"post/Pythonå­¦ä¹ -æ­£åˆ™/","link":"","permalink":"https://shang.at/post/Pythonå­¦ä¹ -æ­£åˆ™/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š","categories":[{"name":"æ­£åˆ™","slug":"æ­£åˆ™","permalink":"https://shang.at/categories/æ­£åˆ™/"}],"tags":[{"name":"æ­£åˆ™","slug":"æ­£åˆ™","permalink":"https://shang.at/tags/æ­£åˆ™/"}]},{"title":"Pythonå­¦ä¹ -Literal String Interpolation","slug":"Pythonå­¦ä¹ -Literal-String-Interpolation","date":"2020-12-08T10:18:18.000Z","updated":"2020-12-08T10:19:07.362Z","comments":true,"path":"post/Pythonå­¦ä¹ -Literal-String-Interpolation/","link":"","permalink":"https://shang.at/post/Pythonå­¦ä¹ -Literal-String-Interpolation/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š https://www.python.org/dev/peps/pep-0498/","categories":[{"name":"python-lsi","slug":"python-lsi","permalink":"https://shang.at/categories/python-lsi/"}],"tags":[{"name":"python-lsi","slug":"python-lsi","permalink":"https://shang.at/tags/python-lsi/"}]},{"title":"å¤§æ•°æ®-flink","slug":"å¤§æ•°æ®-flink","date":"2020-12-07T02:51:11.000Z","updated":"2021-01-31T01:39:53.471Z","comments":true,"path":"post/å¤§æ•°æ®-flink/","link":"","permalink":"https://shang.at/post/å¤§æ•°æ®-flink/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š https://ci.apache.org/projects/flink/flink-docs-release-1.11/try-flink/table_api.html5 -","categories":[{"name":"å¤§æ•°æ®","slug":"å¤§æ•°æ®","permalink":"https://shang.at/categories/å¤§æ•°æ®/"}],"tags":[{"name":"flink","slug":"flink","permalink":"https://shang.at/tags/flink/"}]},{"title":"javaå­¦ä¹ -Dateå’Œæ—¶åŒºè½¬æ¢","slug":"javaå­¦ä¹ -Dateå’Œæ—¶åŒºè½¬æ¢","date":"2020-11-06T02:07:20.000Z","updated":"2020-11-06T02:09:36.492Z","comments":true,"path":"post/javaå­¦ä¹ -Dateå’Œæ—¶åŒºè½¬æ¢/","link":"","permalink":"https://shang.at/post/javaå­¦ä¹ -Dateå’Œæ—¶åŒºè½¬æ¢/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š 1.Dateä¸­ä¿å­˜çš„æ˜¯ä»€ä¹ˆ åœ¨javaä¸­ï¼Œåªè¦æˆ‘ä»¬æ‰§è¡Œ Date date = new Date(); å°±å¯ä»¥å¾—åˆ°å½“å‰æ—¶é—´ã€‚å¦‚ï¼š 12Date date = new Date();System.out.println(date); è¾“å‡ºç»“æœæ˜¯ï¼š Thu Aug 24 10:15:29 CST 2017 ä¹Ÿå°±æ˜¯æˆ‘æ‰§è¡Œä¸Šè¿°ä»£ç çš„æ—¶åˆ»ï¼š2017å¹´8æœˆ24æ—¥10ç‚¹15åˆ†29ç§’ã€‚æ˜¯ä¸æ˜¯Dateå¯¹è±¡é‡Œå­˜äº†å¹´æœˆæ—¥æ—¶åˆ†ç§’å‘¢ï¼Ÿä¸æ˜¯çš„ï¼ŒDateå¯¹è±¡é‡Œå­˜çš„åªæ˜¯ä¸€ä¸ªlongå‹çš„å˜é‡ï¼Œå…¶å€¼ä¸ºè‡ª1970å¹´1æœˆ1æ—¥0ç‚¹è‡³Dateå¯¹è±¡æ‰€è®°å½•æ—¶åˆ»ç»è¿‡çš„æ¯«ç§’æ•°ï¼Œè°ƒç”¨Dateå¯¹è±¡getTime()æ–¹æ³•å°±å¯ä»¥è¿”å›è¿™ä¸ªæ¯«ç§’æ•°ï¼Œå¦‚ä¸‹ä»£ç ï¼š 12Date date = new Date();System.out.println(date + \", \" + date.getTime()); è¾“å‡ºå¦‚ä¸‹ï¼š Thu Aug 24 10:48:05 CST 2017, 1503542885955 å³ä¸Šè¿°ç¨‹åºæ‰§è¡Œçš„æ—¶åˆ»æ˜¯2017å¹´8æœˆ24æ—¥10ç‚¹48åˆ†05ç§’ï¼Œè¯¥æ—¶åˆ»è·ç¦»1970å¹´1æœˆ1æ—¥0ç‚¹ç»è¿‡äº†1503542885955æ¯«ç§’ã€‚åè¿‡æ¥è¯´ï¼Œè¾“å‡ºçš„å¹´æœˆæ—¥æ—¶åˆ†ç§’å…¶å®æ˜¯æ ¹æ®è¿™ä¸ªæ¯«ç§’æ•°æ¥åç®—å‡ºæ¥çš„ã€‚ 2.æ—¶åŒº å…¨çƒåˆ†ä¸º24ä¸ªæ—¶åŒºï¼Œç›¸é‚»æ—¶åŒºæ—¶é—´ç›¸å·®1ä¸ªå°æ—¶ã€‚æ¯”å¦‚åŒ—äº¬å¤„äºä¸œå…«æ—¶åŒºï¼Œä¸œäº¬å¤„äºä¸œä¹æ—¶åŒºï¼ŒåŒ—äº¬æ—¶é—´æ¯”ä¸œäº¬æ—¶é—´æ™š1ä¸ªå°æ—¶ï¼Œè€Œè‹±å›½ä¼¦æ•¦æ—¶é—´æ¯”åŒ—äº¬æ™š7ä¸ªå°æ—¶ï¼ˆè‹±å›½é‡‡ç”¨å¤ä»¤æ—¶æ—¶ï¼Œ8æœˆè‹±å›½å¤„äºå¤ä»¤æ—¶ï¼‰ã€‚æ¯”å¦‚æ­¤åˆ»åŒ—äº¬æ—¶é—´æ˜¯2017å¹´8æœˆ24æ—¥11:17:10ï¼Œåˆ™ä¸œäº¬æ—¶é—´æ˜¯2017å¹´8æœˆ24æ—¥12:17:10ï¼Œä¼¦æ•¦æ—¶é—´æ˜¯2017å¹´8æœˆ24æ—¥4:17:10ã€‚ æ—¢ç„¶Dateé‡Œå­˜æ”¾çš„æ˜¯å½“å‰æ—¶åˆ»è·1970å¹´1æœˆ1æ—¥0ç‚¹æ—¶åˆ»çš„æ¯«ç§’æ•°ï¼Œå¦‚æœæ­¤åˆ»åœ¨ä¼¦æ•¦ã€åŒ—äº¬ã€ä¸œäº¬æœ‰ä¸‰ä¸ªç¨‹åºå‘˜åŒæ—¶æ‰§è¡Œå¦‚ä¸‹è¯­å¥ï¼š 1Date date = new Date(); é‚£è¿™ä¸‰ä¸ªdateå¯¹è±¡é‡Œå­˜çš„æ¯«ç§’æ•°æ˜¯ç›¸åŒçš„å—ï¼Ÿè¿˜æ˜¯åŒ—äº¬çš„æ¯”ä¸œäº¬çš„å°3600000ï¼ˆåŒ—äº¬æ—¶é—´æ¯”ä¸œäº¬æ—¶é—´æ™š1å°æ—¶ï¼Œ1å°æ—¶ä¸º3600ç§’å³3600000æ¯«ç§’ï¼‰ï¼Ÿç­”æ¡ˆæ˜¯ï¼Œè¿™3ä¸ªDateé‡Œçš„æ¯«ç§’æ•°æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚ç¡®åˆ‡çš„è¯´ï¼ŒDateå¯¹è±¡é‡Œå­˜çš„æ˜¯è‡ªæ ¼æ—å¨æ²»æ—¶é—´ï¼ˆ GMTï¼‰1970å¹´1æœˆ1æ—¥0ç‚¹è‡³Dateå¯¹è±¡æ‰€è¡¨ç¤ºæ—¶åˆ»æ‰€ç»è¿‡çš„æ¯«ç§’æ•°ã€‚æ‰€ä»¥ï¼Œå¦‚æœæŸä¸€æ—¶åˆ»éå¸ƒäºä¸–ç•Œå„åœ°çš„ç¨‹åºå‘˜åŒæ—¶æ‰§è¡Œnew Dateè¯­å¥ï¼Œè¿™äº›Dateå¯¹è±¡æ‰€å­˜çš„æ¯«ç§’æ•°æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒDateé‡Œå­˜æ”¾çš„æ¯«ç§’æ•°æ˜¯ä¸æ—¶åŒºæ— å…³çš„ã€‚ ç»§ç»­ä¸Šè¿°ä¾‹å­ï¼Œå¦‚æœä¸Šè¿°3ä¸ªç¨‹åºå‘˜è°ƒç”¨é‚£ä¸€åˆ»çš„æ—¶é—´æ˜¯åŒ—äº¬æ—¶é—´2017å¹´8æœˆ24æ—¥11:17:10ï¼Œä»–ä»¬ç»§ç»­è°ƒç”¨ 1System.out.println(date); é‚£ä¹ˆåŒ—äº¬çš„ç¨‹åºå‘˜å°†ä¼šæ‰“å°å‡º2017å¹´8æœˆ24æ—¥11:17:10ï¼Œè€Œä¸œäº¬çš„ç¨‹åºå‘˜ä¼šæ‰“å°å‡º2017å¹´8æœˆ24æ—¥12:17:10ï¼Œä¼¦æ•¦çš„ç¨‹åºå‘˜ä¼šæ‰“å°å‡º2017å¹´8æœˆ24æ—¥4:17:10ã€‚æ—¢ç„¶Dateå¯¹è±¡åªå­˜äº†ä¸€ä¸ªæ¯«ç§’æ•°ï¼Œä¸ºä»€ä¹ˆè¿™3ä¸ªæ¯«ç§’æ•°å®Œå…¨ç›¸åŒçš„Dateå¯¹è±¡ï¼Œå¯ä»¥æ‰“å°å‡ºä¸åŒçš„æ—¶é—´å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºSysytem.out.printlnå‡½æ•°åœ¨æ‰“å°æ—¶é—´æ—¶ï¼Œä¼šå–æ“ä½œç³»ç»Ÿå½“å‰æ‰€è®¾ç½®çš„æ—¶åŒºï¼Œç„¶åæ ¹æ®è¿™ä¸ªæ—¶åŒºå°†åŒæ¯«ç§’æ•°è§£é‡Šæˆè¯¥æ—¶åŒºçš„æ—¶é—´ã€‚å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰‹åŠ¨è®¾ç½®æ—¶åŒºï¼Œä»¥å°†åŒä¸€ä¸ªDateå¯¹è±¡æŒ‰ä¸åŒçš„æ—¶åŒºè¾“å‡ºã€‚å¯ä»¥åšå¦‚ä¸‹å®éªŒéªŒè¯ï¼š 12345678910Date date = new Date(1503544630000L); // å¯¹åº”çš„åŒ—äº¬æ—¶é—´æ˜¯2017-08-24 11:17:10SimpleDateFormat bjSdf = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\"); // åŒ—äº¬bjSdf.setTimeZone(TimeZone.getTimeZone(\"Asia/Shanghai\")); // è®¾ç½®åŒ—äº¬æ—¶åŒºSimpleDateFormat tokyoSdf = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\"); // ä¸œäº¬tokyoSdf.setTimeZone(TimeZone.getTimeZone(\"Asia/Tokyo\")); // è®¾ç½®ä¸œäº¬æ—¶åŒºSimpleDateFormat londonSdf = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\"); // ä¼¦æ•¦londonSdf.setTimeZone(TimeZone.getTimeZone(\"Europe/London\")); // è®¾ç½®ä¼¦æ•¦æ—¶åŒºSystem.out.println(\"æ¯«ç§’æ•°:\" + date.getTime() + \", åŒ—äº¬æ—¶é—´:\" + bjSdf.format(date));System.out.println(\"æ¯«ç§’æ•°:\" + date.getTime() + \", ä¸œäº¬æ—¶é—´:\" + tokyoSdf.format(date));System.out.println(\"æ¯«ç§’æ•°:\" + date.getTime() + \", ä¼¦æ•¦æ—¶é—´:\" + londonSdf.format(date)); è¾“å‡ºä¸ºï¼š æ¯«ç§’æ•°:1503544630000, åŒ—äº¬æ—¶é—´:2017-08-24 11:17:10 æ¯«ç§’æ•°:1503544630000, ä¸œäº¬æ—¶é—´:2017-08-24 12:17:10 æ¯«ç§’æ•°:1503544630000, ä¼¦æ•¦æ—¶é—´:2017-08-24 04:17:10 å¯ä»¥çœ‹å‡ºï¼ŒåŒä¸€ä¸ªDateå¯¹è±¡ï¼ŒæŒ‰ä¸åŒçš„æ—¶åŒºæ¥æ ¼å¼åŒ–ï¼Œå°†å¾—åˆ°ä¸åŒæ—¶åŒºçš„æ—¶é—´ã€‚ç”±æ­¤å¯è§ï¼ŒDateå¯¹è±¡é‡Œä¿å­˜çš„æ¯«ç§’æ•°å’Œå…·ä½“è¾“å‡ºçš„æ—¶é—´ï¼ˆå³å¹´æœˆæ—¥æ—¶åˆ†ç§’ï¼‰æ˜¯æ¨¡å‹å’Œè§†å›¾çš„å…³ç³»ï¼Œè€Œæ—¶åŒºï¼ˆå³Timezone)åˆ™å†³å®šäº†å°†åŒä¸€ä¸ªæ¨¡å‹å±•ç¤ºæˆä»€ä¹ˆæ ·çš„è§†å›¾ã€‚ 3.ä»å­—ç¬¦ä¸²ä¸­è¯»å–æ—¶é—´ æœ‰æ—¶æˆ‘ä»¬ä¼šé‡åˆ°ä»ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­è¯»å–æ—¶é—´çš„è¦æ±‚ï¼Œå³ä»å­—ç¬¦ä¸²ä¸­è§£ææ—¶é—´å¹¶å¾—åˆ°ä¸€ä¸ªDateå¯¹è±¡ï¼Œæ¯”å¦‚å°† â€œ2017-8-24 11:17:10â€ è§£æä¸ºä¸€ä¸ªDateå¯¹è±¡ã€‚ç°åœ¨é—®é¢˜æ¥äº†ï¼Œè¿™ä¸ªæ—¶é—´åˆ°åº•æŒ‡çš„æ˜¯åŒ—äº¬æ—¶é—´çš„2017å¹´8æœˆ24æ—¥11:17:10ï¼Œè¿˜æ˜¯ä¸œäº¬æ—¶é—´çš„2017å¹´8æœˆ24æ—¥11:17:10ï¼Ÿå¦‚æœæŒ‡çš„æ˜¯åŒ—äº¬æ—¶é—´ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶é—´å¯¹åº”çš„ä¸œäº¬æ—¶é—´2017å¹´8æœˆ24æ—¥12:17:10ï¼›å¦‚æœæŒ‡çš„æ˜¯ä¸œäº¬æ—¶é—´ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶é—´å¯¹åº”çš„åŒ—äº¬æ—¶é—´å°±æ˜¯2017å¹´8æœˆ24æ—¥10:17:10ã€‚å› æ­¤ï¼Œåªè¯´å¹´æœˆæ—¥æ—¶åˆ†ç§’è€Œä¸è¯´æ˜¯å“ªä¸ªæ—¶åŒºçš„ï¼Œæ˜¯æœ‰æ­§ä¹‰çš„ï¼Œæ²¡æœ‰æ­§ä¹‰çš„åšæ³•æ˜¯ï¼Œç»™å‡ºä¸€ä¸ªæ—¶é—´å­—ç¬¦ä¸²ï¼ŒåŒæ—¶æŒ‡æ˜è¿™æ˜¯å“ªä¸ªæ—¶åŒºçš„æ—¶é—´ã€‚ ä»å­—ç¬¦ä¸²ä¸­è§£ææ—¶é—´çš„æ­£ç¡®ä½œæ³•æ˜¯ï¼šæŒ‡å®šæ—¶åŒºæ¥è§£æã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š 12345String timeStr = \"2017-8-24 11:17:10\"; // å­—é¢æ—¶é—´SimpleDateFormat sdf = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\");sdf.setTimeZone(TimeZone.getTimeZone(\"Asia/Shanghai\")); // è®¾ç½®åŒ—äº¬æ—¶åŒºDate d = sdf.parse(timeStr);System.out.println(sdf.format(d) + \", \" + d.getTime()); è¾“å‡ºä¸ºï¼š 2017-08-24 11:17:10, 1503544630000, å°†ä¸€ä¸ªæ—¶é—´å­—ç¬¦ä¸²æŒ‰ä¸åŒæ—¶åŒºæ¥è§£é‡Šï¼Œå¾—åˆ°çš„Dateå¯¹è±¡çš„å€¼æ˜¯ä¸åŒçš„ã€‚éªŒè¯å¦‚ä¸‹ï¼š 123456789101112131415String timeStr = \"2017-8-24 11:17:10\"; // å­—é¢æ—¶é—´SimpleDateFormat bjSdf = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\");bjSdf.setTimeZone(TimeZone.getTimeZone(\"Asia/Shanghai\"));Date bjDate = bjSdf.parse(timeStr); // è§£æSystem.out.println(\"å­—é¢æ—¶é—´: \" + timeStr +\",æŒ‰åŒ—äº¬æ—¶é—´æ¥è§£é‡Š:\" + bjSdf.format(bjDate) + \", \" + bjDate.getTime());SimpleDateFormat tokyoSdf = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\"); // ä¸œäº¬tokyoSdf.setTimeZone(TimeZone.getTimeZone(\"Asia/Tokyo\")); // è®¾ç½®ä¸œäº¬æ—¶åŒºDate tokyoDate = tokyoSdf.parse(timeStr); // è§£æSystem.out.println(\"å­—é¢æ—¶é—´: \" + timeStr +\",æŒ‰ä¸œäº¬æ—¶é—´æ¥è§£é‡Š:\" + tokyoSdf.format(tokyoDate) + \", \" + tokyoDate.getTime()); è¾“å‡ºä¸ºï¼š å­—é¢æ—¶é—´: 2017-8-24 11:17:10,æŒ‰åŒ—äº¬æ—¶é—´æ¥è§£é‡Š:2017-08-24 11:17:10, 1503544630000 å­—é¢æ—¶é—´: 2017-8-24 11:17:10,æŒ‰ä¸œäº¬æ—¶é—´æ¥è§£é‡Š:2017-08-24 11:17:10, 1503541030000 å¯ä»¥çœ‹å‡ºï¼Œå¯¹äºâ€2017-8-24 11:17:10â€è¿™ä¸ªå­—ç¬¦ä¸²ï¼ŒæŒ‰åŒ—äº¬æ—¶é—´æ¥è§£é‡Šå¾—åˆ°Dateå¯¹è±¡çš„æ¯«ç§’æ•°æ˜¯ 1503544630000ï¼›è€ŒæŒ‰ä¸œäº¬æ—¶é—´æ¥è§£é‡Šå¾—åˆ°çš„æ¯«ç§’æ•°æ˜¯1503541030000ï¼Œå‰è€…æ­£å¥½æ¯”åè€…å¤§äº3600000æ¯«ç§’å³1ä¸ªå°æ—¶ï¼Œæ­£å¥½æ˜¯åŒ—äº¬æ—¶é—´å’Œä¸œäº¬æ—¶é—´çš„æ—¶å·®ã€‚è¿™å¾ˆå¥½ç†è§£ï¼ŒåŒ—äº¬æ—¶é—´2017-08-24 11:17:10å¯¹åº”çš„æ¯«ç§’æ•°æ˜¯1503544630000ï¼Œè€Œä¸œäº¬æ—¶é—´2017-08-24 11:17:10å¯¹åº”çš„åŒ—äº¬æ—¶é—´å…¶å®æ˜¯2017-08-24 10:17:10ï¼ˆå› ä¸ºåŒ—äº¬æ—¶é—´æ¯”ä¸œäº¬æ—¶é—´æ™š1ä¸ªå°æ—¶ï¼‰ï¼ŒåŒ—äº¬æ—¶é—´2017-08-24 10:17:10è‡ªç„¶æ¯”åŒ—äº¬æ—¶é—´2017-08-24 11:17:10å°‘3600000æ¯«ç§’ã€‚ 4.å°†å­—ç¬¦ä¸²è¡¨ç¤ºçš„æ—¶é—´è½¬æ¢æˆå¦ä¸€ä¸ªæ—¶åŒºçš„æ—¶é—´å­—ç¬¦ä¸² ç»¼åˆä»¥ä¸Šåˆ†æï¼Œå¦‚æœç»™å®šä¸€ä¸ªæ—¶é—´å­—ç¬¦ä¸²ï¼Œå¹¶å‘Šè¯‰ä½ è¿™æ˜¯æŸä¸ªæ—¶åŒºçš„æ—¶é—´ï¼Œè¦å°†å®ƒè½¬æ¢ä¸ºå¦ä¸€ä¸ªæ—¶åŒºçš„æ—¶é—´å¹¶è¾“å‡ºï¼Œæ­£ç¡®çš„åšæ³•æ˜¯ï¼š 1.å°†å­—ç¬¦ä¸²æŒ‰åŸæ—¶åŒºè½¬æ¢æˆDateå¯¹è±¡ï¼› 2.å°†Dateå¯¹è±¡æ ¼å¼åŒ–æˆç›®æ ‡æ—¶åŒºçš„æ—¶é—´ã€‚ æ¯”å¦‚ï¼Œå°†åŒ—äº¬æ—¶é—´â€2017-8-24 11:17:10 â€œè¾“å‡ºæˆä¸œäº¬æ—¶é—´ï¼Œä»£ç ä¸ºï¼š 123456789String timeStr = \"2017-8-24 11:17:10\"; // å­—é¢æ—¶é—´SimpleDateFormat bjSdf = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\");bjSdf.setTimeZone(TimeZone.getTimeZone(\"Asia/Shanghai\"));Date date = bjSdf.parse(timeStr); // å°†å­—ç¬¦ä¸²æ—¶é—´æŒ‰åŒ—äº¬æ—¶é—´è§£ææˆDateå¯¹è±¡SimpleDateFormat tokyoSdf = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\"); // ä¸œäº¬tokyoSdf.setTimeZone(TimeZone.getTimeZone(\"Asia/Tokyo\")); // è®¾ç½®ä¸œäº¬æ—¶åŒºSystem.out.println(\"åŒ—äº¬æ—¶é—´: \" + timeStr +\"å¯¹åº”çš„ä¸œäº¬æ—¶é—´ä¸º:\" + tokyoSdf.format(date)); è¾“å‡ºä¸ºï¼š åŒ—äº¬æ—¶é—´:2017-8-24 11:17:10å¯¹åº”çš„ä¸œäº¬æ—¶é—´ä¸º:2017-08-24 12:17:10","categories":[],"tags":[]},{"title":"å·¥å…·ä½¿ç”¨-jupyter","slug":"å·¥å…·ä½¿ç”¨-jupyter","date":"2020-10-30T08:40:52.000Z","updated":"2020-10-30T08:45:50.890Z","comments":true,"path":"post/å·¥å…·ä½¿ç”¨-jupyter/","link":"","permalink":"https://shang.at/post/å·¥å…·ä½¿ç”¨-jupyter/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š å¦‚ä½•åœ¨Jupyter notebookä¸­debugï¼Ÿåœ¨éœ€è¦breakpointçš„åœ°æ–¹æ’å…¥import pdb; pdb.set_trace()ï¼Œè¿è¡Œåä¼šè¿›å…¥debuggerï¼Œæœ‰ä¸€ä¸ªäº¤äº’ç•Œé¢ã€‚ è„šæœ¬æ§åˆ¶æ¸…ç©ºoutput12345from IPython.display import clear_outputfor i in range(10): clear_output(wait=True) print(\"Hello World!\")","categories":[{"name":"jupyter","slug":"jupyter","permalink":"https://shang.at/categories/jupyter/"}],"tags":[{"name":"å·¥å…·ä½¿ç”¨","slug":"å·¥å…·ä½¿ç”¨","permalink":"https://shang.at/tags/å·¥å…·ä½¿ç”¨/"}]},{"title":"å·¥å…·ä½¿ç”¨-idea","slug":"å·¥å…·ä½¿ç”¨-idea","date":"2020-10-29T05:51:45.000Z","updated":"2020-12-11T08:04:43.562Z","comments":true,"path":"post/å·¥å…·ä½¿ç”¨-idea/","link":"","permalink":"https://shang.at/post/å·¥å…·ä½¿ç”¨-idea/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š è°ƒæ•´æ³¨é‡Šçš„é¢œè‰² è°ƒæ•´å•è¯ é€‰ä¸­ä¹‹å ç›¸åŒå•è¯çš„é¢œè‰²","categories":[{"name":"idea","slug":"idea","permalink":"https://shang.at/categories/idea/"}],"tags":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://shang.at/tags/å·¥å…·/"}]},{"title":"ç¨‹åºè®¾è®¡æ€æƒ³-æ± åŒ–æ€æƒ³","slug":"ç¨‹åºè®¾è®¡æ€æƒ³-æ± åŒ–æ€æƒ³","date":"2020-10-23T00:00:48.000Z","updated":"2020-10-23T01:34:19.987Z","comments":true,"path":"post/ç¨‹åºè®¾è®¡æ€æƒ³-æ± åŒ–æ€æƒ³/","link":"","permalink":"https://shang.at/post/ç¨‹åºè®¾è®¡æ€æƒ³-æ± åŒ–æ€æƒ³/","excerpt":"ç®€ä»‹ï¼šä¸ºäº†æé«˜ç¨‹åºçš„æ€§èƒ½ï¼Œåœ¨è®¾è®¡ä¸­å¾ˆå·§å¦™çš„ä½¿ç”¨äº†æ± åŒ–çš„æ€æƒ³ï¼ŒåŒ…æ‹¬çº¿ç¨‹æ± ã€è¿æ¥æ± ã€å†…å­˜æ± ","text":"ç®€ä»‹ï¼šä¸ºäº†æé«˜ç¨‹åºçš„æ€§èƒ½ï¼Œåœ¨è®¾è®¡ä¸­å¾ˆå·§å¦™çš„ä½¿ç”¨äº†æ± åŒ–çš„æ€æƒ³ï¼ŒåŒ…æ‹¬çº¿ç¨‹æ± ã€è¿æ¥æ± ã€å†…å­˜æ±  çº¿ç¨‹æ± å¯¹çº¿ç¨‹è¿›è¡Œæ± åŒ–ç®¡ç†ï¼Œå¯ä»¥å®ç°å¯¹çº¿ç¨‹çš„å¤ç”¨ï¼Œé¿å…å¤§é‡åˆ›å»ºçº¿ç¨‹çš„èµ„æºæµªè´¹ ç–‘é—®ï¼šæ¯ä¸ªtaskç»“æŸä¹‹åï¼Œçº¿ç¨‹æ˜¯å¦‚ä½•å¤ç”¨çš„å‘¢ï¼Ÿ è¿æ¥æ± å†…å­˜æ± å¯¹å†…å­˜è¿›è¡Œæ± åŒ–ç®¡ç†ï¼Œå¯ä»¥å®ç°å¯¹å†…å­˜çš„é‡å¤ä½¿ç”¨ï¼Œå¯¹äºjavaç­‰ä¸€ç³»åˆ—éœ€è¦GCçš„è¯­è¨€æ¥è¯´ï¼Œå¯ä»¥èŠ‚çœå¤§é‡GCçš„æ—¶é—´ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šæé«˜ç¨‹åºçš„è¿è¡Œæ•ˆç‡","categories":[{"name":"æ± åŒ–","slug":"æ± åŒ–","permalink":"https://shang.at/categories/æ± åŒ–/"}],"tags":[{"name":"ç¨‹åºè®¾è®¡","slug":"ç¨‹åºè®¾è®¡","permalink":"https://shang.at/tags/ç¨‹åºè®¾è®¡/"}]},{"title":"javaå­¦ä¹ -åŸºç¡€3-å¯¹è±¡å†…å­˜å¸ƒå±€","slug":"javaå­¦ä¹ -åŸºç¡€3-å¯¹è±¡å†…å­˜å¸ƒå±€","date":"2020-09-27T23:56:58.000Z","updated":"2020-12-11T08:21:32.601Z","comments":true,"path":"post/javaå­¦ä¹ -åŸºç¡€3-å¯¹è±¡å†…å­˜å¸ƒå±€/","link":"","permalink":"https://shang.at/post/javaå­¦ä¹ -åŸºç¡€3-å¯¹è±¡å†…å­˜å¸ƒå±€/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š","categories":[{"name":"JAVAå­¦ä¹ ","slug":"JAVAå­¦ä¹ ","permalink":"https://shang.at/categories/JAVAå­¦ä¹ /"}],"tags":[{"name":"å¯¹è±¡å†…å­˜å¸ƒå±€","slug":"å¯¹è±¡å†…å­˜å¸ƒå±€","permalink":"https://shang.at/tags/å¯¹è±¡å†…å­˜å¸ƒå±€/"}]},{"title":"å·¥å…·ä½¿ç”¨-gitlab","slug":"å·¥å…·ä½¿ç”¨-gitlab","date":"2020-09-11T06:52:31.000Z","updated":"2020-12-22T15:18:08.734Z","comments":true,"path":"post/å·¥å…·ä½¿ç”¨-gitlab/","link":"","permalink":"https://shang.at/post/å·¥å…·ä½¿ç”¨-gitlab/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š Local repoï¼šå°±æ˜¯å­˜åœ¨ä½ æœ¬åœ°çš„ä»“åº“ï¼›Remote repoï¼šå°±æ˜¯ä¿å­˜åœ¨è¿œç«¯çš„ä»“åº“ï¼Œä¸¤è€…çš„å†…å®¹åœ¨æŸäº›æ—¶å€™æ˜¯ä¸ä¸€æ ·çš„ï¼Œéœ€è¦æ‰‹åŠ¨å»ä¿æŒä¸€è‡´ localå’Œremoteçš„å…³ç³»ï¼šç¬¬ä¸€æ¬¡ä»remoteå°†ä»“åº“å…‹éš†åˆ°æœ¬åœ°çš„æ—¶å€™ï¼Œæœ¬åœ°çš„repoå’Œè¿œç«¯çš„ä¸€æ¨¡ä¸€æ ·ï¼Œå¦‚æœä½ åœ¨æœ¬åœ°åˆ›å»ºäº†æ–°çš„åˆ†æ”¯ï¼Œé‚£ä¹ˆåœ¨ä½ æ‰§è¡Œgit pushä¹‹å‰ï¼Œremote repoæ˜¯æ²¡æœ‰ä½ åˆ›å»ºçš„åˆ†æ”¯çš„ã€‚åŒæ ·çš„å¦‚æœæœ‰å…¶ä»–äººåˆ›å»ºäº†åˆ†æ”¯å¹¶ä¸”pushåˆ°äº†remote repoï¼Œä½ æœ¬åœ°ä¹Ÿæ˜¯ä¸çŸ¥é“çš„ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦æ‰§è¡Œgit fetchå»æ›´æ–°ä½ æœ¬åœ°çš„repoã€‚ æ–°å»ºrepo1234567891011121314151617181920212223242526# Git global setupgit config --global user.name \"xxx\"git config --global user.email \"xxx@abc.com\"# Create a new repositorygit clone git_urlcd atome-id-apaylater-data-warehousetouch README.mdgit add README.mdgit commit -m \"add README\"git push -u origin master# Push an existing foldercd existing_foldergit initgit remote add origin git_urlgit add .git commit -m \"Initial commit\"git push -u origin master# Push an existing Git repositorycd existing_repogit remote rename origin old-origingit remote add origin git_urlgit push -u origin --allgit push -u origin --tags å¸¸ç”¨æ“ä½œæŸ¥çœ‹æœ¬åœ°åˆ†æ”¯ï¼šgit branch æŸ¥çœ‹å…¨éƒ¨åˆ†æ”¯ï¼šgit branch -a åˆ é™¤æœ¬åœ°åˆ†æ”¯ï¼šgit branch -d branchName å¼ºåˆ¶åˆ é™¤æœ¬åœ°åˆ†æ”¯ï¼šgit branch -D branchName åˆ‡æ¢åˆ†æ”¯ï¼šgit checkout branchName åŸºäºå½“å‰åˆ†æ”¯åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ†æ”¯ï¼šgit checkout -b newBranch æš‚å­˜æœ¬åœ°ä¿®æ”¹ï¼ˆä¿®æ”¹äº†æœ¬åœ°æ–‡ä»¶ï¼Œä½†æ˜¯åˆä¸æƒ³æäº¤ã€‚æ…ç”¨ï¼‰ï¼šgit stash é‡Šæ”¾ æš‚å­˜çš„æœ¬åœ°ä¿®æ”¹ï¼šgit stash pop æŸ¥çœ‹local repo çš„çŠ¶æ€ï¼šgit status å°†ä¿®æ”¹çš„æ–‡ä»¶æ·»åŠ åˆ°local repoï¼ˆtrackedï¼‰ï¼šgit add . æˆ–git add æ–‡ä»¶å å°†ä¿®æ”¹çš„æ–‡ä»¶æäº¤åˆ°local repoï¼šgit commit -m â€˜msgâ€™ åˆå¹¶åˆ†æ”¯ï¼šgit merge æ›´æ–°æœ¬åœ°repoï¼šgit fetch git pullä¸git fetchçš„æ›´è¯¦ç»†çš„è§£è¯» å·¥ä½œä¸­å¸¸ç”¨çš„æ“ä½œæ­¥éª¤ï¼š åˆ›å»ºè‡ªå·±çš„åˆ†æ”¯ å¼€å‘ä»£ç  æ‰§è¡Œ git addå’Œgit commitå‘½ä»¤ï¼Œå°†ä¿®æ”¹æäº¤åˆ°localçš„åˆ†æ”¯ä¸­ï¼ˆè¿™ä¸ªæ—¶å€™remoteæ˜¯æ²¡æœ‰è¿™ä¸ªåˆ†æ”¯çš„ï¼‰ åˆ‡å›masteråˆ†æ”¯ï¼Œæ›´æ–°masterä»£ç  åˆ‡å›è‡ªå·±çš„åˆ†æ”¯ï¼Œå°†masteråˆ†æ”¯mergeåˆ°è‡ªå·±çš„åˆ†æ”¯ï¼Œé¡ºä¾¿è§£å†³å†²çªï¼ˆå†²çªæ˜¯ä¸¤ä¸ªäººåŒæ—¶ä¿®æ”¹åŒä¸€ä¸ªæ–‡ä»¶çš„æ—¶å€™å¯èƒ½ä¼šå‘ç”Ÿçš„ï¼Œä¸€èˆ¬å¾ˆå°‘ä¼šå‘ç”Ÿå†²çªï¼‰ å¯èƒ½éœ€è¦ç»§ç»­æ‰§è¡Œgit add å’Œ git commit å°†æœ¬åœ°åˆ†æ”¯æ¨åˆ°remoteï¼šgit push åˆ°webç«¯æäº¤MR ç”¨rebase -i æ±‡åˆæäº¤è¿›å…¥ä¸€ä¸ªrepoç›®å½•ï¼Œä½¿ç”¨git logå¯ä»¥æŸ¥çœ‹æ¯æ¬¡commitçš„è®°å½• ç„¶åä½¿ç”¨git rebase -i HEAD~~å‘½ä»¤è¿›å…¥æ±‡åˆæäº¤é¡µé¢(å¯ä»¥ä½¿ç”¨vimç¼–è¾‘çš„çŠ¶æ€) æ¯æ¬¡rebaseåªèƒ½æŠŠå½“å‰çš„commitåˆå¹¶åˆ°å‰ä¸€ä¸ªcommitä¸Šï¼Œç¼–è¾‘çŠ¶æ€å¦‚ä¸‹ 12345678910111213141516pick 9a54fd4 æ·»åŠ commitçš„è¯´æ˜pick 0d4a808 æ·»åŠ pullçš„è¯´æ˜# Rebase 326fc9f..0d4a808 onto d286baa## Commands:# p, pick = use commit# r, reword = use commit, but edit the commit message# e, edit = use commit, but stop for amending# s, squash = use commit, but meld into previous commit# f, fixup = like \"squash\", but discard this commit's log message# x, exec = run command (the rest of the line) using shell## If you remove a line here THAT COMMIT WILL BE LOST.# However, if you remove everything, the rebase will be aborted.# å°†ç¬¬äºŒè¡Œçš„pickæ”¹æˆsquashä¿å­˜å³å¯ã€‚ å†æ¬¡ä½¿ç”¨git logæŸ¥çœ‹commit log gitå¦‚ä½•åˆ é™¤å·²ç» add çš„æ–‡ä»¶ä½¿ç”¨ git rm å‘½ä»¤å³å¯ï¼Œæœ‰ä¸¤ç§é€‰æ‹©, ä¸€ç§æ˜¯ git rm â€”cached â€œæ–‡ä»¶è·¯å¾„â€ï¼Œä¸åˆ é™¤ç‰©ç†æ–‡ä»¶ï¼Œä»…å°†è¯¥æ–‡ä»¶ä»ç¼“å­˜ä¸­åˆ é™¤ï¼› ä¸€ç§æ˜¯ git rm â€”f â€œæ–‡ä»¶è·¯å¾„â€ï¼Œä¸ä»…å°†è¯¥æ–‡ä»¶ä»ç¼“å­˜ä¸­åˆ é™¤ï¼Œè¿˜ä¼šå°†ç‰©ç†æ–‡ä»¶åˆ é™¤ï¼ˆä¸ä¼šå›æ”¶åˆ°åƒåœ¾æ¡¶ï¼‰ã€‚ å¦‚ä½•å¦‚ä½•æ›´æ–°forkçš„repositoryé¦–å…ˆï¼Œæ£€æŸ¥ä¸€ä¸‹å½“å‰çš„é…ç½®ï¼Œçœ‹çœ‹å½“å‰æœ‰æ²¡æœ‰å·²ç»è®¾ç½®äº†ä¸Šæ¸¸ï¼Œè¿™è¦ä½¿ç”¨ git remote -v å‘½ä»¤ã€‚å¦‚ä¸‹ï¼š git remote -v origin https://github.com/YOUR_USERNAME/YOUR_FORK.git (fetch) origin https://github.com/YOUR_USERNAME/YOUR_FORK.git (push) ä»¥ä¸Šè¡¨æ˜ï¼Œoriginè¿™ä¸ªrepositoryå¯¹åº”çš„æ˜¯è¿œç«¯çš„httpså¼€å¤´çš„è¿™ä¸ªé“¾æ¥æŒ‡å‘çš„repositoryï¼Œå³è‡ªå·±forkå‡ºçš„repository. ç¬¬äºŒæ­¥ï¼Œå°†åŸrepositoryè®¾ç½®ä¸ºè‡ªå·±forkå‡ºçš„repositoryçš„ä¸Šæ¸¸ï¼ˆupstreamï¼‰ã€‚è¿ç”¨å¦‚ä¸‹çš„å‘½ä»¤ï¼š $git remote add upstream https://github.com/ORIGINAL_OWNER/ORIGINAL_REPOSITORY.git è¿ç”¨ç¬¬ä¸€æ­¥ä¸­æåˆ°çš„git remove -vå‘½ä»¤å†æ¬¡æ£€æŸ¥ä¸€ä¸‹ï¼Œç»“æœå¦‚ä¸‹ï¼š $git remote -v origin https://github.com/YOUR_USERNAME/YOUR_FORK.git (fetch) origin https://github.com/YOUR_USERNAME/YOUR_FORK.git (push) upstream https://github.com/ORIGINAL_OWNER/ORIGINAL_REPOSITORY.git (fetch) upstream https://github.com/ORIGINAL_OWNER/ORIGINAL_REPOSITORY.git (push) ç¬¬ä¸‰æ­¥ï¼Œè¿è¡Œ git fetch upstream å‘½ä»¤ï¼Œå¦‚ä¸‹ï¼š $git fetch upstream remote: Counting objects: 75, done. remote: Compressing objects: 100% (53/53), done. remote: Total 62 (delta 27), reused 44 (delta 9) Unpacking objects: 100% (62/62), done. From https://github.com/ORIGINAL_OWNER/ORIGINAL_REPOSITORY * [new branch] master -&gt; upstream/master ä»¥ä¸Šè¡¨æ˜ï¼Œè¿œç¨‹çš„åŸrepositoryä¸Šç¡®å®æœ‰ä¸€äº›æ›´æ–°ï¼Œç°åœ¨å®ƒä»¬å·²ç»è¢«downloadåˆ°æœ¬åœ°çš„.gitæ–‡ä»¶å¤¹ä¸‹äº†ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰åˆå¹¶åˆ°æœ¬åœ°çš„ä»£ç ä¸­ã€‚ ç¬¬å››æ­¥ï¼Œgit checkout masterï¼Œè¿™æ˜¯ä¿è¯åˆ‡æ¢åˆ°æœ¬åœ°çš„repositoryçš„masterä¸Šï¼Œå¦‚æœæœ¬æ¥å°±åœ¨ï¼Œé‚£ä¹ˆè¿™ä¸€æ­¥ä¸æ˜¯å¿…é¡»çš„ã€‚ ç¬¬äº”æ­¥ï¼Œè¿è¡Œ git merge upstream/master å‘½ä»¤ï¼Œå°†upstream/masterä¸Šçš„æ›´æ–°åˆå¹¶åˆ°æœ¬åœ°çš„masterä¸Šï¼Œå…¶å®å°±æ˜¯å°†ç¬¬ä¸‰æ­¥ä¸­downloadåˆ°.gitæ–‡ä»¶å¤¹ä¸‹çš„é‚£äº›changeåˆå¹¶åˆ°æœ¬åœ°çš„masterä¸­ã€‚å¦‚ä¸‹ï¼š $git merge upstream/master Updating a422352..5fdff0f Fast-forward README | 9 â€”â€”â€”- README.md | 7 ++++++ 2 files changed, 7 insertions(+), 9 deletions(-) delete mode 100644 README create mode 100644 README.md å¦‚æœæœ¬åœ°æ²¡æœ‰ä»€ä¹ˆè‡ªå·±ç‹¬ç«‹çš„æ›´æ–°çš„è¯ï¼Œé‚£ä¹ˆå°†æ‰§è¡Œâ€Fast-forwardâ€çš„åˆå¹¶ã€‚å¦‚æœæœ¬åœ°æœ‰è‡ªå·±ç‹¬ç«‹çš„æ›´æ–°ï¼Œè€Œåˆä¼šå¼•èµ·å†²çªçš„è¯ï¼Œåˆ™è¦è§£å†³å†²çªï¼Œå†commit. å…³äºè§£å†³å†²çªï¼Œå¦‚æœæ˜ç¡®æ‰€æœ‰å†²çªéƒ½æ˜¯ä½¿ç”¨upstream/masterä¸Šçš„æ¥overrideè‡ªå·±çš„ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥è¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œåˆ™æ— éœ€è§£å†³å†²çªäº† git merge -X theirs upstream/master æ³¨æ„ï¼Œä»¥ä¸Šæ­¥éª¤ç»“æŸåï¼Œä»…ä»…æ˜¯æœ¬åœ°çš„forkå‡ºçš„repositoryå’ŒåŸrepositoryå–å¾—äº†åŒæ­¥ï¼Œå¦‚æœæƒ³è®©è¿œç¨‹çš„forkå‡ºçš„repositoryä¹ŸåŒæ ·å–å¾—åŒæ­¥ï¼Œå¿…é¡»å†git pushä¸Šå»ã€‚ submodule åˆ›å»ºä¸€ä¸ªrepoï¼štest_1 1234git clone git@repo.advai.net:shang.wang/test_1.gittouch README.mdgit commit -m \"1\"git push -u origin master åˆ›å»ºä¸€ä¸ªlib repoï¼štest_2 1234git clone git@repo.advai.net:shang.wang/test_2.gittouch README.mdgit commit -m &quot;1&quot;git push -u origin master å°†test_2ä½œä¸ºsubmoduleæ·»åŠ åˆ°test_1ä¸­ 1git submodule add git@repo.advai.net:shang.wang/test_2.git test_lib æäº¤test_1 12345cd test_1git add .git commit -m &apos;2&apos;git submodule initgit push ä¿®æ”¹test_2 12345cd test_2echo &quot;123445&quot; &gt; test.txtgit add .git commit -m &apos;3&apos;git push åœ¨test_1ä¸­æ›´æ–°test_2 12cd test_2git submodule foreach git pull cloneä¸€ä¸ªå¸¦æœ‰submoduleçš„repo 1234567891ã€cloneçˆ¶repoçš„æ—¶å€™ç›´æ¥clonesubmodulegit clone git@repo.advai.net:shang.wang/test_1.git ttttt --recursive2ã€cloneå®Œçˆ¶repoä¹‹åï¼Œå†åˆå§‹åŒ–submodulegit clone git@repo.advai.net:shang.wang/test_1.gitcd test_1git submodule initgit submodule update åˆ é™¤submodule 123456789cd test_1git rm --cached test_librm -rf test_librm .gitmodulesåˆ é™¤gité…ç½®æ–‡ä»¶configä¸­å…³äºsubmoduleçš„ä¿¡æ¯vim .git/config æ‰¾åˆ°submoduleçš„éƒ¨åˆ† åˆ æ‰git commit -a -m 'del submodule' æŸ¥çœ‹ä»“åº“ä¸­çš„submodule 1git submodule","categories":[{"name":"å·¥å…·ä½¿ç”¨","slug":"å·¥å…·ä½¿ç”¨","permalink":"https://shang.at/categories/å·¥å…·ä½¿ç”¨/"}],"tags":[{"name":"gitlab","slug":"gitlab","permalink":"https://shang.at/tags/gitlab/"}]},{"title":"Linux-ä½¿ç”¨é—®ç­”","slug":"Linux-ä½¿ç”¨é—®ç­”","date":"2020-09-10T08:12:59.000Z","updated":"2020-09-10T08:14:14.808Z","comments":true,"path":"post/Linux-ä½¿ç”¨é—®ç­”/","link":"","permalink":"https://shang.at/post/Linux-ä½¿ç”¨é—®ç­”/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š ä»€ä¹ˆæ˜¯Linux?é—®ï¼šä»€ä¹ˆæ˜¯Linux? ç­”ï¼šå¼€æºçš„æ“ä½œç³»ç»Ÿï¼Œé€šè¿‡ä»£ç æ¥å¼•å¯¼è®¡ç®—æœºæ‰§è¡Œå‘½ä»¤ ç­”ï¼šLinuxæ˜¯ä¸€å¥—å…è´¹ä½¿ç”¨å’Œè‡ªç”±ä¼ æ’­çš„ç±»Unixæ“ä½œç³»ç»Ÿï¼Œæ˜¯ä¸€ä¸ªåŸºäºPOSIXå’ŒUnixçš„å¤šç”¨æˆ·ã€å¤šä»»åŠ¡ã€æ”¯æŒå¤šçº¿ç¨‹å’Œå¤šCPUçš„æ“ä½œç³»ç»Ÿã€‚å®ƒèƒ½è¿è¡Œä¸»è¦çš„Unixå·¥å…·è½¯ä»¶ã€åº”ç”¨ç¨‹åºå’Œç½‘ç»œåè®®ã€‚å®ƒæ”¯æŒ32ä½å’Œ64ä½ç¡¬ä»¶ã€‚Linuxç»§æ‰¿äº†Unixä»¥ç½‘ç»œä¸ºæ ¸å¿ƒçš„è®¾è®¡æ€æƒ³ï¼Œæ˜¯ä¸€ä¸ªæ€§èƒ½ç¨³å®šçš„å¤šç”¨æˆ·ç½‘ç»œæ“ä½œç³»ç»Ÿã€‚ Unixå’ŒLinuxæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿé—®ï¼šUnixå’ŒLinuxæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ ç­”ï¼šLinuxå’ŒUnixéƒ½æ˜¯åŠŸèƒ½å¼ºå¤§çš„æ“ä½œç³»ç»Ÿï¼Œéƒ½æ˜¯åº”ç”¨å¹¿æ³›çš„æœåŠ¡å™¨æ“ä½œç³»ç»Ÿï¼Œæœ‰å¾ˆå¤šç›¸ä¼¼ä¹‹å¤„ï¼Œç”šè‡³æœ‰ä¸€éƒ¨åˆ†äººé”™è¯¯åœ°è®¤ä¸ºUnixå’ŒLinuxæ“ä½œç³»ç»Ÿæ˜¯ä¸€æ ·çš„ï¼Œç„¶è€Œï¼Œäº‹å®å¹¶éå¦‚æ­¤ï¼Œä»¥ä¸‹æ˜¯ä¸¤è€…çš„åŒºåˆ«ã€‚å¼€æºæ€§ Linuxæ˜¯ä¸€æ¬¾å¼€æºæ“ä½œç³»ç»Ÿï¼Œä¸éœ€è¦ä»˜è´¹ï¼Œå³å¯ä½¿ç”¨ï¼›Unixæ˜¯ä¸€æ¬¾å¯¹æºç å®è¡ŒçŸ¥è¯†äº§æƒä¿æŠ¤çš„ä¼ ç»Ÿå•†ä¸šè½¯ä»¶ï¼Œä½¿ç”¨éœ€è¦ä»˜è´¹æˆæƒä½¿ç”¨ã€‚è·¨å¹³å°æ€§ Linuxæ“ä½œç³»ç»Ÿå…·æœ‰è‰¯å¥½çš„è·¨å¹³å°æ€§èƒ½ï¼Œå¯è¿è¡Œåœ¨å¤šç§ç¡¬ä»¶å¹³å°ä¸Šï¼›Unixæ“ä½œç³»ç»Ÿè·¨å¹³å°æ€§èƒ½è¾ƒå¼±ï¼Œå¤§å¤šéœ€ä¸ç¡¬ä»¶é…å¥—ä½¿ç”¨ã€‚å¯è§†åŒ–ç•Œé¢ Linuxé™¤äº†è¿›è¡Œå‘½ä»¤è¡Œæ“ä½œï¼Œè¿˜æœ‰çª—ä½“ç®¡ç†ç³»ç»Ÿï¼›Unixåªæ˜¯å‘½ä»¤è¡Œä¸‹çš„ç³»ç»Ÿã€‚ç¡¬ä»¶ç¯å¢ƒ Linuxæ“ä½œç³»ç»Ÿå¯¹ç¡¬ä»¶çš„è¦æ±‚è¾ƒä½ï¼Œå®‰è£…æ–¹æ³•æ›´æ˜“æŒæ¡ï¼›Unixå¯¹ç¡¬ä»¶è¦æ±‚æ¯”è¾ƒè‹›åˆ»ï¼ŒæŒ‰ç…§éš¾åº¦è¾ƒå¤§ã€‚ç”¨æˆ·ç¾¤ä½“ Linuxçš„ç”¨æˆ·ç¾¤ä½“å¾ˆå¹¿æ³›ï¼Œä¸ªäººå’Œä¼ä¸šå‡å¯ä½¿ç”¨ï¼›Unixçš„ç”¨æˆ·ç¾¤ä½“æ¯”è¾ƒçª„ï¼Œå¤šæ˜¯å®‰å…¨æ€§è¦æ±‚é«˜çš„å¤§å‹ä¼ä¸šä½¿ç”¨ï¼Œå¦‚é“¶è¡Œã€ç”µä¿¡éƒ¨é—¨ç­‰ï¼Œæˆ–è€…Unixç¡¬ä»¶å‚å•†ä½¿ç”¨ï¼Œå¦‚Sunç­‰ã€‚ ç›¸æ¯”äºUnixæ“ä½œç³»ç»Ÿï¼ŒLinuxæ“ä½œç³»ç»Ÿæ›´å—å¹¿å¤§è®¡ç®—æœºçˆ±å¥½è€…çš„å–œçˆ±ï¼Œä¸»è¦åŸå› æ˜¯Linuxæ“ä½œç³»ç»Ÿå…·æœ‰Unixæ“ä½œç³»ç»Ÿçš„å…¨éƒ¨åŠŸèƒ½ï¼Œå¹¶ä¸”èƒ½å¤Ÿåœ¨æ™®é€šPCè®¡ç®—æœºä¸Šå®ç°å…¨éƒ¨çš„Unixç‰¹æ€§ï¼Œå¼€æºå…è´¹çš„ç‰¹æ€§ï¼Œæ›´å®¹æ˜“æ™®åŠä½¿ç”¨ï¼ ä»€ä¹ˆæ˜¯ Linux å†…æ ¸ï¼Ÿé—®ï¼šä»€ä¹ˆæ˜¯ Linux å†…æ ¸ï¼Ÿ ç­”ï¼šä½œç”¨æ˜¯å°†åº”ç”¨å±‚åºçš„è¯·æ±‚ä¼ é€’ç»™ç¡¬ä»¶ï¼Œå¹¶å……å½“åº•å±‚é©±åŠ¨ç¨‹åºï¼Œå¯¹ç³»ç»Ÿä¸­çš„å„ç§è®¾å¤‡å’Œç»„ä»¶è¿›è¡Œå¯»å€ã€‚ ç­”ï¼šLinux ç³»ç»Ÿçš„æ ¸å¿ƒæ˜¯å†…æ ¸ã€‚å†…æ ¸æ§åˆ¶ç€è®¡ç®—æœºç³»ç»Ÿä¸Šçš„æ‰€æœ‰ç¡¬ä»¶å’Œè½¯ä»¶ï¼Œåœ¨å¿…è¦æ—¶åˆ†é…ç¡¬ä»¶ï¼Œå¹¶æ ¹æ®éœ€è¦æ‰§è¡Œè½¯ä»¶ã€‚ç³»ç»Ÿå†…å­˜ç®¡ç† åº”ç”¨ç¨‹åºç®¡ç† ç¡¬ä»¶è®¾å¤‡ç®¡ç† æ–‡ä»¶ç³»ç»Ÿç®¡ç† Linuxçš„åŸºæœ¬ç»„ä»¶æ˜¯ä»€ä¹ˆï¼Ÿé—®ï¼šLinuxçš„åŸºæœ¬ç»„ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ ç­”ï¼šå†…å­˜ç®¡ç†,è¿›ç¨‹ç®¡ç†,è¿›ç¨‹é—´é€šä¿¡,è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿå’Œç½‘ç»œæ¥å£ ç­”ï¼šå°±åƒä»»ä½•å…¶ä»–å…¸å‹çš„æ“ä½œç³»ç»Ÿä¸€æ ·ï¼ŒLinuxæ‹¥æœ‰æ‰€æœ‰è¿™äº›ç»„ä»¶ï¼šå†…æ ¸ï¼Œshellå’ŒGUIï¼Œç³»ç»Ÿå®ç”¨ç¨‹åºå’Œåº”ç”¨ç¨‹åºã€‚Linuxæ¯”å…¶ä»–æ“ä½œç³»ç»Ÿæ›´å…·ä¼˜åŠ¿çš„æ˜¯æ¯ä¸ªæ–¹é¢éƒ½é™„å¸¦å…¶ä»–åŠŸèƒ½ï¼Œæ‰€æœ‰ä»£ç éƒ½å¯ä»¥å…è´¹ä¸‹è½½ã€‚ Linux çš„ä½“ç³»ç»“æ„é—®ï¼šLinux çš„ä½“ç³»ç»“æ„ ç­”ï¼šä»å¤§çš„æ–¹é¢è®²ï¼ŒLinux ä½“ç³»ç»“æ„å¯ä»¥åˆ†ä¸ºä¸¤å—ï¼š ç”¨æˆ·ç©ºé—´(User Space) ï¼šç”¨æˆ·ç©ºé—´åˆåŒ…æ‹¬ç”¨æˆ·çš„åº”ç”¨ç¨‹åº(User Applications)ã€C åº“(C Library) ã€‚ å†…æ ¸ç©ºé—´(Kernel Space) ï¼šå†…æ ¸ç©ºé—´åˆåŒ…æ‹¬ç³»ç»Ÿè°ƒç”¨æ¥å£(System Call Interface)ã€å†…æ ¸(Kernel)ã€å¹³å°æ¶æ„ç›¸å…³çš„ä»£ç (Architecture-Dependent Kernel Code) ã€‚ ä¸ºä»€ä¹ˆ Linux ä½“ç³»ç»“æ„è¦åˆ†ä¸ºç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´çš„åŸå› ï¼Ÿé—®ï¼šä¸ºä»€ä¹ˆ Linux ä½“ç³»ç»“æ„è¦åˆ†ä¸ºç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´çš„åŸå› ï¼Ÿ ç­”ï¼š1ã€ç°ä»£ CPU å®ç°äº†ä¸åŒçš„å·¥ä½œæ¨¡å¼ï¼Œä¸åŒæ¨¡å¼ä¸‹ CPU å¯ä»¥æ‰§è¡Œçš„æŒ‡ä»¤å’Œè®¿é—®çš„å¯„å­˜å™¨ä¸åŒã€‚ 2ã€Linux ä» CPU çš„è§’åº¦å‡ºå‘ï¼Œä¸ºäº†ä¿æŠ¤å†…æ ¸çš„å®‰å…¨ï¼ŒæŠŠç³»ç»Ÿåˆ†æˆäº†ä¸¤éƒ¨åˆ†ã€‚ ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´æ˜¯ç¨‹åºæ‰§è¡Œçš„ä¸¤ç§ä¸åŒçš„çŠ¶æ€ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼å®Œæˆç”¨æˆ·ç©ºé—´åˆ°å†…æ ¸ç©ºé—´çš„è½¬ç§»ï¼š1ï¼‰ç³»ç»Ÿè°ƒç”¨ï¼›2ï¼‰ç¡¬ä»¶ä¸­æ–­ã€‚ BASHå’ŒDOSä¹‹é—´çš„åŸºæœ¬åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿé—®ï¼šBASHå’ŒDOSä¹‹é—´çš„åŸºæœ¬åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ ç­”ï¼šBASHå’ŒDOSæ§åˆ¶å°ä¹‹é—´çš„ä¸»è¦åŒºåˆ«åœ¨äº3ä¸ªæ–¹é¢ï¼šBASHå‘½ä»¤åŒºåˆ†å¤§å°å†™ï¼Œè€ŒDOSå‘½ä»¤åˆ™ä¸åŒºåˆ†; åœ¨BASHä¸‹ï¼Œ/ characteræ˜¯ç›®å½•åˆ†éš”ç¬¦ï¼Œ\\ä½œä¸ºè½¬ä¹‰å­—ç¬¦ã€‚åœ¨DOSä¸‹ï¼Œ/ç”¨ä½œå‘½ä»¤å‚æ•°åˆ†éš”ç¬¦ï¼Œ\\æ˜¯ç›®å½•åˆ†éš”ç¬¦ DOSéµå¾ªå‘½åæ–‡ä»¶ä¸­çš„çº¦å®šï¼Œå³8ä¸ªå­—ç¬¦çš„æ–‡ä»¶ååè·Ÿä¸€ä¸ªç‚¹ï¼Œæ‰©å±•åä¸º3ä¸ªå­—ç¬¦ã€‚BASHæ²¡æœ‰éµå¾ªè¿™æ ·çš„æƒ¯ä¾‹ã€‚ Linux å¼€æœºå¯åŠ¨è¿‡ç¨‹ï¼Ÿé—®ï¼šLinux å¼€æœºå¯åŠ¨è¿‡ç¨‹ï¼Ÿ ç­”ï¼š1ã€ä¸»æœºåŠ ç”µè‡ªæ£€ï¼ŒåŠ è½½ BIOS ç¡¬ä»¶ä¿¡æ¯ã€‚2ã€è¯»å– MBR çš„å¼•å¯¼æ–‡ä»¶(GRUBã€LILO)ã€‚3ã€å¼•å¯¼ Linux å†…æ ¸ã€‚4ã€è¿è¡Œç¬¬ä¸€ä¸ªè¿›ç¨‹ init (è¿›ç¨‹å·æ°¸è¿œä¸º 1 )ã€‚5ã€è¿›å…¥ç›¸åº”çš„è¿è¡Œçº§åˆ«ã€‚6ã€è¿è¡Œç»ˆç«¯ï¼Œè¾“å…¥ç”¨æˆ·åå’Œå¯†ç ã€‚ Linuxç³»ç»Ÿç¼ºçœçš„è¿è¡Œçº§åˆ«ï¼Ÿé—®ï¼šLinuxç³»ç»Ÿç¼ºçœçš„è¿è¡Œçº§åˆ«ï¼Ÿ ç­”ï¼šå…³æœºã€‚ å•æœºç”¨æˆ·æ¨¡å¼ã€‚ å­—ç¬¦ç•Œé¢çš„å¤šç”¨æˆ·æ¨¡å¼(ä¸æ”¯æŒç½‘ç»œ)ã€‚ å­—ç¬¦ç•Œé¢çš„å¤šç”¨æˆ·æ¨¡å¼ã€‚ æœªåˆ†é…ä½¿ç”¨ã€‚ å›¾å½¢ç•Œé¢çš„å¤šç”¨æˆ·æ¨¡å¼ã€‚ é‡å¯ã€‚ Linux ä½¿ç”¨çš„è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ï¼Ÿé—®ï¼šLinux ä½¿ç”¨çš„è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ï¼Ÿ ç­”ï¼š1ã€ç®¡é“(pipe)ã€æµç®¡é“(s_pipe)ã€æœ‰åç®¡é“(FIFO)ã€‚ 2ã€ä¿¡å·(signal) ã€‚ 3ã€æ¶ˆæ¯é˜Ÿåˆ—ã€‚ 4ã€å…±äº«å†…å­˜ã€‚ 5ã€ä¿¡å·é‡ã€‚ 6ã€å¥—æ¥å­—(socket) ã€‚ Linux æœ‰å“ªäº›ç³»ç»Ÿæ—¥å¿—æ–‡ä»¶ï¼Ÿé—®ï¼šLinux æœ‰å“ªäº›ç³»ç»Ÿæ—¥å¿—æ–‡ä»¶ï¼Ÿ ç­”ï¼šæ¯”è¾ƒé‡è¦çš„æ˜¯ /var/log/messages æ—¥å¿—æ–‡ä»¶ã€‚è¯¥æ—¥å¿—æ–‡ä»¶æ˜¯è®¸å¤šè¿›ç¨‹æ—¥å¿—æ–‡ä»¶çš„æ±‡æ€»ï¼Œä»è¯¥æ–‡ä»¶å¯ä»¥çœ‹å‡ºä»»ä½•å…¥ä¾µä¼å›¾æˆ–æˆåŠŸçš„å…¥ä¾µã€‚å¦å¤–ï¼Œå¦‚æœèƒ–å‹çš„ç³»ç»Ÿé‡Œæœ‰ ELK æ—¥å¿—é›†ä¸­æ”¶é›†ï¼Œå®ƒä¹Ÿä¼šè¢«æ”¶é›†è¿›å»ã€‚ Linuxç³»ç»Ÿå®‰è£…å¤šä¸ªæ¡Œé¢ç¯å¢ƒæœ‰å¸®åŠ©å—ï¼Ÿé—®ï¼šLinuxç³»ç»Ÿå®‰è£…å¤šä¸ªæ¡Œé¢ç¯å¢ƒæœ‰å¸®åŠ©å—ï¼Ÿ ç­”ï¼šé€šå¸¸ï¼Œä¸€ä¸ªæ¡Œé¢ç¯å¢ƒï¼Œå¦‚KDEæˆ–Gnomeï¼Œè¶³ä»¥åœ¨æ²¡æœ‰é—®é¢˜çš„æƒ…å†µä¸‹è¿è¡Œã€‚å°½ç®¡ç³»ç»Ÿå…è®¸ä»ä¸€ä¸ªç¯å¢ƒåˆ‡æ¢åˆ°å¦ä¸€ä¸ªç¯å¢ƒï¼Œä½†è¿™å¯¹ç”¨æˆ·æ¥è¯´éƒ½æ˜¯ä¼˜å…ˆè€ƒè™‘çš„é—®é¢˜ã€‚æœ‰äº›ç¨‹åºåœ¨ä¸€ä¸ªç¯å¢ƒä¸­å·¥ä½œè€Œåœ¨å¦ä¸€ä¸ªç¯å¢ƒä¸­æ— æ³•å·¥ä½œï¼Œå› æ­¤å®ƒä¹Ÿå¯ä»¥è¢«è§†ä¸ºé€‰æ‹©ä½¿ç”¨å“ªä¸ªç¯å¢ƒçš„ä¸€ä¸ªå› ç´ ã€‚ ä»€ä¹ˆæ˜¯äº¤æ¢ç©ºé—´ï¼Ÿé—®ï¼šä»€ä¹ˆæ˜¯äº¤æ¢ç©ºé—´ï¼Ÿ ç­”ï¼šäº¤æ¢ç©ºé—´æ˜¯Linuxä½¿ç”¨çš„ä¸€å®šç©ºé—´ï¼Œç”¨äºä¸´æ—¶ä¿å­˜ä¸€äº›å¹¶å‘è¿è¡Œçš„ç¨‹åºã€‚å½“RAMæ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜æ¥å®¹çº³æ­£åœ¨æ‰§è¡Œçš„æ‰€æœ‰ç¨‹åºæ—¶ï¼Œå°±ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚ ä»€ä¹ˆæ˜¯rootå¸æˆ·é—®ï¼šä»€ä¹ˆæ˜¯rootå¸æˆ· ç­”ï¼šrootå¸æˆ·å°±åƒä¸€ä¸ªç³»ç»Ÿç®¡ç†å‘˜å¸æˆ·ï¼Œå…è®¸ä½ å®Œå…¨æ§åˆ¶ç³»ç»Ÿã€‚ä½ å¯ä»¥åœ¨æ­¤å¤„åˆ›å»ºå’Œç»´æŠ¤ç”¨æˆ·å¸æˆ·ï¼Œä¸ºæ¯ä¸ªå¸æˆ·åˆ†é…ä¸åŒçš„æƒé™ã€‚æ¯æ¬¡å®‰è£…Linuxæ—¶éƒ½æ˜¯é»˜è®¤å¸æˆ·ã€‚ ä»€ä¹ˆæ˜¯LILOï¼Ÿé—®ï¼šä»€ä¹ˆæ˜¯LILOï¼Ÿ ç­”ï¼šLILOæ˜¯Linuxçš„å¼•å¯¼åŠ è½½ç¨‹åºã€‚å®ƒä¸»è¦ç”¨äºå°†Linuxæ“ä½œç³»ç»ŸåŠ è½½åˆ°ä¸»å†…å­˜ä¸­ï¼Œä»¥ä¾¿å®ƒå¯ä»¥å¼€å§‹è¿è¡Œã€‚ ä»€ä¹ˆæ˜¯BASHï¼Ÿé—®ï¼šä»€ä¹ˆæ˜¯BASHï¼Ÿ ç­”ï¼šBASHæ˜¯Bourne Again SHellçš„ç¼©å†™ã€‚å®ƒç”±Steve Bourneç¼–å†™ï¼Œä½œä¸ºåŸå§‹Bourne Shellï¼ˆç”±/ bin / shè¡¨ç¤ºï¼‰çš„æ›¿ä»£å“ã€‚å®ƒç»“åˆäº†åŸå§‹ç‰ˆæœ¬çš„Bourne Shellçš„æ‰€æœ‰åŠŸèƒ½ï¼Œä»¥åŠå…¶ä»–åŠŸèƒ½ï¼Œä½¿å…¶æ›´å®¹æ˜“ä½¿ç”¨ã€‚ä»é‚£ä»¥åï¼Œå®ƒå·²è¢«æ”¹ç¼–ä¸ºè¿è¡ŒLinuxçš„å¤§å¤šæ•°ç³»ç»Ÿçš„é»˜è®¤shellã€‚ ä»€ä¹ˆæ˜¯CLIï¼Ÿé—®ï¼šä»€ä¹ˆæ˜¯CLIï¼Ÿ ç­”ï¼š 12å‘½ä»¤è¡Œç•Œé¢ï¼ˆè‹±è¯­**ï¼šcommand-line interface**ï¼Œç¼©å†™]ï¼šCLIï¼‰æ˜¯åœ¨å›¾å½¢ç”¨æˆ·ç•Œé¢å¾—åˆ°æ™®åŠä¹‹å‰ä½¿ç”¨æœ€ä¸ºå¹¿æ³›çš„ç”¨æˆ·ç•Œé¢ï¼Œå®ƒé€šå¸¸ä¸æ”¯æŒé¼ æ ‡ï¼Œç”¨æˆ·é€šè¿‡é”®ç›˜è¾“å…¥æŒ‡ä»¤ï¼Œè®¡ç®—æœºæ¥æ”¶åˆ°æŒ‡ä»¤åï¼Œäºˆä»¥æ‰§è¡Œã€‚ä¹Ÿæœ‰äººç§°ä¹‹ä¸ºå­—ç¬¦ç”¨æˆ·ç•Œé¢ï¼ˆCUIï¼‰ã€‚ é€šå¸¸è®¤ä¸ºï¼Œå‘½ä»¤è¡Œç•Œé¢ï¼ˆCLIï¼‰æ²¡æœ‰å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGUIï¼‰é‚£ä¹ˆæ–¹ä¾¿ç”¨æˆ·æ“ä½œã€‚å› ä¸ºï¼Œå‘½ä»¤è¡Œç•Œé¢çš„è½¯ä»¶é€šå¸¸éœ€è¦ç”¨æˆ·è®°å¿†æ“ä½œçš„å‘½ä»¤ï¼Œä½†æ˜¯ï¼Œç”±äºå…¶æœ¬èº«çš„ç‰¹ç‚¹ï¼Œå‘½ä»¤è¡Œç•Œé¢è¦è¾ƒå›¾å½¢ç”¨æˆ·ç•Œé¢èŠ‚çº¦è®¡ç®—æœºç³»ç»Ÿçš„èµ„æºã€‚åœ¨ç†Ÿè®°å‘½ä»¤çš„å‰æä¸‹ï¼Œä½¿ç”¨å‘½ä»¤è¡Œç•Œé¢å¾€å¾€è¦è¾ƒä½¿ç”¨å›¾å½¢ç”¨æˆ·ç•Œé¢çš„æ“ä½œé€Ÿåº¦è¦å¿«ã€‚æ‰€ä»¥ï¼Œå›¾å½¢ç”¨æˆ·ç•Œé¢çš„æ“ä½œç³»ç»Ÿä¸­ï¼Œéƒ½ä¿ç•™ç€å¯é€‰çš„å‘½ä»¤è¡Œç•Œé¢ã€‚ ä»€ä¹ˆæ˜¯GUIï¼Ÿé—®ï¼šä»€ä¹ˆæ˜¯GUIï¼Ÿ ç­”ï¼šå›¾å½¢ç”¨æˆ·ç•Œé¢ ç­”ï¼šå›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGraphical User Interfaceï¼Œç®€ç§° GUIï¼Œåˆç§°å›¾å½¢ç”¨æˆ·æ¥å£ï¼‰æ˜¯æŒ‡é‡‡ç”¨å›¾å½¢æ–¹å¼æ˜¾ç¤ºçš„è®¡ç®—æœºæ“ä½œç”¨æˆ·ç•Œé¢ã€‚å›¾å½¢ç”¨æˆ·ç•Œé¢æ˜¯ä¸€ç§äººä¸è®¡ç®—æœºé€šä¿¡çš„ç•Œé¢æ˜¾ç¤ºæ ¼å¼ï¼Œå…è®¸ç”¨æˆ·ä½¿ç”¨é¼ æ ‡ç­‰è¾“å…¥è®¾å¤‡æ“çºµå±å¹•ä¸Šçš„å›¾æ ‡æˆ–èœå•é€‰é¡¹ï¼Œä»¥é€‰æ‹©å‘½ä»¤ã€è°ƒç”¨æ–‡ä»¶ã€å¯åŠ¨ç¨‹åºæˆ–æ‰§è¡Œå…¶å®ƒä¸€äº›æ—¥å¸¸ä»»åŠ¡ã€‚ä¸é€šè¿‡é”®ç›˜è¾“å…¥æ–‡æœ¬æˆ–å­—ç¬¦å‘½ä»¤æ¥å®Œæˆä¾‹è¡Œä»»åŠ¡çš„å­—ç¬¦ç•Œé¢ç›¸æ¯”ï¼Œå›¾å½¢ç”¨æˆ·ç•Œé¢æœ‰è®¸å¤šä¼˜ç‚¹ã€‚ å¼€æºçš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿé—®ï¼šå¼€æºçš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ ç­”ï¼šèŠ‚çœäººåŠ›èµ„æºæˆæœ¬ï¼ŒåŒæ—¶æœ‰åˆ©äºè½¯ä»¶å®Œå–„ ç­”ï¼šå¼€æºå…è®¸ä½ å°†è½¯ä»¶ï¼ˆåŒ…æ‹¬æºä»£ç ï¼‰å…è´¹åˆ†å‘ç»™ä»»ä½•æ„Ÿå…´è¶£çš„äººã€‚ç„¶åï¼Œäººä»¬å¯ä»¥æ·»åŠ åŠŸèƒ½ï¼Œç”šè‡³å¯ä»¥è°ƒè¯•å’Œæ›´æ­£æºä»£ç ä¸­çš„é”™è¯¯ã€‚å®ƒä»¬ç”šè‡³å¯ä»¥è®©å®ƒè¿è¡Œå¾—æ›´å¥½ï¼Œç„¶åå†æ¬¡è‡ªç”±åœ°é‡æ–°åˆ†é…è¿™äº›å¢å¼ºçš„æºä»£ç ã€‚è¿™æœ€ç»ˆä½¿ç¤¾åŒºä¸­çš„æ¯ä¸ªäººå—ç›Šã€‚ GNUé¡¹ç›®çš„é‡è¦æ€§æ˜¯ä»€ä¹ˆï¼Ÿé—®ï¼šGNUé¡¹ç›®çš„é‡è¦æ€§æ˜¯ä»€ä¹ˆï¼Ÿ ç­”ï¼šè¿™ç§æ‰€è°“çš„è‡ªç”±è½¯ä»¶è¿åŠ¨å…·æœ‰å¤šç§ä¼˜åŠ¿ï¼Œä¾‹å¦‚å¯ä»¥è‡ªç”±åœ°è¿è¡Œç¨‹åºä»¥åŠæ ¹æ®ä½ çš„éœ€è¦è‡ªç”±å­¦ä¹ å’Œä¿®æ”¹ç¨‹åºã€‚å®ƒè¿˜å…è®¸ä½ å°†è½¯ä»¶å‰¯æœ¬é‡æ–°åˆ†å‘ç»™å…¶ä»–äººï¼Œä»¥åŠè‡ªç”±æ”¹è¿›è½¯ä»¶å¹¶å°†å…¶å‘å¸ƒç»™å…¬ä¼—ã€‚ ç®€å• Linux æ–‡ä»¶ç³»ç»Ÿï¼Ÿé—®ï¼šç®€å• Linux æ–‡ä»¶ç³»ç»Ÿï¼Ÿ ç­”ï¼š 123åœ¨ Linux æ“ä½œç³»ç»Ÿä¸­ï¼Œæ‰€æœ‰è¢«æ“ä½œç³»ç»Ÿç®¡ç†çš„èµ„æºï¼Œä¾‹å¦‚ç½‘ç»œæ¥å£å¡ã€ç£ç›˜é©±åŠ¨å™¨ã€æ‰“å°æœºã€è¾“å…¥è¾“å‡ºè®¾å¤‡ã€æ™®é€šæ–‡ä»¶æˆ–æ˜¯ç›®å½•éƒ½è¢«çœ‹ä½œæ˜¯ä¸€ä¸ªæ–‡ä»¶ã€‚ ä¹Ÿå°±æ˜¯è¯´åœ¨ Linux ç³»ç»Ÿä¸­æœ‰ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µ**ï¼šä¸€åˆ‡éƒ½æ˜¯æ–‡ä»¶**ã€‚å…¶å®è¿™æ˜¯ Unix å“²å­¦çš„ä¸€ä¸ªä½“ç°ï¼Œè€Œ Linux æ˜¯é‡å†™ Unix è€Œæ¥ï¼Œæ‰€ä»¥è¿™ä¸ªæ¦‚å¿µä¹Ÿå°±ä¼ æ‰¿äº†ä¸‹æ¥ã€‚åœ¨ Unix ç³»ç»Ÿä¸­ï¼ŒæŠŠä¸€åˆ‡èµ„æºéƒ½çœ‹ä½œæ˜¯æ–‡ä»¶ï¼ŒåŒ…æ‹¬ç¡¬ä»¶è®¾å¤‡ã€‚UNIXç³»ç»ŸæŠŠæ¯ä¸ªç¡¬ä»¶éƒ½çœ‹æˆæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œé€šå¸¸ç§°ä¸ºè®¾å¤‡æ–‡ä»¶ï¼Œè¿™æ ·ç”¨æˆ·å°±å¯ä»¥ç”¨è¯»å†™æ–‡ä»¶çš„æ–¹å¼å®ç°å¯¹ç¡¬ä»¶çš„è®¿é—®ã€‚ Linux æ”¯æŒ 5 ç§æ–‡ä»¶ç±»å‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š &lt;img src=&quot;https://ucc.alicdn.com/pic/developer-ecology/0e49bde8ba7249c2abbbe3a031b6a947.png&quot; alt=&quot;image.png&quot; /&gt; Linux çš„ç›®å½•ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿé—®ï¼šLinux çš„ç›®å½•ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿ ç­”ï¼š 12Linux æ–‡ä»¶ç³»ç»Ÿçš„ç»“æ„å±‚æ¬¡é²œæ˜ï¼Œå°±åƒä¸€æ£µå€’ç«‹çš„æ ‘ï¼Œæœ€é¡¶å±‚æ˜¯å…¶æ ¹ç›®å½•ï¼š &lt;img src=&quot;https://ucc.alicdn.com/pic/developer-ecology/61224ab457b144b08f514f6a720cc597.png&quot; alt=&quot;image.png&quot; /&gt; å¸¸è§ç›®å½•è¯´æ˜ï¼š /binï¼š å­˜æ”¾äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶(ls,cat,mkdirç­‰)ï¼Œå¸¸ç”¨å‘½ä»¤ä¸€èˆ¬éƒ½åœ¨è¿™é‡Œï¼› /etcï¼š å­˜æ”¾ç³»ç»Ÿç®¡ç†å’Œé…ç½®æ–‡ä»¶ï¼› /homeï¼š å­˜æ”¾æ‰€æœ‰ç”¨æˆ·æ–‡ä»¶çš„æ ¹ç›®å½•ï¼Œæ˜¯ç”¨æˆ·ä¸»ç›®å½•çš„åŸºç‚¹ï¼Œæ¯”å¦‚ç”¨æˆ·userçš„ä¸»ç›®å½•å°±æ˜¯/home/userï¼Œå¯ä»¥ç”¨~userè¡¨ç¤ºï¼› **/usr **ï¼š ç”¨äºå­˜æ”¾ç³»ç»Ÿåº”ç”¨ç¨‹åºï¼› /optï¼š é¢å¤–å®‰è£…çš„å¯é€‰åº”ç”¨ç¨‹åºåŒ…æ‰€æ”¾ç½®çš„ä½ç½®ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠtomcatç­‰éƒ½å®‰è£…åˆ°è¿™é‡Œï¼› /procï¼š è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿç›®å½•ï¼Œæ˜¯ç³»ç»Ÿå†…å­˜çš„æ˜ å°„ã€‚å¯ç›´æ¥è®¿é—®è¿™ä¸ªç›®å½•æ¥è·å–ç³»ç»Ÿä¿¡æ¯ï¼› /rootï¼š è¶…çº§ç”¨æˆ·ï¼ˆç³»ç»Ÿç®¡ç†å‘˜ï¼‰çš„ä¸»ç›®å½•ï¼ˆç‰¹æƒé˜¶çº§oï¼‰ï¼› /sbin: å­˜æ”¾äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ï¼Œåªæœ‰rootæ‰èƒ½è®¿é—®ã€‚è¿™é‡Œå­˜æ”¾çš„æ˜¯ç³»ç»Ÿç®¡ç†å‘˜ä½¿ç”¨çš„ç³»ç»Ÿçº§åˆ«çš„ç®¡ç†å‘½ä»¤å’Œç¨‹åºã€‚å¦‚ifconfigç­‰ï¼› /devï¼š ç”¨äºå­˜æ”¾è®¾å¤‡æ–‡ä»¶ï¼› /mntï¼š ç³»ç»Ÿç®¡ç†å‘˜å®‰è£…ä¸´æ—¶æ–‡ä»¶ç³»ç»Ÿçš„å®‰è£…ç‚¹ï¼Œç³»ç»Ÿæä¾›è¿™ä¸ªç›®å½•æ˜¯è®©ç”¨æˆ·ä¸´æ—¶æŒ‚è½½å…¶ä»–çš„æ–‡ä»¶ç³»ç»Ÿï¼› /bootï¼š å­˜æ”¾ç”¨äºç³»ç»Ÿå¼•å¯¼æ—¶ä½¿ç”¨çš„å„ç§æ–‡ä»¶ï¼› **/lib **ï¼š å­˜æ”¾ç€å’Œç³»ç»Ÿè¿è¡Œç›¸å…³çš„åº“æ–‡ä»¶ ï¼› /tmpï¼š ç”¨äºå­˜æ”¾å„ç§ä¸´æ—¶æ–‡ä»¶ï¼Œæ˜¯å…¬ç”¨çš„ä¸´æ—¶æ–‡ä»¶å­˜å‚¨ç‚¹ï¼› /varï¼š ç”¨äºå­˜æ”¾è¿è¡Œæ—¶éœ€è¦æ”¹å˜æ•°æ®çš„æ–‡ä»¶ï¼Œä¹Ÿæ˜¯æŸäº›å¤§æ–‡ä»¶çš„æº¢å‡ºåŒºï¼Œæ¯”æ–¹è¯´å„ç§æœåŠ¡çš„æ—¥å¿—æ–‡ä»¶ï¼ˆç³»ç»Ÿå¯åŠ¨æ—¥å¿—ç­‰ã€‚ï¼‰ç­‰ï¼› /lost+foundï¼š è¿™ä¸ªç›®å½•å¹³æ—¶æ˜¯ç©ºçš„ï¼Œç³»ç»Ÿéæ­£å¸¸å…³æœºè€Œç•™ä¸‹â€œæ— å®¶å¯å½’â€çš„æ–‡ä»¶ï¼ˆwindowsä¸‹å«ä»€ä¹ˆ.chkï¼‰å°±åœ¨è¿™é‡Œã€‚ ä»€ä¹ˆæ˜¯ inode ï¼Ÿé—®ï¼šä»€ä¹ˆæ˜¯ inode ï¼Ÿ ç­”ï¼šç†è§£inodeï¼Œè¦ä»æ–‡ä»¶å‚¨å­˜è¯´èµ·ã€‚æ–‡ä»¶å‚¨å­˜åœ¨ç¡¬ç›˜ä¸Šï¼Œç¡¬ç›˜çš„æœ€å°å­˜å‚¨å•ä½å«åšâ€æ‰‡åŒºâ€ï¼ˆSectorï¼‰ã€‚æ¯ä¸ªæ‰‡åŒºå‚¨å­˜512å­—èŠ‚ï¼ˆç›¸å½“äº0.5KBï¼‰ã€‚æ“ä½œç³»ç»Ÿè¯»å–ç¡¬ç›˜çš„æ—¶å€™ï¼Œä¸ä¼šä¸€ä¸ªä¸ªæ‰‡åŒºåœ°è¯»å–ï¼Œè¿™æ ·æ•ˆç‡å¤ªä½ï¼Œè€Œæ˜¯ä¸€æ¬¡æ€§è¿ç»­è¯»å–å¤šä¸ªæ‰‡åŒºï¼Œå³ä¸€æ¬¡æ€§è¯»å–ä¸€ä¸ªâ€å—â€ï¼ˆblockï¼‰ã€‚è¿™ç§ç”±å¤šä¸ªæ‰‡åŒºç»„æˆçš„â€å—â€ï¼Œæ˜¯æ–‡ä»¶å­˜å–çš„æœ€å°å•ä½ã€‚â€å—â€çš„å¤§å°ï¼Œæœ€å¸¸è§çš„æ˜¯4KBï¼Œå³è¿ç»­å…«ä¸ª sectorç»„æˆä¸€ä¸ª blockã€‚æ–‡ä»¶æ•°æ®éƒ½å‚¨å­˜åœ¨â€å—â€ä¸­ï¼Œé‚£ä¹ˆå¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬è¿˜å¿…é¡»æ‰¾åˆ°ä¸€ä¸ªåœ°æ–¹å‚¨å­˜æ–‡ä»¶çš„å…ƒä¿¡æ¯ï¼Œæ¯”å¦‚æ–‡ä»¶çš„åˆ›å»ºè€…ã€æ–‡ä»¶çš„åˆ›å»ºæ—¥æœŸã€æ–‡ä»¶çš„å¤§å°ç­‰ç­‰ã€‚è¿™ç§å‚¨å­˜æ–‡ä»¶å…ƒä¿¡æ¯çš„åŒºåŸŸå°±å«åšinodeï¼Œä¸­æ–‡è¯‘åä¸ºâ€ç´¢å¼•èŠ‚ç‚¹â€ã€‚æ¯ä¸€ä¸ªæ–‡ä»¶éƒ½æœ‰å¯¹åº”çš„inodeï¼Œé‡Œé¢åŒ…å«äº†ä¸è¯¥æ–‡ä»¶æœ‰å…³çš„ä¸€äº›ä¿¡æ¯ã€‚ ç®€è¿° Linux æ–‡ä»¶ç³»ç»Ÿé€šè¿‡ i èŠ‚ç‚¹æŠŠæ–‡ä»¶çš„é€»è¾‘ç»“æ„å’Œç‰©ç†ç»“æ„è½¬æ¢çš„å·¥ä½œè¿‡ç¨‹ï¼Ÿé—®ï¼šç®€è¿° Linux æ–‡ä»¶ç³»ç»Ÿé€šè¿‡ i èŠ‚ç‚¹æŠŠæ–‡ä»¶çš„é€»è¾‘ç»“æ„å’Œç‰©ç†ç»“æ„è½¬æ¢çš„å·¥ä½œè¿‡ç¨‹ï¼Ÿ ç­”ï¼šLinux é€šè¿‡ inode èŠ‚ç‚¹è¡¨å°†æ–‡ä»¶çš„é€»è¾‘ç»“æ„å’Œç‰©ç†ç»“æ„è¿›è¡Œè½¬æ¢ã€‚inode èŠ‚ç‚¹æ˜¯ä¸€ä¸ª 64 å­—èŠ‚é•¿çš„è¡¨ï¼Œè¡¨ä¸­åŒ…å«äº†æ–‡ä»¶çš„ç›¸å…³ä¿¡æ¯ï¼Œå…¶ä¸­æœ‰æ–‡ä»¶çš„å¤§å°ã€æ–‡ä»¶æ‰€æœ‰è€…ã€æ–‡ä»¶çš„å­˜å–è®¸å¯æ–¹å¼ä»¥åŠæ–‡ä»¶çš„ç±»å‹ç­‰é‡è¦ä¿¡æ¯ã€‚åœ¨ inode èŠ‚ç‚¹è¡¨ä¸­æœ€é‡è¦çš„å†…å®¹æ˜¯ç£ç›˜åœ°å€è¡¨ã€‚åœ¨ç£ç›˜åœ°å€è¡¨ä¸­æœ‰ 13 ä¸ªå—å·ï¼Œæ–‡ä»¶å°†ä»¥å—å·åœ¨ç£ç›˜åœ°å€è¡¨ä¸­å‡ºç°çš„é¡ºåºä¾æ¬¡è¯»å–ç›¸åº”çš„å—ã€‚ Linux æ–‡ä»¶ç³»ç»Ÿé€šè¿‡æŠŠ inode èŠ‚ç‚¹å’Œæ–‡ä»¶åè¿›è¡Œè¿æ¥ï¼Œå½“éœ€è¦è¯»å–è¯¥æ–‡ä»¶æ—¶ï¼Œæ–‡ä»¶ç³»ç»Ÿåœ¨å½“å‰ç›®å½•è¡¨ä¸­æŸ¥æ‰¾è¯¥æ–‡ä»¶åå¯¹åº”çš„é¡¹ï¼Œç”±æ­¤å¾—åˆ°è¯¥æ–‡ä»¶ç›¸å¯¹åº”çš„ inode èŠ‚ç‚¹å·ï¼Œé€šè¿‡è¯¥ inode èŠ‚ç‚¹çš„ç£ç›˜åœ°å€è¡¨æŠŠåˆ†æ•£å­˜æ”¾çš„æ–‡ä»¶ç‰©ç†å—è¿æ¥æˆæ–‡ä»¶çš„é€»è¾‘ç»“æ„ã€‚ ä»€ä¹ˆæ˜¯ç¡¬é“¾æ¥å’Œè½¯é“¾æ¥ï¼Ÿé—®ï¼šä»€ä¹ˆæ˜¯ç¡¬é“¾æ¥å’Œè½¯é“¾æ¥ï¼Ÿ ç­”ï¼š1ï¼‰ç¡¬é“¾æ¥ç”±äº Linux ä¸‹çš„æ–‡ä»¶æ˜¯é€šè¿‡ç´¢å¼•èŠ‚ç‚¹(inode)æ¥è¯†åˆ«æ–‡ä»¶ï¼Œç¡¬é“¾æ¥å¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘æ–‡ä»¶ç´¢å¼•èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œç³»ç»Ÿå¹¶ä¸ä¸ºå®ƒé‡æ–°åˆ†é… inode ã€‚æ¯æ·»åŠ ä¸€ä¸ªä¸€ä¸ªç¡¬é“¾æ¥ï¼Œæ–‡ä»¶çš„é“¾æ¥æ•°å°±åŠ  1 ã€‚ä¸è¶³ï¼š1ï¼‰ä¸å¯ä»¥åœ¨ä¸åŒæ–‡ä»¶ç³»ç»Ÿçš„æ–‡ä»¶é—´å»ºç«‹é“¾æ¥ï¼›2ï¼‰åªæœ‰è¶…çº§ç”¨æˆ·æ‰å¯ä»¥ä¸ºç›®å½•åˆ›å»ºç¡¬é“¾æ¥ã€‚ 2ï¼‰è½¯é“¾æ¥è½¯é“¾æ¥å…‹æœäº†ç¡¬é“¾æ¥çš„ä¸è¶³ï¼Œæ²¡æœ‰ä»»ä½•æ–‡ä»¶ç³»ç»Ÿçš„é™åˆ¶ï¼Œä»»ä½•ç”¨æˆ·å¯ä»¥åˆ›å»ºæŒ‡å‘ç›®å½•çš„ç¬¦å·é“¾æ¥ã€‚å› è€Œç°åœ¨æ›´ä¸ºå¹¿æ³›ä½¿ç”¨ï¼Œå®ƒå…·æœ‰æ›´å¤§çš„çµæ´»æ€§ï¼Œç”šè‡³å¯ä»¥è·¨è¶Šä¸åŒæœºå™¨ã€ä¸åŒç½‘ç»œå¯¹æ–‡ä»¶è¿›è¡Œé“¾æ¥ã€‚ä¸è¶³ï¼šå› ä¸ºé“¾æ¥æ–‡ä»¶åŒ…å«æœ‰åŸæ–‡ä»¶çš„è·¯å¾„ä¿¡æ¯ï¼Œæ‰€ä»¥å½“åŸæ–‡ä»¶ä»ä¸€ä¸ªç›®å½•ä¸‹ç§»åˆ°å…¶ä»–ç›®å½•ä¸­ï¼Œå†è®¿é—®é“¾æ¥æ–‡ä»¶ï¼Œç³»ç»Ÿå°±æ‰¾ä¸åˆ°äº†ï¼Œè€Œç¡¬é“¾æ¥å°±æ²¡æœ‰è¿™ä¸ªç¼ºé™·ï¼Œä½ æƒ³æ€ä¹ˆç§»å°±æ€ä¹ˆç§»ï¼›è¿˜æœ‰å®ƒè¦ç³»ç»Ÿåˆ†é…é¢å¤–çš„ç©ºé—´ç”¨äºå»ºç«‹æ–°çš„ç´¢å¼•èŠ‚ç‚¹å’Œä¿å­˜åŸæ–‡ä»¶çš„è·¯å¾„ã€‚ å®é™…åœºæ™¯ä¸‹ï¼ŒåŸºæœ¬æ˜¯ä½¿ç”¨è½¯é“¾æ¥ã€‚æ€»ç»“åŒºåˆ«å¦‚ä¸‹ï¼šç¡¬é“¾æ¥ä¸å¯ä»¥è·¨åˆ†åŒºï¼Œè½¯ä»¶é“¾å¯ä»¥è·¨åˆ†åŒºã€‚ ç¡¬é“¾æ¥æŒ‡å‘ä¸€ä¸ª inode èŠ‚ç‚¹ï¼Œè€Œè½¯é“¾æ¥åˆ™æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„ inode èŠ‚ç‚¹ã€‚ åˆ é™¤ç¡¬é“¾æ¥æ–‡ä»¶ï¼Œä¸ä¼šåˆ é™¤åŸæ–‡ä»¶ï¼Œåˆ é™¤è½¯é“¾æ¥æ–‡ä»¶ï¼Œä¼šæŠŠåŸæ–‡ä»¶åˆ é™¤ã€‚ RAID æ˜¯ä»€ä¹ˆ?é—®ï¼šRAID æ˜¯ä»€ä¹ˆ? ç­”ï¼šRAID å…¨ç§°ä¸ºç‹¬ç«‹ç£ç›˜å†—ä½™é˜µåˆ—(Redundant Array of Independent Disks)ï¼ŒåŸºæœ¬æ€æƒ³å°±æ˜¯æŠŠå¤šä¸ªç›¸å¯¹ä¾¿å®œçš„ç¡¬ç›˜ç»„åˆèµ·æ¥ï¼Œæˆä¸ºä¸€ä¸ªç¡¬ç›˜é˜µåˆ—ç»„ï¼Œä½¿æ€§èƒ½è¾¾åˆ°ç”šè‡³è¶…è¿‡ä¸€ä¸ªä»·æ ¼æ˜‚è´µã€ å®¹é‡å·¨å¤§çš„ç¡¬ç›˜ã€‚RAID é€šå¸¸è¢«ç”¨åœ¨æœåŠ¡å™¨ç”µè„‘ä¸Šï¼Œä½¿ç”¨å®Œå…¨ç›¸åŒçš„ç¡¬ç›˜ç»„æˆä¸€ä¸ªé€»è¾‘æ‰‡åŒºï¼Œå› æ­¤æ“ä½œç³»ç»Ÿåªä¼šæŠŠå®ƒå½“åšä¸€ä¸ªç¡¬ç›˜ã€‚RAID åˆ†ä¸ºä¸åŒçš„ç­‰çº§ï¼Œå„ä¸ªä¸åŒçš„ç­‰çº§å‡åœ¨æ•°æ®å¯é æ€§åŠè¯»å†™æ€§èƒ½ä¸Šåšäº†ä¸åŒçš„æƒè¡¡ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¯ä»¥ä¾æ®è‡ªå·±çš„å®é™…éœ€æ±‚é€‰æ‹©ä¸åŒçš„ RAID æ–¹æ¡ˆã€‚ å½“ç„¶ï¼Œå› ä¸ºå¾ˆå¤šå…¬å¸éƒ½ä½¿ç”¨äº‘æœåŠ¡ï¼Œå¤§å®¶å¾ˆéš¾æ¥è§¦åˆ° RAID è¿™ä¸ªæ¦‚å¿µï¼Œæ›´å¤šçš„å¯èƒ½æ˜¯æ™®é€šäº‘ç›˜ã€SSD äº‘ç›˜é…±ç´«çš„æ¦‚å¿µã€‚ ä¸€å° Linux ç³»ç»Ÿåˆå§‹åŒ–ç¯å¢ƒåéœ€è¦åšä¸€äº›ä»€ä¹ˆå®‰å…¨å·¥ä½œï¼Ÿé—®ï¼šä¸€å° Linux ç³»ç»Ÿåˆå§‹åŒ–ç¯å¢ƒåéœ€è¦åšä¸€äº›ä»€ä¹ˆå®‰å…¨å·¥ä½œï¼Ÿ ç­”ï¼š1ã€æ·»åŠ æ™®é€šç”¨æˆ·ç™»é™†ï¼Œç¦æ­¢ root ç”¨æˆ·ç™»é™†ï¼Œæ›´æ”¹ SSH ç«¯å£å·ã€‚ä¿®æ”¹ SSH ç«¯å£ä¸ä¸€å®šç»å¯¹å“ˆã€‚å½“ç„¶ï¼Œå¦‚æœè¦æš´éœ²åœ¨å¤–ç½‘ï¼Œå»ºè®®æ”¹ä¸‹ã€‚l2ã€æœåŠ¡å™¨ä½¿ç”¨å¯†é’¥ç™»é™†ï¼Œç¦æ­¢å¯†ç ç™»é™†ã€‚3ã€å¼€å¯é˜²ç«å¢™ï¼Œå…³é—­ SElinux ï¼Œæ ¹æ®ä¸šåŠ¡éœ€æ±‚è®¾ç½®ç›¸åº”çš„é˜²ç«å¢™è§„åˆ™ã€‚4ã€è£… fail2ban è¿™ç§é˜²æ­¢ SSH æš´åŠ›ç ´å‡»çš„è½¯ä»¶ã€‚5ã€è®¾ç½®åªå…è®¸å…¬å¸åŠå…¬ç½‘å‡ºå£ IP èƒ½ç™»é™†æœåŠ¡å™¨(çœ‹å…¬å¸å®é™…éœ€è¦)ä¹Ÿå¯ä»¥å®‰è£… VPN ç­‰è½¯ä»¶ï¼Œåªå…è®¸è¿æ¥ VPN åˆ°æœåŠ¡å™¨ä¸Šã€‚6ã€ä¿®æ”¹å†å²å‘½ä»¤è®°å½•çš„æ¡æ•°ä¸º 10 æ¡ã€‚7ã€åªå…è®¸æœ‰éœ€è¦çš„æœåŠ¡å™¨å¯ä»¥è®¿é—®å¤–ç½‘ï¼Œå…¶å®ƒå…¨éƒ¨ç¦æ­¢ã€‚8ã€åšå¥½è½¯ä»¶å±‚é¢çš„é˜²æŠ¤ã€‚8.1 è®¾ç½® nginx_waf æ¨¡å—é˜²æ­¢ SQL æ³¨å…¥ã€‚ 8.2 æŠŠ Web æœåŠ¡ä½¿ç”¨ www ç”¨æˆ·å¯åŠ¨ï¼Œæ›´æ”¹ç½‘ç«™ç›®å½•çš„æ‰€æœ‰è€…å’Œæ‰€å±ç»„ä¸º www ã€‚ ä»€ä¹ˆå« CC æ”»å‡»ï¼Ÿä»€ä¹ˆå« DDOS æ”»å‡»ï¼Ÿé—®ï¼šä»€ä¹ˆå« CC æ”»å‡»ï¼Ÿä»€ä¹ˆå« DDOS æ”»å‡»ï¼Ÿ ç­”ï¼šddosæ”»å‡»åˆå«åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡æ”»å‡»ï¼Œå¯ä»¥ä½¿å¾ˆå¤šçš„è®¡ç®—æœºåœ¨åŒä¸€æ—¶é—´é­å—åˆ°æ”»å‡»ï¼Œä½¿æ”»å‡»çš„ç›®æ ‡æ— æ³•æ­£å¸¸ä½¿ç”¨ï¼Œåˆ†å¸ƒå¼æ‹’ç»æœåŠ¡æ”»å‡»å·²ç»å‡ºç°äº†å¾ˆå¤šæ¬¡ï¼Œå¯¼è‡´å¾ˆå¤šçš„å¤§å‹ç½‘ç«™éƒ½å‡ºç°äº†æ— æ³•è¿›è¡Œæ“ä½œçš„æƒ…å†µã€‚ ccæ”»å‡»åœ¨å¹¿æ³›å®šä¹‰ä¸Šä¹Ÿå±äºddosä¸€ç§ï¼Œccæ”»å‡»æŒ‡çš„æ˜¯æ”»å‡»è€…æ§åˆ¶æŸäº›ä¸»æœºä¸åœåœ°å‘å¤§é‡æ•°æ®åŒ…ç»™å¯¹æ–¹æœåŠ¡å™¨é€ æˆæœåŠ¡å™¨èµ„æºè€—å°½ï¼Œä¸€ç›´åˆ°å®•æœºå´©æºƒã€‚ ç­”ï¼šCC æ”»å‡»ï¼Œä¸»è¦æ˜¯ç”¨æ¥æ”»å‡»é¡µé¢çš„ï¼Œæ¨¡æ‹Ÿå¤šä¸ªç”¨æˆ·ä¸åœçš„å¯¹ä½ çš„é¡µé¢è¿›è¡Œè®¿é—®ï¼Œä»è€Œä½¿ä½ çš„ç³»ç»Ÿèµ„æºæ¶ˆè€—æ®†å°½ã€‚DDOS æ”»å‡»ï¼Œä¸­æ–‡åå«åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡æ”»å‡»ï¼ŒæŒ‡å€ŸåŠ©æœåŠ¡å™¨æŠ€æœ¯å°†å¤šä¸ªè®¡ç®—æœºè”åˆèµ·æ¥ä½œä¸ºæ”»å‡»å¹³å°ï¼Œæ¥å¯¹ä¸€ä¸ªæˆ–å¤šä¸ªç›®æ ‡å‘åŠ¨ DDOS æ”»å‡»ã€‚æ”»å‡»ï¼Œå³æ˜¯é€šè¿‡å¤§é‡åˆæ³•çš„è¯·æ±‚å ç”¨å¤§é‡ç½‘ç»œèµ„æºï¼Œä»¥è¾¾åˆ°ç˜«ç—ªç½‘ç»œçš„ç›®çš„ã€‚ æ€ä¹ˆé¢„é˜² CC æ”»å‡»å’Œ DDOS æ”»å‡»ï¼Ÿé—®ï¼šæ€ä¹ˆé¢„é˜² CC æ”»å‡»å’Œ DDOS æ”»å‡»ï¼Ÿ ç­”ï¼šé˜²ccå’Œddosä¸€èˆ¬éƒ½æ˜¯é‡‡ç”¨é«˜é˜²æœåŠ¡å™¨æˆ–è€…äº‘ç›¾ï¼Œæ¸¸æˆç›¾å’Œwebç›¾ã€é«˜é˜²æœåŠ¡å™¨éœ€è¦å¯ä»¥è”ç³»æˆ‘ï¼Œddosæ— ä¸Šé™ï¼Œccäº‹ç™¾åˆ†ç™¾é˜²å¾¡ï¼Œä¸€æ—¦è¢«æ”»ç ´éƒ½ä¼šèµ”å¿ã€‚ ç­”ï¼šé˜² CCã€DDOS æ”»å‡»ï¼Œè¿™äº›åªèƒ½æ˜¯ç”¨ç¡¬ä»¶é˜²ç«å¢™åšæµé‡æ¸…æ´—ï¼Œå°†æ”»å‡»æµé‡å¼•å…¥é»‘æ´ã€‚æµé‡æ¸…æ´—è¿™ä¸€å—ï¼Œä¸»è¦æ˜¯ä¹° ISP æœåŠ¡å•†çš„é˜²æ”»å‡»çš„æœåŠ¡å°±å¯ä»¥ï¼Œæœºæˆ¿ä¸€èˆ¬æœ‰ç©ºä½™æµé‡ï¼Œæˆ‘ä»¬ä¸€èˆ¬æ˜¯ä¹°æœåŠ¡ï¼Œæ¯•ç«Ÿæ”»å‡»ä¸ä¼šæ˜¯æŒç»­é•¿æ—¶é—´ã€‚ ä»€ä¹ˆæ˜¯ç½‘ç«™æ•°æ®åº“æ³¨å…¥ï¼Ÿé—®ï¼šä»€ä¹ˆæ˜¯ç½‘ç«™æ•°æ®åº“æ³¨å…¥ï¼Ÿ ç­”ï¼šç”±äºç¨‹åºå‘˜çš„æ°´å¹³åŠç»éªŒå‚å·®ä¸é½ï¼Œå¤§éƒ¨åˆ†ç¨‹åºå‘˜åœ¨ç¼–å†™ä»£ç çš„æ—¶å€™ï¼Œæ²¡æœ‰å¯¹ç”¨æˆ·è¾“å…¥æ•°æ®çš„åˆæ³•æ€§è¿›è¡Œåˆ¤æ–­ã€‚ åº”ç”¨ç¨‹åºå­˜åœ¨å®‰å…¨éšæ‚£ã€‚ç”¨æˆ·å¯ä»¥æäº¤ä¸€æ®µæ•°æ®åº“æŸ¥è¯¢ä»£ç ï¼Œæ ¹æ®ç¨‹åºè¿”å›çš„ç»“æœï¼Œè·å¾—æŸäº›ä»–æƒ³å¾—çŸ¥çš„æ•°æ®ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„ SQL æ³¨å…¥ã€‚ SQLæ³¨å…¥ï¼Œæ˜¯ä»æ­£å¸¸çš„ WWW ç«¯å£è®¿é—®ï¼Œè€Œä¸”è¡¨é¢çœ‹èµ·æ¥è·Ÿä¸€èˆ¬çš„ Web é¡µé¢è®¿é—®æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œå¦‚æœç®¡ç†å‘˜æ²¡æŸ¥çœ‹æ—¥å¿—çš„ä¹ æƒ¯ï¼Œå¯èƒ½è¢«å…¥ä¾µå¾ˆé•¿æ—¶é—´éƒ½ä¸ä¼šå‘è§‰ã€‚ å¦‚ä½•è¿‡æ»¤ä¸é¢„é˜²ï¼Ÿæ•°æ®åº“ç½‘é¡µç«¯æ³¨å…¥è¿™ç§ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ nginx_waf åšè¿‡æ»¤ä¸é¢„é˜²ã€‚ Shell è„šæœ¬æ˜¯ä»€ä¹ˆï¼Ÿé—®ï¼šShell è„šæœ¬æ˜¯ä»€ä¹ˆï¼Ÿ ç­”ï¼šä¸€ä¸ª Shell è„šæœ¬æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼ŒåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå‘½ä»¤ã€‚ä½œä¸ºç³»ç»Ÿç®¡ç†å‘˜ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦ä½¿ç”¨å¤šä¸ªå‘½ä»¤æ¥å®Œæˆä¸€é¡¹ä»»åŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ è¿™äº›æ‰€æœ‰å‘½ä»¤åœ¨ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶(Shell è„šæœ¬)æ¥å®Œæˆè¿™äº›æ—¥å¸¸å·¥ä½œä»»åŠ¡ã€‚ ä»€ä¹ˆæ˜¯é»˜è®¤ç™»å½• Shell ï¼Ÿé—®ï¼šä»€ä¹ˆæ˜¯é»˜è®¤ç™»å½• Shell ï¼Ÿ ç­”ï¼š 123456789åœ¨ Linux æ“ä½œç³»ç»Ÿï¼Œ&quot;/bin/bash&quot; æ˜¯é»˜è®¤ç™»å½• Shellï¼Œæ˜¯åœ¨åˆ›å»ºç”¨æˆ·æ—¶åˆ†é…çš„ã€‚ ä½¿ç”¨ chsh å‘½ä»¤å¯ä»¥æ”¹å˜é»˜è®¤çš„ Shell ã€‚ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š chsh &lt;ç”¨æˆ·å&gt; -s &lt;æ–°shell&gt; chsh ThinkWon -s /bin/sh 1 2 åœ¨ Shell è„šæœ¬ä¸­ï¼Œå¦‚ä½•å†™å…¥æ³¨é‡Šï¼Ÿ æ³¨é‡Šå¯ä»¥ç”¨æ¥æè¿°ä¸€ä¸ªè„šæœ¬å¯ä»¥åšä»€ä¹ˆå’Œå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚æ¯ä¸€è¡Œæ³¨é‡Šä»¥ # å¼€å¤´ã€‚ä¾‹å­å¦‚ä¸‹ï¼š #!/bin/bash This is a command echo â€œI am logged in as $USERâ€ å¯ä»¥åœ¨ Shell è„šæœ¬ä¸­ä½¿ç”¨å“ªäº›ç±»å‹çš„å˜é‡ï¼Ÿé—®ï¼šå¯ä»¥åœ¨ Shell è„šæœ¬ä¸­ä½¿ç”¨å“ªäº›ç±»å‹çš„å˜é‡ï¼Ÿ ç­”ï¼šåœ¨ Shell è„šæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸¤ç§ç±»å‹çš„å˜é‡ï¼šç³»ç»Ÿå®šä¹‰å˜é‡ç³»ç»Ÿå˜é‡æ˜¯ç”±ç³»ç»Ÿç³»ç»Ÿè‡ªå·±åˆ›å»ºçš„ã€‚è¿™äº›å˜é‡é€šå¸¸ç”±å¤§å†™å­—æ¯ç»„æˆï¼Œå¯ä»¥é€šè¿‡ set å‘½ä»¤æŸ¥çœ‹ã€‚ç”¨æˆ·å®šä¹‰å˜é‡ç”¨æˆ·å˜é‡ç”±ç³»ç»Ÿç”¨æˆ·æ¥ç”Ÿæˆå’Œå®šä¹‰ï¼Œå˜é‡çš„å€¼å¯ä»¥é€šè¿‡å‘½ä»¤ â€œecho $&lt;å˜é‡å&gt;â€ æŸ¥çœ‹ã€‚ Shellè„šæœ¬ä¸­ $? æ ‡è®°çš„ç”¨é€”æ˜¯ä»€ä¹ˆï¼Ÿé—®ï¼šShellè„šæœ¬ä¸­ $? æ ‡è®°çš„ç”¨é€”æ˜¯ä»€ä¹ˆï¼Ÿ ç­”ï¼š 1234åœ¨å†™ä¸€ä¸ª Shell è„šæœ¬æ—¶ï¼Œå¦‚æœä½ æƒ³è¦æ£€æŸ¥å‰ä¸€å‘½ä»¤æ˜¯å¦æ‰§è¡ŒæˆåŠŸï¼Œåœ¨ if æ¡ä»¶ä¸­ä½¿ç”¨ $? å¯ä»¥æ¥æ£€æŸ¥å‰ä¸€å‘½ä»¤çš„ç»“æŸçŠ¶æ€ã€‚ å¦‚æœç»“æŸçŠ¶æ€æ˜¯ 0 ï¼Œè¯´æ˜å‰ä¸€ä¸ªå‘½ä»¤æ‰§è¡ŒæˆåŠŸã€‚ä¾‹å¦‚ï¼š root@localhost:~## ls /usr/bin/shar /usr/bin/shar root@localhost:~## echo $? 0 1 2 3 4 å¦‚æœç»“æŸçŠ¶æ€ä¸æ˜¯0ï¼Œè¯´æ˜å‘½ä»¤æ‰§è¡Œå¤±è´¥ã€‚ä¾‹å¦‚ï¼š root@localhost:~## ls /usr/bin/share ls: cannot access /usr/bin/share: No such file or directory root@localhost:~## echo $? 2 Bourne Shell(bash) ä¸­æœ‰å“ªäº›ç‰¹æ®Šçš„å˜é‡ï¼Ÿé—®ï¼šBourne Shell(bash) ä¸­æœ‰å“ªäº›ç‰¹æ®Šçš„å˜é‡ï¼Ÿ ç­”ï¼š 12ä¸‹é¢çš„è¡¨åˆ—å‡ºäº† Bourne Shell ä¸ºå‘½ä»¤è¡Œè®¾ç½®çš„ç‰¹æ®Šå˜é‡ã€‚ å†…å»ºå˜é‡ è§£é‡Š $0 å‘½ä»¤è¡Œä¸­çš„è„šæœ¬åå­— $1 ç¬¬ä¸€ä¸ªå‘½ä»¤è¡Œå‚æ•° $2 ç¬¬äºŒä¸ªå‘½ä»¤è¡Œå‚æ•° â€¦.. â€¦â€¦. $9 ç¬¬ä¹ä¸ªå‘½ä»¤è¡Œå‚æ•° $## å‘½ä»¤è¡Œå‚æ•°çš„æ•°é‡ $* æ‰€æœ‰å‘½ä»¤è¡Œå‚æ•°ï¼Œä»¥ç©ºæ ¼éš”å¼€ å¦‚ä½•å–æ¶ˆå˜é‡æˆ–å–æ¶ˆå˜é‡èµ‹å€¼ï¼Ÿé—®ï¼šå¦‚ä½•å–æ¶ˆå˜é‡æˆ–å–æ¶ˆå˜é‡èµ‹å€¼ï¼Ÿ ç­”ï¼šunset å‘½ä»¤ç”¨äºå–æ¶ˆå˜é‡æˆ–å–æ¶ˆå˜é‡èµ‹å€¼ã€‚è¯­æ³•å¦‚ä¸‹æ‰€ç¤ºï¼šunset &lt;å˜é‡å&gt; Shell è„šæœ¬ä¸­ if è¯­æ³•å¦‚ä½•åµŒå¥—?é—®ï¼šShell è„šæœ¬ä¸­ if è¯­æ³•å¦‚ä½•åµŒå¥—? ç­”ï¼šif [ æ¡ä»¶ ] then å‘½ä»¤1 å‘½ä»¤2 â€¦.. else if [ æ¡ä»¶ ] then å‘½ä»¤1 å‘½ä»¤2 â€¦. else å‘½ä»¤1 å‘½ä»¤2 â€¦.. fi fi åœ¨ Shell è„šæœ¬ä¸­å¦‚ä½•æ¯”è¾ƒä¸¤ä¸ªæ•°å­—ï¼Ÿé—®ï¼šåœ¨ Shell è„šæœ¬ä¸­å¦‚ä½•æ¯”è¾ƒä¸¤ä¸ªæ•°å­—ï¼Ÿ ç­”ï¼š 12åœ¨ if-then ä¸­ä½¿ç”¨æµ‹è¯•å‘½ä»¤ï¼ˆ -gt ç­‰ï¼‰æ¥æ¯”è¾ƒä¸¤ä¸ªæ•°å­—ã€‚ä¾‹å¦‚ï¼š #!/bin/bash x=10 y=20 if [ $x -gt $y ] then echo â€œx is greater than yâ€ else echo â€œy is greater than xâ€ fi Shell è„šæœ¬ä¸­ case è¯­å¥çš„è¯­æ³•?é—®ï¼šShell è„šæœ¬ä¸­ case è¯­å¥çš„è¯­æ³•? ç­”ï¼šåŸºç¡€è¯­æ³•å¦‚ä¸‹ï¼šcase å˜é‡ in å€¼1) å‘½ä»¤1 å‘½ä»¤2 â€¦.. æœ€åå‘½ä»¤ !! å€¼2) å‘½ä»¤1 å‘½ä»¤2 â€¦â€¦ æœ€åå‘½ä»¤ ;; esac Shell è„šæœ¬ä¸­ for å¾ªç¯è¯­æ³•ï¼Ÿé—®ï¼šShell è„šæœ¬ä¸­ for å¾ªç¯è¯­æ³•ï¼Ÿ ç­”ï¼šfor å˜é‡ in å¾ªç¯åˆ—è¡¨ do å‘½ä»¤1 å‘½ä»¤2 â€¦. æœ€åå‘½ä»¤ done Shell è„šæœ¬ä¸­ while å¾ªç¯è¯­æ³•ï¼Ÿé—®ï¼šShell è„šæœ¬ä¸­ while å¾ªç¯è¯­æ³•ï¼Ÿ ç­”ï¼šå¦‚åŒ for å¾ªç¯ï¼Œwhile å¾ªç¯åªè¦æ¡ä»¶æˆç«‹å°±é‡å¤å®ƒçš„å‘½ä»¤å—ã€‚ ä¸åŒäº forå¾ªç¯ï¼Œwhile å¾ªç¯ä¼šä¸æ–­è¿­ä»£ï¼Œç›´åˆ°å®ƒçš„æ¡ä»¶ä¸ä¸ºçœŸã€‚åŸºç¡€è¯­æ³•ï¼šwhile [ æ¡ä»¶ ] do å‘½ä»¤â€¦ done do-while è¯­å¥çš„åŸºæœ¬æ ¼å¼ï¼Ÿé—®ï¼šdo-while è¯­å¥çš„åŸºæœ¬æ ¼å¼ï¼Ÿ ç­”ï¼šdo-while è¯­å¥ç±»ä¼¼äº while è¯­å¥ï¼Œä½†æ£€æŸ¥æ¡ä»¶è¯­å¥ä¹‹å‰å…ˆæ‰§è¡Œå‘½ä»¤ï¼ˆLCTT è¯‘æ³¨ï¼šæ„å³è‡³å°‘æ‰§è¡Œä¸€æ¬¡ã€‚ï¼‰ã€‚ä¸‹é¢æ˜¯ç”¨ do-while è¯­å¥çš„è¯­æ³•ï¼šdo { å‘½ä»¤ } while (æ¡ä»¶) Shell è„šæœ¬ä¸­ break å‘½ä»¤çš„ä½œç”¨ï¼Ÿé—®ï¼šShell è„šæœ¬ä¸­ break å‘½ä»¤çš„ä½œç”¨ï¼Ÿ ç­”ï¼šbreak å‘½ä»¤ä¸€ä¸ªç®€å•çš„ç”¨é€”æ˜¯é€€å‡ºæ‰§è¡Œä¸­çš„å¾ªç¯ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ while å’Œ until å¾ªç¯ä¸­ä½¿ç”¨ break å‘½ä»¤è·³å‡ºå¾ªç¯ã€‚ Shell è„šæœ¬ä¸­ continue å‘½ä»¤çš„ä½œç”¨ï¼Ÿé—®ï¼šShell è„šæœ¬ä¸­ continue å‘½ä»¤çš„ä½œç”¨ï¼Ÿ ç­”ï¼šcontinue å‘½ä»¤ä¸åŒäº break å‘½ä»¤ï¼Œå®ƒåªè·³å‡ºå½“å‰å¾ªç¯çš„è¿­ä»£ï¼Œè€Œä¸æ˜¯æ•´ä¸ªå¾ªç¯ã€‚continue å‘½ä»¤å¾ˆå¤šæ—¶å€™æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œä¾‹å¦‚é”™è¯¯å‘ç”Ÿï¼Œä½†æˆ‘ä»¬ä¾ç„¶å¸Œæœ›ç»§ç»­æ‰§è¡Œå¤§å¾ªç¯çš„æ—¶å€™ã€‚ å¦‚ä½•ä½¿è„šæœ¬å¯æ‰§è¡Œ?é—®ï¼šå¦‚ä½•ä½¿è„šæœ¬å¯æ‰§è¡Œ? ç­”ï¼šä½¿ç”¨ chmod å‘½ä»¤æ¥ä½¿è„šæœ¬å¯æ‰§è¡Œã€‚ä¾‹å­å¦‚ä¸‹ï¼šchmod a+x myscript.sh ã€‚ #!/bin/bash çš„ä½œç”¨ï¼Ÿé—®ï¼š#!/bin/bash çš„ä½œç”¨ï¼Ÿ ç­”ï¼š 12#!/bin/bash æ˜¯ Shell è„šæœ¬çš„ç¬¬ä¸€è¡Œï¼Œç§°ä¸ºé‡Šä¼´ï¼ˆshebangï¼‰è¡Œã€‚ è¿™é‡Œ # ç¬¦å·å«åš hash ï¼Œè€Œ ! å«åš bangã€‚ å®ƒçš„æ„æ€æ˜¯å‘½ä»¤é€šè¿‡ /bin/bash æ¥æ‰§è¡Œã€‚ å¦‚ä½•è°ƒè¯• Shellè„šæœ¬ï¼Ÿé—®ï¼šå¦‚ä½•è°ƒè¯• Shellè„šæœ¬ï¼Ÿ ç­”ï¼šä½¿ç”¨ -xâ€™ æ•°ï¼ˆsh -x myscript.shï¼‰å¯ä»¥è°ƒè¯• Shellè„šæœ¬ã€‚ å¦ä¸€ä¸ªç§æ–¹æ³•æ˜¯ä½¿ç”¨ -nv å‚æ•°(sh -nv myscript.sh)ã€‚ å¦‚ä½•å°†æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯è¾“å‡ºåŒæ—¶é‡å®šå‘åˆ°åŒä¸€ä½ç½®?é—®ï¼šå¦‚ä½•å°†æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯è¾“å‡ºåŒæ—¶é‡å®šå‘åˆ°åŒä¸€ä½ç½®? ç­”ï¼š 1æ–¹æ³•ä¸€ï¼š2&gt;&amp;1 (å¦‚## ls /usr/share/doc &gt; out.txt 2&gt;&amp;1 ) ã€‚ æ–¹æ³•äºŒï¼š&amp;&gt; (å¦‚## ls /usr/share/doc &amp;&gt; out.txt ) ã€‚ åœ¨ Shell è„šæœ¬ä¸­ï¼Œå¦‚ä½•æµ‹è¯•æ–‡ä»¶ï¼Ÿé—®ï¼šåœ¨ Shell è„šæœ¬ä¸­ï¼Œå¦‚ä½•æµ‹è¯•æ–‡ä»¶ï¼Ÿ ç­”ï¼štest å‘½ä»¤å¯ä»¥ç”¨æ¥æµ‹è¯•æ–‡ä»¶ã€‚åŸºç¡€ç”¨æ³•å¦‚ä¸‹è¡¨æ ¼ï¼šTest ç”¨æ³• -d æ–‡ä»¶å å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶ä¸”æ˜¯ç›®å½•ï¼Œè¿”å›true -e æ–‡ä»¶å å¦‚æœæ–‡ä»¶å­˜åœ¨ï¼Œè¿”å›true -f æ–‡ä»¶å å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶ä¸”æ˜¯æ™®é€šæ–‡ä»¶ï¼Œè¿”å›true -r æ–‡ä»¶å å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶å¯è¯»ï¼Œè¿”å›true -s æ–‡ä»¶å å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶ä¸”ä¸ä¸ºç©ºï¼Œè¿”å›true -w æ–‡ä»¶å å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶å¯å†™ï¼Œè¿”å›true -x æ–‡ä»¶å å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶å¯æ‰§è¡Œï¼Œè¿”å›true åœ¨ Shell è„šæœ¬å¦‚ä½•å®šä¹‰å‡½æ•°å‘¢ï¼Ÿé—®ï¼šåœ¨ Shell è„šæœ¬å¦‚ä½•å®šä¹‰å‡½æ•°å‘¢ï¼Ÿ ç­”ï¼šå‡½æ•°æ˜¯æ‹¥æœ‰åå­—çš„ä»£ç å—ã€‚å½“æˆ‘ä»¬å®šä¹‰ä»£ç å—ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨æˆ‘ä»¬çš„è„šæœ¬è°ƒç”¨å‡½æ•°åå­—ï¼Œè¯¥å—å°±ä¼šè¢«æ‰§è¡Œã€‚ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š$ diskusage () { df -h ; } è¯‘æ³¨ï¼šä¸‹é¢æ˜¯æˆ‘ç»™çš„shellå‡½æ•°è¯­æ³•ï¼ŒåŸæ–‡æ²¡æœ‰ [ function ] å‡½æ•°å [()] { å‘½ä»¤; [return int;] } å¦‚ä½•è®© Shell å°±è„šæœ¬å¾—åˆ°æ¥è‡ªç»ˆç«¯çš„è¾“å…¥?é—®ï¼šå¦‚ä½•è®© Shell å°±è„šæœ¬å¾—åˆ°æ¥è‡ªç»ˆç«¯çš„è¾“å…¥? ç­”ï¼š 12345read å‘½ä»¤å¯ä»¥è¯»å–æ¥è‡ªç»ˆç«¯ï¼ˆä½¿ç”¨é”®ç›˜ï¼‰çš„æ•°æ®ã€‚read å‘½ä»¤å¾—åˆ°ç”¨æˆ·çš„è¾“å…¥å¹¶ç½®äºä½ ç»™å‡ºçš„å˜é‡ä¸­ã€‚ä¾‹å­å¦‚ä¸‹ï¼š vi /tmp/test.sh #!/bin/bash echo â€˜Please enter your nameâ€™ read name echo â€œMy Name is $nameâ€ ./test.sh Please enter your name ThinkWon My Name is ThinkWon å¦‚ä½•æ‰§è¡Œç®—æœ¯è¿ç®—ï¼Ÿé—®ï¼šå¦‚ä½•æ‰§è¡Œç®—æœ¯è¿ç®—ï¼Ÿ ç­”ï¼š 12æœ‰ä¸¤ç§æ–¹æ³•æ¥æ‰§è¡Œç®—æœ¯è¿ç®—ï¼š 1ã€ä½¿ç”¨ expr å‘½ä»¤ï¼š## expr 5 + 2 ã€‚ 2ã€ç”¨ä¸€ä¸ªç¾å…ƒç¬¦å·å’Œæ–¹æ‹¬å·ï¼ˆ$[ è¡¨è¾¾å¼ ]ï¼‰ï¼štest=$[16 + 4] ; test=$[16 + 4] ã€‚ åˆ¤æ–­ä¸€æ–‡ä»¶æ˜¯ä¸æ˜¯å­—ç¬¦è®¾å¤‡æ–‡ä»¶ï¼Œå¦‚æœæ˜¯å°†å…¶æ‹·è´åˆ° /dev ç›®å½•ä¸‹ï¼Ÿé—®ï¼šåˆ¤æ–­ä¸€æ–‡ä»¶æ˜¯ä¸æ˜¯å­—ç¬¦è®¾å¤‡æ–‡ä»¶ï¼Œå¦‚æœæ˜¯å°†å…¶æ‹·è´åˆ° /dev ç›®å½•ä¸‹ï¼Ÿ ç­”ï¼š 1#!/bin/bash read -p &quot;Input file name: &quot; FILENAME if [ -c &quot;$FILENAME&quot; ];then cp $FILENAME /dev fi æ·»åŠ ä¸€ä¸ªæ–°ç»„ä¸º class1 ï¼Œç„¶åæ·»åŠ å±äºè¿™ä¸ªç»„çš„ 30 ä¸ªç”¨æˆ·ï¼Œç”¨æˆ·åçš„å½¢å¼ä¸º stdxx ï¼Œå…¶é—®ï¼šæ·»åŠ ä¸€ä¸ªæ–°ç»„ä¸º class1 ï¼Œç„¶åæ·»åŠ å±äºè¿™ä¸ªç»„çš„ 30 ä¸ªç”¨æˆ·ï¼Œç”¨æˆ·åçš„å½¢å¼ä¸º stdxx ï¼Œå…¶ä¸­ xx ä» 01 åˆ° 30 ï¼Ÿ ç­”ï¼š 1#!/bin/bash groupadd class1 for((i=1;i&lt;31;i++)) do if [ $i -le 10 ];then useradd -g class1 std0$i else useradd -g class1 std$i fi done ç¼–å†™ Shell ç¨‹åºï¼Œå®ç°è‡ªåŠ¨åˆ é™¤ 50 ä¸ªè´¦å·çš„åŠŸèƒ½ï¼Œè´¦å·åä¸ºstud1 è‡³ stud50 ï¼Ÿé—®ï¼šç¼–å†™ Shell ç¨‹åºï¼Œå®ç°è‡ªåŠ¨åˆ é™¤ 50 ä¸ªè´¦å·çš„åŠŸèƒ½ï¼Œè´¦å·åä¸ºstud1 è‡³ stud50 ï¼Ÿ ç­”ï¼š 12345#!/bin/bashfor((i=1;i&lt;51;i++))do userdel -r stud$idone å†™ä¸€ä¸ª sed å‘½ä»¤ï¼Œä¿®æ”¹ /tmp/input.txt æ–‡ä»¶çš„å†…å®¹ï¼Ÿé—®ï¼šå†™ä¸€ä¸ª sed å‘½ä»¤ï¼Œä¿®æ”¹ /tmp/input.txt æ–‡ä»¶çš„å†…å®¹ï¼Ÿ è¦æ±‚ï¼šåˆ é™¤æ‰€æœ‰ç©ºè¡Œã€‚ ä¸€è¡Œä¸­ï¼Œå¦‚æœåŒ…å« â€œ11111â€ï¼Œåˆ™åœ¨ â€œ11111â€ å‰é¢æ’å…¥ â€œAAAâ€ï¼Œåœ¨ â€œ11111â€ åé¢æ’å…¥ â€œBBBâ€ ã€‚æ¯”å¦‚ï¼šå°†å†…å®¹ä¸º 0000111112222 çš„ä¸€è¡Œæ”¹ä¸º 0000AAA11111BBB2222 ã€‚ ç­”ï¼š 1234567891011121314151617181920212223242526272829303132[root@~]## cat -n /tmp/input.txt 1 000011111222 2 3 000011111222222 4 11111000000222 5 6 7 111111111111122222222222 8 2211111111 9 112222222 10 1122 11## åˆ é™¤æ‰€æœ‰ç©ºè¡Œå‘½ä»¤[root@~]## sed &apos;/^$/d&apos; /tmp/input.txt0000111112220000111112222221111100000022211111111111112222222222222111111111122222221122## æ’å…¥æŒ‡å®šçš„å­—ç¬¦[root@~]## sed &apos;s#\\(11111\\)#AAA\\1BBB#g&apos; /tmp/input.txt0000AAA11111BBB2220000AAA11111BBB222222AAA11111BBB000000222AAA11111BBBAAA11111BBB1112222222222222AAA11111BBB1111122222221122 å¦‚ä½•é€‰æ‹© Linux æ“ä½œç³»ç»Ÿç‰ˆæœ¬?é—®ï¼šå¦‚ä½•é€‰æ‹© Linux æ“ä½œç³»ç»Ÿç‰ˆæœ¬? ç­”ï¼šä¸€èˆ¬æ¥è®²ï¼Œæ¡Œé¢ç”¨æˆ·é¦–é€‰ Ubuntu ï¼›æœåŠ¡å™¨é¦–é€‰ RHEL æˆ– CentOS ï¼Œä¸¤è€…ä¸­é¦–é€‰ CentOS ã€‚æ ¹æ®å…·ä½“è¦æ±‚ï¼šå®‰å…¨æ€§è¦æ±‚è¾ƒé«˜ï¼Œåˆ™é€‰æ‹© Debian æˆ–è€… FreeBSD ã€‚éœ€è¦ä½¿ç”¨æ•°æ®åº“é«˜çº§æœåŠ¡å’Œç”µå­é‚®ä»¶ç½‘ç»œåº”ç”¨çš„ç”¨æˆ·å¯ä»¥é€‰æ‹© SUSE ã€‚æƒ³è¦æ–°æŠ€æœ¯æ–°åŠŸèƒ½å¯ä»¥é€‰æ‹© Feddora ï¼ŒFeddora æ˜¯ RHEL å’Œ CentOS çš„ä¸€ä¸ªæµ‹è¯•ç‰ˆå’Œé¢„å‘å¸ƒç‰ˆæœ¬ã€‚ã€é‡ç‚¹ã€‘æ ¹æ®ç°æœ‰çŠ¶å†µï¼Œç»å¤§å¤šæ•°äº’è”ç½‘å…¬å¸é€‰æ‹© CentOS ã€‚ç°åœ¨æ¯”è¾ƒå¸¸ç”¨çš„æ˜¯ 6 ç³»åˆ—ï¼Œç°åœ¨å¸‚åœºå æœ‰å¤§æ¦‚ä¸€åŠå·¦å³ã€‚å¦å¤–çš„åŸå› æ˜¯ CentOS æ›´ä¾§é‡æœåŠ¡å™¨é¢†åŸŸï¼Œå¹¶ä¸”æ— ç‰ˆæƒçº¦æŸã€‚CentOS 7 ç³»åˆ—ï¼Œä¹Ÿæ…¢æ…¢ä½¿ç”¨çš„ä¼šæ¯”è¾ƒå¤šäº†ã€‚ å¦‚ä½•è§„åˆ’ä¸€å° Linux ä¸»æœºï¼Œæ­¥éª¤æ˜¯æ€æ ·ï¼Ÿé—®ï¼šå¦‚ä½•è§„åˆ’ä¸€å° Linux ä¸»æœºï¼Œæ­¥éª¤æ˜¯æ€æ ·ï¼Ÿ ç­”ï¼š1ã€ç¡®å®šæœºå™¨æ˜¯åšä»€ä¹ˆç”¨çš„ï¼Œæ¯”å¦‚æ˜¯åš WEB ã€DBã€è¿˜æ˜¯æ¸¸æˆæœåŠ¡å™¨ã€‚ä¸åŒçš„ç”¨é€”ï¼Œæœºå™¨çš„é…ç½®ä¼šæœ‰æ‰€ä¸åŒã€‚2ã€ç¡®å®šå¥½ä¹‹åï¼Œå°±è¦å®šç³»ç»Ÿéœ€è¦æ€ä¹ˆå®‰è£…ï¼Œé»˜è®¤å®‰è£…å“ªäº›ç³»ç»Ÿã€åˆ†åŒºæ€ä¹ˆåšã€‚3ã€éœ€è¦ä¼˜åŒ–ç³»ç»Ÿçš„å“ªäº›å‚æ•°ï¼Œéœ€è¦åˆ›å»ºå“ªäº›ç”¨æˆ·ç­‰ç­‰çš„ã€‚ æœ‰å“ªäº›æ–¹é¢çš„å› ç´ ä¼šå¯¼è‡´ç½‘ç«™ç½‘ç«™è®¿é—®æ…¢ï¼Ÿé—®ï¼šæœ‰å“ªäº›æ–¹é¢çš„å› ç´ ä¼šå¯¼è‡´ç½‘ç«™ç½‘ç«™è®¿é—®æ…¢ï¼Ÿ ç­”ï¼š1ã€æœåŠ¡å™¨å‡ºå£å¸¦å®½ä¸å¤Ÿç”¨æœ¬èº«æœåŠ¡å™¨è´­ä¹°çš„å‡ºå£å¸¦å®½æ¯”è¾ƒå°ã€‚ä¸€æ—¦å¹¶å‘é‡å¤§çš„è¯ï¼Œå°±ä¼šé€ æˆåˆ†ç»™æ¯ä¸ªç”¨æˆ·çš„å‡ºå£å¸¦å®½å°±å°ï¼Œè®¿é—®é€Ÿåº¦è‡ªç„¶å°±ä¼šæ…¢ã€‚ è·¨è¿è¥å•†ç½‘ç»œå¯¼è‡´å¸¦å®½ç¼©å‡ã€‚ä¾‹å¦‚ï¼Œå…¬å¸ç½‘ç«™æ”¾åœ¨ç”µä¿¡çš„ç½‘ç»œä¸Šï¼Œé‚£ä¹ˆå®¢æˆ·è¿™è¾¹å¯¹æ¥æ˜¯é•¿åŸå®½å¸¦æˆ–è”é€šï¼Œè¿™ä¹Ÿå¯èƒ½å¯¼è‡´å¸¦å®½çš„ç¼©å‡ã€‚ 2ã€æœåŠ¡å™¨è´Ÿè½½è¿‡å¤§ï¼Œå¯¼è‡´å“åº”ä¸è¿‡æ¥å¯ä»¥ä»ä¸¤ä¸ªæ–¹é¢å…¥æ‰‹åˆ†æï¼šåˆ†æç³»ç»Ÿè´Ÿè½½ï¼Œä½¿ç”¨ w å‘½ä»¤æˆ–è€… uptime å‘½ä»¤æŸ¥çœ‹ç³»ç»Ÿè´Ÿè½½ã€‚å¦‚æœè´Ÿè½½å¾ˆé«˜ï¼Œåˆ™ä½¿ç”¨ top å‘½ä»¤æŸ¥çœ‹ CPU ï¼ŒMEM ç­‰å ç”¨æƒ…å†µï¼Œè¦ä¹ˆæ˜¯ CPU ç¹å¿™ï¼Œè¦ä¹ˆæ˜¯å†…å­˜ä¸å¤Ÿã€‚ å¦‚æœè¿™äºŒè€…éƒ½æ­£å¸¸ï¼Œå†å»ä½¿ç”¨ sar å‘½ä»¤åˆ†æç½‘å¡æµé‡ï¼Œåˆ†ææ˜¯ä¸æ˜¯é­åˆ°äº†æ”»å‡»ã€‚ä¸€æ—¦åˆ†æå‡ºé—®é¢˜çš„åŸå› ï¼Œé‡‡å–å¯¹åº”çš„æªæ–½è§£å†³ï¼Œå¦‚å†³å®šè¦ä¸è¦æ€æ­»ä¸€äº›è¿›ç¨‹ï¼Œæˆ–è€…ç¦æ­¢ä¸€äº›è®¿é—®ç­‰ã€‚ 3ã€æ•°æ®åº“ç“¶é¢ˆå¦‚æœæ…¢æŸ¥è¯¢æ¯”è¾ƒå¤šã€‚é‚£ä¹ˆå°±è¦å¼€å‘äººå‘˜æˆ– DBA ååŠ©è¿›è¡Œ SQL è¯­å¥çš„ä¼˜åŒ–ã€‚ å¦‚æœæ•°æ®åº“å“åº”æ…¢ï¼Œè€ƒè™‘å¯ä»¥åŠ ä¸€ä¸ªæ•°æ®åº“ç¼“å­˜ï¼Œå¦‚ Redis ç­‰ã€‚ç„¶åï¼Œä¹Ÿå¯ä»¥æ­å»º MySQL ä¸»ä»ï¼Œä¸€å° MySQL æœåŠ¡å™¨è´Ÿè´£å†™ï¼Œå…¶ä»–å‡ å°ä»æ•°æ®åº“è´Ÿè´£è¯»ã€‚ 4ã€ç½‘ç«™å¼€å‘ä»£ç æ²¡æœ‰ä¼˜åŒ–å¥½ä¾‹å¦‚ SQL è¯­å¥æ²¡æœ‰ä¼˜åŒ–ï¼Œå¯¼è‡´æ•°æ®åº“è¯»å†™ç›¸å½“è€—æ—¶ã€‚ é’ˆå¯¹ç½‘ç«™è®¿é—®æ…¢ï¼Œæ€ä¹ˆå»æ’æŸ¥ï¼Ÿé—®ï¼šé’ˆå¯¹ç½‘ç«™è®¿é—®æ…¢ï¼Œæ€ä¹ˆå»æ’æŸ¥ï¼Ÿ ç­”ï¼š1ã€é¦–å…ˆè¦ç¡®å®šæ˜¯ç”¨æˆ·ç«¯è¿˜æ˜¯æœåŠ¡ç«¯çš„é—®é¢˜ã€‚å½“æ¥åˆ°ç”¨æˆ·åé¦ˆè®¿é—®æ…¢ï¼Œé‚£è¾¹è‡ªå·±ç«‹å³è®¿é—®ç½‘ç«™çœ‹çœ‹ï¼Œå¦‚æœè‡ªå·±è¿™è¾¹è®¿é—®å¿«ï¼ŒåŸºæœ¬æ–­å®šæ˜¯ç”¨æˆ·ç«¯é—®é¢˜ï¼Œå°±éœ€è¦è€å¿ƒè·Ÿå®¢æˆ·è§£é‡Šï¼ŒååŠ©å®¢æˆ·è§£å†³é—®é¢˜ã€‚ä¸è¦ä¸Šæ¥å°±çœ‹æœåŠ¡ç«¯çš„é—®é¢˜ã€‚ä¸€å®šè¦ä»æºå¤´å¼€å§‹ï¼Œé€æ­¥é€æ­¥å¾€ä¸‹ã€‚2ã€å¦‚æœè®¿é—®ä¹Ÿæ…¢ï¼Œé‚£ä¹ˆå¯ä»¥åˆ©ç”¨æµè§ˆå™¨çš„è°ƒè¯•åŠŸèƒ½ï¼Œçœ‹çœ‹åŠ è½½é‚£ä¸€é¡¹æ•°æ®æ¶ˆè€—æ—¶é—´è¿‡å¤šï¼Œæ˜¯å›¾ç‰‡åŠ è½½æ…¢ï¼Œè¿˜æ˜¯æŸäº›æ•°æ®åŠ è½½æ…¢ã€‚3ã€é’ˆå¯¹æœåŠ¡å™¨è´Ÿè½½æƒ…å†µã€‚æŸ¥çœ‹æœåŠ¡å™¨ç¡¬ä»¶(ç½‘ç»œã€CPUã€å†…å­˜)çš„æ¶ˆè€—æƒ…å†µã€‚å¦‚æœæ˜¯è´­ä¹°çš„äº‘ä¸»æœºï¼Œæ¯”å¦‚é˜¿é‡Œäº‘ï¼Œå¯ä»¥ç™»å½•é˜¿é‡Œäº‘å¹³å°æä¾›å„æ–¹é¢çš„ç›‘æ§ï¼Œæ¯”å¦‚ CPUã€å†…å­˜ã€å¸¦å®½çš„ä½¿ç”¨æƒ…å†µã€‚4ã€å¦‚æœå‘ç°ç¡¬ä»¶èµ„æºæ¶ˆè€—éƒ½ä¸é«˜ï¼Œé‚£ä¹ˆå°±éœ€è¦é€šè¿‡æŸ¥æ—¥å¿—ï¼Œæ¯”å¦‚çœ‹çœ‹ MySQLæ…¢æŸ¥è¯¢çš„æ—¥å¿—ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯æŸæ¡ SQL è¯­å¥æŸ¥è¯¢æ…¢ï¼Œå¯¼è‡´ç½‘ç«™è®¿é—®æ…¢ã€‚ é’ˆå¯¹ç½‘ç«™è®¿é—®æ…¢ï¼Œæ€ä¹ˆå»è§£å†³ï¼Ÿé—®ï¼šé’ˆå¯¹ç½‘ç«™è®¿é—®æ…¢ï¼Œæ€ä¹ˆå»è§£å†³ï¼Ÿ ç­”ï¼š1ã€å¦‚æœæ˜¯å‡ºå£å¸¦å®½é—®é¢˜ï¼Œé‚£ä¹ˆä¹…ç”³è¯·åŠ å¤§å‡ºå£å¸¦å®½ã€‚ 2ã€å¦‚æœæ…¢æŸ¥è¯¢æ¯”è¾ƒå¤šï¼Œé‚£ä¹ˆå°±è¦å¼€å‘äººå‘˜æˆ– DBA ååŠ©è¿›è¡Œ SQL è¯­å¥çš„ä¼˜åŒ–ã€‚ 3ã€å¦‚æœæ•°æ®åº“å“åº”æ…¢ï¼Œè€ƒè™‘å¯ä»¥åŠ ä¸€ä¸ªæ•°æ®åº“ç¼“å­˜ï¼Œå¦‚ Redis ç­‰ç­‰ã€‚ç„¶åä¹Ÿå¯ä»¥æ­å»ºMySQL ä¸»ä»ï¼Œä¸€å° MySQL æœåŠ¡å™¨è´Ÿè´£å†™ï¼Œå…¶ä»–å‡ å°ä»æ•°æ®åº“è´Ÿè´£è¯»ã€‚ 4ã€ç”³è¯·è´­ä¹° CDN æœåŠ¡ï¼ŒåŠ è½½ç”¨æˆ·çš„è®¿é—®ã€‚ 5ã€å¦‚æœè®¿é—®è¿˜æ¯”è¾ƒæ…¢ï¼Œé‚£å°±éœ€è¦ä»æ•´ä½“æ¶æ„ä¸Šè¿›è¡Œä¼˜åŒ–å’¯ã€‚åšåˆ°ä¸“è§’è‰²ä¸“ç”¨ï¼Œå¤šå°æœåŠ¡å™¨æä¾›åŒä¸€ä¸ªæœåŠ¡ã€‚ Linux æ€§èƒ½è°ƒä¼˜éƒ½æœ‰å“ªå‡ ç§æ–¹æ³•ï¼Ÿé—®ï¼šLinux æ€§èƒ½è°ƒä¼˜éƒ½æœ‰å“ªå‡ ç§æ–¹æ³•ï¼Ÿ ç­”ï¼š1ã€Disabling daemons (å…³é—­ daemons)ã€‚ 2ã€Shutting down the GUI (å…³é—­ GUI)ã€‚ 3ã€Changing kernel parameters (æ”¹å˜å†…æ ¸å‚æ•°)ã€‚ 4ã€Kernel parameters (å†…æ ¸å‚æ•°)ã€‚ 5ã€Tuning the processor subsystem (å¤„ç†å™¨å­ç³»ç»Ÿè°ƒä¼˜)ã€‚ 6ã€Tuning the memory subsystem (å†…å­˜å­ç³»ç»Ÿè°ƒä¼˜)ã€‚ 7ã€Tuning the file system (æ–‡ä»¶ç³»ç»Ÿå­ç³»ç»Ÿè°ƒä¼˜)ã€‚ 8ã€Tuning the network subsystemï¼ˆç½‘ç»œå­ç³»ç»Ÿè°ƒä¼˜)ã€‚ cat å‘½ä»¤é—®ï¼šcat å‘½ä»¤ ç­”ï¼šcatå‘½ä»¤ä¸»è¦ç”¨æ¥æŸ¥çœ‹æ–‡ä»¶å†…å®¹ï¼Œåˆ›å»ºæ–‡ä»¶ï¼Œæ–‡ä»¶åˆå¹¶ï¼Œè¿½åŠ æ–‡ä»¶å†…å®¹ç­‰åŠŸèƒ½ã€‚eg:1ã€cat f1.txtï¼ŒæŸ¥çœ‹f1.txtæ–‡ä»¶çš„å†…å®¹ã€‚ ç­”ï¼šcat å‘½ä»¤ç”¨äºè¿æ¥æ–‡ä»¶å¹¶æ‰“å°åˆ°æ ‡å‡†è¾“å‡ºè®¾å¤‡ä¸Šã€‚cat ä¸»è¦æœ‰ä¸‰å¤§åŠŸèƒ½ï¼š1.ä¸€æ¬¡æ˜¾ç¤ºæ•´ä¸ªæ–‡ä»¶:cat filename 1 2.ä»é”®ç›˜åˆ›å»ºä¸€ä¸ªæ–‡ä»¶:cat &gt; filename 1 åªèƒ½åˆ›å»ºæ–°æ–‡ä»¶ï¼Œä¸èƒ½ç¼–è¾‘å·²æœ‰æ–‡ä»¶ã€‚3.å°†å‡ ä¸ªæ–‡ä»¶åˆå¹¶ä¸ºä¸€ä¸ªæ–‡ä»¶:cat file1 file2 &gt; file 1 -b å¯¹éç©ºè¾“å‡ºè¡Œå· -n è¾“å‡ºæ‰€æœ‰è¡Œå· å®ä¾‹ï¼šï¼ˆ1ï¼‰æŠŠ log2012.log çš„æ–‡ä»¶å†…å®¹åŠ ä¸Šè¡Œå·åè¾“å…¥ log2013.log è¿™ä¸ªæ–‡ä»¶é‡Œcat -n log2012.log log2013.log 1 ï¼ˆ2ï¼‰æŠŠ log2012.log å’Œ log2013.log çš„æ–‡ä»¶å†…å®¹åŠ ä¸Šè¡Œå·ï¼ˆç©ºç™½è¡Œä¸åŠ ï¼‰ä¹‹åå°†å†…å®¹é™„åŠ åˆ° log.log é‡Œcat -b log2012.log log2013.log log.log 1 ï¼ˆ3ï¼‰ä½¿ç”¨ here doc ç”Ÿæˆæ–°æ–‡ä»¶cat &gt;log.txt &lt;&lt;EOF Hello World PWD=$(pwd) EOF ls -l log.txt cat log.txt Hello World PWD=/opt/soft/test 1 2 3 4 5 6 7 8 9 10 ï¼ˆ4ï¼‰åå‘åˆ—ç¤º tac log.txt PWD=/opt/soft/test World Hello chmod å‘½ä»¤é—®ï¼šchmod å‘½ä»¤ ç­”ï¼šæ”¹å˜ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶çš„å­˜å–æ¨¡å¼(mode) ç­”ï¼šLinux/Unix çš„æ–‡ä»¶è°ƒç”¨æƒé™åˆ†ä¸ºä¸‰çº§ : æ–‡ä»¶æ‹¥æœ‰è€…ã€ç¾¤ç»„ã€å…¶ä»–ã€‚åˆ©ç”¨ chmod å¯ä»¥æ§åˆ¶æ–‡ä»¶å¦‚ä½•è¢«ä»–äººæ‰€è°ƒç”¨ã€‚ç”¨äºæ”¹å˜ linux ç³»ç»Ÿæ–‡ä»¶æˆ–ç›®å½•çš„è®¿é—®æƒé™ã€‚ç”¨å®ƒæ§åˆ¶æ–‡ä»¶æˆ–ç›®å½•çš„è®¿é—®æƒé™ã€‚è¯¥å‘½ä»¤æœ‰ä¸¤ç§ç”¨æ³•ã€‚ä¸€ç§æ˜¯åŒ…å«å­—æ¯å’Œæ“ä½œç¬¦è¡¨è¾¾å¼çš„æ–‡å­—è®¾å®šæ³•ï¼›å¦ä¸€ç§æ˜¯åŒ…å«æ•°å­—çš„æ•°å­—è®¾å®šæ³•ã€‚æ¯ä¸€æ–‡ä»¶æˆ–ç›®å½•çš„è®¿é—®æƒé™éƒ½æœ‰ä¸‰ç»„ï¼Œæ¯ç»„ç”¨ä¸‰ä½è¡¨ç¤ºï¼Œåˆ†åˆ«ä¸ºæ–‡ä»¶å±ä¸»çš„è¯»ã€å†™å’Œæ‰§è¡Œæƒé™ï¼›ä¸å±ä¸»åŒç»„çš„ç”¨æˆ·çš„è¯»ã€å†™å’Œæ‰§è¡Œæƒé™ï¼›ç³»ç»Ÿä¸­å…¶ä»–ç”¨æˆ·çš„è¯»ã€å†™å’Œæ‰§è¡Œæƒé™ã€‚å¯ä½¿ç”¨ ls -l test.txt æŸ¥æ‰¾ã€‚ä»¥æ–‡ä»¶ log2012.log ä¸ºä¾‹ï¼š-rw-râ€”râ€” 1 root root 296K 11-13 06:03 log2012.log 1 ç¬¬ä¸€åˆ—å…±æœ‰ 10 ä¸ªä½ç½®ï¼Œç¬¬ä¸€ä¸ªå­—ç¬¦æŒ‡å®šäº†æ–‡ä»¶ç±»å‹ã€‚åœ¨é€šå¸¸æ„ä¹‰ä¸Šï¼Œä¸€ä¸ªç›®å½•ä¹Ÿæ˜¯ä¸€ä¸ªæ–‡ä»¶ã€‚å¦‚æœç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯æ¨ªçº¿ï¼Œè¡¨ç¤ºæ˜¯ä¸€ä¸ªéç›®å½•çš„æ–‡ä»¶ã€‚å¦‚æœæ˜¯ dï¼Œè¡¨ç¤ºæ˜¯ä¸€ä¸ªç›®å½•ã€‚ä»ç¬¬äºŒä¸ªå­—ç¬¦å¼€å§‹åˆ°ç¬¬åä¸ª 9 ä¸ªå­—ç¬¦ï¼Œ3 ä¸ªå­—ç¬¦ä¸€ç»„ï¼Œåˆ†åˆ«è¡¨ç¤ºäº† 3 ç»„ç”¨æˆ·å¯¹æ–‡ä»¶æˆ–è€…ç›®å½•çš„æƒé™ã€‚æƒé™å­—ç¬¦ç”¨æ¨ªçº¿ä»£è¡¨ç©ºè®¸å¯ï¼Œr ä»£è¡¨åªè¯»ï¼Œw ä»£è¡¨å†™ï¼Œx ä»£è¡¨å¯æ‰§è¡Œã€‚å¸¸ç”¨å‚æ•°ï¼š-c å½“å‘ç”Ÿæ”¹å˜æ—¶ï¼ŒæŠ¥å‘Šå¤„ç†ä¿¡æ¯ -R å¤„ç†æŒ‡å®šç›®å½•ä»¥åŠå…¶å­ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ 1 2 æƒé™èŒƒå›´ï¼šu ï¼šç›®å½•æˆ–è€…æ–‡ä»¶çš„å½“å‰çš„ç”¨æˆ· g ï¼šç›®å½•æˆ–è€…æ–‡ä»¶çš„å½“å‰çš„ç¾¤ç»„ o ï¼šé™¤äº†ç›®å½•æˆ–è€…æ–‡ä»¶çš„å½“å‰ç”¨æˆ·æˆ–ç¾¤ç»„ä¹‹å¤–çš„ç”¨æˆ·æˆ–è€…ç¾¤ç»„ a ï¼šæ‰€æœ‰çš„ç”¨æˆ·åŠç¾¤ç»„ 1 2 3 4 æƒé™ä»£å·ï¼šr ï¼šè¯»æƒé™ï¼Œç”¨æ•°å­—4è¡¨ç¤º w ï¼šå†™æƒé™ï¼Œç”¨æ•°å­—2è¡¨ç¤º x ï¼šæ‰§è¡Œæƒé™ï¼Œç”¨æ•°å­—1è¡¨ç¤º - ï¼šåˆ é™¤æƒé™ï¼Œç”¨æ•°å­—0è¡¨ç¤º s ï¼šç‰¹æ®Šæƒé™ 1 2 3 4 5 å®ä¾‹ï¼šï¼ˆ1ï¼‰å¢åŠ æ–‡ä»¶ t.log æ‰€æœ‰ç”¨æˆ·å¯æ‰§è¡Œæƒé™chmod a+x t.log 1 ï¼ˆ2ï¼‰æ’¤é”€åŸæ¥æ‰€æœ‰çš„æƒé™ï¼Œç„¶åä½¿æ‹¥æœ‰è€…å…·æœ‰å¯è¯»æƒé™,å¹¶è¾“å‡ºå¤„ç†ä¿¡æ¯chmod u=r t.log -c 1 ï¼ˆ3ï¼‰ç»™ file çš„å±ä¸»åˆ†é…è¯»ã€å†™ã€æ‰§è¡Œ(7)çš„æƒé™ï¼Œç»™fileçš„æ‰€åœ¨ç»„åˆ†é…è¯»ã€æ‰§è¡Œ(5)çš„æƒé™ï¼Œç»™å…¶ä»–ç”¨æˆ·åˆ†é…æ‰§è¡Œ(1)çš„æƒé™chmod 751 t.log -cï¼ˆæˆ–è€…ï¼šchmod u=rwx,g=rx,o=x t.log -c) 1 ï¼ˆ4ï¼‰å°† test ç›®å½•åŠå…¶å­ç›®å½•æ‰€æœ‰æ–‡ä»¶æ·»åŠ å¯è¯»æƒé™chmod u+r,g+r,o+r -R text/ -c chown å‘½ä»¤é—®ï¼šchown å‘½ä»¤ ç­”ï¼šchown å°†æŒ‡å®šæ–‡ä»¶çš„æ‹¥æœ‰è€…æ”¹ä¸ºæŒ‡å®šçš„ç”¨æˆ·æˆ–ç»„ï¼Œç”¨æˆ·å¯ä»¥æ˜¯ç”¨æˆ·åæˆ–è€…ç”¨æˆ· IDï¼›ç»„å¯ä»¥æ˜¯ç»„åæˆ–è€…ç»„ IDï¼›æ–‡ä»¶æ˜¯ä»¥ç©ºæ ¼åˆ†å¼€çš„è¦æ”¹å˜æƒé™çš„æ–‡ä»¶åˆ—è¡¨ï¼Œæ”¯æŒé€šé…ç¬¦ã€‚-c æ˜¾ç¤ºæ›´æ”¹çš„éƒ¨åˆ†çš„ä¿¡æ¯ -R å¤„ç†æŒ‡å®šç›®å½•åŠå­ç›®å½• 1 2 å®ä¾‹ï¼šï¼ˆ1ï¼‰æ”¹å˜æ‹¥æœ‰è€…å’Œç¾¤ç»„ å¹¶æ˜¾ç¤ºæ”¹å˜ä¿¡æ¯chown -c mail:mail log2012.log 1 ï¼ˆ2ï¼‰æ”¹å˜æ–‡ä»¶ç¾¤ç»„chown -c :mail t.log 1 ï¼ˆ3ï¼‰æ”¹å˜æ–‡ä»¶å¤¹åŠå­æ–‡ä»¶ç›®å½•å±ä¸»åŠå±ç»„ä¸º mailchown -cR mail: test/ cp å‘½ä»¤é—®ï¼šcp å‘½ä»¤ ç­”ï¼šå°†æºæ–‡ä»¶å¤åˆ¶åˆ°ä½ æƒ³ç§»åŠ¨åˆ°çš„æ–‡ä»¶ ç­”ï¼šå°†æºæ–‡ä»¶å¤åˆ¶è‡³ç›®æ ‡æ–‡ä»¶ï¼Œæˆ–å°†å¤šä¸ªæºæ–‡ä»¶å¤åˆ¶è‡³ç›®æ ‡ç›®å½•ã€‚æ³¨æ„ï¼šå‘½ä»¤è¡Œå¤åˆ¶ï¼Œå¦‚æœç›®æ ‡æ–‡ä»¶å·²ç»å­˜åœ¨ä¼šæç¤ºæ˜¯å¦è¦†ç›–ï¼Œè€Œåœ¨ shell è„šæœ¬ä¸­ï¼Œå¦‚æœä¸åŠ  -i å‚æ•°ï¼Œåˆ™ä¸ä¼šæç¤ºï¼Œè€Œæ˜¯ç›´æ¥è¦†ç›–ï¼-i æç¤º -r å¤åˆ¶ç›®å½•åŠç›®å½•å†…æ‰€æœ‰é¡¹ç›® -a å¤åˆ¶çš„æ–‡ä»¶ä¸åŸæ–‡ä»¶æ—¶é—´ä¸€æ · 1 2 3 å®ä¾‹ï¼šï¼ˆ1ï¼‰å¤åˆ¶ a.txt åˆ° test ç›®å½•ä¸‹ï¼Œä¿æŒåŸæ–‡ä»¶æ—¶é—´ï¼Œå¦‚æœåŸæ–‡ä»¶å­˜åœ¨æç¤ºæ˜¯å¦è¦†ç›–ã€‚cp -ai a.txt test 1 ï¼ˆ2ï¼‰ä¸º a.txt å»ºè®®ä¸€ä¸ªé“¾æ¥ï¼ˆå¿«æ·æ–¹å¼ï¼‰cp -s a.txt link_a.txt find å‘½ä»¤é—®ï¼šfind å‘½ä»¤ ç­”ï¼š 1234567891011ç”¨äºåœ¨æ–‡ä»¶æ ‘ä¸­æŸ¥æ‰¾æ–‡ä»¶ï¼Œå¹¶ä½œå‡ºç›¸åº”çš„å¤„ç†ã€‚ å‘½ä»¤æ ¼å¼ï¼š find pathname -options [-print -exec -ok ...] 1 å‘½ä»¤å‚æ•°ï¼š pathname: findå‘½ä»¤æ‰€æŸ¥æ‰¾çš„ç›®å½•è·¯å¾„ã€‚ä¾‹å¦‚ç”¨.æ¥è¡¨ç¤ºå½“å‰ç›®å½•ï¼Œç”¨/æ¥è¡¨ç¤ºç³»ç»Ÿæ ¹ç›®å½•ã€‚ -printï¼š findå‘½ä»¤å°†åŒ¹é…çš„æ–‡ä»¶è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºã€‚ -execï¼š findå‘½ä»¤å¯¹åŒ¹é…çš„æ–‡ä»¶æ‰§è¡Œè¯¥å‚æ•°æ‰€ç»™å‡ºçš„shellå‘½ä»¤ã€‚ç›¸åº”å‘½ä»¤çš„å½¢å¼ä¸º&apos;command&apos; &#123; &#125; ;ï¼Œæ³¨æ„&#123; &#125;å’Œ\\ï¼›ä¹‹é—´çš„ç©ºæ ¼ã€‚ -okï¼š å’Œ-execçš„ä½œç”¨ç›¸åŒï¼Œåªä¸è¿‡ä»¥ä¸€ç§æ›´ä¸ºå®‰å…¨çš„æ¨¡å¼æ¥æ‰§è¡Œè¯¥å‚æ•°æ‰€ç»™å‡ºçš„shellå‘½ä»¤ï¼Œåœ¨æ‰§è¡Œæ¯ä¸€ä¸ªå‘½ä»¤ä¹‹å‰ï¼Œéƒ½ä¼šç»™å‡ºæç¤ºï¼Œè®©ç”¨æˆ·æ¥ç¡®å®šæ˜¯å¦æ‰§è¡Œã€‚ 1 2 3 4 å‘½ä»¤é€‰é¡¹ï¼š -name æŒ‰ç…§æ–‡ä»¶åæŸ¥æ‰¾æ–‡ä»¶ -perm æŒ‰æ–‡ä»¶æƒé™æŸ¥æ‰¾æ–‡ä»¶ -user æŒ‰æ–‡ä»¶å±ä¸»æŸ¥æ‰¾æ–‡ä»¶ -group æŒ‰ç…§æ–‡ä»¶æ‰€å±çš„ç»„æ¥æŸ¥æ‰¾æ–‡ä»¶ã€‚ -type æŸ¥æ‰¾æŸä¸€ç±»å‹çš„æ–‡ä»¶ï¼Œè¯¸å¦‚ï¼š b - å—è®¾å¤‡æ–‡ä»¶ d - ç›®å½• c - å­—ç¬¦è®¾å¤‡æ–‡ä»¶ l - ç¬¦å·é“¾æ¥æ–‡ä»¶ p - ç®¡é“æ–‡ä»¶ f - æ™®é€šæ–‡ä»¶ 1 2 3 4 5 6 7 8 9 10 11 å®ä¾‹ï¼š ï¼ˆ1ï¼‰æŸ¥æ‰¾ 48 å°æ—¶å†…ä¿®æ”¹è¿‡çš„æ–‡ä»¶ find -atime -2 1 ï¼ˆ2ï¼‰åœ¨å½“å‰ç›®å½•æŸ¥æ‰¾ ä»¥ .log ç»“å°¾çš„æ–‡ä»¶ã€‚ . ä»£è¡¨å½“å‰ç›®å½• find ./ -name &apos;*.log&apos; 1 ï¼ˆ3ï¼‰æŸ¥æ‰¾ /opt ç›®å½•ä¸‹ æƒé™ä¸º 777 çš„æ–‡ä»¶ find /opt -perm 777 1 ï¼ˆ4ï¼‰æŸ¥æ‰¾å¤§äº 1K çš„æ–‡ä»¶ find -size +1000c 1 æŸ¥æ‰¾ç­‰äº 1000 å­—ç¬¦çš„æ–‡ä»¶ find -size 1000c 1 -exec å‚æ•°åé¢è·Ÿçš„æ˜¯ command å‘½ä»¤ï¼Œå®ƒçš„ç»ˆæ­¢æ˜¯ä»¥ ; ä¸ºç»“æŸæ ‡å¿—çš„ï¼Œæ‰€ä»¥è¿™å¥å‘½ä»¤åé¢çš„åˆ†å·æ˜¯ä¸å¯ç¼ºå°‘çš„ï¼Œè€ƒè™‘åˆ°å„ä¸ªç³»ç»Ÿä¸­åˆ†å·ä¼šæœ‰ä¸åŒçš„æ„ä¹‰ï¼Œæ‰€ä»¥å‰é¢åŠ åæ–œæ ã€‚&#123;&#125; èŠ±æ‹¬å·ä»£è¡¨å‰é¢findæŸ¥æ‰¾å‡ºæ¥çš„æ–‡ä»¶åã€‚ head å‘½ä»¤é—®ï¼šhead å‘½ä»¤ ç­”ï¼šhead ç”¨æ¥æ˜¾ç¤ºæ¡£æ¡ˆçš„å¼€å¤´è‡³æ ‡å‡†è¾“å‡ºä¸­ï¼Œé»˜è®¤ head å‘½ä»¤æ‰“å°å…¶ç›¸åº”æ–‡ä»¶çš„å¼€å¤´ 10 è¡Œã€‚å¸¸ç”¨å‚æ•°ï¼š-n&lt;è¡Œæ•°&gt; æ˜¾ç¤ºçš„è¡Œæ•°ï¼ˆè¡Œæ•°ä¸ºå¤æ•°è¡¨ç¤ºä»æœ€åå‘å‰æ•°ï¼‰ 1 å®ä¾‹ï¼šï¼ˆ1ï¼‰æ˜¾ç¤º 1.log æ–‡ä»¶ä¸­å‰ 20 è¡Œhead 1.log -n 20 1 ï¼ˆ2ï¼‰æ˜¾ç¤º 1.log æ–‡ä»¶å‰ 20 å­—èŠ‚head -c 20 log2014.log 1 ï¼ˆ3ï¼‰æ˜¾ç¤º t.logæœ€å 10 è¡Œhead -n -10 t.log less å‘½ä»¤é—®ï¼šless å‘½ä»¤ ç­”ï¼šless ä¸ more ç±»ä¼¼ï¼Œä½†ä½¿ç”¨ less å¯ä»¥éšæ„æµè§ˆæ–‡ä»¶ï¼Œè€Œ more ä»…èƒ½å‘å‰ç§»åŠ¨ï¼Œå´ä¸èƒ½å‘åç§»åŠ¨ï¼Œè€Œä¸” less åœ¨æŸ¥çœ‹ä¹‹å‰ä¸ä¼šåŠ è½½æ•´ä¸ªæ–‡ä»¶ã€‚å¸¸ç”¨å‘½ä»¤å‚æ•°ï¼š-i å¿½ç•¥æœç´¢æ—¶çš„å¤§å°å†™ -N æ˜¾ç¤ºæ¯è¡Œçš„è¡Œå· -o &lt;æ–‡ä»¶å&gt; å°†less è¾“å‡ºçš„å†…å®¹åœ¨æŒ‡å®šæ–‡ä»¶ä¸­ä¿å­˜èµ·æ¥ -s æ˜¾ç¤ºè¿ç»­ç©ºè¡Œä¸ºä¸€è¡Œ /å­—ç¬¦ä¸²ï¼šå‘ä¸‹æœç´¢â€œå­—ç¬¦ä¸²â€çš„åŠŸèƒ½ ?å­—ç¬¦ä¸²ï¼šå‘ä¸Šæœç´¢â€œå­—ç¬¦ä¸²â€çš„åŠŸèƒ½ nï¼šé‡å¤å‰ä¸€ä¸ªæœç´¢ï¼ˆä¸ / æˆ– ? æœ‰å…³ï¼‰ Nï¼šåå‘é‡å¤å‰ä¸€ä¸ªæœç´¢ï¼ˆä¸ / æˆ– ? æœ‰å…³ï¼‰ -x &lt;æ•°å­—&gt; å°†â€œtabâ€é”®æ˜¾ç¤ºä¸ºè§„å®šçš„æ•°å­—ç©ºæ ¼ b å‘åç¿»ä¸€é¡µ d å‘åç¿»åŠé¡µ h æ˜¾ç¤ºå¸®åŠ©ç•Œé¢ Q é€€å‡ºless å‘½ä»¤ u å‘å‰æ»šåŠ¨åŠé¡µ y å‘å‰æ»šåŠ¨ä¸€è¡Œ ç©ºæ ¼é”® æ»šåŠ¨ä¸€è¡Œ å›è½¦é”® æ»šåŠ¨ä¸€é¡µ [pagedown]ï¼š å‘ä¸‹ç¿»åŠ¨ä¸€é¡µ [pageup]ï¼š å‘ä¸Šç¿»åŠ¨ä¸€é¡µ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 å®ä¾‹ï¼šï¼ˆ1ï¼‰ps æŸ¥çœ‹è¿›ç¨‹ä¿¡æ¯å¹¶é€šè¿‡ less åˆ†é¡µæ˜¾ç¤ºps -aux | less -N 1 ï¼ˆ2ï¼‰æŸ¥çœ‹å¤šä¸ªæ–‡ä»¶less 1.log 2.log 1 å¯ä»¥ä½¿ç”¨ n æŸ¥çœ‹ä¸‹ä¸€ä¸ªï¼Œä½¿ç”¨ p æŸ¥çœ‹å‰ä¸€ä¸ªã€‚ ln å‘½ä»¤é—®ï¼šln å‘½ä»¤ ç­”ï¼šåŠŸèƒ½æ˜¯ä¸ºæ–‡ä»¶åœ¨å¦å¤–ä¸€ä¸ªä½ç½®å»ºç«‹ä¸€ä¸ªåŒæ­¥çš„é“¾æ¥ï¼Œå½“åœ¨ä¸åŒç›®å½•éœ€è¦è¯¥é—®é¢˜æ—¶ï¼Œå°±ä¸éœ€è¦ä¸ºæ¯ä¸€ä¸ªç›®å½•åˆ›å»ºåŒæ ·çš„æ–‡ä»¶ï¼Œé€šè¿‡ ln åˆ›å»ºçš„é“¾æ¥ï¼ˆlinkï¼‰å‡å°‘ç£ç›˜å ç”¨é‡ã€‚é“¾æ¥åˆ†ç±»ï¼šè½¯ä»¶é“¾æ¥åŠç¡¬é“¾æ¥è½¯é“¾æ¥ï¼š1.è½¯é“¾æ¥ï¼Œä»¥è·¯å¾„çš„å½¢å¼å­˜åœ¨ã€‚ç±»ä¼¼äºWindowsæ“ä½œç³»ç»Ÿä¸­çš„å¿«æ·æ–¹å¼ 2.è½¯é“¾æ¥å¯ä»¥ è·¨æ–‡ä»¶ç³»ç»Ÿ ï¼Œç¡¬é“¾æ¥ä¸å¯ä»¥ 3.è½¯é“¾æ¥å¯ä»¥å¯¹ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶åè¿›è¡Œé“¾æ¥ 4.è½¯é“¾æ¥å¯ä»¥å¯¹ç›®å½•è¿›è¡Œé“¾æ¥ ç¡¬é“¾æ¥:1.ç¡¬é“¾æ¥ï¼Œä»¥æ–‡ä»¶å‰¯æœ¬çš„å½¢å¼å­˜åœ¨ã€‚ä½†ä¸å ç”¨å®é™…ç©ºé—´ã€‚ 2.ä¸å…è®¸ç»™ç›®å½•åˆ›å»ºç¡¬é“¾æ¥ 3.ç¡¬é“¾æ¥åªæœ‰åœ¨åŒä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸­æ‰èƒ½åˆ›å»º éœ€è¦æ³¨æ„ï¼šç¬¬ä¸€ï¼šlnå‘½ä»¤ä¼šä¿æŒæ¯ä¸€å¤„é“¾æ¥æ–‡ä»¶çš„åŒæ­¥æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸è®ºä½ æ”¹åŠ¨äº†å“ªä¸€å¤„ï¼Œå…¶å®ƒçš„æ–‡ä»¶éƒ½ä¼šå‘ç”Ÿç›¸åŒçš„å˜åŒ–ï¼› ç¬¬äºŒï¼šlnçš„é“¾æ¥åˆåˆ†è½¯é“¾æ¥å’Œç¡¬é“¾æ¥ä¸¤ç§ï¼Œè½¯é“¾æ¥å°±æ˜¯ln â€“s æºæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶ï¼Œå®ƒåªä¼šåœ¨ä½ é€‰å®šçš„ä½ç½®ä¸Šç”Ÿæˆä¸€ä¸ªæ–‡ä»¶çš„é•œåƒï¼Œä¸ä¼šå ç”¨ç£ç›˜ç©ºé—´ï¼Œç¡¬é“¾æ¥ ln æºæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶ï¼Œæ²¡æœ‰å‚æ•°-sï¼Œ å®ƒä¼šåœ¨ä½ é€‰å®šçš„ä½ç½®ä¸Šç”Ÿæˆä¸€ä¸ªå’Œæºæ–‡ä»¶å¤§å°ç›¸åŒçš„æ–‡ä»¶ï¼Œæ— è®ºæ˜¯è½¯é“¾æ¥è¿˜æ˜¯ç¡¬é“¾æ¥ï¼Œæ–‡ä»¶éƒ½ä¿æŒåŒæ­¥å˜åŒ–ã€‚ ç¬¬ä¸‰ï¼šlnæŒ‡ä»¤ç”¨åœ¨é“¾æ¥æ–‡ä»¶æˆ–ç›®å½•ï¼Œå¦‚åŒæ—¶æŒ‡å®šä¸¤ä¸ªä»¥ä¸Šçš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œä¸”æœ€åçš„ç›®çš„åœ°æ˜¯ä¸€ä¸ªå·²ç»å­˜åœ¨çš„ç›®å½•ï¼Œåˆ™ä¼šæŠŠå‰é¢æŒ‡å®šçš„æ‰€æœ‰æ–‡ä»¶æˆ–ç›®å½•å¤åˆ¶åˆ°è¯¥ç›®å½•ä¸­ã€‚è‹¥åŒæ—¶æŒ‡å®šå¤šä¸ªæ–‡ä»¶æˆ–ç›®å½•ï¼Œä¸”æœ€åçš„ç›®çš„åœ°å¹¶éæ˜¯ä¸€ä¸ªå·²å­˜åœ¨çš„ç›®å½•ï¼Œåˆ™ä¼šå‡ºç°é”™è¯¯ä¿¡æ¯ã€‚ å¸¸ç”¨å‚æ•°ï¼š-b åˆ é™¤ï¼Œè¦†ç›–ä»¥å‰å»ºç«‹çš„é“¾æ¥ -s è½¯é“¾æ¥ï¼ˆç¬¦å·é“¾æ¥ï¼‰ -v æ˜¾ç¤ºè¯¦ç»†å¤„ç†è¿‡ç¨‹ 1 2 3 å®ä¾‹ï¼šï¼ˆ1ï¼‰ç»™æ–‡ä»¶åˆ›å»ºè½¯é“¾æ¥ï¼Œå¹¶æ˜¾ç¤ºæ“ä½œä¿¡æ¯ln -sv source.log link.log 1 ï¼ˆ2ï¼‰ç»™æ–‡ä»¶åˆ›å»ºç¡¬é“¾æ¥ï¼Œå¹¶æ˜¾ç¤ºæ“ä½œä¿¡æ¯ln -v source.log link1.log 1 ï¼ˆ3ï¼‰ç»™ç›®å½•åˆ›å»ºè½¯é“¾æ¥ln -sv /opt/soft/test/test3 /opt/soft/test/test5 locate å‘½ä»¤é—®ï¼šlocate å‘½ä»¤ ç­”ï¼š 12345678locate é€šè¿‡æœå¯»ç³»ç»Ÿå†…å»ºæ–‡æ¡£æ•°æ®åº“è¾¾åˆ°å¿«é€Ÿæ‰¾åˆ°æ¡£æ¡ˆï¼Œæ•°æ®åº“ç”± updatedb ç¨‹åºæ¥æ›´æ–°ï¼Œupdatedb æ˜¯ç”± cron daemon å‘¨æœŸæ€§è°ƒç”¨çš„ã€‚é»˜è®¤æƒ…å†µä¸‹ locate å‘½ä»¤åœ¨æœå¯»æ•°æ®åº“æ—¶æ¯”ç”±æ•´ä¸ªç”±ç¡¬ç›˜èµ„æ–™æ¥æœå¯»èµ„æ–™æ¥å¾—å¿«ï¼Œä½†è¾ƒå·®åŠ²çš„æ˜¯ locate æ‰€æ‰¾åˆ°çš„æ¡£æ¡ˆè‹¥æ˜¯æœ€è¿‘æ‰å»ºç«‹æˆ– åˆšæ›´åçš„ï¼Œå¯èƒ½ä¼šæ‰¾ä¸åˆ°ï¼Œåœ¨å†…å®šå€¼ä¸­ï¼Œupdatedb æ¯å¤©ä¼šè·‘ä¸€æ¬¡ï¼Œå¯ä»¥ç”±ä¿®æ”¹ crontab æ¥æ›´æ–°è®¾å®šå€¼ (etc/crontab)ã€‚ locate ä¸ find å‘½ä»¤ç›¸ä¼¼ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ *ã€? ç­‰è¿›è¡Œæ­£åˆ™åŒ¹é…æŸ¥æ‰¾ å¸¸ç”¨å‚æ•°ï¼š -l numï¼ˆè¦æ˜¾ç¤ºçš„è¡Œæ•°ï¼‰ -f å°†ç‰¹å®šçš„æ¡£æ¡ˆç³»ç»Ÿæ’é™¤åœ¨å¤–ï¼Œå¦‚å°†procæ’é™¤åœ¨å¤– -r ä½¿ç”¨æ­£åˆ™è¿ç®—å¼åšä¸ºå¯»æ‰¾æ¡ä»¶ 1 2 3 å®ä¾‹ï¼š ï¼ˆ1ï¼‰æŸ¥æ‰¾å’Œ pwd ç›¸å…³çš„æ‰€æœ‰æ–‡ä»¶(æ–‡ä»¶åä¸­åŒ…å« pwdï¼‰ locate pwd 1 ï¼ˆ2ï¼‰æœç´¢ etc ç›®å½•ä¸‹æ‰€æœ‰ä»¥ sh å¼€å¤´çš„æ–‡ä»¶ locate /etc/sh 1 ï¼ˆ3ï¼‰æŸ¥æ‰¾ /var ç›®å½•ä¸‹ï¼Œä»¥ reason ç»“å°¾çš„æ–‡ä»¶ locate -r &apos;^/var.*reason$&apos;ï¼ˆå…¶ä¸­.è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œ*è¡¨ç¤ºä»»åŠ¡å¤šä¸ªï¼›.*è¡¨ç¤ºä»»æ„å¤šä¸ªå­—ç¬¦ï¼‰ more å‘½ä»¤é—®ï¼šmore å‘½ä»¤ ç­”ï¼šåŠŸèƒ½ç±»ä¼¼äº cat, more ä¼šä»¥ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ–¹ä¾¿ä½¿ç”¨è€…é€é¡µé˜…è¯»ï¼Œè€Œæœ€åŸºæœ¬çš„æŒ‡ä»¤å°±æ˜¯æŒ‰ç©ºç™½é”®ï¼ˆspaceï¼‰å°±å¾€ä¸‹ä¸€é¡µæ˜¾ç¤ºï¼ŒæŒ‰ b é”®å°±ä¼šå¾€å›ï¼ˆbackï¼‰ä¸€é¡µæ˜¾ç¤ºã€‚å‘½ä»¤å‚æ•°ï¼š+n ä»ç¬« n è¡Œå¼€å§‹æ˜¾ç¤º -n å®šä¹‰å±å¹•å¤§å°ä¸ºnè¡Œ +/pattern åœ¨æ¯ä¸ªæ¡£æ¡ˆæ˜¾ç¤ºå‰æœå¯»è¯¥å­—ä¸²ï¼ˆpatternï¼‰ï¼Œç„¶åä»è¯¥å­—ä¸²å‰ä¸¤è¡Œä¹‹åå¼€å§‹æ˜¾ç¤º -c ä»é¡¶éƒ¨æ¸…å±ï¼Œç„¶åæ˜¾ç¤º -d æç¤ºâ€œPress space to continueï¼Œâ€™qâ€™ to quitï¼ˆæŒ‰ç©ºæ ¼é”®ç»§ç»­ï¼ŒæŒ‰qé”®é€€å‡ºï¼‰â€ï¼Œç¦ç”¨å“é“ƒåŠŸèƒ½ -l å¿½ç•¥Ctrl+lï¼ˆæ¢é¡µï¼‰å­—ç¬¦ -p é€šè¿‡æ¸…é™¤çª—å£è€Œä¸æ˜¯æ»šå±æ¥å¯¹æ–‡ä»¶è¿›è¡Œæ¢é¡µï¼Œä¸-cé€‰é¡¹ç›¸ä¼¼ -s æŠŠè¿ç»­çš„å¤šä¸ªç©ºè¡Œæ˜¾ç¤ºä¸ºä¸€è¡Œ -u æŠŠæ–‡ä»¶å†…å®¹ä¸­çš„ä¸‹ç”»çº¿å»æ‰ 1 2 3 4 5 6 7 8 9 å¸¸ç”¨æ“ä½œå‘½ä»¤ï¼šEnter å‘ä¸‹ n è¡Œï¼Œéœ€è¦å®šä¹‰ã€‚é»˜è®¤ä¸º 1 è¡Œ Ctrl+F å‘ä¸‹æ»šåŠ¨ä¸€å± ç©ºæ ¼é”® å‘ä¸‹æ»šåŠ¨ä¸€å± Ctrl+B è¿”å›ä¸Šä¸€å± = è¾“å‡ºå½“å‰è¡Œçš„è¡Œå· :f è¾“å‡ºæ–‡ä»¶åå’Œå½“å‰è¡Œçš„è¡Œå· V è°ƒç”¨viç¼–è¾‘å™¨ !å‘½ä»¤ è°ƒç”¨Shellï¼Œå¹¶æ‰§è¡Œå‘½ä»¤ q é€€å‡ºmore 1 2 3 4 5 6 7 8 9 å®ä¾‹ï¼šï¼ˆ1ï¼‰æ˜¾ç¤ºæ–‡ä»¶ä¸­ä»ç¬¬3è¡Œèµ·çš„å†…å®¹more +3 text.txt 1 ï¼ˆ2ï¼‰åœ¨æ‰€åˆ—å‡ºæ–‡ä»¶ç›®å½•è¯¦ç»†ä¿¡æ¯ï¼Œå€ŸåŠ©ç®¡é“ä½¿æ¯æ¬¡æ˜¾ç¤º 5 è¡Œls -l | more -5 1 æŒ‰ç©ºæ ¼æ˜¾ç¤ºä¸‹ 5 è¡Œã€‚ mv å‘½ä»¤é—®ï¼šmv å‘½ä»¤ ç­”ï¼š 12345678ç§»åŠ¨æ–‡ä»¶æˆ–ä¿®æ”¹æ–‡ä»¶åï¼Œæ ¹æ®ç¬¬äºŒå‚æ•°ç±»å‹ï¼ˆå¦‚ç›®å½•ï¼Œåˆ™ç§»åŠ¨æ–‡ä»¶ï¼›å¦‚ä¸ºæ–‡ä»¶åˆ™é‡å‘½ä»¤è¯¥æ–‡ä»¶ï¼‰ã€‚ å½“ç¬¬äºŒä¸ªå‚æ•°ä¸ºç›®å½•æ—¶ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥æ˜¯å¤šä¸ªä»¥ç©ºæ ¼åˆ†éš”çš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œç„¶åç§»åŠ¨ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šçš„å¤šä¸ªæ–‡ä»¶åˆ°ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šçš„ç›®å½•ä¸­ã€‚ å®ä¾‹ï¼š ï¼ˆ1ï¼‰å°†æ–‡ä»¶ test.log é‡å‘½åä¸º test1.txt mv test.log test1.txt 1 ï¼ˆ2ï¼‰å°†æ–‡ä»¶ log1.txt,log2.txt,log3.txt ç§»åŠ¨åˆ°æ ¹çš„ test3 ç›®å½•ä¸­ mv llog1.txt log2.txt log3.txt /test3 1 ï¼ˆ3ï¼‰å°†æ–‡ä»¶ file1 æ”¹åä¸º file2ï¼Œå¦‚æœ file2 å·²ç»å­˜åœ¨ï¼Œåˆ™è¯¢é—®æ˜¯å¦è¦†ç›– mv -i log1.txt log2.txt 1 ï¼ˆ4ï¼‰ç§»åŠ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åˆ°ä¸Šä¸€çº§ç›®å½• mv * ../ rm å‘½ä»¤é—®ï¼šrm å‘½ä»¤ ç­”ï¼š 123456åˆ é™¤ä¸€ä¸ªç›®å½•ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶æˆ–ç›®å½•ï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨ -r é€‰é¡¹ï¼Œåˆ™ rm ä¸ä¼šåˆ é™¤ç›®å½•ã€‚å¦‚æœä½¿ç”¨ rm æ¥åˆ é™¤æ–‡ä»¶ï¼Œé€šå¸¸ä»å¯ä»¥å°†è¯¥æ–‡ä»¶æ¢å¤åŸçŠ¶ã€‚ rm [é€‰é¡¹] æ–‡ä»¶â€¦ 1 å®ä¾‹ï¼š ï¼ˆ1ï¼‰åˆ é™¤ä»»ä½• .log æ–‡ä»¶ï¼Œåˆ é™¤å‰é€ä¸€è¯¢é—®ç¡®è®¤ï¼š rm -i *.log 1 ï¼ˆ2ï¼‰åˆ é™¤ test å­ç›®å½•åŠå­ç›®å½•ä¸­æ‰€æœ‰æ¡£æ¡ˆåˆ é™¤ï¼Œå¹¶ä¸”ä¸ç”¨ä¸€ä¸€ç¡®è®¤ï¼š rm -rf test 1 ï¼ˆ3ï¼‰åˆ é™¤ä»¥ -f å¼€å¤´çš„æ–‡ä»¶ rm -- -f* ç­”ï¼šåˆ åº“è·‘è·¯ã€‚ã€‚ã€‚ã€‚ tail å‘½ä»¤é—®ï¼štail å‘½ä»¤ ç­”ï¼šç”¨äºæ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶æœ«å°¾å†…å®¹ï¼Œä¸æŒ‡å®šæ–‡ä»¶æ—¶ï¼Œä½œä¸ºè¾“å…¥ä¿¡æ¯è¿›è¡Œå¤„ç†ã€‚å¸¸ç”¨æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ã€‚å¸¸ç”¨å‚æ•°ï¼š-f å¾ªç¯è¯»å–ï¼ˆå¸¸ç”¨äºæŸ¥çœ‹é€’å¢çš„æ—¥å¿—æ–‡ä»¶ï¼‰ -n&lt;è¡Œæ•°&gt; æ˜¾ç¤ºè¡Œæ•°ï¼ˆä»åå‘å‰ï¼‰ 1 2 ï¼ˆ1ï¼‰å¾ªç¯è¯»å–é€æ¸å¢åŠ çš„æ–‡ä»¶å†…å®¹ping 127.0.0.1 &gt; ping.log &amp; 1 åå°è¿è¡Œï¼šå¯ä½¿ç”¨ jobs -l æŸ¥çœ‹ï¼Œä¹Ÿå¯ä½¿ç”¨ fg å°†å…¶ç§»åˆ°å‰å°è¿è¡Œã€‚tail -f ping.log 1 ï¼ˆæŸ¥çœ‹æ—¥å¿—ï¼‰ touch å‘½ä»¤é—®ï¼štouch å‘½ä»¤ ç­”ï¼š 12345678910111213141516Linux touchå‘½ä»¤ç”¨äºä¿®æ”¹æ–‡ä»¶æˆ–è€…ç›®å½•çš„æ—¶é—´å±æ€§ï¼ŒåŒ…æ‹¬å­˜å–æ—¶é—´å’Œæ›´æ”¹æ—¶é—´ã€‚è‹¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œç³»ç»Ÿä¼šå»ºç«‹ä¸€ä¸ªæ–°çš„æ–‡ä»¶ã€‚ ls -l å¯ä»¥æ˜¾ç¤ºæ¡£æ¡ˆçš„æ—¶é—´è®°å½•ã€‚ è¯­æ³• touch [-acfm][-d&lt;æ—¥æœŸæ—¶é—´&gt;][-r&lt;å‚è€ƒæ–‡ä»¶æˆ–ç›®å½•&gt;] [-t&lt;æ—¥æœŸæ—¶é—´&gt;][--help][--version][æ–‡ä»¶æˆ–ç›®å½•â€¦] 1 å‚æ•°è¯´æ˜ï¼š a æ”¹å˜æ¡£æ¡ˆçš„è¯»å–æ—¶é—´è®°å½•ã€‚ m æ”¹å˜æ¡£æ¡ˆçš„ä¿®æ”¹æ—¶é—´è®°å½•ã€‚ c å‡å¦‚ç›®çš„æ¡£æ¡ˆä¸å­˜åœ¨ï¼Œä¸ä¼šå»ºç«‹æ–°çš„æ¡£æ¡ˆã€‚ä¸ --no-create çš„æ•ˆæœä¸€æ ·ã€‚ f ä¸ä½¿ç”¨ï¼Œæ˜¯ä¸ºäº†ä¸å…¶ä»– unix ç³»ç»Ÿçš„ç›¸å®¹æ€§è€Œä¿ç•™ã€‚ r ä½¿ç”¨å‚è€ƒæ¡£çš„æ—¶é—´è®°å½•ï¼Œä¸ --file çš„æ•ˆæœä¸€æ ·ã€‚ d è®¾å®šæ—¶é—´ä¸æ—¥æœŸï¼Œå¯ä»¥ä½¿ç”¨å„ç§ä¸åŒçš„æ ¼å¼ã€‚ t è®¾å®šæ¡£æ¡ˆçš„æ—¶é—´è®°å½•ï¼Œæ ¼å¼ä¸ date æŒ‡ä»¤ç›¸åŒã€‚ â€“no-create ä¸ä¼šå»ºç«‹æ–°æ¡£æ¡ˆã€‚ â€“help åˆ—å‡ºæŒ‡ä»¤æ ¼å¼ã€‚ â€“version åˆ—å‡ºç‰ˆæœ¬è®¯æ¯ã€‚ å®ä¾‹ ä½¿ç”¨æŒ‡ä»¤&quot;touch&quot;ä¿®æ”¹æ–‡ä»¶&quot;testfile&quot;çš„æ—¶é—´å±æ€§ä¸ºå½“å‰ç³»ç»Ÿæ—¶é—´ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š $ touch testfile #ä¿®æ”¹æ–‡ä»¶çš„æ—¶é—´å±æ€§ 1 é¦–å…ˆï¼Œä½¿ç”¨lså‘½ä»¤æŸ¥çœ‹testfileæ–‡ä»¶çš„å±æ€§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š $ ls -l testfile #æŸ¥çœ‹æ–‡ä»¶çš„æ—¶é—´å±æ€§ #åŸæ¥æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´ä¸º16:09 -rw-r--r-- 1 hdd hdd 55 2011-08-22 16:09 testfile 1 2 3 æ‰§è¡ŒæŒ‡ä»¤&quot;touch&quot;ä¿®æ”¹æ–‡ä»¶å±æ€§ä»¥åï¼Œå¹¶å†æ¬¡æŸ¥çœ‹è¯¥æ–‡ä»¶çš„æ—¶é—´å±æ€§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š $ touch testfile #ä¿®æ”¹æ–‡ä»¶æ—¶é—´å±æ€§ä¸ºå½“å‰ç³»ç»Ÿæ—¶é—´ $ ls -l testfile #æŸ¥çœ‹æ–‡ä»¶çš„æ—¶é—´å±æ€§ #ä¿®æ”¹åæ–‡ä»¶çš„æ—¶é—´å±æ€§ä¸ºå½“å‰ç³»ç»Ÿæ—¶é—´ -rw-r--r-- 1 hdd hdd 55 2011-08-22 19:53 testfile 1 2 3 4 ä½¿ç”¨æŒ‡ä»¤&quot;touch&quot;æ—¶ï¼Œå¦‚æœæŒ‡å®šçš„æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™å°†åˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºç™½æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œåœ¨å½“å‰ç›®å½•ä¸‹ï¼Œä½¿ç”¨è¯¥æŒ‡ä»¤åˆ›å»ºä¸€ä¸ªç©ºç™½æ–‡ä»¶&quot;file&quot;ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š $ touch file #åˆ›å»ºä¸€ä¸ªåä¸ºâ€œfileâ€çš„æ–°çš„ç©ºç™½æ–‡ä»¶ vim å‘½ä»¤é—®ï¼švim å‘½ä»¤ ç­”ï¼šVimæ˜¯ä» vi å‘å±•å‡ºæ¥çš„ä¸€ä¸ªæ–‡æœ¬ç¼–è¾‘å™¨ã€‚ä»£ç è¡¥å®Œã€ç¼–è¯‘åŠé”™è¯¯è·³è½¬ç­‰æ–¹ä¾¿ç¼–ç¨‹çš„åŠŸèƒ½ç‰¹åˆ«ä¸°å¯Œï¼Œåœ¨ç¨‹åºå‘˜ä¸­è¢«å¹¿æ³›ä½¿ç”¨ã€‚æ‰“å¼€æ–‡ä»¶å¹¶è·³åˆ°ç¬¬ 10 è¡Œï¼švim +10 filename.txt ã€‚ æ‰“å¼€æ–‡ä»¶è·³åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…çš„è¡Œï¼švim +/search-term filename.txt ã€‚ ä»¥åªè¯»æ¨¡å¼æ‰“å¼€æ–‡ä»¶ï¼švim -R /etc/passwd ã€‚ åŸºæœ¬ä¸Š vi/vim å…±åˆ†ä¸ºä¸‰ç§æ¨¡å¼ï¼Œåˆ†åˆ«æ˜¯å‘½ä»¤æ¨¡å¼ï¼ˆCommand modeï¼‰ï¼Œè¾“å…¥æ¨¡å¼ï¼ˆInsert modeï¼‰å’Œåº•çº¿å‘½ä»¤æ¨¡å¼ï¼ˆLast line modeï¼‰ã€‚ç®€å•çš„è¯´ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸‰ä¸ªæ¨¡å¼æƒ³æˆåº•ä¸‹çš„å›¾æ ‡æ¥è¡¨ç¤ºï¼š whereis å‘½ä»¤é—®ï¼šwhereis å‘½ä»¤ ç­”ï¼šwhereis å‘½ä»¤åªèƒ½ç”¨äºç¨‹åºåçš„æœç´¢ï¼Œè€Œä¸”åªæœç´¢äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå‚æ•°-bï¼‰ã€manè¯´æ˜æ–‡ä»¶ï¼ˆå‚æ•°-mï¼‰å’Œæºä»£ç æ–‡ä»¶ï¼ˆå‚æ•°-sï¼‰ã€‚å¦‚æœçœç•¥å‚æ•°ï¼Œåˆ™è¿”å›æ‰€æœ‰ä¿¡æ¯ã€‚whereis åŠ locate éƒ½æ˜¯åŸºäºç³»ç»Ÿå†…å»ºçš„æ•°æ®åº“è¿›è¡Œæœç´¢ï¼Œå› æ­¤æ•ˆç‡å¾ˆé«˜ï¼Œè€Œfindåˆ™æ˜¯éå†ç¡¬ç›˜æŸ¥æ‰¾æ–‡ä»¶ã€‚å¸¸ç”¨å‚æ•°ï¼š-b å®šä½å¯æ‰§è¡Œæ–‡ä»¶ã€‚ -m å®šä½å¸®åŠ©æ–‡ä»¶ã€‚ -s å®šä½æºä»£ç æ–‡ä»¶ã€‚ -u æœç´¢é»˜è®¤è·¯å¾„ä¸‹é™¤å¯æ‰§è¡Œæ–‡ä»¶ã€æºä»£ç æ–‡ä»¶ã€å¸®åŠ©æ–‡ä»¶ä»¥å¤–çš„å…¶å®ƒæ–‡ä»¶ã€‚ 1 2 3 4 å®ä¾‹ï¼šï¼ˆ1ï¼‰æŸ¥æ‰¾ locate ç¨‹åºç›¸å…³æ–‡ä»¶whereis locate 1 ï¼ˆ2ï¼‰æŸ¥æ‰¾ locate çš„æºç æ–‡ä»¶whereis -s locate 1 ï¼ˆ3ï¼‰æŸ¥æ‰¾ lcoate çš„å¸®åŠ©æ–‡ä»¶whereis -m locate which å‘½ä»¤é—®ï¼šwhich å‘½ä»¤ ç­”ï¼šåœ¨ linux è¦æŸ¥æ‰¾æŸä¸ªæ–‡ä»¶ï¼Œä½†ä¸çŸ¥é“æ”¾åœ¨å“ªé‡Œäº†ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä¸€äº›å‘½ä»¤æ¥æœç´¢ï¼šwhich æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶çš„ä½ç½®ã€‚ whereis æŸ¥çœ‹æ–‡ä»¶çš„ä½ç½®ã€‚ locate é…åˆæ•°æ®åº“æŸ¥çœ‹æ–‡ä»¶ä½ç½®ã€‚ find å®é™…æœå¯»ç¡¬ç›˜æŸ¥è¯¢æ–‡ä»¶åç§°ã€‚ 1 2 3 4 which æ˜¯åœ¨ PATH å°±æ˜¯æŒ‡å®šçš„è·¯å¾„ä¸­ï¼Œæœç´¢æŸä¸ªç³»ç»Ÿå‘½ä»¤çš„ä½ç½®ï¼Œå¹¶è¿”å›ç¬¬ä¸€ä¸ªæœç´¢ç»“æœã€‚ä½¿ç”¨ which å‘½ä»¤ï¼Œå°±å¯ä»¥çœ‹åˆ°æŸä¸ªç³»ç»Ÿå‘½ä»¤æ˜¯å¦å­˜åœ¨ï¼Œä»¥åŠæ‰§è¡Œçš„åˆ°åº•æ˜¯å“ªä¸€ä¸ªä½ç½®çš„å‘½ä»¤ã€‚å¸¸ç”¨å‚æ•°ï¼š-n æŒ‡å®šæ–‡ä»¶åé•¿åº¦ï¼ŒæŒ‡å®šçš„é•¿åº¦å¿…é¡»å¤§äºæˆ–ç­‰äºæ‰€æœ‰æ–‡ä»¶ä¸­æœ€é•¿çš„æ–‡ä»¶åã€‚ 1 å®ä¾‹ï¼šï¼ˆ1ï¼‰æŸ¥çœ‹ ls å‘½ä»¤æ˜¯å¦å­˜åœ¨ï¼Œæ‰§è¡Œå“ªä¸ªwhich ls 1 ï¼ˆ2ï¼‰æŸ¥çœ‹ whichwhich which 1 ï¼ˆ3ï¼‰æŸ¥çœ‹ cdwhich cdï¼ˆæ˜¾ç¤ºä¸å­˜åœ¨ï¼Œå› ä¸º cd æ˜¯å†…å»ºå‘½ä»¤ï¼Œè€Œ which æŸ¥æ‰¾æ˜¾ç¤ºæ˜¯ PATH ä¸­çš„å‘½ä»¤ï¼‰ 1 æŸ¥çœ‹å½“å‰ PATH é…ç½®ï¼šecho $PATH 1 æˆ–ä½¿ç”¨ env æŸ¥çœ‹æ‰€æœ‰ç¯å¢ƒå˜é‡åŠå¯¹åº”å€¼ grep å‘½ä»¤é—®ï¼šgrep å‘½ä»¤ ç­”ï¼š 123456789101112131415161718192021å¼ºå¤§çš„æ–‡æœ¬æœç´¢å‘½ä»¤ï¼Œgrep(Global Regular Expression Print) å…¨å±€æ­£åˆ™è¡¨è¾¾å¼æœç´¢ã€‚ grep çš„å·¥ä½œæ–¹å¼æ˜¯è¿™æ ·çš„ï¼Œå®ƒåœ¨ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ä¸­æœç´¢å­—ç¬¦ä¸²æ¨¡æ¿ã€‚å¦‚æœæ¨¡æ¿åŒ…æ‹¬ç©ºæ ¼ï¼Œåˆ™å¿…é¡»è¢«å¼•ç”¨ï¼Œæ¨¡æ¿åçš„æ‰€æœ‰å­—ç¬¦ä¸²è¢«çœ‹ä½œæ–‡ä»¶åã€‚æœç´¢çš„ç»“æœè¢«é€åˆ°æ ‡å‡†è¾“å‡ºï¼Œä¸å½±å“åŸæ–‡ä»¶å†…å®¹ã€‚ å‘½ä»¤æ ¼å¼ï¼š grep [option] pattern file|dir 1 å¸¸ç”¨å‚æ•°ï¼š -A n --after-contextæ˜¾ç¤ºåŒ¹é…å­—ç¬¦ånè¡Œ -B n --before-contextæ˜¾ç¤ºåŒ¹é…å­—ç¬¦å‰nè¡Œ -C n --context æ˜¾ç¤ºåŒ¹é…å­—ç¬¦å‰ånè¡Œ -c --count è®¡ç®—ç¬¦åˆæ ·å¼çš„åˆ—æ•° -i å¿½ç•¥å¤§å°å†™ -l åªåˆ—å‡ºæ–‡ä»¶å†…å®¹ç¬¦åˆæŒ‡å®šçš„æ ·å¼çš„æ–‡ä»¶åç§° -f ä»æ–‡ä»¶ä¸­è¯»å–å…³é”®è¯ -n æ˜¾ç¤ºåŒ¹é…å†…å®¹çš„æ‰€åœ¨æ–‡ä»¶ä¸­è¡Œæ•° -R é€’å½’æŸ¥æ‰¾æ–‡ä»¶å¤¹ 1 2 3 4 5 6 7 8 9 grep çš„è§„åˆ™è¡¨è¾¾å¼: ^ #é”šå®šè¡Œçš„å¼€å§‹ å¦‚ï¼š&apos;^grep&apos;åŒ¹é…æ‰€æœ‰ä»¥grepå¼€å¤´çš„è¡Œã€‚ $ #é”šå®šè¡Œçš„ç»“æŸ å¦‚ï¼š&apos;grep$&apos;åŒ¹é…æ‰€æœ‰ä»¥grepç»“å°¾çš„è¡Œã€‚ . #åŒ¹é…ä¸€ä¸ªéæ¢è¡Œç¬¦çš„å­—ç¬¦ å¦‚ï¼š&apos;gr.p&apos;åŒ¹é…gråæ¥ä¸€ä¸ªä»»æ„å­—ç¬¦ï¼Œç„¶åæ˜¯pã€‚ * #åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªå…ˆå‰å­—ç¬¦ å¦‚ï¼š&apos;&lt;em&gt;grep&apos;åŒ¹é…æ‰€æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªç©ºæ ¼åç´§è·Ÿgrepçš„è¡Œã€‚ .&lt;/em&gt; #ä¸€èµ·ç”¨ä»£è¡¨ä»»æ„å­—ç¬¦ã€‚ [] #åŒ¹é…ä¸€ä¸ªæŒ‡å®šèŒƒå›´å†…çš„å­—ç¬¦ï¼Œå¦‚&apos;[Gg]rep&apos;åŒ¹é…Grepå’Œgrepã€‚ [^] #åŒ¹é…ä¸€ä¸ªä¸åœ¨æŒ‡å®šèŒƒå›´å†…çš„å­—ç¬¦ï¼Œå¦‚ï¼š&apos;[^A-FH-Z]rep&apos;åŒ¹é…ä¸åŒ…å«A-Rå’ŒT-Zçš„ä¸€ä¸ªå­—æ¯å¼€å¤´ï¼Œç´§è·Ÿrepçš„è¡Œã€‚ (..) #æ ‡è®°åŒ¹é…å­—ç¬¦ï¼Œå¦‚&apos;(love)&apos;ï¼Œloveè¢«æ ‡è®°ä¸º1ã€‚ &lt; #é”šå®šå•è¯çš„å¼€å§‹ï¼Œå¦‚:&apos;&lt;grep&apos;åŒ¹é…åŒ…å«ä»¥grepå¼€å¤´çš„å•è¯çš„è¡Œã€‚ &gt; #é”šå®šå•è¯çš„ç»“æŸï¼Œå¦‚&apos;grep&gt;&apos;åŒ¹é…åŒ…å«ä»¥grepç»“å°¾çš„å•è¯çš„è¡Œã€‚ x&#123;m&#125; #é‡å¤å­—ç¬¦xï¼Œmæ¬¡ï¼Œå¦‚ï¼š&apos;0&#123;5&#125;&apos;åŒ¹é…åŒ…å«5ä¸ªoçš„è¡Œã€‚ x&#123;m,&#125; #é‡å¤å­—ç¬¦x,è‡³å°‘mæ¬¡ï¼Œå¦‚ï¼š&apos;o&#123;5,&#125;&apos;åŒ¹é…è‡³å°‘æœ‰5ä¸ªoçš„è¡Œã€‚ x&#123;m,n&#125; #é‡å¤å­—ç¬¦xï¼Œè‡³å°‘mæ¬¡ï¼Œä¸å¤šäºnæ¬¡ï¼Œå¦‚ï¼š&apos;o&#123;5,10&#125;&apos;åŒ¹é…5--10ä¸ªoçš„è¡Œã€‚ \\w #åŒ¹é…æ–‡å­—å’Œæ•°å­—å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯[A-Za-z0-9]ï¼Œå¦‚ï¼š&apos;G\\w*p&apos;åŒ¹é…ä»¥Gåè·Ÿé›¶ä¸ªæˆ–å¤šä¸ªæ–‡å­—æˆ–æ•°å­—å­—ç¬¦ï¼Œç„¶åæ˜¯pã€‚ \\W #\\wçš„åç½®å½¢å¼ï¼ŒåŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªéå•è¯å­—ç¬¦ï¼Œå¦‚ç‚¹å·å¥å·ç­‰ã€‚ \\b #å•è¯é”å®šç¬¦ï¼Œå¦‚: &apos;\\bgrep\\b&apos;åªåŒ¹é…grepã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 å®ä¾‹ï¼š ï¼ˆ1ï¼‰æŸ¥æ‰¾æŒ‡å®šè¿›ç¨‹ ps -ef | grep svn 1 ï¼ˆ2ï¼‰æŸ¥æ‰¾æŒ‡å®šè¿›ç¨‹ä¸ªæ•° ps -ef | grep svn -c 1 ï¼ˆ3ï¼‰ä»æ–‡ä»¶ä¸­è¯»å–å…³é”®è¯ cat test1.txt | grep -f key.log 1 ï¼ˆ4ï¼‰ä»æ–‡ä»¶å¤¹ä¸­é€’å½’æŸ¥æ‰¾ä»¥grepå¼€å¤´çš„è¡Œï¼Œå¹¶åªåˆ—å‡ºæ–‡ä»¶ grep -lR &apos;^grep&apos; /tmp 1 ï¼ˆ5ï¼‰æŸ¥æ‰¾éxå¼€å…³çš„è¡Œå†…å®¹ grep &apos;^[^x]&apos; test.txt 1 ï¼ˆ6ï¼‰æ˜¾ç¤ºåŒ…å« ed æˆ–è€… at å­—ç¬¦çš„å†…å®¹è¡Œ grep -E &apos;ed|at&apos; test.txt wc å‘½ä»¤é—®ï¼šwc å‘½ä»¤ ç­”ï¼šwc(word count)åŠŸèƒ½ä¸ºç»Ÿè®¡æŒ‡å®šçš„æ–‡ä»¶ä¸­å­—èŠ‚æ•°ã€å­—æ•°ã€è¡Œæ•°ï¼Œå¹¶å°†ç»Ÿè®¡ç»“æœè¾“å‡ºå‘½ä»¤æ ¼å¼ï¼šwc [option] file.. 1 å‘½ä»¤å‚æ•°ï¼š-c ç»Ÿè®¡å­—èŠ‚æ•° -l ç»Ÿè®¡è¡Œæ•° -m ç»Ÿè®¡å­—ç¬¦æ•° -w ç»Ÿè®¡è¯æ•°ï¼Œä¸€ä¸ªå­—è¢«å®šä¹‰ä¸ºç”±ç©ºç™½ã€è·³æ ¼æˆ–æ¢è¡Œå­—ç¬¦åˆ†éš”çš„å­—ç¬¦ä¸² 1 2 3 4 å®ä¾‹ï¼šï¼ˆ1ï¼‰æŸ¥æ‰¾æ–‡ä»¶çš„ è¡Œæ•° å•è¯æ•° å­—èŠ‚æ•° æ–‡ä»¶åwc text.txt 1 ç»“æœï¼š7 8 70 test.txt 1 ï¼ˆ2ï¼‰ç»Ÿè®¡è¾“å‡ºç»“æœçš„è¡Œæ•°cat test.txt | wc -l cd å‘½ä»¤é—®ï¼šcd å‘½ä»¤ ç­”ï¼šè¿›å…¥æŸä¸ªç›®å½• ç­”ï¼šcd(changeDirectory) å‘½ä»¤è¯­æ³•ï¼šcd [ç›®å½•å] 1 è¯´æ˜ï¼šåˆ‡æ¢å½“å‰ç›®å½•è‡³ dirNameã€‚å®ä¾‹ï¼šï¼ˆ1ï¼‰è¿›å…¥è¦ç›®å½•cd / 1 ï¼ˆ2ï¼‰è¿›å…¥ â€œhomeâ€ ç›®å½•cd ~ 1 ï¼ˆ3ï¼‰è¿›å…¥ä¸Šä¸€æ¬¡å·¥ä½œè·¯å¾„cd - 1 ï¼ˆ4ï¼‰æŠŠä¸Šä¸ªå‘½ä»¤çš„å‚æ•°ä½œä¸ºcdå‚æ•°ä½¿ç”¨ã€‚cd !$ df å‘½ä»¤é—®ï¼šdf å‘½ä»¤ ç­”ï¼šæ˜¾ç¤ºç£ç›˜ç©ºé—´ä½¿ç”¨æƒ…å†µã€‚è·å–ç¡¬ç›˜è¢«å ç”¨äº†å¤šå°‘ç©ºé—´ï¼Œç›®å‰è¿˜å‰©ä¸‹å¤šå°‘ç©ºé—´ç­‰ä¿¡æ¯ï¼Œå¦‚æœæ²¡æœ‰æ–‡ä»¶åè¢«æŒ‡å®šï¼Œåˆ™æ‰€æœ‰å½“å‰è¢«æŒ‚è½½çš„æ–‡ä»¶ç³»ç»Ÿçš„å¯ç”¨ç©ºé—´å°†è¢«æ˜¾ç¤ºã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç£ç›˜ç©ºé—´å°†ä»¥ 1KB ä¸ºå•ä½è¿›è¡Œæ˜¾ç¤ºï¼Œé™¤éç¯å¢ƒå˜é‡ POSIXLY_CORRECT è¢«æŒ‡å®šï¼Œé‚£æ ·å°†ä»¥512å­—èŠ‚ä¸ºå•ä½è¿›è¡Œæ˜¾ç¤ºï¼š-a å…¨éƒ¨æ–‡ä»¶ç³»ç»Ÿåˆ—è¡¨ -h ä»¥æ–¹ä¾¿é˜…è¯»çš„æ–¹å¼æ˜¾ç¤ºä¿¡æ¯ -i æ˜¾ç¤ºinodeä¿¡æ¯ -k åŒºå—ä¸º1024å­—èŠ‚ -l åªæ˜¾ç¤ºæœ¬åœ°ç£ç›˜ -T åˆ—å‡ºæ–‡ä»¶ç³»ç»Ÿç±»å‹ 1 2 3 4 5 6 å®ä¾‹ï¼šï¼ˆ1ï¼‰æ˜¾ç¤ºç£ç›˜ä½¿ç”¨æƒ…å†µdf -l 1 ï¼ˆ2ï¼‰ä»¥æ˜“è¯»æ–¹å¼åˆ—å‡ºæ‰€æœ‰æ–‡ä»¶ç³»ç»ŸåŠå…¶ç±»å‹df -haT du å‘½ä»¤é—®ï¼šdu å‘½ä»¤ ç­”ï¼šdu å‘½ä»¤ä¹Ÿæ˜¯æŸ¥çœ‹ä½¿ç”¨ç©ºé—´çš„ï¼Œä½†æ˜¯ä¸ df å‘½ä»¤ä¸åŒçš„æ˜¯ Linux du å‘½ä»¤æ˜¯å¯¹æ–‡ä»¶å’Œç›®å½•ç£ç›˜ä½¿ç”¨çš„ç©ºé—´çš„æŸ¥çœ‹ï¼šå‘½ä»¤æ ¼å¼ï¼šdu [é€‰é¡¹][æ–‡ä»¶] 1 å¸¸ç”¨å‚æ•°ï¼š-a æ˜¾ç¤ºç›®å½•ä¸­æ‰€æœ‰æ–‡ä»¶å¤§å° -k ä»¥KBä¸ºå•ä½æ˜¾ç¤ºæ–‡ä»¶å¤§å° -m ä»¥MBä¸ºå•ä½æ˜¾ç¤ºæ–‡ä»¶å¤§å° -g ä»¥GBä¸ºå•ä½æ˜¾ç¤ºæ–‡ä»¶å¤§å° -h ä»¥æ˜“è¯»æ–¹å¼æ˜¾ç¤ºæ–‡ä»¶å¤§å° -s ä»…æ˜¾ç¤ºæ€»è®¡ -cæˆ–â€”total é™¤äº†æ˜¾ç¤ºä¸ªåˆ«ç›®å½•æˆ–æ–‡ä»¶çš„å¤§å°å¤–ï¼ŒåŒæ—¶ä¹Ÿæ˜¾ç¤ºæ‰€æœ‰ç›®å½•æˆ–æ–‡ä»¶çš„æ€»å’Œ 1 2 3 4 5 6 7 å®ä¾‹ï¼šï¼ˆ1ï¼‰ä»¥æ˜“è¯»æ–¹å¼æ˜¾ç¤ºæ–‡ä»¶å¤¹å†…åŠå­æ–‡ä»¶å¤¹å¤§å°du -h scf/ 1 ï¼ˆ2ï¼‰ä»¥æ˜“è¯»æ–¹å¼æ˜¾ç¤ºæ–‡ä»¶å¤¹å†…æ‰€æœ‰æ–‡ä»¶å¤§å°du -ah scf/ 1 ï¼ˆ3ï¼‰æ˜¾ç¤ºå‡ ä¸ªæ–‡ä»¶æˆ–ç›®å½•å„è‡ªå ç”¨ç£ç›˜ç©ºé—´çš„å¤§å°ï¼Œè¿˜ç»Ÿè®¡å®ƒä»¬çš„æ€»å’Œdu -hc test/ scf/ 1 ï¼ˆ4ï¼‰è¾“å‡ºå½“å‰ç›®å½•ä¸‹å„ä¸ªå­ç›®å½•æ‰€ä½¿ç”¨çš„ç©ºé—´du -hc â€”max-depth=1 scf/ lså‘½ä»¤é—®ï¼šlså‘½ä»¤ ç­”ï¼šæŸ¥çœ‹ç›®å½•ä¸‹æœ‰å“ªäº›ä¸œè¥¿ ç­”ï¼šlså‘½ä»¤ç”¨æ¥æ˜¾ç¤ºç›®æ ‡åˆ—è¡¨ï¼Œåœ¨Linuxä¸­æ˜¯ä½¿ç”¨ç‡è¾ƒé«˜çš„å‘½ä»¤ã€‚lså‘½ä»¤çš„è¾“å‡ºä¿¡æ¯å¯ä»¥è¿›è¡Œå½©è‰²åŠ äº®æ˜¾ç¤ºï¼Œä»¥åˆ†åŒºä¸åŒç±»å‹çš„æ–‡ä»¶ã€‚ ç­”ï¼š 123456789å°±æ˜¯ list çš„ç¼©å†™ï¼Œé€šè¿‡ ls å‘½ä»¤ä¸ä»…å¯ä»¥æŸ¥çœ‹ linux æ–‡ä»¶å¤¹åŒ…å«çš„æ–‡ä»¶ï¼Œè€Œä¸”å¯ä»¥æŸ¥çœ‹æ–‡ä»¶æƒé™(åŒ…æ‹¬ç›®å½•ã€æ–‡ä»¶å¤¹ã€æ–‡ä»¶æƒé™)î€‚æŸ¥çœ‹ç›®å½•ä¿¡æ¯ç­‰ç­‰ã€‚ å¸¸ç”¨å‚æ•°æ­é…ï¼š ls -a åˆ—å‡ºç›®å½•æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…å«ä»¥.å¼€å§‹çš„éšè—æ–‡ä»¶ ls -A åˆ—å‡ºé™¤.åŠ..çš„å…¶å®ƒæ–‡ä»¶ ls -r ååºæ’åˆ— ls -t ä»¥æ–‡ä»¶ä¿®æ”¹æ—¶é—´æ’åº ls -S ä»¥æ–‡ä»¶å¤§å°æ’åº ls -h ä»¥æ˜“è¯»å¤§å°æ˜¾ç¤º ls -l é™¤äº†æ–‡ä»¶åä¹‹å¤–ï¼Œè¿˜å°†æ–‡ä»¶çš„æƒé™ã€æ‰€æœ‰è€…ã€æ–‡ä»¶å¤§å°ç­‰ä¿¡æ¯è¯¦ç»†åˆ—å‡ºæ¥ 1 2 3 4 5 6 7 å®ä¾‹ï¼š (1) æŒ‰æ˜“è¯»æ–¹å¼æŒ‰æ—¶é—´ååºæ’åºï¼Œå¹¶æ˜¾ç¤ºæ–‡ä»¶è¯¦ç»†ä¿¡æ¯ ls -lhrt 1 (2) æŒ‰å¤§å°ååºæ˜¾ç¤ºæ–‡ä»¶è¯¦ç»†ä¿¡æ¯ ls -lrS 1 (3)åˆ—å‡ºå½“å‰ç›®å½•ä¸­æ‰€æœ‰ä»¥&quot;t&quot;å¼€å¤´çš„ç›®å½•çš„è¯¦ç»†å†…å®¹ ls -l t* 1 (4) åˆ—å‡ºæ–‡ä»¶ç»å¯¹è·¯å¾„ï¼ˆä¸åŒ…å«éšè—æ–‡ä»¶ï¼‰ ls | sed &quot;s:^:pwd/:&quot; 1 (5) åˆ—å‡ºæ–‡ä»¶ç»å¯¹è·¯å¾„ï¼ˆåŒ…å«éšè—æ–‡ä»¶ï¼‰ find $pwd -maxdepth 1 | xargs ls -ld mkdir å‘½ä»¤é—®ï¼šmkdir å‘½ä»¤ ç­”ï¼šmkdir å‘½ä»¤ç”¨äºåˆ›å»ºæ–‡ä»¶å¤¹ã€‚å¯ç”¨é€‰é¡¹ï¼š-m: å¯¹æ–°å»ºç›®å½•è®¾ç½®å­˜å–æƒé™ï¼Œä¹Ÿå¯ä»¥ç”¨ chmod å‘½ä»¤è®¾ç½®; -p: å¯ä»¥æ˜¯ä¸€ä¸ªè·¯å¾„åç§°ã€‚æ­¤æ—¶è‹¥è·¯å¾„ä¸­çš„æŸäº›ç›®å½•å°šä¸å­˜åœ¨,åŠ ä¸Šæ­¤é€‰é¡¹åï¼Œç³»ç»Ÿå°†è‡ªåŠ¨å»ºç«‹å¥½é‚£äº›å°šä¸åœ¨çš„ç›®å½•ï¼Œå³ä¸€æ¬¡å¯ä»¥å»ºç«‹å¤šä¸ªç›®å½•ã€‚ å®ä¾‹ï¼šï¼ˆ1ï¼‰å½“å‰å·¥ä½œç›®å½•ä¸‹åˆ›å»ºåä¸º tçš„æ–‡ä»¶å¤¹mkdir t 1 ï¼ˆ2ï¼‰åœ¨ tmp ç›®å½•ä¸‹åˆ›å»ºè·¯å¾„ä¸º test/t1/t çš„ç›®å½•ï¼Œè‹¥ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºï¼šmkdir -p /tmp/test/t1/t pwd å‘½ä»¤é—®ï¼špwd å‘½ä»¤ ç­”ï¼špwd å‘½ä»¤ç”¨äºæŸ¥çœ‹å½“å‰å·¥ä½œç›®å½•è·¯å¾„ã€‚å®ä¾‹ï¼šï¼ˆ1ï¼‰æŸ¥çœ‹å½“å‰è·¯å¾„pwd 1 ï¼ˆ2ï¼‰æŸ¥çœ‹è½¯é“¾æ¥çš„å®é™…è·¯å¾„pwd -P rmdir å‘½ä»¤é—®ï¼šrmdir å‘½ä»¤ ç­”ï¼šä»ä¸€ä¸ªç›®å½•ä¸­åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå­ç›®å½•é¡¹ï¼Œåˆ é™¤æŸç›®å½•æ—¶ä¹Ÿå¿…é¡»å…·æœ‰å¯¹å…¶çˆ¶ç›®å½•çš„å†™æƒé™ã€‚æ³¨æ„ï¼šä¸èƒ½åˆ é™¤éç©ºç›®å½•å®ä¾‹ï¼šï¼ˆ1ï¼‰å½“ parent å­ç›®å½•è¢«åˆ é™¤åä½¿å®ƒä¹Ÿæˆä¸ºç©ºç›®å½•çš„è¯ï¼Œåˆ™é¡ºä¾¿ä¸€å¹¶åˆ é™¤ï¼šrmdir -p parent/child/child11 ifconfig å‘½ä»¤é—®ï¼šifconfig å‘½ä»¤ ç­”ï¼šifconfig(interfaces config)ã€‚é€šå¸¸éœ€è¦ä»¥rootèº«ä»½ç™»å½•æˆ–ä½¿ç”¨sudoæ¥ä½¿ç”¨ifconfigå·¥å…·ifconfig å‘½ä»¤ç”¨æ¥æŸ¥çœ‹å’Œé…ç½®ç½‘ç»œè®¾å¤‡ã€‚å½“ç½‘ç»œç¯å¢ƒå‘ç”Ÿæ”¹å˜æ—¶å¯é€šè¿‡æ­¤å‘½ä»¤å¯¹ç½‘ç»œè¿›è¡Œç›¸åº”çš„é…ç½®ã€‚å¤‡æ³¨ï¼šç”¨ifconfigå‘½ä»¤é…ç½®çš„ç½‘å¡ä¿¡æ¯ï¼Œåœ¨ç½‘å¡é‡å¯åæœºå™¨é‡å¯åï¼Œé…ç½®å°±ä¸å­˜åœ¨ã€‚è¦æƒ³å°†ä¸Šè¿°çš„é…ç½®ä¿¡æ¯æ°¸è¿œçš„å­˜çš„ç”µè„‘é‡Œï¼Œé‚£å°±è¦ä¿®æ”¹ç½‘å¡çš„é…ç½®æ–‡ä»¶äº†ã€‚ ç­”ï¼šifconfig ç”¨äºæŸ¥çœ‹å’Œé…ç½® Linux ç³»ç»Ÿçš„ç½‘ç»œæ¥å£ã€‚ æŸ¥çœ‹æ‰€æœ‰ç½‘ç»œæ¥å£åŠå…¶çŠ¶æ€ï¼šifconfig -a ã€‚ ä½¿ç”¨ up å’Œ down å‘½ä»¤å¯åŠ¨æˆ–åœæ­¢æŸä¸ªæ¥å£ï¼šifconfig eth0 up å’Œ ifconfig eth0 down ã€‚ iptables å‘½ä»¤é—®ï¼šiptables å‘½ä»¤ ç­”ï¼šiptables ï¼Œæ˜¯ä¸€ä¸ªé…ç½® Linux å†…æ ¸é˜²ç«å¢™çš„å‘½ä»¤è¡Œå·¥å…·ã€‚åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œå¯¹äºæˆ‘ä»¬å¼€å‘æ¥è¯´ï¼Œä¸»è¦æŒæ¡å¦‚ä½•å¼€æ”¾ç«¯å£å³å¯ã€‚ä¾‹å¦‚ï¼šæŠŠæ¥æº IP ä¸º 192.168.1.101 è®¿é—®æœ¬æœº 80 ç«¯å£çš„åŒ…ç›´æ¥æ‹’ç»ï¼šiptables -I INPUT -s 192.168.1.101 -p tcp â€”dport 80 -j REJECT ã€‚å¼€å¯ 80 ç«¯å£ï¼Œå› ä¸ºwebå¯¹å¤–éƒ½æ˜¯è¿™ä¸ªç«¯å£iptables -A INPUT -p tcp â€”dport 80 -j ACCEP 1 å¦å¤–ï¼Œè¦æ³¨æ„ä½¿ç”¨ iptables save å‘½ä»¤ï¼Œè¿›è¡Œä¿å­˜ã€‚å¦åˆ™ï¼ŒæœåŠ¡å™¨é‡å¯åï¼Œé…ç½®çš„è§„åˆ™å°†ä¸¢å¤±ã€‚ netstat å‘½ä»¤é—®ï¼šnetstat å‘½ä»¤ ç­”ï¼š 123456789101112Linux netstatå‘½ä»¤ç”¨äºæ˜¾ç¤ºç½‘ç»œçŠ¶æ€ã€‚ åˆ©ç”¨netstatæŒ‡ä»¤å¯è®©ä½ å¾—çŸ¥æ•´ä¸ªLinuxç³»ç»Ÿçš„ç½‘ç»œæƒ…å†µã€‚ è¯­æ³• netstat [-acCeFghilMnNoprstuvVwx][-A&lt;ç½‘ç»œç±»å‹&gt;][--ip] 1 å‚æ•°è¯´æ˜ï¼š -aæˆ–â€“all æ˜¾ç¤ºæ‰€æœ‰è¿çº¿ä¸­çš„Socketã€‚ -A&lt;ç½‘ç»œç±»å‹&gt;æˆ–â€“&lt;ç½‘ç»œç±»å‹&gt; åˆ—å‡ºè¯¥ç½‘ç»œç±»å‹è¿çº¿ä¸­çš„ç›¸å…³åœ°å€ã€‚ -cæˆ–â€“continuous æŒç»­åˆ—å‡ºç½‘ç»œçŠ¶æ€ã€‚ -Cæˆ–â€“cache æ˜¾ç¤ºè·¯ç”±å™¨é…ç½®çš„å¿«å–ä¿¡æ¯ã€‚ -eæˆ–â€“extend æ˜¾ç¤ºç½‘ç»œå…¶ä»–ç›¸å…³ä¿¡æ¯ã€‚ -Fæˆ–â€“fib æ˜¾ç¤ºFIBã€‚ -gæˆ–â€“groups æ˜¾ç¤ºå¤šé‡å¹¿æ’­åŠŸèƒ½ç¾¤ç»„ç»„å‘˜åå•ã€‚ -hæˆ–â€“help åœ¨çº¿å¸®åŠ©ã€‚ -iæˆ–â€“interfaces æ˜¾ç¤ºç½‘ç»œç•Œé¢ä¿¡æ¯è¡¨å•ã€‚ -læˆ–â€“listening æ˜¾ç¤ºç›‘æ§ä¸­çš„æœåŠ¡å™¨çš„Socketã€‚ -Mæˆ–â€“masquerade æ˜¾ç¤ºä¼ªè£…çš„ç½‘ç»œè¿çº¿ã€‚ -næˆ–â€“numeric ç›´æ¥ä½¿ç”¨IPåœ°å€ï¼Œè€Œä¸é€šè¿‡åŸŸåæœåŠ¡å™¨ã€‚ -Næˆ–â€“netlinkæˆ–â€“symbolic æ˜¾ç¤ºç½‘ç»œç¡¬ä»¶å¤–å›´è®¾å¤‡çš„ç¬¦å·è¿æ¥åç§°ã€‚ -oæˆ–â€“timers æ˜¾ç¤ºè®¡æ—¶å™¨ã€‚ -pæˆ–â€“programs æ˜¾ç¤ºæ­£åœ¨ä½¿ç”¨Socketçš„ç¨‹åºè¯†åˆ«ç å’Œç¨‹åºåç§°ã€‚ -ræˆ–â€“route æ˜¾ç¤ºRouting Tableã€‚ -sæˆ–â€“statistice æ˜¾ç¤ºç½‘ç»œå·¥ä½œä¿¡æ¯ç»Ÿè®¡è¡¨ã€‚ -tæˆ–â€“tcp æ˜¾ç¤ºTCPä¼ è¾“åè®®çš„è¿çº¿çŠ¶å†µã€‚ -uæˆ–â€“udp æ˜¾ç¤ºUDPä¼ è¾“åè®®çš„è¿çº¿çŠ¶å†µã€‚ -væˆ–â€“verbose æ˜¾ç¤ºæŒ‡ä»¤æ‰§è¡Œè¿‡ç¨‹ã€‚ -Væˆ–â€“version æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ã€‚ -wæˆ–â€“raw æ˜¾ç¤ºRAWä¼ è¾“åè®®çš„è¿çº¿çŠ¶å†µã€‚ -xæˆ–â€“unix æ­¤å‚æ•°çš„æ•ˆæœå’ŒæŒ‡å®š&quot;-A unix&quot;å‚æ•°ç›¸åŒã€‚ â€“ipæˆ–â€“inet æ­¤å‚æ•°çš„æ•ˆæœå’ŒæŒ‡å®š&quot;-A inet&quot;å‚æ•°ç›¸åŒã€‚ å®ä¾‹ å¦‚ä½•æŸ¥çœ‹ç³»ç»Ÿéƒ½å¼€å¯äº†å“ªäº›ç«¯å£ï¼Ÿ [root@centos6 ~ 13:20 #55]# netstat -lnp Active Internet connections (only servers) Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN 1035/sshd tcp 0 0 :::22 :::* LISTEN 1035/sshd udp 0 0 0.0.0.0:68 0.0.0.0:* 931/dhclient Active UNIX domain sockets (only servers) Proto RefCnt Flags Type State I-Node PID/Program name Path unix 2 [ ACC ] STREAM LISTENING 6825 1/init @/com/ubuntu/upstart unix 2 [ ACC ] STREAM LISTENING 8429 1003/dbus-daemon /var/run/dbus/system_bus_socket 1 2 3 4 5 6 7 8 9 10 å¦‚ä½•æŸ¥çœ‹ç½‘ç»œè¿æ¥çŠ¶å†µï¼Ÿ [root@centos6 ~ 13:22 #58]# netstat -an Active Internet connections (servers and established) Proto Recv-Q Send-Q Local Address Foreign Address State tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN tcp 0 0 192.168.147.130:22 192.168.147.1:23893 ESTABLISHED tcp 0 0 :::22 :::* LISTEN udp 0 0 0.0.0.0:68 0.0.0.0:* 1 2 3 4 5 6 7 å¦‚ä½•ç»Ÿè®¡ç³»ç»Ÿå½“å‰è¿›ç¨‹è¿æ¥æ•°ï¼Ÿ è¾“å…¥å‘½ä»¤ netstat -an | grep ESTABLISHED | wc -l ã€‚ è¾“å‡ºç»“æœ 177 ã€‚ä¸€å…±æœ‰ 177 è¿æ¥æ•°ã€‚ ç”¨ netstat å‘½ä»¤é…åˆå…¶ä»–å‘½ä»¤ï¼ŒæŒ‰ç…§æº IP ç»Ÿè®¡æ‰€æœ‰åˆ° 80 ç«¯å£çš„ ESTABLISHED çŠ¶æ€é“¾æ¥çš„ä¸ªæ•°ï¼Ÿ ä¸¥æ ¼æ¥è¯´ï¼Œè¿™ä¸ªé¢˜ç›®è€ƒéªŒçš„æ˜¯å¯¹ awk çš„ä½¿ç”¨ã€‚ é¦–å…ˆï¼Œä½¿ç”¨ netstat -an|grep ESTABLISHED å‘½ä»¤ã€‚ç»“æœå¦‚ä¸‹ï¼š tcp 0 0 120.27.146.122:80 113.65.18.33:62721 ESTABLISHED tcp 0 0 120.27.146.122:80 27.43.83.115:47148 ESTABLISHED tcp 0 0 120.27.146.122:58838 106.39.162.96:443 ESTABLISHED tcp 0 0 120.27.146.122:52304 203.208.40.121:443 ESTABLISHED tcp 0 0 120.27.146.122:33194 203.208.40.122:443 ESTABLISHED tcp 0 0 120.27.146.122:53758 101.37.183.144:443 ESTABLISHED tcp 0 0 120.27.146.122:27017 23.105.193.30:50556 ESTABLISHED ping å‘½ä»¤é—®ï¼šping å‘½ä»¤ ç­”ï¼šLinux pingå‘½ä»¤ç”¨äºæ£€æµ‹ä¸»æœºã€‚æ‰§è¡ŒpingæŒ‡ä»¤ä¼šä½¿ç”¨ICMPä¼ è¾“åè®®ï¼Œå‘å‡ºè¦æ±‚å›åº”çš„ä¿¡æ¯ï¼Œè‹¥è¿œç«¯ä¸»æœºçš„ç½‘ç»œåŠŸèƒ½æ²¡æœ‰é—®é¢˜ï¼Œå°±ä¼šå›åº”è¯¥ä¿¡æ¯ï¼Œå› è€Œå¾—çŸ¥è¯¥ä¸»æœºè¿ä½œæ­£å¸¸ã€‚æŒ‡å®šæ¥æ”¶åŒ…çš„æ¬¡æ•°ping -c 2 www.baidu.com telnet å‘½ä»¤é—®ï¼štelnet å‘½ä»¤ ç­”ï¼šLinux telnetå‘½ä»¤ç”¨äºè¿œç«¯ç™»å…¥ã€‚æ‰§è¡ŒtelnetæŒ‡ä»¤å¼€å¯ç»ˆç«¯æœºé˜¶æ®µä½œä¸šï¼Œå¹¶ç™»å…¥è¿œç«¯ä¸»æœºã€‚è¯­æ³•telnet [-8acdEfFKLrx][-b&lt;ä¸»æœºåˆ«å&gt;][-e&lt;è„±ç¦»å­—ç¬¦&gt;][-k&lt;åŸŸå&gt;][-l&lt;ç”¨æˆ·åç§°&gt;][-n&lt;è®°å½•æ–‡ä»¶&gt;][-S&lt;æœåŠ¡ç±»å‹&gt;][-X&lt;è®¤è¯å½¢æ€&gt;][ä¸»æœºåç§°æˆ–IPåœ°å€&lt;é€šä¿¡ç«¯å£&gt;] 1 å‚æ•°è¯´æ˜ï¼š-8 å…è®¸ä½¿ç”¨8ä½å­—ç¬¦èµ„æ–™ï¼ŒåŒ…æ‹¬è¾“å…¥ä¸è¾“å‡ºã€‚ -a å°è¯•è‡ªåŠ¨ç™»å…¥è¿œç«¯ç³»ç»Ÿã€‚ -b&lt;ä¸»æœºåˆ«å&gt; ä½¿ç”¨åˆ«åæŒ‡å®šè¿œç«¯ä¸»æœºåç§°ã€‚ -c ä¸è¯»å–ç”¨æˆ·ä¸“å±ç›®å½•é‡Œçš„.telnetrcæ–‡ä»¶ã€‚ -d å¯åŠ¨æ’é”™æ¨¡å¼ã€‚ -e&lt;è„±ç¦»å­—ç¬¦&gt; è®¾ç½®è„±ç¦»å­—ç¬¦ã€‚ -E æ»¤é™¤è„±ç¦»å­—ç¬¦ã€‚ -f æ­¤å‚æ•°çš„æ•ˆæœå’ŒæŒ‡å®šâ€-Fâ€å‚æ•°ç›¸åŒã€‚ -F ä½¿ç”¨Kerberos V5è®¤è¯æ—¶ï¼ŒåŠ ä¸Šæ­¤å‚æ•°å¯æŠŠæœ¬åœ°ä¸»æœºçš„è®¤è¯æ•°æ®ä¸Šä¼ åˆ°è¿œç«¯ä¸»æœºã€‚ -k&lt;åŸŸå&gt; ä½¿ç”¨Kerberosè®¤è¯æ—¶ï¼ŒåŠ ä¸Šæ­¤å‚æ•°è®©è¿œç«¯ä¸»æœºé‡‡ç”¨æŒ‡å®šçš„é¢†åŸŸåï¼Œè€Œéè¯¥ä¸»æœºçš„åŸŸåã€‚ -K ä¸è‡ªåŠ¨ç™»å…¥è¿œç«¯ä¸»æœºã€‚ -l&lt;ç”¨æˆ·åç§°&gt; æŒ‡å®šè¦ç™»å…¥è¿œç«¯ä¸»æœºçš„ç”¨æˆ·åç§°ã€‚ -L å…è®¸è¾“å‡º8ä½å­—ç¬¦èµ„æ–™ã€‚ -n&lt;è®°å½•æ–‡ä»¶&gt; æŒ‡å®šæ–‡ä»¶è®°å½•ç›¸å…³ä¿¡æ¯ã€‚ -r ä½¿ç”¨ç±»ä¼¼rloginæŒ‡ä»¤çš„ç”¨æˆ·ç•Œé¢ã€‚ -S&lt;æœåŠ¡ç±»å‹&gt; è®¾ç½®telnetè¿çº¿æ‰€éœ€çš„IP TOSä¿¡æ¯ã€‚ -x å‡è®¾ä¸»æœºæœ‰æ”¯æŒæ•°æ®åŠ å¯†çš„åŠŸèƒ½ï¼Œå°±ä½¿ç”¨å®ƒã€‚ -X&lt;è®¤è¯å½¢æ€&gt; å…³é—­æŒ‡å®šçš„è®¤è¯å½¢æ€ã€‚ å®ä¾‹ç™»å½•è¿œç¨‹ä¸»æœºç™»å½•IPä¸º 192.168.0.5 çš„è¿œç¨‹ä¸»æœºtelnet 192.168.0.5 date å‘½ä»¤é—®ï¼šdate å‘½ä»¤ ç­”ï¼šæ˜¾ç¤ºæˆ–è®¾å®šç³»ç»Ÿçš„æ—¥æœŸä¸æ—¶é—´ã€‚å‘½ä»¤å‚æ•°ï¼š-d&lt;å­—ç¬¦ä¸²&gt; æ˜¾ç¤ºå­—ç¬¦ä¸²æ‰€æŒ‡çš„æ—¥æœŸä¸æ—¶é—´ã€‚å­—ç¬¦ä¸²å‰åå¿…é¡»åŠ ä¸ŠåŒå¼•å·ã€‚ -s&lt;å­—ç¬¦ä¸²&gt; æ ¹æ®å­—ç¬¦ä¸²æ¥è®¾ç½®æ—¥æœŸä¸æ—¶é—´ã€‚å­—ç¬¦ä¸²å‰åå¿…é¡»åŠ ä¸ŠåŒå¼•å·ã€‚ -u æ˜¾ç¤ºGMTã€‚ %H å°æ—¶(00-23) %I å°æ—¶(00-12) %M åˆ†é’Ÿ(ä»¥00-59æ¥è¡¨ç¤º) %s æ€»ç§’æ•°ã€‚èµ·ç®—æ—¶é—´ä¸º1970-01-01 00:00:00 UTCã€‚ %S ç§’(ä»¥æœ¬åœ°çš„æƒ¯ç”¨æ³•æ¥è¡¨ç¤º) %a æ˜ŸæœŸçš„ç¼©å†™ã€‚ %A æ˜ŸæœŸçš„å®Œæ•´åç§°ã€‚ %d æ—¥æœŸ(ä»¥01-31æ¥è¡¨ç¤º)ã€‚ %D æ—¥æœŸ(å«å¹´æœˆæ—¥)ã€‚ %m æœˆä»½(ä»¥01-12æ¥è¡¨ç¤º)ã€‚ %y å¹´ä»½(ä»¥00-99æ¥è¡¨ç¤º)ã€‚ %Y å¹´ä»½(ä»¥å››ä½æ•°æ¥è¡¨ç¤º)ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 å®ä¾‹ï¼šï¼ˆ1ï¼‰æ˜¾ç¤ºä¸‹ä¸€å¤©date +%Y%m%d â€”date=â€+1 dayâ€ //æ˜¾ç¤ºä¸‹ä¸€å¤©çš„æ—¥æœŸ 1 ï¼ˆ2ï¼‰-då‚æ•°ä½¿ç”¨date -d â€œnov 22â€ ä»Šå¹´çš„ 11 æœˆ 22 æ—¥æ˜¯æ˜ŸæœŸä¸‰ date -d â€˜2 weeksâ€™ 2å‘¨åçš„æ—¥æœŸ date -d â€˜next mondayâ€™ (ä¸‹å‘¨ä¸€çš„æ—¥æœŸ) date -d next-day +%Y%m%dï¼ˆæ˜å¤©çš„æ—¥æœŸï¼‰æˆ–è€…ï¼šdate -d tomorrow +%Y%m%d date -d last-day +%Y%m%d(æ˜¨å¤©çš„æ—¥æœŸ) æˆ–è€…ï¼šdate -d yesterday +%Y%m%d date -d last-month +%Y%m(ä¸Šä¸ªæœˆæ˜¯å‡ æœˆ) date -d next-month +%Y%m(ä¸‹ä¸ªæœˆæ˜¯å‡ æœˆ) free å‘½ä»¤é—®ï¼šfree å‘½ä»¤ ç­”ï¼šæ˜¾ç¤ºç³»ç»Ÿå†…å­˜ä½¿ç”¨æƒ…å†µï¼ŒåŒ…æ‹¬ç‰©ç†å†…å­˜ã€äº¤äº’åŒºå†…å­˜(swap)å’Œå†…æ ¸ç¼“å†²åŒºå†…å­˜ã€‚å‘½ä»¤å‚æ•°ï¼š-b ä»¥Byteæ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ -k ä»¥kbä¸ºå•ä½æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ -m ä»¥mbä¸ºå•ä½æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ -g ä»¥gbä¸ºå•ä½æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ -s&lt;é—´éš”ç§’æ•°&gt; æŒç»­æ˜¾ç¤ºå†…å­˜ -t æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æ€»åˆ 1 2 3 4 5 6 å®ä¾‹ï¼šï¼ˆ1ï¼‰æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µfree free -k free -m 1 2 3 ï¼ˆ2ï¼‰ä»¥æ€»å’Œçš„å½¢å¼æ˜¾ç¤ºå†…å­˜çš„ä½¿ç”¨ä¿¡æ¯free -t 1 ï¼ˆ3ï¼‰å‘¨æœŸæ€§æŸ¥è¯¢å†…å­˜ä½¿ç”¨æƒ…å†µfree -s 10 kill å‘½ä»¤é—®ï¼škill å‘½ä»¤ ç­”ï¼šå‘é€æŒ‡å®šçš„ä¿¡å·åˆ°ç›¸åº”è¿›ç¨‹ã€‚ä¸æŒ‡å®šå‹å·å°†å‘é€SIGTERMï¼ˆ15ï¼‰ç»ˆæ­¢æŒ‡å®šè¿›ç¨‹ã€‚å¦‚æœä»»æ— æ³•ç»ˆæ­¢è¯¥ç¨‹åºå¯ç”¨â€-KILLâ€ å‚æ•°ï¼Œå…¶å‘é€çš„ä¿¡å·ä¸ºSIGKILL(9) ï¼Œå°†å¼ºåˆ¶ç»“æŸè¿›ç¨‹ï¼Œä½¿ç”¨pså‘½ä»¤æˆ–è€…jobs å‘½ä»¤å¯ä»¥æŸ¥çœ‹è¿›ç¨‹å·ã€‚rootç”¨æˆ·å°†å½±å“ç”¨æˆ·çš„è¿›ç¨‹ï¼Œérootç”¨æˆ·åªèƒ½å½±å“è‡ªå·±çš„è¿›ç¨‹ã€‚å¸¸ç”¨å‚æ•°ï¼š-l ä¿¡å·ï¼Œè‹¥æœä¸åŠ ä¿¡å·çš„ç¼–å·å‚æ•°ï¼Œåˆ™ä½¿ç”¨â€œ-lâ€å‚æ•°ä¼šåˆ—å‡ºå…¨éƒ¨çš„ä¿¡å·åç§° -a å½“å¤„ç†å½“å‰è¿›ç¨‹æ—¶ï¼Œä¸é™åˆ¶å‘½ä»¤åå’Œè¿›ç¨‹å·çš„å¯¹åº”å…³ç³» -p æŒ‡å®škill å‘½ä»¤åªæ‰“å°ç›¸å…³è¿›ç¨‹çš„è¿›ç¨‹å·ï¼Œè€Œä¸å‘é€ä»»ä½•ä¿¡å· -s æŒ‡å®šå‘é€ä¿¡å· -u æŒ‡å®šç”¨æˆ· 1 2 3 4 5 å®ä¾‹ï¼šï¼ˆ1ï¼‰å…ˆä½¿ç”¨psæŸ¥æ‰¾è¿›ç¨‹pro1ï¼Œç„¶åç”¨killæ€æ‰kill -9 $(ps -ef | grep pro1) ps å‘½ä»¤é—®ï¼šps å‘½ä»¤ ç­”ï¼šps(process status)ï¼Œç”¨æ¥æŸ¥çœ‹å½“å‰è¿è¡Œçš„è¿›ç¨‹çŠ¶æ€ï¼Œä¸€æ¬¡æ€§æŸ¥çœ‹ï¼Œå¦‚æœéœ€è¦åŠ¨æ€è¿ç»­ç»“æœä½¿ç”¨ toplinuxä¸Šè¿›ç¨‹æœ‰5ç§çŠ¶æ€:è¿è¡Œ(æ­£åœ¨è¿è¡Œæˆ–åœ¨è¿è¡Œé˜Ÿåˆ—ä¸­ç­‰å¾…)ä¸­æ–­(ä¼‘çœ ä¸­, å—é˜», åœ¨ç­‰å¾…æŸä¸ªæ¡ä»¶çš„å½¢æˆæˆ–æ¥å—åˆ°ä¿¡å·)ä¸å¯ä¸­æ–­(æ”¶åˆ°ä¿¡å·ä¸å”¤é†’å’Œä¸å¯è¿è¡Œ, è¿›ç¨‹å¿…é¡»ç­‰å¾…ç›´åˆ°æœ‰ä¸­æ–­å‘ç”Ÿ)åƒµæ­»(è¿›ç¨‹å·²ç»ˆæ­¢, ä½†è¿›ç¨‹æè¿°ç¬¦å­˜åœ¨, ç›´åˆ°çˆ¶è¿›ç¨‹è°ƒç”¨wait4()ç³»ç»Ÿè°ƒç”¨åé‡Šæ”¾)åœæ­¢(è¿›ç¨‹æ”¶åˆ°SIGSTOP, SIGSTP, SIGTIN, SIGTOUä¿¡å·ååœæ­¢è¿è¡Œè¿è¡Œ)ps å·¥å…·æ ‡è¯†è¿›ç¨‹çš„5ç§çŠ¶æ€ç :D ä¸å¯ä¸­æ–­ uninterruptible sleep (usually IO) R è¿è¡Œ runnable (on run queue) S ä¸­æ–­ sleeping T åœæ­¢ traced or stopped Z åƒµæ­» a defunct (â€zombieâ€) process 1 2 3 4 5 å‘½ä»¤å‚æ•°ï¼š-A æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹ a æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹ -a æ˜¾ç¤ºåŒä¸€ç»ˆç«¯ä¸‹æ‰€æœ‰è¿›ç¨‹ c æ˜¾ç¤ºè¿›ç¨‹çœŸå®åç§° e æ˜¾ç¤ºç¯å¢ƒå˜é‡ f æ˜¾ç¤ºè¿›ç¨‹é—´çš„å…³ç³» r æ˜¾ç¤ºå½“å‰ç»ˆç«¯è¿è¡Œçš„è¿›ç¨‹ -aux æ˜¾ç¤ºæ‰€æœ‰åŒ…å«å…¶å®ƒä½¿ç”¨çš„è¿›ç¨‹ 1 2 3 4 5 6 7 8 å®ä¾‹ï¼šï¼ˆ1ï¼‰æ˜¾ç¤ºå½“å‰æ‰€æœ‰è¿›ç¨‹ç¯å¢ƒå˜é‡åŠè¿›ç¨‹é—´å…³ç³»ps -ef 1 ï¼ˆ2ï¼‰æ˜¾ç¤ºå½“å‰æ‰€æœ‰è¿›ç¨‹ps -A 1 ï¼ˆ3ï¼‰ä¸grepè”ç”¨æŸ¥æ‰¾æŸè¿›ç¨‹ps -aux | grep apache 1 ï¼ˆ4ï¼‰æ‰¾å‡ºä¸ cron ä¸ syslog è¿™ä¸¤ä¸ªæœåŠ¡æœ‰å…³çš„ PID å·ç ps aux | grep â€˜(cron|syslog)â€™ rpm å‘½ä»¤é—®ï¼šrpm å‘½ä»¤ ç­”ï¼šLinux rpm å‘½ä»¤ç”¨äºç®¡ç†å¥—ä»¶ã€‚rpm(redhat package manager) åŸæœ¬æ˜¯ Red Hat Linux å‘è¡Œç‰ˆä¸“é—¨ç”¨æ¥ç®¡ç† Linux å„é¡¹å¥—ä»¶çš„ç¨‹åºï¼Œç”±äºå®ƒéµå¾ª GPL è§„åˆ™ä¸”åŠŸèƒ½å¼ºå¤§æ–¹ä¾¿ï¼Œå› è€Œå¹¿å—æ¬¢è¿ã€‚é€æ¸å—åˆ°å…¶ä»–å‘è¡Œç‰ˆçš„é‡‡ç”¨ã€‚RPM å¥—ä»¶ç®¡ç†æ–¹å¼çš„å‡ºç°ï¼Œè®© Linux æ˜“äºå®‰è£…ï¼Œå‡çº§ï¼Œé—´æ¥æå‡äº† Linux çš„é€‚ç”¨åº¦ã€‚æŸ¥çœ‹ç³»ç»Ÿè‡ªå¸¦jdkrpm -qa | grep jdkåˆ é™¤ç³»ç»Ÿè‡ªå¸¦jdkrpm -e â€”nodeps æŸ¥çœ‹jdkæ˜¾ç¤ºçš„æ•°æ®å®‰è£…jdkrpm -ivh jdk-7u80-linux-x64.rpm top å‘½ä»¤é—®ï¼štop å‘½ä»¤ ç­”ï¼šæ˜¾ç¤ºå½“å‰ç³»ç»Ÿæ­£åœ¨æ‰§è¡Œçš„è¿›ç¨‹çš„ç›¸å…³ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¿›ç¨‹ IDã€å†…å­˜å ç”¨ç‡ã€CPU å ç”¨ç‡ç­‰å¸¸ç”¨å‚æ•°ï¼š-c æ˜¾ç¤ºå®Œæ•´çš„è¿›ç¨‹å‘½ä»¤ -s ä¿å¯†æ¨¡å¼ -p &lt;è¿›ç¨‹å·&gt; æŒ‡å®šè¿›ç¨‹æ˜¾ç¤º -n &lt;æ¬¡æ•°&gt;å¾ªç¯æ˜¾ç¤ºæ¬¡æ•° 1 2 3 4 å®ä¾‹ï¼štop - 14:06:23 up 70 days, 16:44, 2 users, load average: 1.25, 1.32, 1.35 Tasks: 206 total, 1 running, 205 sleeping, 0 stopped, 0 zombie Cpu(s): 5.9%us, 3.4%sy, 0.0%ni, 90.4%id, 0.0%wa, 0.0%hi, 0.2%si, 0.0%st Mem: 32949016k total, 14411180k used, 18537836k free, 169884k buffers Swap: 32764556k total, 0k used, 32764556k free, 3612636k cached PID USER PR NI VIRT RES SHR S %CPU %MEM TIME+ COMMAND 28894 root 22 0 1501m 405m 10m S 52.2 1.3 2534:16 java 1 2 3 4 5 6 7 å‰äº”è¡Œæ˜¯å½“å‰ç³»ç»Ÿæƒ…å†µæ•´ä½“çš„ç»Ÿè®¡ä¿¡æ¯åŒºã€‚ç¬¬ä¸€è¡Œï¼Œä»»åŠ¡é˜Ÿåˆ—ä¿¡æ¯ï¼ŒåŒ uptime å‘½ä»¤çš„æ‰§è¡Œç»“æœï¼Œå…·ä½“å‚æ•°è¯´æ˜æƒ…å†µå¦‚ä¸‹ï¼š14:06:23 â€” å½“å‰ç³»ç»Ÿæ—¶é—´up 70 days, 16:44 â€” ç³»ç»Ÿå·²ç»è¿è¡Œäº†70å¤©16å°æ—¶44åˆ†é’Ÿï¼ˆåœ¨è¿™æœŸé—´ç³»ç»Ÿæ²¡æœ‰é‡å¯è¿‡çš„å†ï¼ï¼‰2 users â€” å½“å‰æœ‰2ä¸ªç”¨æˆ·ç™»å½•ç³»ç»Ÿload average: 1.15, 1.42, 1.44 â€” load averageåé¢çš„ä¸‰ä¸ªæ•°åˆ†åˆ«æ˜¯1åˆ†é’Ÿã€5åˆ†é’Ÿã€15åˆ†é’Ÿçš„è´Ÿè½½æƒ…å†µã€‚load averageæ•°æ®æ˜¯æ¯éš”5ç§’é’Ÿæ£€æŸ¥ä¸€æ¬¡æ´»è·ƒçš„è¿›ç¨‹æ•°ï¼Œç„¶åæŒ‰ç‰¹å®šç®—æ³•è®¡ç®—å‡ºçš„æ•°å€¼ã€‚å¦‚æœè¿™ä¸ªæ•°é™¤ä»¥é€»è¾‘CPUçš„æ•°é‡ï¼Œç»“æœé«˜äº5çš„æ—¶å€™å°±è¡¨æ˜ç³»ç»Ÿåœ¨è¶…è´Ÿè·è¿è½¬äº†ã€‚ç¬¬äºŒè¡Œï¼ŒTasks â€” ä»»åŠ¡ï¼ˆè¿›ç¨‹ï¼‰ï¼Œå…·ä½“ä¿¡æ¯è¯´æ˜å¦‚ä¸‹ï¼šç³»ç»Ÿç°åœ¨å…±æœ‰206ä¸ªè¿›ç¨‹ï¼Œå…¶ä¸­å¤„äºè¿è¡Œä¸­çš„æœ‰1ä¸ªï¼Œ205ä¸ªåœ¨ä¼‘çœ ï¼ˆsleepï¼‰ï¼ŒstopedçŠ¶æ€çš„æœ‰0ä¸ªï¼ŒzombieçŠ¶æ€ï¼ˆåƒµå°¸ï¼‰çš„æœ‰0ä¸ªã€‚ç¬¬ä¸‰è¡Œï¼ŒcpuçŠ¶æ€ä¿¡æ¯ï¼Œå…·ä½“å±æ€§è¯´æ˜å¦‚ä¸‹ï¼š5.9%us â€” ç”¨æˆ·ç©ºé—´å ç”¨CPUçš„ç™¾åˆ†æ¯”ã€‚ 3.4% sy â€” å†…æ ¸ç©ºé—´å ç”¨CPUçš„ç™¾åˆ†æ¯”ã€‚ 0.0% ni â€” æ”¹å˜è¿‡ä¼˜å…ˆçº§çš„è¿›ç¨‹å ç”¨CPUçš„ç™¾åˆ†æ¯” 90.4% id â€” ç©ºé—²CPUç™¾åˆ†æ¯” 0.0% wa â€” IOç­‰å¾…å ç”¨CPUçš„ç™¾åˆ†æ¯” 0.0% hi â€” ç¡¬ä¸­æ–­ï¼ˆHardware IRQï¼‰å ç”¨CPUçš„ç™¾åˆ†æ¯” 0.2% si â€” è½¯ä¸­æ–­ï¼ˆSoftware Interruptsï¼‰å ç”¨CPUçš„ç™¾åˆ†æ¯” 1 2 3 4 5 6 7 å¤‡æ³¨ï¼šåœ¨è¿™é‡ŒCPUçš„ä½¿ç”¨æ¯”ç‡å’Œwindowsæ¦‚å¿µä¸åŒï¼Œéœ€è¦ç†è§£linuxç³»ç»Ÿç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´çš„ç›¸å…³çŸ¥è¯†ï¼ç¬¬å››è¡Œï¼Œå†…å­˜çŠ¶æ€ï¼Œå…·ä½“ä¿¡æ¯å¦‚ä¸‹ï¼š32949016k total â€” ç‰©ç†å†…å­˜æ€»é‡ï¼ˆ32GBï¼‰ 14411180k used â€” ä½¿ç”¨ä¸­çš„å†…å­˜æ€»é‡ï¼ˆ14GBï¼‰ 18537836k free â€” ç©ºé—²å†…å­˜æ€»é‡ï¼ˆ18GBï¼‰ 169884k buffers â€” ç¼“å­˜çš„å†…å­˜é‡ ï¼ˆ169Mï¼‰ 1 2 3 4 ç¬¬äº”è¡Œï¼Œswapäº¤æ¢åˆ†åŒºä¿¡æ¯ï¼Œå…·ä½“ä¿¡æ¯è¯´æ˜å¦‚ä¸‹ï¼š32764556k total â€” äº¤æ¢åŒºæ€»é‡ï¼ˆ32GBï¼‰ 0k used â€” ä½¿ç”¨çš„äº¤æ¢åŒºæ€»é‡ï¼ˆ0Kï¼‰ 32764556k free â€” ç©ºé—²äº¤æ¢åŒºæ€»é‡ï¼ˆ32GBï¼‰ 3612636k cached â€” ç¼“å†²çš„äº¤æ¢åŒºæ€»é‡ï¼ˆ3.6GBï¼‰ 1 2 3 4 ç¬¬å…­è¡Œï¼Œç©ºè¡Œã€‚ç¬¬ä¸ƒè¡Œä»¥ä¸‹ï¼šå„è¿›ç¨‹ï¼ˆä»»åŠ¡ï¼‰çš„çŠ¶æ€ç›‘æ§ï¼Œé¡¹ç›®åˆ—ä¿¡æ¯è¯´æ˜å¦‚ä¸‹ï¼šPID â€” è¿›ç¨‹id USER â€” è¿›ç¨‹æ‰€æœ‰è€… PR â€” è¿›ç¨‹ä¼˜å…ˆçº§ NI â€” niceå€¼ã€‚è´Ÿå€¼è¡¨ç¤ºé«˜ä¼˜å…ˆçº§ï¼Œæ­£å€¼è¡¨ç¤ºä½ä¼˜å…ˆçº§ VIRT â€” è¿›ç¨‹ä½¿ç”¨çš„è™šæ‹Ÿå†…å­˜æ€»é‡ï¼Œå•ä½kbã€‚VIRT=SWAP+RES RES â€” è¿›ç¨‹ä½¿ç”¨çš„ã€æœªè¢«æ¢å‡ºçš„ç‰©ç†å†…å­˜å¤§å°ï¼Œå•ä½kbã€‚RES=CODE+DATA SHR â€” å…±äº«å†…å­˜å¤§å°ï¼Œå•ä½kb S â€” è¿›ç¨‹çŠ¶æ€ã€‚D=ä¸å¯ä¸­æ–­çš„ç¡çœ çŠ¶æ€ R=è¿è¡Œ S=ç¡çœ  T=è·Ÿè¸ª/åœæ­¢ Z=åƒµå°¸è¿›ç¨‹ %CPU â€” ä¸Šæ¬¡æ›´æ–°åˆ°ç°åœ¨çš„CPUæ—¶é—´å ç”¨ç™¾åˆ†æ¯” %MEM â€” è¿›ç¨‹ä½¿ç”¨çš„ç‰©ç†å†…å­˜ç™¾åˆ†æ¯” TIME+ â€” è¿›ç¨‹ä½¿ç”¨çš„CPUæ—¶é—´æ€»è®¡ï¼Œå•ä½1/100ç§’ COMMAND â€” è¿›ç¨‹åç§°ï¼ˆå‘½ä»¤å/å‘½ä»¤è¡Œï¼‰ 1 2 3 4 5 6 7 8 9 10 11 12 top äº¤äº’å‘½ä»¤h æ˜¾ç¤ºtopäº¤äº’å‘½ä»¤å¸®åŠ©ä¿¡æ¯ c åˆ‡æ¢æ˜¾ç¤ºå‘½ä»¤åç§°å’Œå®Œæ•´å‘½ä»¤è¡Œ m ä»¥å†…å­˜ä½¿ç”¨ç‡æ’åº P æ ¹æ®CPUä½¿ç”¨ç™¾åˆ†æ¯”å¤§å°è¿›è¡Œæ’åº T æ ¹æ®æ—¶é—´/ç´¯è®¡æ—¶é—´è¿›è¡Œæ’åº W å°†å½“å‰è®¾ç½®å†™å…¥~/.toprcæ–‡ä»¶ä¸­ oæˆ–è€…O æ”¹å˜æ˜¾ç¤ºé¡¹ç›®çš„é¡ºåº yum å‘½ä»¤é—®ï¼šyum å‘½ä»¤ ç­”ï¼š 123456yumï¼ˆ Yellow dog Updater, Modifiedï¼‰æ˜¯ä¸€ä¸ªåœ¨Fedoraå’ŒRedHatä»¥åŠSUSEä¸­çš„Shellå‰ç«¯è½¯ä»¶åŒ…ç®¡ç†å™¨ã€‚ åŸºæ–¼RPMåŒ…ç®¡ç†ï¼Œèƒ½å¤Ÿä»æŒ‡å®šçš„æœåŠ¡å™¨è‡ªåŠ¨ä¸‹è½½RPMåŒ…å¹¶ä¸”å®‰è£…ï¼Œå¯ä»¥è‡ªåŠ¨å¤„ç†ä¾èµ–æ€§å…³ç³»ï¼Œå¹¶ä¸”ä¸€æ¬¡å®‰è£…æ‰€æœ‰ä¾èµ–çš„è½¯ä½“åŒ…ï¼Œæ— é¡»ç¹çåœ°ä¸€æ¬¡æ¬¡ä¸‹è½½ã€å®‰è£…ã€‚ yumæä¾›äº†æŸ¥æ‰¾ã€å®‰è£…ã€åˆ é™¤æŸä¸€ä¸ªã€ä¸€ç»„ç”šè‡³å…¨éƒ¨è½¯ä»¶åŒ…çš„å‘½ä»¤ï¼Œè€Œä¸”å‘½ä»¤ç®€æ´è€Œåˆå¥½è®°ã€‚ 1.åˆ—å‡ºæ‰€æœ‰å¯æ›´æ–°çš„è½¯ä»¶æ¸…å•å‘½ä»¤ï¼šyum check-update 2.æ›´æ–°æ‰€æœ‰è½¯ä»¶å‘½ä»¤ï¼šyum update 3.ä»…å®‰è£…æŒ‡å®šçš„è½¯ä»¶å‘½ä»¤ï¼šyum install &lt;package_name&gt; 4.ä»…æ›´æ–°æŒ‡å®šçš„è½¯ä»¶å‘½ä»¤ï¼šyum update &lt;package_name&gt; 5.åˆ—å‡ºæ‰€æœ‰å¯å®‰è£çš„è½¯ä»¶æ¸…å•å‘½ä»¤ï¼šyum list 6.åˆ é™¤è½¯ä»¶åŒ…å‘½ä»¤ï¼šyum remove &lt;package_name&gt; 7.æŸ¥æ‰¾è½¯ä»¶åŒ… å‘½ä»¤ï¼šyum search 8.æ¸…é™¤ç¼“å­˜å‘½ä»¤: yum clean packages: æ¸…é™¤ç¼“å­˜ç›®å½•ä¸‹çš„è½¯ä»¶åŒ… yum clean headers: æ¸…é™¤ç¼“å­˜ç›®å½•ä¸‹çš„ headers yum clean oldheaders: æ¸…é™¤ç¼“å­˜ç›®å½•ä¸‹æ—§çš„ headers yum clean, yum clean all (= yum clean packages; yum clean oldheaders) :æ¸…é™¤ç¼“å­˜ç›®å½•ä¸‹çš„è½¯ä»¶åŒ…åŠæ—§çš„headers å®ä¾‹ å®‰è£… pam-devel [root@www ~]# yum install pam-devel bzip2 å‘½ä»¤é—®ï¼šbzip2 å‘½ä»¤ ç­”ï¼š 1åˆ›å»º *.bz2 å‹ç¼©æ–‡ä»¶ï¼šbzip2 test.txt ã€‚ è§£å‹ *.bz2 æ–‡ä»¶ï¼šbzip2 -d test.txt.bz2 ã€‚ gzip å‘½ä»¤é—®ï¼šgzip å‘½ä»¤ ç­”ï¼š 1åˆ›å»ºä¸€ä¸ª *.gz çš„å‹ç¼©æ–‡ä»¶ï¼šgzip test.txt ã€‚ è§£å‹ *.gz æ–‡ä»¶ï¼šgzip -d test.txt.gz ã€‚ æ˜¾ç¤ºå‹ç¼©çš„æ¯”ç‡ï¼šgzip -l *.gz ã€‚ tar å‘½ä»¤é—®ï¼štar å‘½ä»¤ ç­”ï¼š 1234567891011ç”¨æ¥å‹ç¼©å’Œè§£å‹æ–‡ä»¶ã€‚tar æœ¬èº«ä¸å…·æœ‰å‹ç¼©åŠŸèƒ½ï¼Œåªå…·æœ‰æ‰“åŒ…åŠŸèƒ½ï¼Œæœ‰å…³å‹ç¼©åŠè§£å‹æ˜¯è°ƒç”¨å…¶å®ƒçš„åŠŸèƒ½æ¥å®Œæˆã€‚ å¼„æ¸…ä¸¤ä¸ªæ¦‚å¿µï¼šæ‰“åŒ…å’Œå‹ç¼©ã€‚æ‰“åŒ…æ˜¯æŒ‡å°†ä¸€å¤§å †æ–‡ä»¶æˆ–ç›®å½•å˜æˆä¸€ä¸ªæ€»çš„æ–‡ä»¶ï¼›å‹ç¼©åˆ™æ˜¯å°†ä¸€ä¸ªå¤§çš„æ–‡ä»¶é€šè¿‡ä¸€äº›å‹ç¼©ç®—æ³•å˜æˆä¸€ä¸ªå°æ–‡ä»¶ å¸¸ç”¨å‚æ•°ï¼š -c å»ºç«‹æ–°çš„å‹ç¼©æ–‡ä»¶ -f æŒ‡å®šå‹ç¼©æ–‡ä»¶ -r æ·»åŠ æ–‡ä»¶åˆ°å·²ç»å‹ç¼©æ–‡ä»¶åŒ…ä¸­ -u æ·»åŠ æ”¹äº†å’Œç°æœ‰çš„æ–‡ä»¶åˆ°å‹ç¼©åŒ…ä¸­ -x ä»å‹ç¼©åŒ…ä¸­æŠ½å–æ–‡ä»¶ -t æ˜¾ç¤ºå‹ç¼©æ–‡ä»¶ä¸­çš„å†…å®¹ -z æ”¯æŒgzipå‹ç¼© -j æ”¯æŒbzip2å‹ç¼© -Z æ”¯æŒcompressè§£å‹æ–‡ä»¶ -v æ˜¾ç¤ºæ“ä½œè¿‡ç¨‹ 1 2 3 4 5 6 7 8 9 10 æœ‰å…³ gzip åŠ bzip2 å‹ç¼©: gzip å®ä¾‹ï¼šå‹ç¼© gzip fileName .tar.gz å’Œ.tgz è§£å‹ï¼šgunzip filename.gz æˆ– gzip -d filename.gz å¯¹åº”ï¼štar zcvf filename.tar.gz tar zxvf filename.tar.gz bz2å®ä¾‹ï¼šå‹ç¼© bzip2 -z filename .tar.bz2 è§£å‹ï¼šbunzip filename.bz2æˆ–bzip -d filename.bz2 å¯¹åº”ï¼štar jcvf filename.tar.gz è§£å‹ï¼štar jxvf filename.tar.bz2 1 2 3 4 5 å®ä¾‹ï¼š ï¼ˆ1ï¼‰å°†æ–‡ä»¶å…¨éƒ¨æ‰“åŒ…æˆ tar åŒ… tar -cvf log.tar 1.log,2.log æˆ–tar -cvf log.* 1 ï¼ˆ2ï¼‰å°† /etc ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åŠç›®å½•æ‰“åŒ…åˆ°æŒ‡å®šç›®å½•ï¼Œå¹¶ä½¿ç”¨ gz å‹ç¼© tar -zcvf /tmp/etc.tar.gz /etc 1 ï¼ˆ3ï¼‰æŸ¥çœ‹åˆšæ‰“åŒ…çš„æ–‡ä»¶å†…å®¹ï¼ˆä¸€å®šåŠ zï¼Œå› ä¸ºæ˜¯ä½¿ç”¨ gzip å‹ç¼©çš„ï¼‰ tar -ztvf /tmp/etc.tar.gz 1 ï¼ˆ4ï¼‰è¦å‹ç¼©æ‰“åŒ… /home, /etc ï¼Œä½†ä¸è¦ /home/dmtsai tar --exclude /home/dmtsai -zcvf myfile.tar.gz /home/* /etc unzip å‘½ä»¤é—®ï¼šunzip å‘½ä»¤ ç­”ï¼š 1è§£å‹ *.zip æ–‡ä»¶ï¼šunzip test.zip ã€‚ æŸ¥çœ‹ *.zip æ–‡ä»¶çš„å†…å®¹ï¼šunzip -l jasper.zip ã€‚","categories":[{"name":"Linux","slug":"Linux","permalink":"https://shang.at/categories/Linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://shang.at/tags/Linux/"}]},{"title":"javaå­¦ä¹ -åŸºç¡€2-Classçš„åŠ è½½è¿‡ç¨‹","slug":"javaå­¦ä¹ -åŸºç¡€2-Classçš„åŠ è½½è¿‡ç¨‹","date":"2020-08-24T22:54:32.000Z","updated":"2020-12-11T08:21:15.043Z","comments":true,"path":"post/javaå­¦ä¹ -åŸºç¡€2-Classçš„åŠ è½½è¿‡ç¨‹/","link":"","permalink":"https://shang.at/post/javaå­¦ä¹ -åŸºç¡€2-Classçš„åŠ è½½è¿‡ç¨‹/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š ClassåŠ è½½è¿‡ç¨‹ Loading åŒäº²å§”æ´¾ï¼Œä¸»è¦å‡ºäºå®‰å…¨æ¥è€ƒè™‘ LazyLoading äº”ç§æƒ…å†µ new getstatic putstatic invokestaticæŒ‡ä»¤ï¼Œè®¿é—®finalå˜é‡é™¤å¤– java.lang.reflectå¯¹ç±»è¿›è¡Œåå°„è°ƒç”¨æ—¶ åˆå§‹åŒ–å­ç±»çš„æ—¶å€™ï¼Œçˆ¶ç±»é¦–å…ˆåˆå§‹åŒ– è™šæ‹Ÿæœºå¯åŠ¨æ—¶ï¼Œè¢«æ‰§è¡Œçš„ä¸»ç±»å¿…é¡»åˆå§‹åŒ– åŠ¨æ€è¯­è¨€æ”¯æŒjava.lang.invoke.MethodHandleè§£æçš„ç»“æœä¸ºREF_getstatic REF_putstatic REF_invokestaticçš„æ–¹æ³•å¥æŸ„æ—¶ï¼Œè¯¥ç±»å¿…é¡»åˆå§‹åŒ– ClassLoaderçš„æºç  findInCache -&gt; parent.loadClass -&gt; findClass() è‡ªå®šä¹‰ç±»åŠ è½½å™¨ extends ClassLoader overwrite findClass() -&gt; defineClass(byte[] -&gt; Class clazz) åŠ å¯† ç¬¬ä¸€èŠ‚è¯¾é—ç•™é—®é¢˜ï¼šparentæ˜¯å¦‚ä½•æŒ‡å®šçš„ï¼Œæ‰“ç ´åŒäº²å§”æ´¾ï¼Œå­¦ç”Ÿé—®é¢˜æ¡Œé¢å›¾ç‰‡ ç”¨super(parent)æŒ‡å®š åŒäº²å§”æ´¾çš„æ‰“ç ´ å¦‚ä½•æ‰“ç ´ï¼šé‡å†™loadClassï¼ˆï¼‰ ä½•æ—¶æ‰“ç ´è¿‡ï¼Ÿ JDK1.2ä¹‹å‰ï¼Œè‡ªå®šä¹‰ClassLoaderéƒ½å¿…é¡»é‡å†™loadClass() ThreadContextClassLoaderå¯ä»¥å®ç°åŸºç¡€ç±»è°ƒç”¨å®ç°ç±»ä»£ç ï¼Œé€šè¿‡thread.setContextClassLoaderæŒ‡å®š çƒ­å¯åŠ¨ï¼Œçƒ­éƒ¨ç½² osgi tomcat éƒ½æœ‰è‡ªå·±çš„æ¨¡å—æŒ‡å®šclassloaderï¼ˆå¯ä»¥åŠ è½½åŒä¸€ç±»åº“çš„ä¸åŒç‰ˆæœ¬ï¼‰ æ··åˆæ‰§è¡Œ ç¼–è¯‘æ‰§è¡Œ è§£é‡Šæ‰§è¡Œ æ£€æµ‹çƒ­ç‚¹ä»£ç ï¼š-XX:CompileThreshold = 10000 Linking Verification éªŒè¯æ–‡ä»¶æ˜¯å¦ç¬¦åˆJVMè§„å®š Preparation é™æ€æˆå‘˜å˜é‡èµ‹é»˜è®¤å€¼ Resolution å°†ç±»ã€æ–¹æ³•ã€å±æ€§ç­‰ç¬¦å·å¼•ç”¨è§£æä¸ºç›´æ¥å¼•ç”¨å¸¸é‡æ± ä¸­çš„å„ç§ç¬¦å·å¼•ç”¨è§£æä¸ºæŒ‡é’ˆã€åç§»é‡ç­‰å†…å­˜åœ°å€çš„ç›´æ¥å¼•ç”¨ Initializing è°ƒç”¨ç±»åˆå§‹åŒ–ä»£ç  &lt;clinit&gt;ï¼Œç»™é™æ€æˆå‘˜å˜é‡èµ‹åˆå§‹å€¼ ClassLoader ä»»ä½•ä¸€ä¸ªClassè¢«loadåˆ°å†…å­˜ä¸­å®é™…ä¸Šç”Ÿæˆäº†ä¸¤å—å†…å®¹ï¼š classæ–‡ä»¶çš„äºŒè¿›åˆ¶å†…å®¹è¢«æ”¾ç½®åˆ°å†…å­˜çš„ä¸€å—åŒºåŸŸ[Metaspace(1.8åŠä»¥å)/PermGen(1.7åŠä»¥å‰)] åŒæ—¶[åœ¨å †å†…]ç”Ÿæˆäº†ä¸€ä¸ªclassç±»å‹çš„å¯¹è±¡ï¼ŒæŒ‡å‘è¯¥åŒºåŸŸ å…¶ä»–çš„å¯¹è±¡é€šè¿‡è·å–classç±»å‹å¯¹è±¡çš„å®ä¾‹æ¥è®¿é—®classæ–‡ä»¶çš„å†…å®¹ åŒäº²å§”æ´¾çš„ç»§æ‰¿å…³ç³»å’Œçˆ¶å­å…³ç³»ï¼Œçˆ¶åŠ è½½å™¨å’Œå­åŠ è½½å™¨æ²¡æœ‰ç»§æ‰¿å…³ç³»ï¼Œparentæ˜¯åœ¨åˆ›å»ºçš„æ—¶å€™æŒ‡å®šçš„ã€‚ClassLoaderæœ‰ä¸€ä¸ªé»˜è®¤çš„æ— å‚çš„æ„é€ å™¨ï¼Œå®ƒä¼šè‡ªåŠ¨æ‰¾åˆ°SystemClassLoaderè®¾ç½®ä¸ºè‡ªå®šä¹‰åŠ è½½å™¨çš„parent(SystemClassLoaderé»˜è®¤ä¸ºAppClassLoader) ä»€ä¹ˆå«åšåŒäº²å§”æ´¾ï¼šè¡¨ç¤ºæ˜¯ä¸€ä¸ªä»ä½åˆ°é¡¶çš„è¿‡ç¨‹å’Œä»é¡¶åˆ°åº•çš„è¿‡ç¨‹ ä¸‹å›¾æ˜¯åŒäº²å§”æ´¾çš„è¿‡ç¨‹ ä¸ºä»€ä¹ˆéœ€è¦åŒäº²å§”æ´¾ï¼Ÿ å®‰å…¨é—®é¢˜ï¼Œæ¯”å¦‚ä¸èƒ½è®©ç”¨æˆ·è‡ªå®šä¹‰åŠ è½½å™¨åŠ è½½java.lang.Stringç±»å‹ï¼Œå¯èƒ½å¸¦æ¥å®‰å…¨é—®é¢˜ã€‚ é˜²æ­¢é‡å¤åŠ è½½ åŒäº²å§”æ´¾çš„æ¨¡å¼ä¸ºä»€ä¹ˆèƒ½å¤Ÿé¿å…å®‰å…¨é—®é¢˜ï¼Ÿ åŒäº²å§”æ´¾æŠŠé€»è¾‘è®¾è®¡æˆäº†æ¨¡æ¿æ–¹æ³•ï¼Œå³å°†æ•´ä½“æµç¨‹è§„å®šæ­»äº†ï¼Œåªå°†ç‰¹å®šçš„æ­¥éª¤æš´éœ²ç»™ç”¨æˆ·é‡å†™ã€‚è¿™æ ·çš„è®¾è®¡ä¼šä¿è¯classloaderä¼šå…ˆå»parentåŠ è½½å™¨è¯¢é—®å¾…åŠ è½½çš„ç±»æ˜¯å¦å·²ç»è¢«åŠ è½½è¿‡ï¼Œä¸€ç›´è¯¢é—®åˆ°Bootstrap Loaderï¼Œå¦‚æœæ¯ä¸€å±‚éƒ½è¿”å›ç©ºï¼Œé‚£ä¹ˆè¿”å›å­åŠ è½½å™¨ï¼Œå¦‚æœè¢«åŠ è½½è¿‡ç›´æ¥è¿”å›ï¼Œå¦åˆ™æŠ›å‡ºClassNotFoundExceptionå¼‚å¸¸ çƒ­åŠ è½½åŸç†ï¼šéœ€è¦ç›‘æµ‹classæ–‡ä»¶çš„å˜åŒ–ï¼Œå¦‚æœå‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆé‡æ–°loadingè¯¥classæ–‡ä»¶ã€‚å…¶ä»–çš„å®ä¾‹å¯¹è±¡å¦‚ä½•æ›´æ–°å‘¢ï¼Ÿè¿˜æ˜¯ä¼šè‡ªåŠ¨æ›´æ–°ï¼Ÿ è¦å®ç°reloadingï¼Œéœ€è¦æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ï¼š é‡å†™ClassLoaderçš„loadClassæ–¹æ³•ï¼Œæ‰“ç ´åŒäº²å§”æ´¾æœºåˆ¶ æ¯æ¬¡reloadï¼Œéƒ½éœ€è¦é‡æ–°newä¸€ä¸ªClassLoaderå‡ºæ¥ï¼Œä½¿ç”¨åŸæ¥çš„ClassLoaderå¯¹è±¡è¿›è¡ŒloadClassä¼šæŠ›å‡ºLinkageErrorï¼Œè¡¨ç¤ºä¸èƒ½reloadé‡åçš„class 123456Exception in thread \"main\" java.lang.LinkageError: loader (instance of com/mashibing/jvm/c2_classloader/T012_ClassReloading2$MyLoader): attempted duplicate class definition for name: \"com/mashibing/jvm/Hello\" at java.lang.ClassLoader.defineClass1(Native Method) at java.lang.ClassLoader.defineClass(ClassLoader.java:763) at java.lang.ClassLoader.defineClass(ClassLoader.java:642) at com.mashibing.jvm.c2_classloader.T012_ClassReloading2$MyLoader.loadClass(T012_ClassReloading2.java:25) at com.mashibing.jvm.c2_classloader.T012_ClassReloading2.main(T012_ClassReloading2.java:40) æœ€ç»ˆloadClassä¼šä¸€ç›´è°ƒç”¨åˆ°ä¸€ä¸ªnativeçš„defineClassæ–¹æ³•ï¼Œåœ¨é‚£é‡Œä¼šæ£€æµ‹åŒä¸€ä¸ªClassLoaderçš„load classçš„ç¼“å­˜. LazyLoading æ‰§è¡Œæ¨¡å¼ Linking Verification éªŒè¯æ–‡ä»¶æ˜¯å¦ç¬¦åˆJVMè§„å®šï¼Œæ£€æµ‹classæ–‡ä»¶çš„æ ¼å¼ä»¥åŠå†…å®¹æ˜¯å¦ç¬¦åˆclass file format Preparation é™æ€æˆå‘˜å˜é‡èµ‹é»˜è®¤å€¼ Resolution å°†ç±»ã€æ–¹æ³•ã€å±æ€§ç­‰ç¬¦å·å¼•ç”¨è§£æä¸ºç›´æ¥å¼•ç”¨å¸¸é‡æ± ä¸­çš„å„ç§ç¬¦å·å¼•ç”¨è§£æä¸ºæŒ‡é’ˆã€åç§»é‡ç­‰å†…å­˜åœ°å€çš„ç›´æ¥å¼•ç”¨ åœ¨Class File Formatä¸­æˆ‘ä»¬çŸ¥é“ï¼Œä¸€ä¸ªç±»æ–‡ä»¶ä¸­ä¼šè®°å½•äº†å¾ˆå¤šå†…å®¹ï¼Œå…¶ä¸­åŒ…å«fieldsä¿¡æ¯ï¼Œmethodä¿¡æ¯ï¼Œå½“å‰ç±»ä¿¡æ¯ï¼Œçˆ¶ç±»ä¿¡æ¯ç­‰ã€‚å°±æ‹¿è®°å½•çš„super_classè¿™ä¸€é¡¹æ¥è¯´ï¼Œä¸€ä¸ªæ²¡æœ‰æ˜ç¡®å£°æ˜çš„ç±»è‚¯å®šç»§æ‰¿äº†Objectï¼Œé‚£ä¹ˆå®é™…ä¸Šsuper_classè¿™ä¸€é¡¹æ˜¯æŒ‡å‘äº†å¸¸é‡æ± çš„æŸä¸€æ¡ï¼Œè€Œå¸¸é‡æ± çš„å¯¹åº”çš„é‚£æ¡è®°å½•æ˜¯è®°å½•çš„Ljava/lang/Objectè¿™æ ·çš„å­—ç¬¦ä¸²ï¼Œè€Œåœ¨Runtime(è¿è¡Œæ—¶)ï¼ŒLjava/lang/Objectå®é™…ä¸Šæ˜¯ä½äºå†…å­˜çš„æŸä¸€ä¸ªä½ç½®(Metaspace)ï¼Œæ‰€è°“çš„Resolutionå°±æ˜¯æŠŠsuper_classçš„è¿™ç§å­—é¢å¼•ç”¨è½¬æ¢æˆæŒ‡å‘å†…å­˜æŸä¸ªåœ°å€çš„ç›´æ¥å¼•ç”¨ Initializingè°ƒç”¨ç±»åˆå§‹åŒ–ä»£ç  &lt;clinit&gt;ï¼Œç»™é™æ€æˆå‘˜å˜é‡èµ‹åˆå§‹å€¼ æœ‰ä¸€ä¸ªéå¸¸æœ‰æ„æ€çš„æƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨classçš„åŠ è½½è¿‡ç¨‹æ¥è§£é‡Šï¼š ä»£ç ä¸€ 12345678910111213141516171819public class T001_ClassLoadingProcedure &#123; public static void main(String[] args) &#123; System.out.println(T.count); &#125;&#125;class T &#123; public static T t = new T(); // null public static int count = 2; //0 //private int m = 8; private T() &#123; count ++; //System.out.println(\"--\" + count); &#125;&#125;// æ‰“å°ç»“æœï¼š 2 ä»£ç äºŒ 12345678910111213141516171819public class T001_ClassLoadingProcedure &#123; public static void main(String[] args) &#123; System.out.println(T.count); &#125;&#125;class T &#123; public static int count = 2; //0 public static T t = new T(); // null //private int m = 8; private T() &#123; count ++; //System.out.println(\"--\" + count); &#125;&#125;// æ‰“å°ç»“æœï¼š3 æ‰§è¡Œç»“æŸä¼šå‘ç°ä¸Šè¿°ä¸¤ä¸ªä»£ç çš„ç»“æœæ˜¯ä¸ä¸€æ ·çš„ï¼Œå¯ä»¥ä½¿ç”¨classçš„åŠ è½½è¿‡ç¨‹æ¥è§£é‡Šï¼š loading-&gt;linking(å…¶ä¸­preparationï¼šé™æ€æˆå‘˜å˜é‡èµ‹é»˜è®¤å€¼)-&gt;initializing(è°ƒç”¨ç±»åˆå§‹åŒ–ä»£ç  &lt;clinit&gt;ï¼Œç»™é™æ€æˆå‘˜å˜é‡èµ‹åˆå§‹å€¼) ä»£ç ä¸€ï¼šåœ¨linking-preparationé˜¶æ®µt=nullï¼›count=0ï¼Œç”±äºpublic static T t = new T();åœ¨å‰ï¼Œæ‰€ä»¥ä¼šå…ˆæ‰§è¡Œå®ƒï¼Œé‚£ä¹ˆå°±ä¼šæ‰§è¡Œnew T()çš„è¿‡ç¨‹ï¼Œå°±ä¼šæ‰§è¡ŒTçš„æ„é€ æ–¹æ³•ï¼Œé‚£ä¹ˆæ­¤æ—¶countè¿˜æ˜¯0ï¼Œå› æ­¤count++å¹¶æ²¡æœ‰ç”Ÿæ•ˆï¼Œç»™countèµ‹åˆå§‹å€¼ä¹‹åï¼Œå°±æŠŠå®ƒç»™è¦†ç›–äº†ï¼Œæ‰€ä»¥æœ€ç»ˆæ‰“å°çš„countæ˜¯2 ä»£ç äºŒï¼šè¿™é‡Œpublic static int count = 2;åœ¨å‰ï¼Œæ•…ä¼šå…ˆç»™countçš„èµ‹åˆå§‹å€¼2ï¼Œç„¶åæ‰§è¡Œnew T()ï¼Œcount++æ˜¯ä½œç”¨åœ¨äº†åˆå§‹åŒ–ä¹‹åçš„countä¸Šï¼Œæ•…æœ€ç»ˆæ‰“å°ç»“æœæ˜¯3. æ‹“å±•ï¼šnewä¸€ä¸ªå¯¹è±¡çš„è¿‡ç¨‹ï¼Œä¹Ÿä¼šåˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µ å¼€è¾Ÿå†…å­˜ç©ºé—´ï¼Œè¿™é‡Œä¼šç»™æˆå‘˜å˜é‡èµ‹é»˜è®¤å€¼ ç»™æˆå‘˜å˜é‡èµ‹åˆå§‹å€¼ è¿™é‡Œä¼šç‰µæ‰¯åˆ°ä¸€ä¸ªå¯¹è±¡åˆå§‹åŒ–è¿‡ç¨‹ä¸­çš„CPUä¹±åºæ‰§è¡Œçš„æƒ…å†µï¼ŒDCL","categories":[{"name":"JAVAå­¦ä¹ ","slug":"JAVAå­¦ä¹ ","permalink":"https://shang.at/categories/JAVAå­¦ä¹ /"}],"tags":[{"name":"Classçš„åŠ è½½è¿‡ç¨‹","slug":"Classçš„åŠ è½½è¿‡ç¨‹","permalink":"https://shang.at/tags/Classçš„åŠ è½½è¿‡ç¨‹/"}]},{"title":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°-é«˜çº§5-Manacherç®—æ³•åŠå…¶æ‰©å±•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°-é«˜çº§5-Manacherç®—æ³•åŠå…¶æ‰©å±•","date":"2020-08-19T07:55:51.000Z","updated":"2020-08-20T00:16:13.907Z","comments":true,"path":"post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°-é«˜çº§5-Manacherç®—æ³•åŠå…¶æ‰©å±•/","link":"","permalink":"https://shang.at/post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°-é«˜çº§5-Manacherç®—æ³•åŠå…¶æ‰©å±•/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š ç®—æ³•å¼•å­ï¼šè®¡ç®—ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„æœ€å¤§å›æ–‡ä¸²çš„é•¿åº¦ ä»€ä¹ˆæ˜¯å›æ–‡ä¸²ï¼šå•ä¸ªå­—ç¬¦æ˜¯å›æ–‡ä¸²ï¼Œâ€™abaâ€™æ˜¯å›æ–‡ä¸²ï¼Œâ€™aaâ€™æ˜¯å›æ–‡ä¸² æš´åŠ›è§£æ±‚è§£ï¼šéå†å­—ç¬¦ä¸²ï¼Œå¯»æ‰¾ä»¥æ¯ä¸ªå­—ç¬¦ä¸ºä¸­å¿ƒçš„æ‰€æœ‰å›æ–‡å­ä¸²ã€‚ æ—¶é—´å¤æ‚åº¦æ˜¯ï¼šO(N^2) éœ€è¦æ³¨æ„çš„ç‚¹æ˜¯å›æ–‡ä¸²ä¸­æœ‰å¶æ•°ä¸ªå­—ç¬¦æ²¡æ³•è·å–åˆ°ï¼Œæ‰€ä»¥éœ€è¦å°†åŸå§‹å­—ç¬¦ä¸²è¿›è¡Œä¿®æ”¹ï¼Œå¼€å¤´å’Œç»“å°¾ä»¥åŠæ¯ä¸¤ä¸ªå­—ç¬¦ä¹‹é—´éƒ½æ’å…¥ä¸€ä¸ªè¾…åŠ©å­—ç¬¦ æš´åŠ›è§£æ³•ï¼š 12 ç»å†äº†æš´åŠ›è§£æ³•ä¹‹åï¼ŒManacheré—ªäº®ç™»åœºï¼Œå¯ä»¥åœ¨O(N)çš„æ—¶é—´å¤æ‚åº¦å†…è§£å†³è¯¥é—®é¢˜ æ¦‚å¿µï¼š å›æ–‡åŠå¾„ã€ç›´å¾„ã€åŒºåŸŸ å­—ç¬¦ä¸²ä¸ºf#1#a#1#sï¼Œåˆ™ä»¥aä¸ºä¸­å¿ƒï¼šå›æ–‡ç›´å¾„ä¸º7ï¼ŒåŠå¾„ä¸º4 å›æ–‡åŠå¾„æ•°ç»„ï¼ŒpArr[] å°†æ¯ä¸ªå­—ç¬¦ä¸ºä¸­å¿ƒçš„å›æ–‡å­ä¸²çš„é•¿åº¦è®°å½•ä¸‹æ¥ æ”¾åˆ°pArr å›æ–‡æœ€å³å³è¾¹ç•Œ Rï¼Œåˆå§‹å€¼ä¸º-1 ä»å·¦å¾€å³éå†å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œæ„æˆå›æ–‡å­ä¸²çš„æœ€åè¾¹ç•Œçš„ä½ç½®ï¼Œå¦‚ï¼š#1#2#2#1#è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œéå†åˆ°ç¬¬ä¸€ä¸ªä½ç½®æ—¶ï¼ŒRä¸º0ï¼Œå› ä¸º#åªæœ‰è¿™ä¸€ä¸ªå­—ç¬¦ï¼›éå†åˆ°ç¬¬äºŒä¸ªå­—ç¬¦çš„æ—¶å€™ï¼ŒRä¸º2ï¼Œå› ä¸ºä»ç¬¬äºŒä¸ªå­—ç¬¦å¯ä»¥å¾€å‰å¾€åæ‰© ä¸­å¿ƒ Cï¼Œåˆå§‹å€¼ä¸º-1 ä»å·¦å¾€å³éå†å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œæ„æˆå›æ–‡å­ä¸²çš„ä¸­å¿ƒä½ç½®ï¼Œå¦‚ï¼š#1#2#2#1#è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œéå†åˆ°ç¬¬ä¸€ä¸ªä½ç½®æ—¶ï¼ŒCä¸º0ï¼Œéå†åˆ°ç¬¬äºŒä¸ªå­—ç¬¦çš„æ—¶å€™ï¼ŒCä¸º1 Manacherå°±æ˜¯åŸºäºè¿™äº›æ¦‚å¿µçš„ å‡è®¾æœ‰ä¸ªå­—ç¬¦ä¸²ï¼š#1#2#2#1#ï¼Œé•¿åº¦ä¸º9ï¼Œåˆ™pArr[9]ï¼Œ R=-1, C=-1 éå†åˆ°iä¸ªå­—ç¬¦æ—¶ï¼Œåˆ†ä¸ºä»¥ä¸‹çš„æƒ…å†µï¼š iåœ¨Rå¤–ï¼Œå«ä¹‰æ˜¯ï¼šä½ç½®iå¤§äºR æ¯”å¦‚ï¼Œåˆå§‹æƒ…å†µä¸‹ï¼Œiä»0å¼€å§‹éå†ï¼ŒR=-1ï¼Œè¿™æ—¶0&gt;-1ï¼Œè¡¨ç¤ºiåœ¨Rå¤– è¿™ç§æƒ…å†µä¸‹ï¼Œåªèƒ½ä»¥iä½ç½®ä¸ºä¸­å¿ƒï¼Œå‘ä¸¤ä¾§æ‰©å±•ï¼Œæ— æ³•åŠ é€Ÿ iåœ¨Rå†…ï¼Œå«ä¹‰æ˜¯ï¼šä½ç½®iå°äºç­‰äºR é‚£ä¹ˆä¸€å®šä¼šæœ‰å¦‚ä¸‹çš„å…³ç³»å­˜åœ¨ï¼š C&lt;i&lt;=Rï¼Œä¸”å­˜åœ¨ä¸€ä¸ªä»¥Cä¸ºä¸­å¿ƒçš„å¯¹ç§°ç‚¹iâ€™ï¼Œå¦‚ä¸‹å›¾ iå­˜åœ¨ä¸€ä¸ªä»¥Cä¸ºä¸­å¿ƒçš„å¯¹ç§°ç‚¹iâ€™ è®¨è®ºiâ€™çš„ä½ç½®æƒ…å†µï¼š ä»¥iâ€™ä¸ºä¸­å¿ƒçš„å›æ–‡å­ä¸²å®Œå…¨è½åœ¨Lâ€¦Rä¹‹å†…ï¼šé‚£ä¹ˆiä½ç½®çš„å›æ–‡å­ä¸²é•¿åº¦ä¸iâ€™ä¸€æ · è¯æ˜ï¼š ä»¥iâ€™ä¸ºä¸­å¿ƒçš„å›æ–‡å­ä¸²çš„å·¦è¾¹ç•Œè½åœ¨äº†Lçš„å·¦ä¾§ï¼šiä½ç½®ä¸ºä¸­å¿ƒçš„å›æ–‡å­ä¸²çš„å›æ–‡åŠå¾„ä¸ºR-iï¼Œåˆ™å…¶é•¿åº¦ä¸º2*(R-i)+1 è¯æ˜ï¼š ä»¥iâ€™ä¸ºä¸­å¿ƒçš„å›æ–‡å­ä¸²çš„å·¦è¾¹ç•Œæ­£å¥½è½åœ¨Lä¸Šï¼šä»¥iä¸ºä¸­å¿ƒçš„å›æ–‡å­ä¸²ï¼Œéœ€è¦ä»é—®å·å¤„ç»§ç»­å‘åæ‰©ï¼Œå¦‚æœæ‰©æˆåŠŸï¼ŒåŒæ—¶æ›´æ–°Rå’ŒC è¯æ˜ï¼š ä¼ªä»£ç ï¼š æ—¶é—´å¤æ‚åº¦çš„ä¼°è®¡ï¼šæŠŠå¤æ‚åº¦çš„ä¼°ç®—ç»‘å®šåˆ°Rçš„å˜åŒ–ä¸Š å»¶ä¼¸çš„é—®é¢˜ï¼šç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²strï¼Œè¦æ±‚ç»™stråé¢è¡¥ä¸Šä¸€äº›å­—ç¬¦ä¸²ï¼Œè¦æ±‚è¡¥å®Œçš„å­—ç¬¦ä¸²æ•´ä½“å››å›æ–‡ï¼Œé—®æœ€å°‘éœ€è¦æ·»åŠ çš„å­—ç¬¦ä¸²çš„ä¸ªæ•°ã€‚ æ€è·¯ï¼šåˆ©ç”¨Manacherè®¡ç®—å‡ºæ¥ç¬¬ä¸€ä¸ªåŒ…å«æœ€å³å­—ç¬¦çš„å›æ–‡å­ä¸²çš„å›æ–‡åŠå¾„å’Œä¸­å¿ƒï¼Œç„¶åå°†å­—ç¬¦ä¸²è¡¥é½å³å¯ï¼Œå¦‚ä¸‹å›¾ï¼š","categories":[],"tags":[]},{"title":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°-å…¬å¼€è¯¾ä¸€","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°-å…¬å¼€è¯¾ä¸€","date":"2020-08-12T08:00:42.000Z","updated":"2020-08-12T08:09:19.493Z","comments":true,"path":"post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°-å…¬å¼€è¯¾ä¸€/","link":"","permalink":"https://shang.at/post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°-å…¬å¼€è¯¾ä¸€/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š é¢˜ç›®ä¸€ç»™å®šä¸€ä¸ªæœ‰åºæ•°ç»„arrï¼Œarr[i]è¡¨ç¤ºiå·ç‚¹åœ¨xè½´ä¸Šçš„ä½ç½®ï¼Œæ‰€ä»¥æ•´ä¸ªarrè¡¨ç¤ºä¸€äº›ç‚¹åœ¨xè½´ä¸Šä»å·¦å¾€å³çš„åˆ†å¸ƒï¼Œç»™å®šä¸€ä¸ªæ­£æ•°lenï¼Œè¡¨ç¤ºç»³å­çš„é•¿åº¦ï¼Œè¿”å›ç»³å­æœ€å¤šèƒ½è¦†ç›–å‡ ä¸ªç‚¹ï¼Ÿ ä¸€ã€æš´åŠ›è§£ O(n^2) äºŒã€äºŒåˆ†æ³•O(N logN) ä¸‰ã€O(N) é¢˜ç›®äºŒ","categories":[],"tags":[]},{"title":"å·¥å…·ä½¿ç”¨-ç¼–è¯‘å·¥å…·-sbt","slug":"å·¥å…·ä½¿ç”¨-ç¼–è¯‘å·¥å…·-sbt","date":"2020-08-09T15:07:24.000Z","updated":"2021-04-13T03:28:30.549Z","comments":true,"path":"post/å·¥å…·ä½¿ç”¨-ç¼–è¯‘å·¥å…·-sbt/","link":"","permalink":"https://shang.at/post/å·¥å…·ä½¿ç”¨-ç¼–è¯‘å·¥å…·-sbt/","excerpt":"ç®€ä»‹ï¼šä½¿ç”¨sbtç¼–è¯‘Scalaé¡¹ç›®","text":"ç®€ä»‹ï¼šä½¿ç”¨sbtç¼–è¯‘Scalaé¡¹ç›® SBT æ˜¯Scala çš„æ„å»ºå·¥å…·ï¼Œå…¨ç§°æ˜¯Simple Build Toolï¼Œ ç±»ä¼¼Maven æˆ–Gradleã€‚ æ­å»ºä¸€ä¸ªSBTé¡¹ç›®ç›®å½•ç»“æ„ï¼š 12345678910111213è¿™æ˜¯ä¸€ä¸ªSBTé¡¹ç›®çš„æœ€ç®€å•çš„ç»“æ„ï¼šatome-sg-apaylater-nightly-data-warehouse/ data-warehouse-core/ src/ main/ scala/ java/ resources/ test/ prject/ build.properties plugins.sbt build.sbt javaè¯­è¨€å’Œscalaè¯­è¨€éƒ½æ˜¯åŸºäºclassçš„ï¼Œéƒ½å¯ä»¥è¿è¡Œåœ¨JVMä¸Šï¼Œæ•…åœ¨é¡¹ç›®å¯ä»¥åŒæ—¶ä½¿ç”¨javaè¯­è¨€å’Œscalaè¯­è¨€ã€‚ ä¸‹é¢ç½—åˆ—ä¸€ä¸‹ç›¸å…³çš„é…ç½®æ–‡ä»¶ï¼š build.sbt 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556import sbt.Keys.dependencyOverrides// https://docs.aws.amazon.com/emr/latest/ReleaseGuide/images/emr-releases-5x.pngval emrMajorVersion = \"5.24\"val scalaFullVersion = \"2.11.12\"val scalaMajorVersion = \"2.11\"val sparkVersion = \"2.4.2\"val hadoopVersion = \"2.8.5\"val dataConsolidationRootVersion = \"1.0.0\"val dataConsolidationCoreVersion = \"1.0.0\"val dataOrganization = \"ai.advance\"val pureconfigVersion = \"0.10.0\"val commonSetting = Seq( compileOrder := CompileOrder.JavaThenScala, libraryDependencies ++= Seq( \"org.scalatest\" %% \"scalatest\" % \"3.2.0-SNAP10\" % \"test\", \"org.scalamock\" %% \"scalamock-scalatest-support\" % \"3.6.0\" % \"test\" ))val assemblySetting = Seq( assemblyOption in assembly := (assemblyOption in assembly).value.copy(includeScala = false), assemblyJarName in assembly := s\"$&#123;name.value&#125;_$scalaMajorVersion-$&#123;version.value&#125;-emr_$&#123;emrMajorVersion&#125;.jar\")lazy val core = (project in file(\"data-warehouse-core\")).settings( commonSetting ).settings( name := \"atome-sg-apaylater-nightly-data-warehouse\", organization := dataOrganization, version := dataConsolidationCoreVersion, scalaVersion := scalaFullVersion, test in assembly := &#123;&#125;, libraryDependencies ++= Seq( \"org.apache.spark\" % s\"spark-core_$&#123;scalaMajorVersion&#125;\" % sparkVersion % \"provided\", \"org.apache.spark\" % s\"spark-sql_$&#123;scalaMajorVersion&#125;\" % sparkVersion % \"provided\", \"org.scalacheck\" %% \"scalacheck\" % \"1.13.5\" % \"provided\", \"mysql\" % \"mysql-connector-java\" % \"5.1.38\" % \"provided\", \"com.github.pureconfig\" %% \"pureconfig\" % pureconfigVersion % \"provided\", \"com.typesafe.play\" %% \"play-json\" % \"2.6.9\" % \"provided\" ), dependencyOverrides += \"com.fasterxml.jackson.core\" % \"jackson-databind\" % \"2.6.7\" % \"provided\" ).settings( assemblySetting )lazy val root = (project in file(\".\")). settings( name := \"data-warehouse-root\", organization := dataOrganization, version := dataConsolidationRootVersion, scalaVersion := scalaFullVersion ).disablePlugins(sbtassembly.AssemblyPlugin) .aggregate(core) build.properties 1sbt.version = 0.13.18 plugins.sbt 12logLevel := Level.WarnaddSbtPlugin(\"com.eed3si9n\" % \"sbt-assembly\" % \"0.14.6\") å…¶ä¸­æœ€ä¸»è¦çš„é…ç½®æ–‡ä»¶æ˜¯build.sbtï¼Œ æœ¬åœ°æ‰§è¡Œæ—¶ï¼Œéœ€è¦å°†libçš„scopeè®¾ç½®ä¸ºcompileï¼Œä¸Šçº¿æ—¶å†æ”¹æˆprovidedã€‚ providedè¡¨ç¤ºåªåœ¨ç¼–è¯‘æœŸæœ‰æ•ˆï¼Œè¿è¡ŒæœŸä¸éœ€è¦æä¾›ï¼Œæ‰€ä»¥è¿è¡Œæ—¶å¯èƒ½å¯¼è‡´æœ‰äº›éšå¼è½¬æ¢æ‰¾ä¸åˆ°ã€‚","categories":[],"tags":[]},{"title":"Sparkå­¦ä¹ -æºç ä¸€-wordcount","slug":"Sparkå­¦ä¹ -æºç ä¸€-wordcount","date":"2020-08-09T00:12:46.000Z","updated":"2020-08-09T03:20:05.272Z","comments":true,"path":"post/Sparkå­¦ä¹ -æºç ä¸€-wordcount/","link":"","permalink":"https://shang.at/post/Sparkå­¦ä¹ -æºç ä¸€-wordcount/","excerpt":"ç®€ä»‹ï¼šSparkæºç å­¦ä¹ -wordcountä»£ç è·Ÿè¸ª","text":"ç®€ä»‹ï¼šSparkæºç å­¦ä¹ -wordcountä»£ç è·Ÿè¸ª SparkContextï¼šRPCã€åºåˆ—åŒ–ã€ååºåˆ—åŒ–ã€é›¶æ‹·è´ã€å †å†…å†…å­˜ã€å †å¤–å†…å­˜ sc.clean(f)ï¼šæ£€æŸ¥fæ˜¯å¦å¯åºåˆ—åŒ– ç¬¬ä¸€æ­¥æ•°æ®æ–‡ä»¶testdata.txt 1234hello worldhello msbhello sparkgood spark ç¬¬äºŒæ­¥sparkè„šæœ¬ 1234567891011121314151617181920212223242526272829import org.apache.spark.rdd.RDDimport org.apache.spark.&#123;SparkConf, SparkContext&#125;object WordCountScala &#123; def main(args: Array[String]): Unit = &#123; val conf = new SparkConf() conf.setAppName(\"wordcount\") conf.setMaster(\"local\") //å•å‡»æœ¬åœ°è¿è¡Œ val sc = new SparkContext(conf) val fileRDD: RDD[String] = sc.textFile(\"testdata.txt\") //hello world val words: RDD[String] = fileRDD.flatMap((x: String) =&gt; _.split(\" \")) //hello //world val pairWord: RDD[(String, Int)] = words.map((x: String) =&gt; (_, 1)) //(hello,1) //(hello,1) //(world,1) val res: RDD[(String, Int)] = pairWord.reduceByKey((x: Int, y: Int) =&gt; x + y) //X:oldValue Y:value //(hello,2) -&gt; (2,1) //(world,1) -&gt; (1,1) //(msb,2) -&gt; (2,1) res.foreach(println) &#125;&#125; ä¸‹é¢è·Ÿè¸ªwordcountè„šæœ¬çš„æ•°æ®æµçš„æ“ä½œæµç¨‹ï¼Œä»è¡¨é¢ä¸Šçœ‹æˆ‘ä»¬æ˜¯è°ƒç”¨äº†RDDçš„apiï¼Œä½†å®é™…ä¸Šæˆ‘ä»¬è°ƒç”¨çš„è¿™äº›ä¸ªapiåªæ˜¯æ„é€ äº†ä¸€ä¸ªæ•°æ®æµç¨‹ï¼Œå¹¶æ²¡æœ‰å»å®é™…çš„è¿è¡Œç›¸å…³çš„é€»è¾‘ï¼Œæœ€åæˆ‘ä»¬ä¼šå¼•å‡ºï¼Œå®ƒåº•å±‚å®é™…ä¸Šæ˜¯åŸºäºæˆ‘ä»¬æœ€å¸¸è§çš„ä¸€ç§ç¼–ç¨‹æ¨¡å¼â€”â€”â€” è¿­ä»£å™¨æ¨¡å¼ã€‚ ä¸€ä¸ªå¤§æ•°æ®å¤„ç†æ¡†æ¶ï¼Œä»–ä¸ºæˆ‘ä»¬åšäº†ä»€ä¹ˆäº‹æƒ…å‘¢ï¼Ÿ 1ã€è¯»å–æ•°æ®ï¼Œç¡®å®šæ•°æ®åœ¨é›†ç¾¤ä¸­å­˜å‚¨çš„ä½ç½® 2ã€åˆ†é…ä»»åŠ¡ï¼Œä»»åŠ¡å…·ä½“ä¼šåœ¨å“ªé‡Œæ‰§è¡Œå‘¢ï¼Ÿéµå¾ªè®¡ç®—å‘æ•°æ®ç§»åŠ¨çš„åŸåˆ™ 3ã€æ ¹æ®æˆ‘ä»¬å†™å‡ºæ¥çš„è„šæœ¬ï¼Œç”Ÿæˆä»»åŠ¡çš„æ‰§è¡Œè®¡åˆ’ï¼ŒDAGã€‚ 4ã€å¯åŠ¨ä»»åŠ¡ï¼Œè°ƒç”¨æˆ‘ä»¬çš„è®¡ç®—é€»è¾‘ã€‚ å°±åƒæ˜¯æˆ‘ä»¬å¹³å¸¸æ‰€è¯´çš„æ¨¡æ¿æ–¹æ³•ï¼Œå‡½æ•°å›è°ƒ(callback) 5ã€å°†ç»“æœå†™å…¥ç›®æ ‡æ–‡ä»¶ 6ã€åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ¡†æ¶è¿˜ä¼šå¸®åŠ©æˆ‘ä»¬è§£å†³é›†ç¾¤ä¸­çš„ç½‘ç»œé€šä¿¡(RPC)ã€æ•°æ®ä¼ è¾“(ç¼–è§£ç /åºåˆ—åŒ–ååºåˆ—åŒ–)ã€å„ç§ä¼˜åŒ–(é›¶æ‹·è´ï¼Œå†…å­˜ç®¡ç†ã€è®¡ç®—ç»“æœç¼“å­˜) ç¬¬ä¸€æ­¥ï¼šval fileRDD: RDD[String] = sc.textFile(&quot;testdata.txt&quot;) è·Ÿè¸ªä¸‹å»ï¼Œä»–å®é™…ä¸Šæ˜¯è°ƒç”¨çš„SparkContextå¯¹è±¡çš„textFileæ–¹æ³• 123456789101112131415161718192021222324252627def textFile( path: String, minPartitions: Int = defaultMinPartitions): RDD[String] = withScope &#123; assertNotStopped() hadoopFile(path, classOf[TextInputFormat], classOf[LongWritable], classOf[Text], minPartitions).map(pair =&gt; pair._2.toString).setName(path)&#125;def hadoopFile[K, V]( path: String, inputFormatClass: Class[_ &lt;: InputFormat[K, V]], keyClass: Class[K], valueClass: Class[V], minPartitions: Int = defaultMinPartitions): RDD[(K, V)] = withScope &#123; assertNotStopped() FileSystem.getLocal(hadoopConfiguration) val confBroadcast = broadcast(new SerializableConfiguration(hadoopConfiguration)) val setInputPathsFunc = (jobConf: JobConf) =&gt; FileInputFormat.setInputPaths(jobConf, path) new HadoopRDD( this, confBroadcast, Some(setInputPathsFunc), inputFormatClass, keyClass, valueClass, minPartitions).setName(path)&#125; å‘ç°æœ€ç»ˆå®é™…ä¸Šè¿”å›çš„ä¸€ä¸ªHadoopRDDå¯¹è±¡ï¼Œå¹¶æ²¡æœ‰åšä»€ä¹ˆå…·ä½“çš„è®¡ç®—ã€‚OKï¼Œæˆ‘ä»¬ç»§ç»­å¾€ä¸‹çœ‹ï¼š ç¬¬äºŒæ­¥ï¼šval words: RDD[String] = fileRDD.flatMap((x: String) =&gt; _.split(&quot; &quot;))","categories":[],"tags":[]},{"title":"Javaå­¦ä¹ -IOå­¦ä¹ 4-C10Ké—®é¢˜åŠNIOç²¾è®²å’ŒIOæ¨¡å‹æ€§èƒ½å‹æµ‹","slug":"Javaå­¦ä¹ -IOå­¦ä¹ 4-C10Ké—®é¢˜åŠNIOç²¾è®²å’ŒIOæ¨¡å‹æ€§èƒ½å‹æµ‹","date":"2020-08-03T00:12:30.000Z","updated":"2020-08-03T00:12:30.028Z","comments":true,"path":"post/Javaå­¦ä¹ -IOå­¦ä¹ 4-C10Ké—®é¢˜åŠNIOç²¾è®²å’ŒIOæ¨¡å‹æ€§èƒ½å‹æµ‹/","link":"","permalink":"https://shang.at/post/Javaå­¦ä¹ -IOå­¦ä¹ 4-C10Ké—®é¢˜åŠNIOç²¾è®²å’ŒIOæ¨¡å‹æ€§èƒ½å‹æµ‹/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š","categories":[],"tags":[]},{"title":"Javaå­¦ä¹ -IOå­¦ä¹ 3-Socketç¼–ç¨‹BIOåŠTCPå‚æ•°","slug":"Javaå­¦ä¹ -IOå­¦ä¹ 3-Socketç¼–ç¨‹BIOåŠTCPå‚æ•°","date":"2020-08-03T00:12:15.000Z","updated":"2021-02-22T23:54:09.361Z","comments":true,"path":"post/Javaå­¦ä¹ -IOå­¦ä¹ 3-Socketç¼–ç¨‹BIOåŠTCPå‚æ•°/","link":"","permalink":"https://shang.at/post/Javaå­¦ä¹ -IOå­¦ä¹ 3-Socketç¼–ç¨‹BIOåŠTCPå‚æ•°/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š","categories":[],"tags":[]},{"title":"Javaå­¦ä¹ -IOå­¦ä¹ 2-PageCache-mmap","slug":"Javaå­¦ä¹ -IOå­¦ä¹ 2-PageCache-mmap","date":"2020-08-03T00:11:59.000Z","updated":"2020-08-03T00:11:59.864Z","comments":true,"path":"post/Javaå­¦ä¹ -IOå­¦ä¹ 2-PageCache-mmap/","link":"","permalink":"https://shang.at/post/Javaå­¦ä¹ -IOå­¦ä¹ 2-PageCache-mmap/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š","categories":[],"tags":[]},{"title":"Javaå­¦ä¹ -IOå­¦ä¹ 1-è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ-æ–‡ä»¶æè¿°ç¬¦-IOé‡å®šå‘","slug":"Javaå­¦ä¹ -IOå­¦ä¹ 1-è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ-æ–‡ä»¶æè¿°ç¬¦-IOé‡å®šå‘","date":"2020-08-03T00:11:29.000Z","updated":"2021-02-18T10:58:08.047Z","comments":true,"path":"post/Javaå­¦ä¹ -IOå­¦ä¹ 1-è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ-æ–‡ä»¶æè¿°ç¬¦-IOé‡å®šå‘/","link":"","permalink":"https://shang.at/post/Javaå­¦ä¹ -IOå­¦ä¹ 1-è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ-æ–‡ä»¶æè¿°ç¬¦-IOé‡å®šå‘/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š æ“ä½œç³»ç»Ÿå®è§‚ä»‹ç» å†¯Â·è¯ºä¾æ›¼ï¼šè®¡ç®—å™¨ã€æ§åˆ¶å™¨ã€ä¸»å­˜å‚¨å™¨ã€è¾“å…¥è¾“å‡ºè®¾å¤‡(I/O) å†…å­˜ã€CPUã€IOè®¾å¤‡ï¼ˆç£ç›˜ã€ç½‘å¡ï¼‰ kernelï¼šæ“ä½œç³»ç»Ÿå†…æ ¸ï¼Œè¯´ç™½äº†å°±æ˜¯ä¸€ä¸ªç¨‹åºï¼Œä½äºå†…æ ¸ç©ºé—´ kernelç®¡ç†å†…å­˜åˆ†é…ï¼Œç£ç›˜IO VFSï¼šè™šæ‹Ÿ æ–‡ä»¶ç³»ç»Ÿï¼Œæ˜¯å†…å­˜ä¸­çš„ä¸€ä¸ªç›®å½•æ ‘ï¼Œæ•°ä¸Šä¸åŒçš„èŠ‚ç‚¹æ˜ å°„åˆ°ç£ç›˜ä¸Šä¸åŒçš„ç‰©ç†ä½ç½®ï¼Œæ¯ä¸ªç‰©ç†ä½ç½®ï¼Œå¯ä»¥ä½¿ä¸åŒçš„å…·ä½“çš„æ–‡ä»¶ç³»ç»Ÿã€‚æ¯”å¦‚FATï¼ŒEXT4ã€æˆ–è€…ç½‘ç»œèŠ‚ç‚¹ï¼Œæˆ–è€…è™šæ‹Ÿçš„ä¸€ä¸ªå—è®¾å¤‡(åé¢æœ‰ä¾‹å­) æ˜¯ä¸€ä¸ªä½äºåº•å±‚ç¡¬ä»¶è®¾å¤‡(ä¸åŒæ–‡ä»¶ç³»ç»Ÿä¼šæœ‰ä¸åŒçš„é©±åŠ¨)å’Œä¸Šå±‚åº”ç”¨ç¨‹åºä¹‹é—´çš„è§£è€¦å±‚ï¼Œæ˜¯ç»™ç”¨æˆ·ç©ºé—´ç¨‹åºæš´éœ²çš„ä¸€ä¸ªç»Ÿä¸€æ¥å£ï¼Œä¸Šå±‚åº”ç”¨æ“ä½œåº•å±‚ç¡¬ä»¶è®¾å¤‡çš„æ—¶å€™å¯ä»¥ä¸ç”¨è€ƒè™‘å…·ä½“çš„åº•å±‚ä¸åŒè®¾å¤‡é©±åŠ¨çš„ä¸åŒ inodeï¼šidï¼Œå”¯ä¸€æ ‡ç¤ºä¸€ä¸ªæ–‡ä»¶(åœ¨linuxä¸­ä¸‡ç‰©çš†æ–‡ä»¶)ï¼ŒåŒä¸€ä¸ªæ–‡ä»¶çš„inodeå·æ˜¯ä¸€æ ·çš„ FDï¼šæ–‡ä»¶æè¿°ç¬¦ï¼ŒæŒ‡é’ˆ-seekï¼Œæ¯ä¸ªåº”ç”¨ç¨‹åºè·å–å„è‡ªçš„FD ä»¥å¯¹æ–‡ä»¶è¿›è¡Œè¯»å†™ï¼Œç±»ä¼¼äºjavaä¸­è¿­ä»£å™¨æ¨¡å¼ï¼Œä¸åŒçš„åº”ç”¨ç¨‹åºå¯ä»¥è‡ªå·±æ§åˆ¶è¯»å–æ–‡ä»¶çš„æŒ‡é’ˆï¼Œè€Œä¸ä¼šå—åˆ°å…¶ä»–åº”ç”¨ç¨‹åºçš„å½±å“ pagecacheï¼šä¹Ÿç¼“å­˜ï¼Œé»˜è®¤æ˜¯4kå¤§å°ï¼Œæ“ä½œç³»ç»Ÿå¯¹pagecacheæ˜¯å¯¹æ‰€æœ‰ä¸Šå±‚åº”ç”¨ç¨‹åºæ‰“å¼€çš„æ–‡ä»¶çš„ä¸€ä¸ªç»Ÿä¸€çš„å¤„ç†ï¼Œå¹¶ä¸æ˜¯é’ˆå¯¹æŸä¸€ä¸ªç‰¹å®šçš„æ–‡ä»¶çš„ã€‚å¦‚æœå¤šä¸ªç¨‹åºå¦‚æœåŒæ—¶æ‰“å¼€åŒä¸€ä¸ªæ–‡ä»¶ï¼Œé‚£ä¹ˆæ“ä½œç³»ç»Ÿä¸ä¼šç»™æ¯ä¸ªåº”ç”¨ç¨‹åºéœ€éƒ½é‡æ–°åŠ è½½ä¸€éè¿™ä¸ªæ–‡ä»¶ï¼Œä»–ä»¬ä¼šå…±ç”¨åŒä¸€ä¸ªpagecacheã€‚å¦‚æœæŸä¸ªåº”ç”¨å¯¹æ–‡ä»¶å†…å®¹è¿›è¡Œäº†ä¿®æ”¹ï¼Œé‚£ä¹ˆæ“ä½œç³»ç»Ÿä¼šæŠŠè¯¥pagecacheæ ‡è®°ä¸ºdirty dirtyï¼šè„ï¼Œå¦‚æœappä¿®æ”¹äº†pagecacheçš„æ•°æ®ï¼Œpagecacheå°±ä¼šè¢«æ ‡è®°ä¸ºdirtyï¼Œdirtyçš„æ ‡è¯†æ˜¯æ“ä½œç³»ç»Ÿå¯¹æ‰€æœ‰ä¸Šå±‚æ‰“å¼€æ–‡ä»¶çš„ä¸€ä¸ªç»Ÿä¸€ç®¡ç†ï¼Œå¹¶ä¸æ˜¯é’ˆå¯¹æŸä¸€ä¸ªæ–‡ä»¶çš„ï¼Œä¼šæœ‰ä¸€äº›ç³»ç»Ÿå‚æ•°æ¥æ§åˆ¶ä½•æ—¶åˆ·å†™dirtyçš„æ•°æ® flushï¼šæ–‡ä»¶å†…å®¹åœ¨å†…å­˜ä¸­å‘ç”Ÿäº†ä¿®æ”¹ï¼Œä»€ä¹ˆæ—¶å€™åˆ·å†™åˆ°ç£ç›˜ã€‚ åº”ç”¨ç¨‹åºæ§åˆ¶flushï¼Œé‚£ä¹ˆæ•ˆç‡ä¼šéå¸¸ä½ä¸‹ å¦‚æœäº¤ç”±æ“ä½œç³»ç»Ÿæ§åˆ¶ï¼Œæ¯”å¦‚å½“å†…å­˜å ç”¨è¾¾åˆ°ç³»ç»Ÿå†…å­˜çš„n%ï¼Œæˆ–è€…æ¯éš”nç§’flushä¸€æ¬¡ï¼Œåˆ™å¯èƒ½å¯¼è‡´å¤§é‡çš„æ•°æ®ä¸¢å¤± äº†è§£äº†æ“ä½œç³»ç»Ÿçš„è¿™äº›bugï¼Œé‚£ä¹ˆå¾ˆå¤šå¼€æºçš„ç³»ç»Ÿä»–ä»¬åœ¨å¤„ç†IOçš„æ—¶å€™éƒ½ä¼šæœ‰ä¸€äº›ç‰¹æ®Šçš„è®¾è®¡ã€‚ appï¼šç©ºæˆ·ç©ºé—´çš„ç¨‹åºï¼Œä¸€èˆ¬æ¥è¯´ç¨‹åºä¸èƒ½ç›´æ¥è°ƒç”¨ç¡¬ä»¶è®¾å¤‡ï¼Œç¨‹åºè¦æƒ³è°ƒç”¨ç¡¬ä»¶è®¾å¤‡ï¼Œå¿…é¡»é€šè¿‡å†…æ ¸çš„ç³»ç»Ÿè°ƒç”¨ æ¯ä¸ªç¨‹åºå…¶å®æ˜¯ä¸€ä¸ªé€»è¾‘çš„çº¿æ€§çš„å†…å­˜åœ°å€ï¼Œé€šè¿‡MMUç»™å®ƒæ˜ å°„åˆ°å†…å­˜çš„ç‰©ç†åœ°å€ã€‚æ¯ä¸ªç¨‹åºå…¶å®æ˜¯æ¨¡æ‹Ÿçš„ä½¿ç”¨æ•´ä¸ªå†…å­˜ç©ºé—´ è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ /dev ç›®å½•æ¯”è¾ƒç‰¹æ®Šï¼Œä»–æ˜¯è®¾å¤‡æŒ‚è½½çš„ç›®å½• /dev/null /dev/zero ç£ç›˜åˆ†åŒº å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä½¿ç”¨dfå‘½ä»¤å¯ä»¥æŸ¥çœ‹å½“å‰ç³»ç»Ÿçš„è®¾å¤‡æŒ‚è½½æƒ…å†µ /dev/sda1æ˜¯ç£ç›˜çš„1å·åˆ†åŒº - bootåˆ†åŒº 1è¯¥åˆ†åŒºå¯¹åº”äº/bootç›®å½•ï¼Œçº¦100MB.è¯¥åˆ†åŒºå­˜æ”¾Linuxçš„Grub(bootloader)å’Œå†…æ ¸æºç ã€‚ç”¨æˆ·å¯é€šè¿‡è®¿é—®/bootç›®å½•æ¥è®¿é—®è¯¥åˆ†åŒº.æ¢å¥è¯è¯´ï¼Œç”¨æˆ·å¯¹/bootç›®å½•çš„æ“ä½œå°±æ˜¯æ“ä½œè¯¥åˆ†åŒºã€‚ /dev/sda3æ˜¯ç£ç›˜çš„2å·åˆ†åŒº - æ ¹åˆ†åŒº 1åœ¨Linuxæ“ä½œç³»ç»Ÿä¸­ï¼Œé™¤/bootç›®å½•å¤–çš„å…¶å®ƒæ‰€æœ‰ç›®å½•éƒ½å¯¹åº”äºè¯¥åˆ†åŒº.å› æ­¤ï¼Œç”¨æˆ·å¯é€šè¿‡è®¿é—®é™¤/bootç›®å½•å¤–çš„å…¶å®ƒæ‰€æœ‰ç›®å½•æ¥è®¿é—®è¯¥åˆ†åŒºã€‚ tmpfsæ˜¯äº¤æ¢åˆ†åŒº 1234è¯¥åˆ†åŒºæ²¡æœ‰å¯¹åº”çš„ç›®å½•ï¼Œæ•…ç”¨æˆ·æ— æ³•è®¿é—®ã€‚Linuxä¸‹çš„swapåˆ†åŒºå³ä¸ºè™šæ‹Ÿå†…å­˜.è™šæ‹Ÿå†…å­˜ç”¨äºå½“ç³»ç»Ÿå†…å­˜ç©ºé—´ä¸è¶³æ—¶ï¼Œå…ˆå°†ä¸´æ—¶æ•°æ®å­˜æ”¾åœ¨swapåˆ†åŒºï¼Œç­‰å¾…ä¸€æ®µæ—¶é—´åï¼Œç„¶åå†å°†æ•°æ®è°ƒå…¥åˆ°å†…å­˜ä¸­æ‰§è¡Œ.æ‰€ä»¥è¯´ï¼Œè™šæ‹Ÿå†…å­˜åªæ˜¯æš‚æ—¶å­˜æ”¾æ•°æ®ï¼Œåœ¨è¯¥ç©ºé—´å†…å¹¶æ²¡æœ‰æ‰§è¡Œã€‚Ps:è™šæ‹Ÿå†…å­˜è™šæ‹Ÿå†…å­˜æ˜¯æŒ‡å°†ç¡¬ç›˜ä¸ŠæŸä¸ªåŒºåŸŸæ¨¡æ‹Ÿä¸ºå†…å­˜.å› æ­¤è™šæ‹Ÿå†…å­˜çš„å®é™…ç‰©ç†åœ°å€ä»ç„¶åœ¨ç¡¬ç›˜ä¸Š.è™šæ‹Ÿå†…å­˜ï¼Œæˆ–è€…è¯´swapåˆ†åŒºåªèƒ½ç”±ç³»ç»Ÿè®¿é—®ï¼Œå…¶å¤§å°ä¸ºç‰©ç†å†…å­˜çš„2å€ã€‚ åœ¨ä¸Šé¢çš„dfçš„å‘½ä»¤ç»“æœä¸­ï¼Œ/ä¸‹çš„æ‰€æœ‰ç›®å½•é™¤äº†/bootç›®å½•ï¼Œå…¶ä»–ç›®å½•éƒ½æ˜¯åœ¨/dev/sda2åˆ†åŒºä¸‹ï¼Œ/bootæ˜¯ç‹¬ç«‹æŒ‚è½½åœ¨äº†/dev/sda1åˆ†åŒºä¸‹çš„ï¼Œä»–è¦†ç›–äº†åŸå§‹çš„/ç›®å½•ä¸‹çš„/bootç›®å½• æ¼”ç¤º/bootçš„æŒ‚è½½è¿‡ç¨‹ï¼š umountå‘½ä»¤å¸è½½/boot mountå‘½ä»¤å°†/dev/sda1æŒ‚è½½åˆ°/bootä¸Š åœ¨æ•´ä¸ªæ“ä½œçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å‘ç°ç»“æ„ç›®å½•æ ‘æ˜¯è¶‹å‘äºç¨³å®šçš„ï¼Œæ–°æŒ‚è½½çš„è®¾å¤‡ä¸éœ€è¦é¢å¤–çš„æ“ä½œã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¯ä»¥ç»™æ¯ä¸ªç”¨æˆ·ä¸€ä¸ªç‹¬ç«‹çš„ç¡¬ç›˜ï¼Œç„¶åæŒ‚è½½åœ¨ç”¨æˆ·è‡ªå·±çš„ç›®å½•ä¸‹ æ–‡ä»¶ç±»å‹ï¼š -ï¼šæ™®é€šæ–‡ä»¶ï¼ˆå¯æ‰§è¡Œæ–‡ä»¶ã€å›¾ç‰‡ã€æ–‡æœ¬ï¼‰ REG dï¼šç›®å½• lï¼šè¿æ¥ç±»å‹ï¼Œåˆ†ä¸ºè½¯è¿æ¥å’Œç¡¬é“¾æ¥ã€‚ å…±åŒçš„å±æ€§ï¼šä¿®æ”¹ä»»æ„ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹ï¼Œå…¶ä»–çš„æ–‡ä»¶åå¯¹åº”çš„æ–‡ä»¶çš„å†…å®¹éƒ½ä¼šå‘ç”Ÿå˜åŒ– è½¯è¿æ¥ï¼šln -s a.txt b.txt rootå‰çš„æ•°å­—1è¡¨ç¤ºï¼Œè¯¥æ–‡ä»¶è¢«å¼•ç”¨çš„ä¸ªæ•°ï¼Œå‘ç°éƒ½æ˜¯1ï¼Œè¯´æ˜è½¯è¿æ¥å¹¶ä¸æ˜¯ç›´æ¥æŒ‡å‘ç‰©ç†æ–‡ä»¶çš„ï¼Œå¦‚æœæŠŠåŸå§‹çš„xxoo.txtåˆ æ‰ï¼Œé‚£ä¹ˆmsb.txtå°±ä¼šæŠ¥é”™ï¼Œæ‰¾ä¸åˆ°åŸå§‹æ–‡ä»¶ statè§‚å¯Ÿè¿™ä¸¤ä¸ªæ–‡ä»¶çš„æƒ…å†µå‘ç°ï¼šè¿™ä¸¤ä¸ªæ–‡ä»¶çš„inodeå·æ˜¯ä¸ä¸€æ ·çš„ ç¡¬é“¾æ¥ï¼šln a.txt b.txtï¼Œä¸¤ä¸ªæ–‡ä»¶åæŒ‡å‘äº†åŒä¸€ä¸ªç‰©ç†ä½ç½® rootå‰çš„æ•°å­—2è¡¨ç¤ºï¼Œè¯¥æ–‡ä»¶è¢«å¼•ç”¨çš„ä¸ªæ•°ï¼Œå‘ç°éƒ½æ˜¯2ï¼Œè¯´æ˜è½¯ç¡¬è¿æ¥éƒ½æ˜¯ç›´æ¥æŒ‡å‘ç‰©ç†æ–‡ä»¶çš„ï¼Œå¦‚æœæŠŠåŸå§‹çš„xxoo.txtåˆ æ‰ï¼Œé‚£ä¹ˆå¯¹msb.txtå¹¶æ²¡æœ‰ä»€ä¹ˆå½±å“ï¼Œåªä¸è¿‡ä¼šå¯¼è‡´è¯¥æ–‡ä»¶çš„è¢«å¼•ç”¨ä¸ªæ•°å‡ä¸º1 statè§‚å¯Ÿè¿™ä¸¤ä¸ªæ–‡ä»¶çš„æƒ…å†µå‘ç°ï¼šè¿™ä¸¤ä¸ªæ–‡ä»¶çš„inodeå·æ˜¯ä¸€æ ·çš„ï¼Œä¸”Linksä¸ªæ•°ä¸º2 bï¼šè¯»æ•°æ®çš„æ—¶å€™ï¼Œå¦‚æœå¯ä»¥è‡ªç”±æ¼‚ç§»çš„è¯»ï¼Œä»ä»»æ„ä½ç½®è¯»ã€‚å¦‚ç£ç›˜ cï¼šè¯»å–æ•°æ®çš„æ—¶å€™ï¼Œä¸èƒ½è¯»å‰é¢çš„ï¼Œä¸èƒ½è¯»åˆ°åé¢çš„ï¼Œä¸èƒ½éšä¾¿æ¼‚ç§»çš„è¯»ï¼Œå¯èƒ½æœ‰æ—¶å€™è¿˜éœ€è¦ä¸€äº›ç¼–è§£ç å’Œé©±åŠ¨çš„çº¦æŸã€‚å¦‚é”®ç›˜ã€ç»ˆç«¯ CHR sï¼šsocket pï¼špipeline [eventpoll]ï¼š æ¼”ç¤ºé•œåƒçš„åˆ›å»ºè¿‡ç¨‹ï¼š ifï¼šinput file ä½¿ç”¨ddå‘½ä»¤åˆ›å»ºä¸€ä¸ªé•œåƒæ–‡ä»¶ï¼Œifï¼šinput file,ofï¼šoutput fileï¼Œbså†™çš„åŸºæœ¬å•ä½æ˜¯å¤šå°‘å­—èŠ‚ï¼Œcountå†™å¤šå°‘ä¸ªåŸºæœ¬å•ä½ã€‚è¿™é‡Œå‘ç°åˆ›å»ºäº†ä¸€ä¸ª100Mçš„é•œåƒæ–‡ä»¶ losetupå‘½ä»¤ï¼šè®¾ç½®å¾ªç¯è®¾å¤‡ å¾ªç¯è®¾å¤‡å¯ä»¥æŠŠæ–‡ä»¶è™šæ‹Ÿæˆå—è®¾å¤‡ï¼ˆblock device)ï¼Œä»¥ä¾¿æ¨¡æ‹Ÿæ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œè¿™æ ·ç”¨æˆ·å¯ä»¥å°†å…¶çœ‹ä½œæ˜¯ç¡¬ç›˜é©±åŠ¨å™¨ï¼Œå…‰é©±æˆ–è½¯é©±ç­‰è®¾å¤‡ï¼Œå¹¶æŒ‚å…¥å½“ä½œç›®å½•æ¥ä½¿ç”¨ loopå¥½æ¯”æ˜¯å…‰é©±ï¼Œè€Œæ–‡ä»¶å°±åƒå…‰ç›˜ï¼Œæ”¾åˆ°loopä¸­ï¼Œä¹‹åæŒ‚è½½ä¸€ä¸‹å°±å¯ä»¥è®¿é—® æ ¼å¼åŒ–è™šæ‹Ÿç£ç›˜ æŒ‚è½½è™šæ‹Ÿç£ç›˜åˆ°/mnt/ooxxè¿™ä¸ªç›®å½•ï¼Œå¹¶æŒ‡å®šæ–‡ä»¶ç³»ç»Ÿä¸ºext2 åœ¨mydisk.imgè¿™ä¸ªé•œåƒä¸­ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ç³»ç»Ÿçš„å‘½åç©ºé—´ lddè·Ÿç€ä¸€ä¸ªå‘½ä»¤ï¼Œå¯ä»¥æ‰¾åˆ°è¯¥å‘½ä»¤ä¾èµ–çš„ç³»ç»Ÿæ–‡ä»¶ èŠ±æ‹¬å·æ‰©å±•ç”¨æ³•å¦‚ä¸Š ä½¿ç”¨chrootå‘½ä»¤æŠŠæ ¹ç›®å½•åˆ‡æ¢åˆ°å½“å‰ç›®å½•ï¼Œä¼šå‘ç°è¿›å…¥äº†ä¸€ä¸ªæ–°çš„å‘½ä»¤è¡Œï¼Œecho $$æŸ¥çœ‹å½“å‰çš„è¿›ç¨‹id æ–‡ä»¶æè¿°ç¬¦ï¼Œinodeidï¼Œè„è¯» lsofæŸ¥çœ‹æŸä¸ªè¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½å­˜åœ¨ä¸‰ä¸ªç‰¹å®šçš„æ–‡ä»¶æè¿°ç¬¦ï¼š0 - æ ‡å‡†è¾“å…¥ 1 - æ ‡å‡†è¾“å‡º 2 - æŠ¥é”™è¾“å‡ºï¼Œ ä½¿ç”¨å¦ä¸€ä¸ªè¿›ç¨‹ï¼Œå‘ç°FDçš„åç§»é‡å¹¶ä¸ä¼šå—åˆ°å‰ä¸€ä¸ªè¿›ç¨‹çš„å½±å“ socketexecå‘½ä»¤å¯ä»¥å®ç°é‡å®šå‘æ“ä½œï¼Œå¦‚ä¸‹æ“ä½œï¼Œå°†/dev/tcp/www.baidu.com/80é‡å®šå‘åˆ°8å·æ–‡ä»¶æè¿°ç¬¦ è¿›å…¥/proc/$$/fdç›®å½•ä¸‹å³å¯çœ‹åˆ°ä¸€ä¸ªsocketç±»å‹çš„æ–‡ä»¶ pipeline/proc - æ˜¯å¯¹å†…å­˜ä¸­è¿›ç¨‹å±æ€§çš„ä¸€ä¸ªæ˜ å°„ç›®å½•ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰pidï¼Œå¯¹åº”ä¸€ä¸ªç‹¬ç«‹çš„æ–‡ä»¶ é‡å®šå‘çš„æ ‡å‡†ç¬¦ï¼š&gt; è¾“å‡ºé‡å®šå‘ &lt; è¾“å…¥é‡å®šå‘ cat 0&lt; ooxx.txt 1&gt;cat.out catå‘½ä»¤çš„æ ‡å‡†è¾“å…¥æ¥è‡ªäºooxx.txtæ–‡ä»¶ï¼Œæ ‡å‡†è¾“å‡ºåˆ°cat.outæ–‡ä»¶ read a ï¼š æ ‡å‡†è¾“å…¥æ¥è‡ªé”®ç›˜çš„è¾“å…¥ï¼Œæ ‡å‡†è¾“å‡ºåˆ°å˜é‡aï¼Œå¯¹æ¢è¡Œç¬¦æ•æ„Ÿï¼Œé‡åˆ°æ¢è¡Œç¬¦åˆ™é€€å‡º read a 0&lt; cat.out å°†æ ‡å‡†è¾“å…¥é‡å®šå‘åˆ°cat.outæ–‡ä»¶ æ³¨æ„ï¼š0 1 2ä¸é‡å®šå‘æ“ä½œç¬¦ä¹‹é—´ä¸èƒ½æœ‰ç©ºç™½ç¬¦ï¼Œ ls ./ /oososos 1&gt; ls01.out 2&gt; ls02.out æ ‡å‡†è¾“å‡ºåˆ°ls01.outï¼Œé”™è¯¯è¾“å‡ºåˆ°ls02.out ls ./ /oososos 1&gt; ls03.out 2&gt; ls03.out æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯è¾“å‡ºéƒ½åˆ°ls03.outï¼Œä½†æ˜¯å‰é¢çš„è¾“å‡ºä¼šè¢«åé¢çš„è¾“å‡ºè¦†ç›– ls ./ .ooosdfso 1&gt; ls04.out 2&gt;&amp; 1 å°†é”™è¯¯è¾“å‡ºè¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºï¼Œé‚£ä¹ˆéœ€è¦åœ¨&gt;ç´§è·Ÿä¸€ä¸ª&amp;ç¬¦ï¼ŒåŒæ—¶è¦å°†1&gt; ls04.outæ”¾åˆ°2&gt;&amp; 1å‰é¢ ç®¡é“ |å¦‚ä½•è¯»å–æ–‡ä»¶çš„ç¬¬8è¡Œï¼Œåªæ˜¾ç¤ºç¬¬8è¡Œï¼š head -8 test.txt | tail -1å°†å‰é¢çš„æ ‡å‡†è¾“å‡ºä½œä¸ºåé¢çš„æ ‡å‡†è¾“å…¥ ç®¡é“è¿æ¥çš„ä¸¤ä¸ªæŒ‡ä»¤å— æ˜¯åˆ†åˆ«åœ¨ä¸¤ä¸ªå­è¿›ç¨‹ä¸­æ‰§è¡Œçš„ï¼Œæ“ä½œç³»ç»Ÿä¼šé€šè¿‡ç®¡é“å°†ç¬¬ä¸€ä¸ªå­è¿›ç¨‹çš„æ ‡å‡†è¾“å‡ºä¸ç¬¬äºŒä¸ªå­è¿›ç¨‹çš„æ ‡å‡†è¾“å…¥å¯¹æ¥èµ·æ¥ æ¯”å¦‚ï¼š{ a=9; echo &quot;sdfs&quot; } | cat è¿›å…¥æ­£é¢˜ï¼š å½“å‰bashè¿›ç¨‹çš„pidä¸º4398 1&#123; echo $BASHPID; read x; &#125; | &#123; echo $BASHPID; read y; &#125; æŒ‡ä»¤å—{ echo &quot;asdasd&quot;; echo &quot;123&quot; }ï¼Œä½¿ç”¨èŠ±æ‹¬å·æ ‡è¯†ä¸€ä¸ªä»£ç å—ï¼Œä¸€ä¸ªä»£ç å—ä¸­å¯ä»¥æœ‰å¤šæ¡æŒ‡ä»¤ï¼Œä½¿ç”¨åˆ†å·éš”å¼€ï¼Œä»–ä»¬ä¼šåœ¨åŒä¸€ä¸ªå­è¿›ç¨‹ä¸­æ‰§è¡Œ çˆ¶å­è¿›ç¨‹ åœ¨çˆ¶è¿›ç¨‹ä¸­å®šä¹‰çš„å˜é‡ åœ¨å­è¿›ç¨‹ä¸­æ— æ³•è¢«è¯»å–ï¼Œæ‰€ä»¥æ‰ä¼šæœ‰ä¸€ä¸ªexportå¯¼å‡ºæ“ä½œï¼Œåœ¨çˆ¶è¿›ç¨‹ä¸­ä½¿ç”¨exportå¯¼å‡ºçš„å˜é‡å¯ä»¥åœ¨å­è¿›ç¨‹ä¸­è¢«è®¿é—®ã€‚ $å’Œ$BASHPIDçš„åŒºåˆ«$$$$ä¼˜å…ˆçº§é«˜äºç®¡é“ï¼Œbashæ˜¯ä¸€ä¸ªè§£é‡Šæ‰§è¡Œï¼Œå®ƒçœ‹åˆ°$$$$åï¼Œä¼šç›´æ¥æŠŠ$$$$æ›¿æ¢æˆå½“å‰è¿›ç¨‹çš„pidï¼Œå¼€è¾Ÿå­è¿›ç¨‹çš„æ—¶å€™å°±å·²ç»è¢«æ›¿æ¢äº† $$BASHPIDä¼˜å…ˆçº§ä½äºç®¡é“ï¼Œä¼šåœ¨å¼€è¾Ÿçš„å­è¿›ç¨‹ä¸­è¢«æ‰§è¡Œ PageCache ä¸­æ–­ï¼šå‘Šè¯‰CPUç°åœ¨è¯¥å¹²ä»€ä¹ˆäº‹æƒ…äº†ï¼Œè§¦å‘ä¸­æ–­çš„æ—¶å€™ ä¼šç»™CPUä¸€ä¸ªä¸­æ–­å·ï¼ŒCPUä¼šæ‹¿ç€è¿™ä¸ªä¸­æ–­å·æŸ¥è¯¢ä¸­æ–­å‘é‡è¡¨ï¼Œæ¥å¾—çŸ¥è¯¥å¹²ä»€ä¹ˆäº‹æƒ…äº†ã€‚","categories":[{"name":"IO","slug":"IO","permalink":"https://shang.at/categories/IO/"}],"tags":[{"name":"IO","slug":"IO","permalink":"https://shang.at/tags/IO/"}]},{"title":"Javaå­¦ä¹ -IOå­¦ä¹ 5-ç½‘ç»œç¼–ç¨‹ä¹‹å¤šè·¯å¤ç”¨å™¨åŠEpoll","slug":"Javaå­¦ä¹ -IOå­¦ä¹ 5-ç½‘ç»œç¼–ç¨‹ä¹‹å¤šè·¯å¤ç”¨å™¨åŠEpoll","date":"2020-08-03T00:08:15.000Z","updated":"2020-08-03T00:10:28.598Z","comments":true,"path":"post/Javaå­¦ä¹ -IOå­¦ä¹ 5-ç½‘ç»œç¼–ç¨‹ä¹‹å¤šè·¯å¤ç”¨å™¨åŠEpoll/","link":"","permalink":"https://shang.at/post/Javaå­¦ä¹ -IOå­¦ä¹ 5-ç½‘ç»œç¼–ç¨‹ä¹‹å¤šè·¯å¤ç”¨å™¨åŠEpoll/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š","categories":[{"name":"JAVAå­¦ä¹ ","slug":"JAVAå­¦ä¹ ","permalink":"https://shang.at/categories/JAVAå­¦ä¹ /"}],"tags":[{"name":"JAVA-IO","slug":"JAVA-IO","permalink":"https://shang.at/tags/JAVA-IO/"},{"name":"Epoll","slug":"Epoll","permalink":"https://shang.at/tags/Epoll/"}]},{"title":"Scalaå­¦ä¹ -0.3-æŠ½è±¡ç±»","slug":"Scalaå­¦ä¹ -0-3-æŠ½è±¡ç±»","date":"2020-07-31T00:34:32.000Z","updated":"2021-05-05T11:33:24.512Z","comments":true,"path":"post/Scalaå­¦ä¹ -0-3-æŠ½è±¡ç±»/","link":"","permalink":"https://shang.at/post/Scalaå­¦ä¹ -0-3-æŠ½è±¡ç±»/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š æŠ½è±¡ç±»ç‰¹è´¨å’ŒæŠ½è±¡ç±»å¯ä»¥åŒ…å«ä¸€ä¸ªæŠ½è±¡ç±»å‹æˆå‘˜ï¼Œæ„å‘³ç€å®é™…ç±»å‹å¯ç”±å…·ä½“å®ç°æ¥ç¡®å®šã€‚ä¾‹å¦‚ï¼š 1234trait Buffer &#123; type T val element: T&#125; è¿™é‡Œå®šä¹‰çš„æŠ½è±¡ç±»å‹Tæ˜¯ç”¨æ¥æè¿°æˆå‘˜elementçš„ç±»å‹çš„ã€‚é€šè¿‡æŠ½è±¡ç±»æ¥æ‰©å±•è¿™ä¸ªç‰¹è´¨åï¼Œå°±å¯ä»¥æ·»åŠ ä¸€ä¸ªç±»å‹ä¸Šè¾¹ç•Œæ¥è®©æŠ½è±¡ç±»å‹Tå˜å¾—æ›´åŠ å…·ä½“ã€‚ 12345abstract class SeqBuffer extends Buffer &#123; type U type T &lt;: Seq[U] def length = element.length&#125; æ³¨æ„è¿™é‡Œæ˜¯å¦‚ä½•å€ŸåŠ©å¦å¤–ä¸€ä¸ªæŠ½è±¡ç±»å‹Uæ¥é™å®šç±»å‹ä¸Šè¾¹ç•Œçš„ã€‚é€šè¿‡å£°æ˜ç±»å‹Tåªå¯ä»¥æ˜¯Seq[U]çš„å­ç±»ï¼ˆå…¶ä¸­Uæ˜¯ä¸€ä¸ªæ–°çš„æŠ½è±¡ç±»å‹ï¼‰ï¼Œè¿™ä¸ªSeqBufferç±»å°±é™å®šäº†ç¼“å†²åŒºä¸­å­˜å‚¨çš„å…ƒç´ ç±»å‹åªèƒ½æ˜¯åºåˆ—ã€‚ å«æœ‰æŠ½è±¡ç±»å‹æˆå‘˜çš„ç‰¹è´¨æˆ–ç±»ï¼ˆclassesï¼‰ç»å¸¸å’ŒåŒ¿åç±»çš„åˆå§‹åŒ–ä¸€èµ·ä½¿ç”¨ã€‚ä¸ºäº†èƒ½å¤Ÿé˜æ˜é—®é¢˜ï¼Œä¸‹é¢çœ‹ä¸€æ®µç¨‹åºï¼Œå®ƒå¤„ç†ä¸€ä¸ªæ¶‰åŠæ•´å‹åˆ—è¡¨çš„åºåˆ—ç¼“å†²åŒºã€‚ 12345678910111213abstract class IntSeqBuffer extends SeqBuffer &#123; type U = Int&#125;def newIntSeqBuf(elem1: Int, elem2: Int): IntSeqBuffer = new IntSeqBuffer &#123; type T = List[U] val element = List(elem1, elem2) &#125;val buf = newIntSeqBuf(7, 8)println(\"length = \" + buf.length)println(\"content = \" + buf.element) è¿™é‡Œçš„å·¥å‚æ–¹æ³•newIntSeqBufä½¿ç”¨äº†IntSeqBufçš„åŒ¿åç±»å®ç°æ–¹å¼ï¼Œå…¶ç±»å‹Tè¢«è®¾ç½®æˆäº†List[Int]ã€‚ æŠŠæŠ½è±¡ç±»å‹æˆå‘˜è½¬æˆç±»çš„ç±»å‹å‚æ•°æˆ–è€…åè¿‡æ¥ï¼Œä¹Ÿæ˜¯å¯è¡Œçš„ã€‚å¦‚ä¸‹é¢è¿™ä¸ªç‰ˆæœ¬åªç”¨äº†ç±»çš„ç±»å‹å‚æ•°æ¥è½¬æ¢ä¸Šé¢çš„ä»£ç ï¼š 123456789101112131415abstract class Buffer[+T] &#123; val element: T&#125;abstract class SeqBuffer[U, +T &lt;: Seq[U]] extends Buffer[T] &#123; def length = element.length&#125;def newIntSeqBuf(e1: Int, e2: Int): SeqBuffer[Int, Seq[Int]] = new SeqBuffer[Int, List[Int]] &#123; val element = List(e1, e2) &#125;val buf = newIntSeqBuf(7, 8)println(\"length = \" + buf.length)println(\"content = \" + buf.element) éœ€è¦æ³¨æ„çš„æ˜¯ä¸ºäº†éšè—ä»æ–¹æ³•newIntSeqBufè¿”å›çš„å¯¹è±¡çš„å…·ä½“åºåˆ—å®ç°çš„ç±»å‹ï¼Œè¿™é‡Œçš„å‹å˜æ ‡å·ï¼ˆ+T &lt;: Seq[U]ï¼‰æ˜¯å¿…ä¸å¯å°‘çš„ã€‚æ­¤å¤–è¦è¯´æ˜çš„æ˜¯ï¼Œæœ‰äº›æƒ…å†µä¸‹ç”¨ç±»å‹å‚æ•°æ›¿æ¢æŠ½è±¡ç±»å‹æ˜¯è¡Œä¸é€šçš„ã€‚ ç±»å‹è¾¹ç•Œå®é™…ä¸Šå°±æ˜¯å®šä¹‰äº†çˆ¶ç±»ä¸å­ç±»çš„å…³ç³» è¿˜æ˜¯æœ‰ç‚¹ç–‘æƒ‘çš„â€¦ ç±»å‹ä¸Šç•Œ æ¯”å¦‚åƒT &lt;: Aè¿™æ ·å£°æ˜çš„ç±»å‹ä¸Šç•Œè¡¨ç¤ºç±»å‹å˜é‡Tåº”è¯¥æ˜¯ç±»å‹Aæˆ–è€…Açš„å­ç±» ç±»å‹ä¸‹ç•Œ æœ¯è¯­ B &gt;: A è¡¨ç¤ºç±»å‹å‚æ•° B æˆ–æŠ½è±¡ç±»å‹ B æ˜¯ç±»å‹ A çš„è¶…ç±»å‹ã€‚ åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒA å°†æ˜¯ç±»çš„ç±»å‹å‚æ•°ï¼Œè€Œ B å°†æ˜¯æ–¹æ³•çš„ç±»å‹å‚æ•°ã€‚ ç±»çš„æ„é€ è¾…åŠ©æ„é€ å™¨(Auxiliary Constructor) è¾…åŠ©æ„é€ å™¨çš„åç§°ä¸ºthis æ¯ä¸ªè¾…åŠ©æ„é€ å™¨éƒ½å¿…é¡»ä»¥ä¸€ä¸ªå¯¹å…ˆå‰å·²å®šä¹‰çš„å…¶ä»–è¾…åŠ©æ„é€ å™¨æˆ–ä¸»æ„é€ å™¨çš„è°ƒç”¨å¼€å§‹ 12345678910111213class Student &#123; private var name = \" \" private var age = 0 def this(name: String)&#123; //è¾…åŠ©æ„é€ å™¨1 this() //è°ƒç”¨ä¸»æ„é€ å™¨ this.name = name &#125; def this(name: String,age: Int)&#123; //è¾…åŠ©æ„é€ å™¨2 this(name) //è°ƒç”¨å‰ä¸€ä¸ªè¾…åŠ©æ„é€ å™¨ this.age = age &#125;&#125; ç°åœ¨æœ‰ä»¥ä¸‹ä¸‰ç§æ–¹å¼å®ä¾‹åŒ–å¯¹è±¡: 1234567object Test1 &#123; def main(args: Array[String]): Unit = &#123; val s1 = new Student //ä¸»æ„é€ å™¨ val s2 = new Student(\"KK\") //è¾…åŠ©æ„é€ å™¨1 val s3 = new Student(\"Captian72\",18) //è¾…åŠ©æ„é€ å™¨2 &#125;&#125; ä¸»æ„é€ å™¨(Primary Constructor)Scalaä¸­ï¼Œæ¯ä¸ªç±»éƒ½æœ‰ä¸»æ„é€ å™¨ï¼Œä½†å¹¶ä¸ä»¥thiså®šä¹‰ã€‚ ä¸»æ„é€ å™¨çš„å‚æ•°ç›´æ¥æ”¾åœ¨ç±»åä¹‹å 123class Student(val name: String,val age: Int)&#123; // æ‹¬å·ä¸­çš„å°±æ˜¯ä¸»æ„é€ å™¨çš„å‚æ•° ......&#125; åªæœ‰ä¸»æ„é€ å™¨çš„å‚æ•°æ‰ä¼šè¢«ç¼–è¯‘æˆå­—æ®µï¼Œå…¶åˆå§‹åŒ–çš„å€¼ä¸ºæ„é€ æ—¶ä¼ å…¥çš„å‚æ•°ã€‚ ä¸»æ„é€ å™¨ä¼šæ‰§è¡Œç±»å®šä¹‰ä¸­çš„æ‰€æœ‰è¯­å¥ 123456789101112131415161718class Student (val name: String,val age: Int)&#123; println(\"Primary constructor and Auxiliary constructor!\") def fun = name + \" is \" + age +\" years old!\"&#125;object Test2 &#123; def main(args: Array[String]): Unit = &#123; val s1 = new Student(\"Captian72\",18) val s2 = new Student(\"KK\",20) println(s1.fun) println(s2.fun) &#125;&#125;// è¾“å‡ºä¸ºï¼šPrimary constructor and Auxiliary constructor!Primary constructor and Auxiliary constructor!Captian72 is 18 years old!KK is 20 years old! è¯´æ˜ï¼šå› ä¸ºprintlnè¯­å¥æ˜¯ä¸»æ„é€ å™¨çš„ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥åœ¨æ¯æ¬¡å®ä¾‹åŒ–çš„æ—¶å€™ï¼Œä¼šæ‰§è¡Œä¸€æ¬¡printlnã€‚ç„¶åfunå‡½æ•°è¢«è°ƒç”¨2æ¬¡ï¼Œå°±æ‰§è¡Œä¸¤æ¬¡funå‡½æ•°çš„å†…å®¹ï¼Œå³è¾“å‡ºï¼š 12Captian72 is 18 years old!KK is 20 years old! åœ¨ä¸»æ„é€ å™¨ä¸­ä½¿ç”¨é»˜è®¤å‚æ•°ï¼Œå¯é˜²æ­¢è¾…åŠ©æ„é€ å™¨ä½¿ç”¨è¿‡å¤š 1class Student(val name:String=\"\",val age: Int = 0) å¦‚æœä¸å¸¦valæˆ–varçš„å‚æ•°è‡³å°‘è¢«ä¸€ä¸ªæ–¹æ³•ä½¿ç”¨ï¼Œå®ƒå°†å‡æ ¼ä¸ºå­—æ®µ 123class Dog(name:String, color:String)&#123; def fun = name + \" is \" + color + \" Dog!\"&#125; ä¸Šè¿°ä»£ç å£°æ˜å¹¶åˆå§‹åŒ–äº†ä¸å¯å˜å­—æ®µnameå’Œcolorï¼Œå¹¶ä¸”è¿™ä¸¤ä¸ªå­—æ®µéƒ½æ˜¯å¯¹è±¡ç§æœ‰çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç±»çš„æ–¹æ³•ï¼Œåªèƒ½è®¿é—®åˆ°å½“å‰å¯¹è±¡çš„å­—æ®µã€‚ ç§æœ‰æ„é€ å™¨(Private Constructor)æƒ³è¦è®©ä¸»æ„é€ å™¨å˜æˆç§æœ‰æ„é€ å™¨ï¼Œåªéœ€è¦åŠ ä¸Šprivateå…³é”®å­—å³å¯ã€‚ä¾‹å¦‚ï¼š 1class Dog private(val age: Int)&#123;...&#125; è¿™æ ·åšä¹‹åï¼Œå°±å¿…é¡»ä½¿ç”¨è¾…åŠ©æ„é€ å™¨æ¥æ„é€ Dogå¯¹è±¡äº†ã€‚","categories":[],"tags":[]},{"title":"Scalaå­¦ä¹ -0.2-æ³›å‹","slug":"Scalaå­¦ä¹ -0-2-æ³›å‹","date":"2020-07-31T00:23:17.000Z","updated":"2020-08-05T08:42:04.288Z","comments":true,"path":"post/Scalaå­¦ä¹ -0-2-æ³›å‹/","link":"","permalink":"https://shang.at/post/Scalaå­¦ä¹ -0-2-æ³›å‹/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š ä¸javaä¸åŒï¼Œjavaä¸­çš„æ³›å‹ç”¨&lt;&gt;åŒ…å›´ï¼Œåœ¨scalaä¸­æ³›å‹ç”¨[]åŒ…å›´","categories":[{"name":"Scalaå­¦ä¹ ","slug":"Scalaå­¦ä¹ ","permalink":"https://shang.at/categories/Scalaå­¦ä¹ /"}],"tags":[{"name":"Scalaæ³›å‹","slug":"Scalaæ³›å‹","permalink":"https://shang.at/tags/Scalaæ³›å‹/"}]},{"title":"Scalaå­¦ä¹ -0.1-import","slug":"Scalaå­¦ä¹ -0-1-import","date":"2020-07-31T00:23:01.000Z","updated":"2020-09-07T07:12:35.776Z","comments":true,"path":"post/Scalaå­¦ä¹ -0-1-import/","link":"","permalink":"https://shang.at/post/Scalaå­¦ä¹ -0-1-import/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š Scalaçš„importæœºåˆ¶æ€»ç»“import ä¸»è¦ç”¨äºå¯¼å…¥å„ç§åå­—ç©ºé—´ï¼ˆpackageï¼‰æˆ–å…¶åŒ…å«çš„æˆå‘˜ï¼Œä½¿å®ƒä»¬åœ¨å£°æ˜çš„ä½œç”¨åŸŸé‡Œå¯è§ã€‚ 1 å¯¼å…¥package è®¿é—®packageçš„æˆå‘˜éœ€è¦ç”¨å¯¼å…¥çš„packageåä½œä¸ºå‰ç¼€ï¼Œä¸»è¦ç”¨äºå½“packageåµŒå¥—è¾ƒå¤šæ—¶ï¼Œå¯ä»¥èµ·åˆ°ç®€åŒ–åŠéš”ç¦»åå­—ç©ºé—´çš„ä½œç”¨ã€‚ å½“ç„¶ä»»ä½•æ—¶å€™ä½¿ç”¨å®Œæ•´packageè·¯å¾„ï¼ˆfull package pathï¼‰éƒ½æ˜¯å¯ä»¥çš„ã€‚å¦‚ï¼š 123456import java.utilnew util.ArrayList[String]() // éœ€è¦æœ‰utilä½œä¸ºå‰ç¼€ï¼Œçœç•¥æ‰utilçš„çˆ¶package â€œjavaâ€new java.util.ArrayList[String] // é€šè¿‡å®Œæ•´packageè·¯å¾„è®¿é—®import java.sqlnew sql.Date(new util.Date().getTime) // ä½¿ç”¨packageåéš”ç¦»Dateç±»çš„åå­—å†²çª 2 å¯¼å…¥packageä¸‹æ‰€æœ‰æˆå‘˜ ç›¸æ¯”Javaä¸­ä½¿ç”¨â€˜*â€™ï¼ŒScalaä½¿ç”¨â€™_â€™è¡¨ç¤ºå¯¼å…¥packageä¸‹æ‰€æœ‰æˆå‘˜. å¦‚ï¼š 1234567891011121314151617scala&gt; val map = new HashMap[String,Int]&lt;console&gt;:7: error: not found: type HashMap val map = new HashMap[String,Int] ^scala&gt; import scala.collection.immutable.HashMapimport scala.collection.immutable.HashMapscala&gt; var map = new HashMap[String,Int]map: scala.collection.immutable.HashMap[String,Int] = Map()scala&gt; map += \"itang\" -&gt; 1scala&gt; mapres1: scala.collection.immutable.HashMap[String,Int] = Map(itang -&gt; 1)scala&gt; import java.util._scala&gt; new ArrayList[String]() 3 å¯¼å…¥packageä¸‹ç‰¹å®šæˆå‘˜ æŒ‡å®špackageè·¯å¾„åŠè¦å¯¼å…¥çš„ç±»ç­‰çš„åç§°ï¼Œå¦‚ï¼š 123import java.util.ArrayListnew ArrayList[Int] 4 å¯¼å…¥packageä¸‹ç‰¹å®šæˆå‘˜ï¼Œå¹¶é‡å‘½å åœ¨è¦å¯¼å…¥packageåä½¿ç”¨â€{}â€,æŒ‡å®šè¦å¯¼å…¥çš„æˆå‘˜ï¼Œå¹¶ä½¿ç”¨â€=&gt;â€é‡å‘½å;å¦‚æœåœ¨ä¸€ä¸ªpackageä¸‹è¦å¯¼å…¥å¤šä¸ªæˆå‘˜ï¼Œåˆ™ä½¿ç”¨é€—å·åˆ†éš”.å¦‚: 12345678910111213141516scala&gt; import java.util.&#123;ArrayList =&gt; JList, HashMap =&gt; JMap&#125;scala&gt; new JList[Int]res: java.util.ArrayList[Int] = []scala&gt; type JStringList = JList[String]defined type alias JStringListscala&gt; new JStringListres: java.util.ArrayList[String] = []scala&gt; new JMap[String, String]res: java.util.HashMap[String,String] = &#123;&#125;scala&gt; import scala.Option.&#123;empty =&gt; jempty&#125;scala&gt; jemptyres: Option[Nothing] = None 5 å¯¼å…¥package objectçš„æˆå‘˜ scalaä¸­packageé™¤äº†å……å½“å‘½åç©ºé—´ä¹‹å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡package objectå¯å®šä¹‰ä¸€äº›æˆå‘˜ï¼Œå½¢å¦‚ï¼š 123456789101112131415package testpackage object utils &#123; type JStringList = java.util.ArrayList[String] val Msg = \"Hello, World\" implicit def iw(target: Int) = new &#123; def times(proc: =&gt; Any) &#123; var i = 0 while (i &lt; target) &#123; proc i += 1 &#125; &#125; &#125;&#125; 123456import test.utils._object tt extends App &#123; println(Msg) new JStringList 10.times(println(\"hello\"))&#125; 6 å¯¼å…¥objectçš„æˆå‘˜ Scalaä¸­æ˜¯æ²¡æœ‰Javaä¸­ç±»ä¸­é™æ€æˆå‘˜çš„æ¦‚å¿µï¼Œåä¹‹ï¼ŒScalaä½¿ç”¨object classï¼ˆå¯¹è±¡ç±»å‹ï¼‰å•ä¾‹æ¨¡å¼ Scalaèƒ½å¯¼å…¥object classçš„æˆå‘˜ï¼Œä¹Ÿèƒ½å¯¼å…¥è¿è¡Œæ—¶å¯¹è±¡å®ä¾‹çš„æˆå‘˜ã€‚ åœ¨å†™sparkåº”ç”¨çš„æ—¶å€™ï¼Œimport spark.implicits._çš„å†™æ³•å°±æ˜¯è¿™ç§åœºæ™¯çš„ä¸€ç§åº”ç”¨ï¼Œå…¶ä¸­sparkæ˜¯SparkSessionçš„å¯¹è±¡ã€‚ 12345678910scala&gt; import scala.Option._scala&gt; emptyres: Option[Nothing] = None case class User(name: String, age: Int)val a = new User(\"itang\", 18)println(\"%s's age is %d\" format (a.name, a.age))import a._println(\"%s's age is %d\", name, age) //output: itang's age is 18 7 import å¯ä»¥ä½äºè¡¨è¾¾å¼çš„èƒ½æ”¾çš„ä»»æ„ä½ç½®ï¼Œè€Œä¸”å¯¼å…¥çš„æˆå‘˜æœ‰å…¶â€œå¯è§â€çš„ä½œç”¨åŸŸ å¦‚ä¸€ä¸‹ä»£ç æ‰€ç¤ºï¼š 1234567891011121314151617181920212223import scala.actors.Actor._class TestPackagePosScope extends App &#123; actor &#123; println(\"Hello\") &#125; //new HashSet[String] ///not found type: HashSet import collection.immutable.HashSet new HashSet[String] def test1() &#123; import java.text.&#123; SimpleDateFormat =&gt; Sdf &#125; import java.util.Date new Sdf(\"yyyy-MM-dd\").format(new Date) &#125; //new Sdf(\"yyyy-MM-dd\").format(new Date) //not found type: Sdf &#123; import java.util._ val jlist = new ArrayList[String] &#125; //val badJlist = new ArrayList[String] // not found type: ArrayList&#125; import ä½¿ç”¨ä¸Šåƒè¡¨è¾¾å¼ï¼Œä½†å®ƒä¸æ˜¯è¡¨è¾¾å¼ä¹Ÿä¸æ˜¯å‡½æ•°ï¼Œå®ƒæ²¡æœ‰è¿”å›å€¼ï¼Œå­˜åœ¨äºç¼–è¯‘æ—¶ï¼Œå¦‚ 12345scala&gt; val some = import java.util._&lt;console&gt;:1: error: illegal start of simple expression val some = import java.util._ 8 scalaé»˜è®¤å·²å¯¼å…¥çš„åå­—ç©ºé—´åŠæˆå‘˜ scalaåŒ…ä¸‹æˆå‘˜é»˜è®¤å¯è§ ç›¸å½“ä¸æ¯ä¸ªç¼–è¯‘å•å…ƒé‡Œé»˜è®¤import scala._ 123scala&gt; Console.println(\"hello\") // scala.Consolescala&gt; Seq(1,2)scala&gt; scala.Seq(1,2) æ³¨æ„åˆ°scalaä¹Ÿæ˜¯ä¸€ä¸ªpackage objectï¼Œé‡Œé¢å®šä¹‰äº†å¾ˆå¤šä¸åŒpackageçš„ä¸‹ç±»å‹åˆ«åï¼Œå¦‚æ­¤å¯ä»¥å°†ä¼—å¤šçš„ç±»å‹ç»„ç»‡åˆ°scalaåå­—ç©ºé—´ã€‚ java.langåŒ…ä¸‹æˆå‘˜é»˜è®¤å¯è§ ç›¸å½“ä¸æ¯ä¸ªç¼–è¯‘å•å…ƒé‡Œé»˜è®¤import java.lang._ 12scala&gt; Runtime.getRuntime.availableProcessors // java.lang.Runtimescala&gt; System.getProperty(\"user.home\") scala.Predef è¿™ä¸ªobjectä¸‹æˆå‘˜é»˜è®¤å¯è§ï¼ˆä¸»è¦å®šä¹‰å…¨å±€å‡½æ•°ï¼Œç±»å‹åˆ«åï¼Œéšå¼è½¬æ¢ç­‰ç­‰) ç›¸å½“ä¸æ¯ä¸ªç¼–è¯‘å•å…ƒé‡Œé»˜è®¤import scala.Predef._ 1234scala&gt; println(\"hello\")scala&gt; scala.Predef.println(\"hell\")scala&gt; \"msg\" -&gt; \"Hello\"scala&gt; any2ArrowAssoc(\"msg\").-&gt;(\"Hello\") //scala.Predef.any2ArrowAssoc","categories":[{"name":"Scalaå­¦ä¹ ","slug":"Scalaå­¦ä¹ ","permalink":"https://shang.at/categories/Scalaå­¦ä¹ /"}],"tags":[{"name":"Scala-import","slug":"Scala-import","permalink":"https://shang.at/tags/Scala-import/"}]},{"title":"Sparkå­¦ä¹ -Encoder","slug":"Sparkå­¦ä¹ -Encoder","date":"2020-07-29T10:39:29.000Z","updated":"2020-07-29T10:39:44.621Z","comments":true,"path":"post/Sparkå­¦ä¹ -Encoder/","link":"","permalink":"https://shang.at/post/Sparkå­¦ä¹ -Encoder/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š","categories":[],"tags":[{"name":"Encoder","slug":"Encoder","permalink":"https://shang.at/tags/Encoder/"}]},{"title":"Javaå­¦ä¹ -String","slug":"Javaå­¦ä¹ -String","date":"2020-07-29T10:23:44.000Z","updated":"2020-09-02T23:26:41.375Z","comments":true,"path":"post/Javaå­¦ä¹ -String/","link":"","permalink":"https://shang.at/post/Javaå­¦ä¹ -String/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š internæ–¹æ³•ä»‹ç»â€‹ Oracleçš„å¼€å‘æ–‡æ¡£ä¸Šè®²è§£çš„å¾ˆè¯¦ç»†ï¼šStringç±»å†…éƒ¨ç»´æŠ¤ä¸€ä¸ªå­—ç¬¦ä¸²æ± (strings pool)ï¼Œå½“è°ƒç”¨Stringçš„intern()æ–¹æ³•æ—¶ï¼Œå¦‚æœå­—ç¬¦ä¸²æ± ä¸­å·²ç»å­˜åœ¨è¯¥å­—ç¬¦ä¸²ï¼Œåˆ™ç›´æ¥è¿”å›æ± ä¸­å­—ç¬¦ä¸²å¼•ç”¨ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™å°†è¯¥å­—ç¬¦ä¸²æ·»åŠ åˆ°æ± ä¸­ï¼Œå¹¶è¿”å›è¯¥å­—ç¬¦ä¸²å¯¹è±¡çš„å¼•ç”¨ã€‚æ‰§è¡Œè¿‡intern()æ–¹æ³•çš„å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬å°±è¯´è¿™ä¸ªå­—ç¬¦ä¸²è¢«æ‹˜ç¦äº†(interned)ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä»£ç ä¸­çš„å­—ç¬¦ä¸²å­—é¢é‡å’Œå­—ç¬¦ä¸²å¸¸é‡å€¼éƒ½æ˜¯è¢«æ‹˜ç¦çš„ï¼Œä¾‹å¦‚ï¼š 12345String s1 = \"abc\";String s2 =new String(\"abc\"); //è¿”å›trueSystem.out.println(s1 == s2.intern()); â€‹ åŒå€¼å­—ç¬¦ä¸²çš„intern()æ–¹æ³•è¿”å›çš„å¼•ç”¨éƒ½ç›¸åŒï¼Œä¾‹å¦‚ï¼š 1234567String s2 = new String(\"abc\");String s3 = new String(\"abc\"); //è¿”å›trueSystem.out.println(s2.intern() == s3.intern());//è¿”å›falseSystem.out.println(s2 == s3);","categories":[{"name":"JAVAå­¦ä¹ ","slug":"JAVAå­¦ä¹ ","permalink":"https://shang.at/categories/JAVAå­¦ä¹ /"}],"tags":[{"name":"String","slug":"String","permalink":"https://shang.at/tags/String/"}]},{"title":"Scalaå­¦ä¹ -å‡½æ•°å¼ç¼–ç¨‹","slug":"Scalaå­¦ä¹ -å‡½æ•°å¼ç¼–ç¨‹","date":"2020-07-29T08:51:56.000Z","updated":"2021-04-19T03:41:23.136Z","comments":true,"path":"post/Scalaå­¦ä¹ -å‡½æ•°å¼ç¼–ç¨‹/","link":"","permalink":"https://shang.at/post/Scalaå­¦ä¹ -å‡½æ•°å¼ç¼–ç¨‹/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š ä»€ä¹ˆæ˜¯å‡½æ•°å¼ç¼–ç¨‹å‡½æ•°çš„èŒè´£æ˜¯å•ä¸€çš„ â€”â€”â€” è¿™å’Œé¢å‘æ¥å£çš„ç¼–ç¨‹æ¨¡å‹æ˜¯ä¸€è‡´çš„ çº¯å‡½æ•°ï¼šæ²¡æœ‰å‰¯ä½œç”¨çš„å‡½æ•° ä»€ä¹ˆæ˜¯å‰¯ä½œç”¨ï¼šä»è¾“å…¥åˆ°è¾“å‡ºçš„è¿‡ç¨‹ä¸­è¿˜å¹²äº†ä¸€äº›é¢å¤–çš„äº‹æƒ… â€‹ ä¿®æ”¹äº†æŸäº›å€¼ã€ä¸å¤–éƒ¨ç³»ç»Ÿå‘ç”Ÿäº¤äº’ã€ç›´æ¥ä¿®æ”¹æ•°æ®ç»“æ„ å‡½æ•°å¼ç¼–ç¨‹çš„å¥½å¤„ï¼š åŠŸèƒ½æ¨¡å—åŒ–ã€æ˜“æµ‹è¯•ã€æ˜“å¤ç”¨ã€å¹¶è¡ŒåŒ–ã€æ³›åŒ–ã€æ¨å¯¼ å®šä¹‰å‡½æ•°å¼ç¼–ç¨‹åˆç§°æ³›å‡½ç¼–ç¨‹æ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå‹ï¼Œå®ƒå°†è®¡ç®—æœºè¿ç®—è§†ä¸ºæ•°å­¦ä¸Šçš„å‡½æ•°è®¡ç®—ï¼Œå¹¶ä¸”é¿å…ä½¿ç”¨ç¨‹åºçŠ¶æ€ä»¥åŠæ˜“å˜å¯¹è±¡ã€‚å‡½æ•°ç¼–ç¨‹è¯­è¨€æœ€é‡è¦çš„åŸºç¡€æ˜¯Î»æ¼”ç®—ï¼ˆlambda calculusï¼‰ã€‚Î»æ¼”ç®—ä¸­æœ€å…³é”®çš„è¦ç´ å°±æ˜¯å‡½æ•°è¢«å½“ä½œå˜é‡å¤„ç†ï¼Œèƒ½å¤Ÿå‚ä¸è¿ç®—ã€‚ä¸ä¹‹å¯¹åº”çš„ï¼Œå‘½ä»¤å¼ç¼–ç¨‹æ˜¯ä¸€ç§æè¿°ç”µè„‘æ‰€éœ€ä½œå‡ºçš„è¡Œä¸ºçš„ç¼–ç¨‹èŒƒå‹ã€‚æ¯”èµ·å‘½ä»¤å¼ç¼–ç¨‹ï¼Œå‡½æ•°å¼ç¼–ç¨‹æ›´åŠ å¼ºè°ƒæ‰§è¡Œçš„ç»“æœè€Œéæ‰§è¡Œè¿‡ç¨‹ï¼Œå€¡å¯¼åˆ©ç”¨è‹¥å¹²ç®€å•çš„æ‰§è¡Œå•å…ƒè®©è®¡ç®—ç»“æœä¸æ–­æ¼”è¿›ï¼ŒæŠ½ä¸å‰¥èŒ§é€å±‚æ¨å¯¼å¤æ‚çš„è¿ç®—ï¼Œè€Œä¸æ˜¯è®¾è®¡ä¸€ä¸ªå¤æ‚çš„è¿ç®—è¿‡ç¨‹ã€‚æ€»ç»“ä¸€ä¸‹å°±æ˜¯ å‘½ä»¤å¼ç¼–ç¨‹(Imperative)å‘½ä»¤â€œæœºå™¨â€å¦‚ä½•å»åšäº‹æƒ…(how)ï¼Œè¿™æ ·ä¸ç®¡ä½ æƒ³è¦çš„æ˜¯ä»€ä¹ˆ(what)ï¼Œå®ƒéƒ½ä¼šæŒ‰ç…§ä½ çš„å‘½ä»¤å®ç°ã€‚ å‡½æ•°å¼ç¼–ç¨‹(functional)å‘Šè¯‰â€œæœºå™¨â€ä½ æƒ³è¦çš„æ˜¯ä»€ä¹ˆ(what)ï¼Œè®©æœºå™¨æƒ³å‡ºå¦‚ä½•å»åš(how)ã€‚ æˆ‘ä»¬ç”¨ä¸€ä¸ªä½¿æ•°ç»„ç¿»å€çš„ä¾‹å­æ¥æ¯”è¾ƒè¿™ä¸¤ç§ç¼–ç¨‹èŒƒå¼ã€‚ Java Code \\ Imperative 123456Integer[] nums = new Integer[]&#123;1, 2, 3, 4&#125;;int i=0;for (Integer n : nums) &#123; n*=2; nums[i++]=n;&#125; éå†æ•´ä¸ªæ•°ç»„ï¼Œå–å‡ºæ¯ä¸ªå…ƒç´ ï¼Œä¹˜ä»¥äºŒï¼Œç„¶åæŠŠç¿»å€åçš„å€¼æ”¾å›æ•°ç»„ï¼Œæ¯æ¬¡éƒ½è¦æ“ä½œè¿™ä¸ªæ•°ç»„ï¼Œç›´åˆ°è®¡ç®—å®Œæ‰€æœ‰å…ƒç´ ã€‚ Scala code \\ functional 12val nums = Array(1,2,3,4)val doubleNums = nums.map(_*2) åˆ©ç”¨Arrayçš„mapå‡½æ•°ï¼Œå°†æ‰€æœ‰å…ƒç´ 2ï¼Œå¹¶ç”Ÿæˆäº†ä¸€ä¸ªæ–°çš„åŒå€æ•°ç»„ã€‚mapå‡½æ•°æ‰€åšçš„äº‹æƒ…æ˜¯æŠŠéå†æ•´ä¸ªæ•°ç»„çš„è¿‡ç¨‹ï¼Œå½’çº³å¹¶æŠ½ç¦»å‡ºæ¥ï¼Œè®©æˆ‘ä»¬ä¸“æ³¨äºæè¿°æˆ‘ä»¬æƒ³è¦çš„æ˜¯ä»€ä¹ˆâ€**_*2***â€ã€‚æˆ‘ä»¬ä¼ å…¥mapçš„æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼›å®ƒä¸å…·æœ‰ä»»ä½•å‰¯ä½œç”¨(ä¸ä¼šæ”¹å˜å¤–éƒ¨çŠ¶æ€)ï¼Œå®ƒåªæ˜¯æ¥æ”¶ä¸€ä¸ªæ•°å­—ï¼Œè¿”å›ä¹˜ä»¥2åçš„å€¼ã€‚PSï¼š _ å­—ç¬¦æ˜¯scalaä¸­çš„å…¥å‚ç¼©å†™å½¢å¼ã€‚ æ­£å¦‚å°è£…ã€ç»§æ‰¿å’Œå¤šæ€æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¸‰å¤§ç‰¹æ€§ã€‚å‡½æ•°å¼ç¼–ç¨‹ä¹Ÿæœ‰è‡ªå·±çš„è¯­è¨€ç‰¹æ€§ï¼šæ•°æ®ä¸å¯å˜ã€å‡½æ•°æ˜¯ç¬¬ä¸€å…¬æ°‘ã€å¼•ç”¨é€æ˜å’Œå°¾é€’å½’ *æ•°æ®ä¸å¯å˜ï¼ˆimmutable dataï¼‰ï¼šå˜é‡åªèµ‹å€¼ä¸€æ¬¡ï¼Œå¦‚æœæƒ³æ”¹å˜å…¶å€¼å°±åˆ›å»ºä¸€ä¸ªæ–°çš„ã€‚ *å‡½æ•°æ˜¯ç¬¬ä¸€å…¬æ°‘ï¼ˆfirst class methodï¼‰å‡½æ•°å¯ä»¥åƒæ™®é€šå˜é‡ä¸€æ ·å»ä½¿ç”¨ã€‚å‡½æ•°å¯ä»¥åƒå˜é‡ä¸€æ ·è¢«åˆ›å»ºï¼Œä¿®æ”¹ï¼Œå¹¶å½“æˆå˜é‡ä¸€æ ·ä¼ é€’ï¼Œè¿”å›æˆ–æ˜¯åœ¨å‡½æ•°ä¸­åµŒå¥—å‡½æ•°ã€‚ *å¼•ç”¨é€æ˜(referential transparency) æŒ‡çš„æ˜¯å‡½æ•°çš„è¿è¡Œä¸ä¾èµ–äºå¤–éƒ¨å˜é‡æˆ–â€œçŠ¶æ€â€ï¼Œåªä¾èµ–äºè¾“å…¥çš„å‚æ•°ï¼Œä»»ä½•æ—¶å€™åªè¦å‚æ•°ç›¸åŒï¼Œè°ƒç”¨å‡½æ•°æ‰€å¾—åˆ°çš„è¿”å›å€¼æ€»æ˜¯ç›¸åŒçš„ã€‚å¤©ç„¶é€‚åº”å¹¶å‘ç¼–ç¨‹ï¼Œå› ä¸ºè°ƒç”¨å‡½æ•°çš„ç»“æœå…·æœ‰ä¸€è‡´æ€§ï¼Œæ‰€ä»¥æ ¹æœ¬ä¸éœ€è¦åŠ é”ï¼Œä¹Ÿå°±ä¸å­˜åœ¨æ­»é”çš„é—®é¢˜ã€‚ *å°¾é€’å½’ï¼ˆtail call optimizationï¼‰:å‡½æ•°è°ƒç”¨è¦å‹æ ˆä¿å­˜ç°åœºï¼Œé€’å½’å±‚æ¬¡è¿‡æ·±çš„è¯ï¼Œå‹æ ˆè¿‡å¤šä¼šäº§ç”Ÿæ€§èƒ½é—®é¢˜ã€‚æ‰€ä»¥å¼•å…¥å°¾é€’å½’ä¼˜åŒ–ï¼Œæ¯æ¬¡é€’å½’æ—¶éƒ½ä¼šé‡ç”¨æ ˆï¼Œæå‡æ€§èƒ½ã€‚ -â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” æ™®é€šå‡½æ•°123def max(x: Int, y: Int): Int = &#123; if (x &gt; y) x else y&#125; def æ˜¯å£°æ˜å‡½æ•°çš„å…³é”®å­—ï¼Œå°æ‹¬å·ä¸­çš„x:Int,y:intæ˜¯å‡½æ•°çš„å…¥å‚ï¼Œç´§è·Ÿç€çš„:Intæ˜¯å‡½æ•°è¿”å›å€¼ç±»å‹ï¼ŒèŠ±æ‹¬å·ä¸­çš„æ˜¯å‡½æ•°ä½“ã€‚(å‰ä¸€ç« ä»‹ç»è¿‡ï¼Œå¦‚æœå‡½æ•°è¿”å›ç±»å‹æ˜¯éUnitï¼Œé‚£ä¹ˆé»˜è®¤ä»£ç æ‰§è¡Œçš„æœ€åä¸€è¡Œçš„å€¼ï¼Œå³ä¸ºè¿”å›å€¼ï¼Œä¸éœ€è¦æ˜¾å¼çš„æ³¨æ˜returnå…³é”®å­—) åŒ¿åå‡½æ•°123val increment = (x: Int) =&gt; x + 1increment(2)// output 3 åŒ¿åå‡½æ•°æ˜¯æŒ‡ä¸€ç±»æ— éœ€å®šä¹‰æ ‡è¯†ç¬¦çš„å‡½æ•°ï¼Œå®šä¹‰åŒ¿åå‡½æ•°çš„è¯­æ³•å¾ˆç®€å•ï¼Œ=&gt;ç®­å¤´å·¦è¾¹æ˜¯å‚æ•°åˆ—è¡¨ï¼Œå³è¾¹æ˜¯å‡½æ•°ä½“ã€‚å¯ä»¥æŠŠå‘½åå‡½æ•°èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ä½¿ç”¨ã€‚ å¦ä¸€ç§æ–¹å¼ 123val increment =new Function1[Int, Int] &#123; def apply(x: Int): Int = x + 1&#125; æ— å‚åŒ¿åå‡½æ•°123val sayHello = () =&gt; &#123; System.out.print(\"Hello World!\") &#125;sayHello()//output: Hello World! é«˜é˜¶å‡½æ•°è‡³å°‘æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ä¹‹ä¸€çš„å‡½æ•°ï¼Œå³ä¸ºé«˜é˜¶å‡½æ•° æ¥å—ä¸€ä¸ªæˆ–å¤šä¸ªå‡½æ•°ä½œä¸ºè¾“å…¥ è¾“å‡ºä¸€ä¸ªå‡½æ•° åœ¨æ•°å­¦é¢†åŸŸä»–ä»¬ä¹Ÿå«åšç®—å­æˆ–æ³›å‡½ã€‚å¾®ç§¯åˆ†ä¸­çš„å¯¼æ•°å°±æ˜¯å¸¸è§çš„ä¾‹å­ï¼Œå®ƒæ˜ å°„ä¸€ä¸ªå‡½æ•°åˆ°å¦ä¸€ä¸ªå‡½æ•°ã€‚ 1234val convert2String=(x:Int)=&gt;\"==[\" + x.toString() + \"]==\"def apply(f: Int =&gt; String, v: Int) = f(v)apply(convert2String,36)//output: ==[36]== åµŒå…¥å¼å‡½æ•°(æœ¬åœ°å‡½æ•°)åœ¨Scalaä¸­å¯ä»¥åœ¨å‡½æ•°ä½“ä¸­å†å®šä¹‰ä¸€ä¸ªå‡½æ•°ã€‚ 1234567def filter(xs: List[Int], threshold: Int) = &#123;def process(ys: List[Int]): List[Int] =if (ys.isEmpty) yselse if (ys.head &lt; threshold) ys.head :: process(ys.tail)else process(ys.tail) process(xs)&#125; å‡½æ•°æŸ¯é‡ŒåŒ–(Currying)åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼ŒæŸ¯é‡ŒåŒ–æ˜¯æŒ‡æŠŠæ¥å—å¤šä¸ªå‚æ•°çš„å‡½æ•°å˜æ¢æˆæ¥å—ä¸€ä¸ªå•ä¸€å‚æ•°çš„å‡½æ•°ï¼Œå¹¶ä¸”è¿”å›å…¶ä½™çš„å‚æ•°å’Œç»“æœçš„å‡½æ•°ã€‚ 123456789101112131415def curriedSum(x: Int)(y: Int)(z: Int) = x + y + zval sum = curriedSum(1)(2)(3)//output: 6//the calling procedure of currying functiondef first(x: Int) = (y: Int) =&gt; (z: Int) =&gt; x + y + zdef second = first(5)//output: Int =&gt; (Int =&gt; Int) = 5 + y + zdef third = second(6)//output: Int =&gt; Int = 5 + 6 + zval fourth = third(7)//output: 18first(5)(6)(7)//output: 18 ä»£ç èŒƒä¾‹ä¸­ï¼ŒcurriedSumæ˜¯ä¸€ä¸ªcurryingå‡½æ•°çš„Scalaå†™æ³•ï¼Œè€Œfirstã€secondã€thirdã€fourthå±•ç¤ºäº†curryingå‡½æ•°è°ƒç”¨è¿‡ç¨‹ã€‚é€šè¿‡ä»£ç æ³¨é‡Šå¯çœ‹åˆ°secondã€thirdè¿”å›çš„éƒ½æ˜¯å‡½æ•°ï¼Œç›´åˆ°fourthæ‰è¿”å›æ±‚å’Œå€¼ã€‚è€Œè¿™ç§ç‰¹æ€§ä¹Ÿæ­£æ˜¯æƒ°æ€§æ±‚å€¼çš„ç§˜å¯†æ‰€åœ¨ã€‚ éƒ¨åˆ†åº”ç”¨å‡½æ•°å‡å¦‚æœ‰ä¸€ä¸ªå‡½æ•°å¯ä»¥è¡¨ç¤ºå¾ˆå¤šçš„å«ä¹‰ï¼Œæ¯”å¦‚æœ‰ä¸€ä¸ªå‡½æ•°fun(m,n)æ±‚$m^n$ï¼Œæˆ‘ä»¬æ›´å¸¸ç”¨çš„å¯èƒ½æ˜¯æ±‚$m^2$æˆ–è€…$m^3$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å›ºå®šæ¬¡æ•°ä¸º2æˆ–3ï¼Œæ¥åˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œå¦‚fun2=fun(m, 2)å’Œfun3=fun(m,3)ã€‚ 123456def sum(x: Int, y: Int, z: Int) = &#123;x + y + z&#125;val sum2 = sum(10, _: Int, 15)sum2(2)//output: 27 åå‡½æ•°(Partial Function)Scalaå®šä¹‰äº†ä¸€ä¸ªç‰¹æ®Šçš„åå‡½æ•°(Partial Function)ã€‚é¦–å…ˆï¼Œæˆ‘å…ˆæ¥ç†è§£åå‡½æ•°çš„æ¦‚å¿µã€‚ ä»è¾“å…¥é›†åˆXåˆ°å¯èƒ½çš„è¾“å‡ºé›†åˆYçš„å‡½æ•°f(è®°ä½œf(X)=&gt;Y)æ˜¯Xä¸Yçš„å…³ç³»ï¼Œæ»¡è¶³å¦‚ä¸‹æ¡ä»¶ï¼š fæ˜¯å®Œå…¨çš„å³å¯¹äºé›†åˆXä¸­çš„ä»»ä¸€å…ƒç´ xéƒ½æœ‰é›†åˆYä¸­çš„å…ƒç´ yï¼Œä»è€Œæ»¡è¶³f(x)=y,æ¢å¥è¯è¯´å°±æ˜¯æ¯ä¸€ä¸ªè¾“å…¥å€¼xéƒ½æœ‰yä¸ä¹‹å¯¹åº”ã€‚ fæ˜¯å¤šå¯¹ä¸€çš„å³å­˜åœ¨ ä¸” å¹¶ä¸” ã€‚ä¹Ÿå°±æ˜¯å¤šä¸ªè¾“å…¥å¯ä»¥æ˜ å°„ä¸€ä¸ªè¾“å‡ºï¼Œä½†ä¸€ä¸ªè¾“å…¥ä¸èƒ½æ˜ å°„å¤šä¸ªè¾“å‡ºã€‚ é‚£ä¹ˆç»“è®ºæ¥äº†ï¼ŒXä¸Yçš„å…³ç³»fæ»¡è¶³æ¡ä»¶1ï¼Œåˆ™ä¸ºå¤šå€¼å‡½æ•°ã€‚Xä¸Yçš„å…³ç³»fæ»¡è¶³æ¡ä»¶2ï¼Œåˆ™ä¸ºåå‡½æ•°ã€‚ 1234567891011val pf: PartialFunction[Int, String] = &#123; case 1 =&gt; \"One\" case 2 =&gt; \"Two\" case 3 =&gt; \"Three\" case 9 =&gt; \"Nine\" case _=&gt; \"Nothing\"&#125;pf(1) // output: Onepf(2) // output: Twopf(5) // output: Nothingpf(9) // output: Nine ç¤ºä¾‹ä»£ç ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªScalaçš„åå‡½æ•°ï¼Œé‚£ä¹ˆåªæœ‰1ã€2ã€3ã€9æœ‰å¯¹åº”çš„è¾“å‡ºå€¼ï¼Œè€Œè¾“å…¥å…¶å®ƒå€¼åªä¼šæ‰“å° Nothingã€‚ é‚£ä¹ˆåå‡½æ•°æœ‰ä»€ä¹ˆåº”ç”¨ä»·å€¼å‘¢ï¼Ÿå‡½æ•°å¼çš„ç¼–ç¨‹æ€æƒ³æ˜¯ä»¥ä¸€ç§â€œæ¼”ç»æ³•â€è€Œéâ€œå½’çº³æ³•â€å»å¯»æ±‚è§£å†³ç©ºé—´ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒå¹¶ä¸æ˜¯è¦å»å½’çº³é—®é¢˜ç„¶ååˆ†è§£é—®é¢˜å¹¶è§£å†³é—®é¢˜ï¼Œè€Œæ˜¯çœ‹è¯·é—®é¢˜æœ¬è´¨ï¼Œå®šä¹‰æœ€åˆçš„æƒ³æ³•å’Œç»„åˆè§„åˆ™ï¼Œé¢å¯¹é—®é¢˜æ—¶ï¼Œå¯ä»¥é€šè¿‡ç»„åˆå„ç§å‡½æ•°å»è§£å†³é—®é¢˜ï¼Œè¿™ä¹Ÿæ­£æ˜¯â€œç»„åˆå­ï¼ˆcombinatorï¼‰â€çš„å«ä¹‰ã€‚åå‡½æ•°åˆ™æ›´è¿›ä¸€æ­¥ï¼Œå°†å‡½æ•°æ±‚è§£ç©ºé—´ä¸­å„ä¸ªåˆ†æ”¯ä¹Ÿåˆ†ç¦»å‡ºæ¥ï¼Œå½¢æˆå¯ä»¥è¢«ç»„åˆçš„åå‡½æ•°ã€‚ e.g. åå‡½æ•°ä½¿ç”¨orElseç»„æˆæ–°çš„å‡½æ•°ï¼Œå¾—åˆ°çš„åå‡½æ•°åæ˜ äº†æ˜¯å¦å¯¹ç»™å®šå‚æ•°è¿›è¡Œäº†å®šä¹‰ã€‚ 123456789101112131415161718192021222324val one: PartialFunction[Int, String] = &#123; case 1 =&gt; \"one\"&#125;val two: PartialFunction[Int, String] = &#123;case 2 =&gt; \"two\"&#125;val three: PartialFunction[Int, String] = &#123;case 3 =&gt; \"three\"&#125;val wildcard: PartialFunction[Int, String] = &#123;case _ =&gt; \"something else\"&#125;val partial = one orElse two orElse three orElse wildcardpartial(5)//output: something elsepartial(3)//output: threepartial(2)//output: twopartial(1)//output: = onepartial(0)//output: something else æ­¤å¤–ï¼Œåœ¨é›†åˆç±»çš„å¾ˆå¤šå‡½æ•°éƒ½å¸¦æœ‰è¿™ç§åå‡½æ•°çš„èƒ½åŠ›ã€‚e.g. map å‡½æ•° 123456val L1 = List(1, 2, 3, \"A\", 4, \"B\", 5)val L2 = L1 map &#123; case x: Int =&gt; x * xcase x: String =&gt; s\"$x*$x\"&#125;//L2: List[Any] = List(1, 4, 9, A*A, 16, B*B, 25) é—­åŒ…åˆç§°å‡½æ•°é—­åŒ…ï¼Œæ˜¯å¼•ç”¨äº†è‡ªç”±å˜é‡çš„å‡½æ•°ã€‚è¿™ä¸ªè¢«å¼•ç”¨çš„è‡ªç”±å˜é‡å°†å’Œè¿™ä¸ªå‡½æ•°ä¸€åŒå­˜åœ¨ï¼Œæ¢å¥è¯è¯´ï¼Œé—­åŒ…æ˜¯ç”±å‡½æ•°å’Œä¸å…¶ç›¸å…³çš„å¼•ç”¨ç¯å¢ƒç»„åˆæˆçš„ã€‚ PS:å¦å¤–ä¸€ç§è§£é‡Šï¼Œå¯¹è±¡æ˜¯å¸¦æœ‰å‡½æ•°çš„æ•°æ®ï¼Œé—­åŒ…æ˜¯å¸¦æœ‰æ•°æ®çš„å‡½æ•°ã€‚ 123val more = 2val addMore = (x: Int) =&gt; x + moreaddMore(1) ä¼ å€¼è°ƒç”¨å‡½æ•°(call by value)å…ˆè®¡ç®—å‚æ•°è¡¨è¾¾å¼çš„å€¼ï¼Œå†åº”ç”¨åˆ°å‡½æ•°å†…éƒ¨å³ä¸ºä¼ å€¼è°ƒç”¨ã€‚ 12345def assert(predicate: () =&gt; Boolean) =if (!predicate()) throw new AssertionErrorassert(() =&gt; (1 &gt; 3)) ä¼ åè°ƒç”¨å‡½æ•°(call by name)å°†æœªè®¡ç®—çš„å‚æ•°è¡¨è¾¾å¼ç›´æ¥åº”ç”¨åˆ°å‡½æ•°å†…éƒ¨å³ä¸ºä¼ åè°ƒç”¨ã€‚ 123456789def assert(predicate: =&gt; Boolean) =if (!predicate) throw new AssertionErrorassert(1 &gt; 3)def compare(x: Int, y: Int): Boolean = &#123; if (x &gt; y) true else false&#125;assert(compare(1, 3)) å¯å˜å‚å‡½æ•°12345def echo(args:String*)=&#123; for(arg &lt;- args) println(arg)&#125;echo(\"Hello\",\"World\",\"!\")//output: Hello World! ç®¡é“(pipeline)å‡½æ•°123456789101112def even(x:Array[Int]):Array[Int]=&#123; x.filter(_%2==0)&#125;def square(x:Array[Int]):Array[Int]=&#123; x.map(e=&gt;e*e)&#125;def total(x:Array[Int]):Int=&#123; x.reduce(_+_)&#125;val nums = Array(1,2,3,4,5,6,7,8,9,10)val pipeline = total(square(even(nums)))//output: 220 é€’å½’å‡½æ•° 1234567def fun(i:Int):Unit= &#123; if (i &lt; 10 &amp;&amp; i &gt;= 0) &#123; println(s\"i:$i\"); fun(i + 1); &#125;&#125;fun(1) Scalaç¼–è¯‘å™¨ä¼˜åŒ–äº†å°¾é€’å½’è°ƒç”¨ï¼Œé€’å½’è°ƒç”¨å’Œæ‰§è¡Œä¸€ä¸ªwhileå¾ªç¯æ²¡æœ‰æ€§èƒ½ä¸ŠåŒºåˆ«ã€‚ æ–¹æ³•ä¸å‡½æ•°åœ¨Scalaä¸­å‡½æ•°å¦‚æœæ˜¯æŸä¸ªå¯¹è±¡çš„æˆå‘˜ï¼Œé‚£ä¹ˆç§°è¿™ç§å‡½æ•°ä¸ºæ–¹æ³•ã€‚ 12345class Sample&#123; def sayHello():Unit=&#123; print(\"Hello\") &#125;&#125; æ–¹æ³•çš„è®¿é—®æƒé™å’ŒJavaæœ‰äº›ä¸åŒï¼Œæ²¡æœ‰æ ‡æ³¨è®¿é—®æƒé™å…³é”®å­—çš„æ–¹æ³•å³ä¸ºpublicã€‚ private 12345678910object Sample&#123; def apply()=new Sample //Visible Sample().sayHello()&#125;class Sample &#123; private def sayHello():Unit=&#123; print(\"Hello\") &#125;&#125; æ ‡æ³¨äº†privateå…³é”®å­—ï¼Œä¼´ç”Ÿå¯¹è±¡å’Œæœ¬å¯¹è±¡å¯ä»¥è®¿é—®ã€‚ private[this] 12345678910object Sample&#123; def apply()=new Sample //Invisible Sample().sayHello()&#125;class Sample &#123; private[this] def sayHello():Unit=&#123; print(\"Hello\") &#125;&#125; ä¸ºprivateæ ‡æ³¨äº†thisé™å®šè¯,åˆ™åªæœ‰æœ¬å¯¹è±¡å¯ä»¥è®¿é—®ã€‚ protected 12345678910111213141516object Sample&#123; def apply()=new Sample&#125;class Sample &#123; protected[scala] def sayHello():Unit=&#123; print(\"Hello\") &#125;&#125;object OtherSample extends Sample&#123; //Visible Sample().sayHello()&#125;object ThirdSample &#123; //Invisible Sample().sayHello()&#125; Scalaçš„æ–¹æ³•è¢«æ ‡æ³¨äº†protedtedï¼Œå°±åªæ¯”privateå¤šäº†èƒ½åœ¨å­ç±»ä¸­è®¿é—®ã€‚ protected[packageName] 12345678910111213package com.stanley.scalaobject Sample&#123; def apply()=new Sample&#125;class Sample &#123; protected[stanley] def sayHello():Unit=&#123; print(\"Hello\") &#125;&#125;object OtherSample&#123; //Visible Sample().sayHello()&#125; é€šè¿‡æŒ‡å®šprotectedçš„é™å®šè¯ï¼Œå¯ä»¥æŒ‡æ˜åœ¨åŒ…ä¸­å¯è§ã€‚æ ·ä¾‹ä»£ç ä¸­ï¼Œæ ‡æ˜äº†åœ¨ stanley åŒ…ä¸­å¯è§ã€‚ æ·»åŠ é™å®šè¯å ã€‚å½“é™å®šè¯æ˜¯Sampleæ—¶ï¼Œprivate[Sample] ç­‰äº privateã€‚è€Œprotected[Sample]ç­‰äºprotectedã€‚å½“é™å®šè¯æ˜¯thisæ—¶ï¼Œprotected[this] å­ç±»ä¸­å¯è§ï¼Œä¼´ç”Ÿå¯¹è±¡ä¸­ä¸å¯è§ï¼Œprivate[this]åªæœ‰æœ¬å¯¹è±¡å¯è§ã€‚å½“é™å®šè¯æ˜¯åŒ…åæ—¶ï¼Œprivateå’Œprotectedæ²¡æœ‰åŒºåˆ«ã€‚ -â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” è¡¥å……ï¼šScalaçš„lambdaæ¼”ç®—ä¸ºäº†æ›´å¥½çš„ç†è§£å‡½æ•°å¼ç¼–ç¨‹ï¼Œè¿˜æ˜¯è¡¥å……ä¸€éƒ¨åˆ†å…³äºlambdaçš„çŸ¥è¯†å’Œå¤§å®¶äº¤æµã€‚ lambdaæ¼”ç®—æ˜¯ä¸€å¥—ç”¨äºç ”ç©¶å‡½æ•°å®šä¹‰ã€å‡½æ•°åº”ç”¨å’Œé€’å½’çš„å½¢å¼ç³»ç»Ÿã€‚å®ƒç”±é˜¿éš†ä½Â·é‚±å¥‡å’Œä»–çš„å­¦ç”Ÿæ–¯è’‚èŠ¬Â·ç§‘å°”Â·å…‹è±å°¼åœ¨20ä¸–çºª30å¹´ä»£å¼•å…¥ã€‚é‚±å¥‡è¿ç”¨Î»æ¼”ç®—åœ¨1936å¹´ç»™å‡ºåˆ¤å®šæ€§é—®é¢˜çš„ä¸€ä¸ªå¦å®šçš„ç­”æ¡ˆã€‚è¿™ç§æ¼”ç®—å¯ä»¥ç”¨æ¥æ¸…æ™°åœ°å®šä¹‰ä»€ä¹ˆæ˜¯ä¸€ä¸ªå¯è®¡ç®—å‡½æ•°ã€‚å…³äºä¸¤ä¸ªlambdaæ¼”ç®—è¡¨è¾¾å¼æ˜¯å¦ç­‰ä»·çš„å‘½é¢˜æ— æ³•é€šè¿‡ä¸€ä¸ªâ€œé€šç”¨çš„ç®—æ³•â€æ¥è§£å†³ï¼Œè¿™æ˜¯ä¸å¯åˆ¤å®šæ€§èƒ½å¤Ÿè¯æ˜çš„å¤´ä¸€ä¸ªé—®é¢˜ï¼Œç”šè‡³è¿˜åœ¨åœæœºé—®é¢˜ä¹‹å…ˆã€‚Lambdaæ¼”ç®—å¯¹å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€æœ‰å·¨å¤§çš„å½±å“ï¼Œæ¯”å¦‚Lispè¯­è¨€ã€MLè¯­è¨€å’ŒHaskellè¯­è¨€ï¼ŒåŒ…æ‹¬Scalaè¯­è¨€ã€‚ Lambdaæ¼”ç®—å¯ä»¥è¢«ç§°ä¸ºæœ€å°çš„é€šç”¨ç¨‹åºè®¾è®¡è¯­è¨€ã€‚å®ƒåŒ…æ‹¬ä¸€æ¡å˜æ¢è§„åˆ™ï¼ˆå˜é‡æ›¿æ¢ï¼‰å’Œä¸€æ¡å‡½æ•°å®šä¹‰æ–¹å¼ï¼ŒLambdaæ¼”ç®—ä¹‹é€šç”¨åœ¨äºï¼Œä»»ä½•ä¸€ä¸ªå¯è®¡ç®—å‡½æ•°éƒ½èƒ½ç”¨è¿™ç§å½¢å¼æ¥è¡¨è¾¾å’Œæ±‚å€¼ã€‚å› è€Œï¼Œå®ƒæ˜¯ç­‰ä»·äºå›¾çµæœºçš„ã€‚å°½ç®¡å¦‚æ­¤ï¼ŒLambdaæ¼”ç®—å¼ºè°ƒçš„æ˜¯å˜æ¢è§„åˆ™çš„è¿ç”¨ï¼Œè€Œéå®ç°å®ƒä»¬çš„å…·ä½“æœºå™¨ã€‚å¯ä»¥è®¤ä¸ºè¿™æ˜¯ä¸€ç§æ›´æ¥è¿‘è½¯ä»¶è€Œéç¡¬ä»¶çš„æ–¹å¼ã€‚ éå½¢å¼åŒ–çš„æè¿°åœ¨lambdaæ¼”ç®—ä¸­ï¼Œæ¯ä¸ªè¡¨è¾¾å¼éƒ½ä»£è¡¨ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æœ‰ä¸€ä¸ªå‚æ•°ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªå€¼ã€‚ä¸è®ºæ˜¯å‚æ•°å’Œè¿”å›å€¼ï¼Œä¹Ÿéƒ½æ˜¯ä¸€ä¸ªå•å‚çš„å‡½æ•°ã€‚å¯ä»¥è¿™ä¹ˆè¯´ï¼Œlambdaæ¼”ç®—ä¸­ï¼Œåªæœ‰ä¸€ç§â€œç±»å‹â€ï¼Œé‚£å°±æ˜¯è¿™ç§å•å‚å‡½æ•°ã€‚ å‡½æ•°æ˜¯é€šè¿‡lambdaè¡¨è¾¾å¼åŒ¿ååœ°å®šä¹‰çš„ï¼Œè¿™ä¸ªè¡¨è¾¾å¼è¯´æ˜äº†æ­¤å‡½æ•°å°†å¯¹å…¶å‚æ•°è¿›è¡Œä»€ä¹ˆæ“ä½œã€‚e.g.ï¼Œâ€œåŠ 2â€å‡½æ•°def f(x)= x + 2å¯ä»¥ç”¨lambdaæ¼”ç®—è¡¨ç¤ºä¸ºã€‚ Scalaçš„è¡¨è¾¾å¼ 1(x)=&gt;x+2 è€ƒè™‘è¿™ä¹ˆä¸€ä¸ªå‡½æ•°ï¼šå®ƒæŠŠä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¿™ä¸ªå‡½æ•°å°†è¢«ä½œç”¨åœ¨3ä¸Š 1f3 = (x:Int=&gt;Int)=&gt;x(3) ã€‚å¦‚æœæŠŠè¿™ä¸ªï¼ˆç”¨å‡½æ•°ä½œå‚æ•°çš„ï¼‰å‡½æ•°ä½œç”¨äºæˆ‘ä»¬å…ˆå‰çš„â€œåŠ 2â€å‡½æ•°ä¸Š 1f3(f) ï¼Œåˆ™æ˜æ˜¾åœ°ï¼Œè¿™ä¸‰ä¸ªè¡¨è¾¾å¼ï¼šã€ã€æ˜¯ç­‰ä»·çš„ã€‚ 1f3(f)ã€f(3)ã€3+2 æœ‰ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°å¯ä»¥é€šè¿‡lambdaæ¼”ç®—è¿™ä¹ˆè¡¨è¾¾ï¼šä¸€ä¸ªå•ä¸€å‚æ•°çš„å‡½æ•°çš„è¿”å›å€¼åˆæ˜¯ä¸€ä¸ªå•ä¸€å‚æ•°çš„å‡½æ•°ï¼ˆCurryingï¼‰ã€‚ä¾‹å¦‚ï¼Œå‡½æ•°å¯ä»¥å†™ä½œã€‚ 123def f(x:Int, y:Int) = x - y//Can this(x:Int,y:Int)=&gt;x-y è¿™ä¸‰ä¸ªè¡¨è¾¾å¼ï¼šä½œã€ã€ä¹Ÿæ˜¯ç­‰ä»·çš„ã€‚ 123((x:Int,y:Int)=&gt;x-y)(7,2)((y:Int)=&gt;7-y)(2)7-2 ç„¶è€Œè¿™ç§lambdaè¡¨è¾¾å¼ä¹‹é—´çš„ç­‰ä»·æ€§æ— æ³•æ‰¾åˆ°ä¸€ä¸ªé€šç”¨çš„å‡½æ•°æ¥åˆ¤å®šã€‚ å¹¶éæ‰€æœ‰çš„lambdaè¡¨è¾¾å¼éƒ½å¯ä»¥è§„çº¦è‡³ä¸Šè¿°é‚£æ ·çš„ç¡®å®šå€¼ï¼Œè€ƒè™‘æˆ– 123((x:Int)=&gt;x)(((x:Int)=&gt;x)(((x:Int)=&gt;x)(((x:Int)=&gt;x)(0))))//OR((x:Int)=&gt;x)(((x:Int)=&gt;x)(((x:Int)=&gt;x)(((x:Int)=&gt;x)(((x:Int)=&gt;x)(((x:Int)=&gt;x)(0)))))) ï¼ˆæ³¨æ„:0åªæ˜¯ä¸ªå‚æ•°ï¼‰ ç„¶åè¯•å›¾æŠŠç¬¬ä¸€ä¸ªå‡½æ•°ä½œç”¨åœ¨å®ƒçš„å‚æ•°ä¸Šã€‚è¢«ç§°ä¸ºÏ‰ ç»„åˆå­ï¼Œè¢«ç§°ä¸ºÎ©ï¼Œè€Œè¢«ç§°ä¸ºÎ©2ï¼Œä»¥æ­¤ç±»æ¨ã€‚ lambdaæ¼”ç®—ä¸­çš„ç®—æœ¯åœ¨lambdaæ¼”ç®—ä¸­æœ‰è®¸å¤šæ–¹å¼éƒ½å¯ä»¥å®šä¹‰è‡ªç„¶æ•°ï¼Œä½†æœ€å¸¸è§çš„æ˜¯Churchæ•°ã€‚é‚±å¥‡æ•´æ•°æ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°ï¼Œä»¥å•ä¸€å‚æ•°å‡½æ•°fä¸ºå‚æ•°ï¼Œè¿”å›å¦ä¸€ä¸ªå•ä¸€å‚æ•°çš„å‡½æ•°ã€‚åˆ©ç”¨å‡½æ•°è¢«è°ƒç”¨çš„æ¬¡æ•°æ ‡è¯†è‡ªç„¶æ•°ã€‚ 12345678910111213//Scala Sampledef zero[A](f: A =&gt; A) = (x: A) =&gt; xdef one[A](f: A =&gt; A) = (x: A) =&gt; f(x)def two[A](f: A =&gt; A) = (x: A) =&gt; f(f(x))def three[A](f: A =&gt; A) = (x: A) =&gt; f(f(f(x)))def four[A](f: A =&gt; A) = (x: A) =&gt; f(f(f(f(x))))def five[A](f: A =&gt; A) = (x: A) =&gt; f(f(f(f(f(x)))))println(\"zero: \" + zero[Int](i =&gt; i + 1)(0))println(\"one: \" + one[Int](i =&gt; i + 1)(0))println(\"two: \" + two[Int](i =&gt; i + 1)(0))println(\"three: \" + three[Int](i =&gt; i + 1)(0))println(\"four: \" + four[Int](i =&gt; i + 1)(0))println(\"four: \" + five[Int](i =&gt; i + 1)(0)) Churchæ•°å®šä¹‰çš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªåç»§å‡½æ•°ï¼Œå®ƒä»¥nä¸ºå‚æ•°ï¼Œè¿”å›n + 1 12def succ[A](n: (A =&gt; A) =&gt; A =&gt; A) = (f: A =&gt; A) =&gt; (x: A) =&gt; f(n(f)(x))println(\"succ: \" + succ[Int](two)(i =&gt; i + 1)(0)) å®šä¹‰åŠ æ³• 12def plus[A](m: (A =&gt; A) =&gt; A =&gt; A) = (n: (A =&gt; A) =&gt; A =&gt; A) =&gt; (f: A =&gt; A) =&gt; (x: A) =&gt; m(f)(n(f)(x))println(\"plus: \" + plus[Int](three)(two)(i =&gt; i + 1)(0)) ä¹˜æ³•å¯ä»¥è¿™æ ·å®šä¹‰ åŸå§‹é“¾æ¥ï¼šhttps://zhuanlan.zhihu.com/p/25484213 é›†åˆæ•°æ®æ“ä½œscala.collection.TraversableOnceï¼šå®šä¹‰äº†å¯éå†é›†åˆçš„æ“ä½œ 12// æ˜¯å¦ä¸ºç©ºdef isEmpty: Boolean 12// æ˜¯å¦ä¸ä¸ºç©ºdef nonEmpty: Boolean = !isEmpty 12345678// å¯¹æ»¡è¶³pæ¡ä»¶çš„å…ƒç´ è®¡æ•°ï¼Œé»˜è®¤ç›´æ¥ä¼ Trueå³å¯ def count(p: A =&gt; Boolean): Int = &#123; var cnt = 0 for (x &lt;- this) if (p(x)) cnt += 1 cnt &#125; 12// å¯¹é›†åˆä¸­çš„æ¯ä¸ªå…ƒç´ æ–½åŠ fæ“ä½œï¼Œæ²¡æœ‰è¿”å›å€¼def foreach[U](f: A =&gt; U): Unit 12// æ£€æŸ¥æŸä¸ªå…ƒç´ åœ¨é›†åˆä¸­æ˜¯å¦å­˜åœ¨def exists(p: A =&gt; Boolean): Boolean 12// æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³pæ¡ä»¶çš„å…ƒç´ ï¼Œè¿”å›ä¸€ä¸ªOptionå¯¹è±¡ï¼Œè¡¨ç¤ºå¯èƒ½æ‰¾ä¸åˆ°def find(p: A =&gt; Boolean): Option[A] 12// foldLeftçš„åˆ«ådef /:[B](z: B)(op: (B, A) =&gt; B): B = foldLeft(z)(op) 12345678910 // æœ€é‡è¦çš„ä¸€ä¸ªæ–¹æ³•ã€‚å¾ˆå¤šæ–¹æ³•åŸºæœ¬éƒ½æ˜¯åŸºäºæ­¤æ–¹æ³•æ¼”åŒ–å‡ºæ¥çš„// å¯¹å½“å‰çš„é›†åˆçš„æ¯ä¸€ä¸ªå…ƒç´  ä»å·¦åˆ°å³çš„æ–½åŠ ä¸€ä¸ªæœ‰åˆå§‹å€¼(z)äºŒå€¼æ“ä½œ(op)// è¿”å›ç±»å‹Bä¸åˆå§‹å€¼zçš„ç±»å‹ä¸€è‡´// opæ¥æ”¶çš„ä¸¤ä¸ªå‚æ•°ç±»å‹åˆ†åˆ«ä¸ºï¼šBå’ŒAï¼ŒAä¸ºåŸå§‹é›†åˆå…ƒç´ çš„ç±»å‹ï¼›Bæ˜¯opæ¯ä¸€æ¬¡å¤„ç†çš„ç»“æœï¼›åˆå§‹æƒ…å†µï¼šB=z // æœ€ç»ˆçš„æ•ˆæœæ˜¯ï¼š1-&gt;2-&gt;3-&gt;4 z op(op(op(op(z, 1), 2), 3), 4)def foldLeft[B](z: B)(op: (B, A) =&gt; B): B = &#123; var result = z this foreach (x =&gt; result = op(result, x)) result &#125; 12// foldRightçš„åˆ«ådef :\\[B](z: B)(op: (A, B) =&gt; B): B = foldRight(z)(op) 12def foldRight[B](z: B)(op: (A, B) =&gt; B): B = reversed.foldLeft(z)((x, y) =&gt; op(y, x)) 1234567891011121314151617181920// å°†é›†åˆä¸­çš„å…ƒç´ ä»å·¦åˆ°å³çš„æ–½åŠ ä¸€ä¸ªäºŒå€¼æ“ä½œ(op)// è¿”å›ç»“æœç±»å‹æ˜¯é›†åˆå…ƒç´ æœ¬èº«çš„ç±»å‹æˆ–è€…æ˜¯å…¶çˆ¶ç±»å‹// 1-&gt;2-&gt;3-&gt;4 op(op(op(1, 2), 3), 4)// å®è´¨ä¸Šå°±æ˜¯æ²¡æœ‰åˆå§‹å€¼çš„foldLeftdef reduceLeft[B &gt;: A](op: (B, A) =&gt; B): B = &#123; if (isEmpty) throw new UnsupportedOperationException(\"empty.reduceLeft\") var first = true var acc: B = 0.asInstanceOf[B] for (x &lt;- self) &#123; if (first) &#123; acc = x first = false &#125; else acc = op(acc, x) &#125; acc&#125; 123456def reduceRight[B &gt;: A](op: (A, B) =&gt; B): B = &#123; if (isEmpty) throw new UnsupportedOperationException(\"empty.reduceRight\") reversed.reduceLeft[B]((x, y) =&gt; op(y, x))&#125; 123456// é›†åˆä¸ºç©ºçš„æ—¶å€™è¿”å›Noneï¼Œä¸ä¸ºç©ºçš„æ—¶å€™è¿”å›æ‰§è¡Œç»“æœdef reduceLeftOption[B &gt;: A](op: (B, A) =&gt; B): Option[B] = if (isEmpty) None else Some(reduceLeft(op))def reduceRightOption[B &gt;: A](op: (A, B) =&gt; B): Option[B] = if (isEmpty) None else Some(reduceRight(op)) 123def reduce[A1 &gt;: A](op: (A1, A1) =&gt; A1): A1 = reduceLeft(op)def reduceOption[A1 &gt;: A](op: (A1, A1) =&gt; A1): Option[A1] = reduceLeftOption(op) 123def fold[A1 &gt;: A](z: A1)(op: (A1, A1) =&gt; A1): A1 = foldLeft(z)(op)def aggregate[B](z: =&gt;B)(seqop: (B, A) =&gt; B, combop: (B, B) =&gt; B): B = foldLeft(z)(seqop) 123456789// ä½¿ç”¨foldLeftæ¥å®ç°æ±‚å’Œ å¿…é¡»æ˜¯æ•°å­—ç±»å‹çš„å…ƒç´ // z=num.zero// op=num.plusdef sum[B &gt;: A](implicit num: Numeric[B]): B = foldLeft(num.zero)(num.plus)// z=num.one// op=num.timesdef product[B &gt;: A](implicit num: Numeric[B]): B = foldLeft(num.one)(num.times)// è¿™é‡Œä¼šè‡ªåŠ¨å¯»æ‰¾Numericçš„éšå¼è½¬æ¢å¯¹è±¡ï¼Œä½¿ç”¨sunå’Œproductæ—¶åªéœ€è¦ç›´æ¥è°ƒç”¨å³å¯ 12345678910111213141516// è¿™é‡Œçš„op=(x, y) =&gt; if (cmp.lteq(x, y)) x else y// ä¼šè‡ªåŠ¨å»å¯»æ‰¾Orderingçš„éšå¼è½¬æ¢å¯¹è±¡ï¼Œå¦‚æœæ˜¯åŸå§‹å…ƒç´ å°±æ˜¯æ•°å­—ç±»å‹çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªå‚æ•°å¯ä»¥ä¸ç”¨ä¼ ï¼Œä½†æ˜¯å¦‚æœåŸå§‹å…ƒç´ ç±»å‹ä¸æ˜¯æ•°å­—è¿™æ ·å¯æ¯”è¾ƒçš„ç±»å‹ï¼Œé‚£ä¹ˆéœ€è¦è‡ªé¡¶ä¸€ä¸ªOrderingè§„åˆ™ï¼Œä½œä¸ºå‚æ•°ä¼ é€’è¿›æ¥// æˆ–è€…åŸå§‹çš„å…ƒç´ ç±»å‹å®ç°äº†java.util.Comparatoræ¥å£def min[B &gt;: A](implicit cmp: Ordering[B]): A = &#123; if (isEmpty) throw new UnsupportedOperationException(\"empty.min\") reduceLeft((x, y) =&gt; if (cmp.lteq(x, y)) x else y)&#125;def max[B &gt;: A](implicit cmp: Ordering[B]): A = &#123; if (isEmpty) throw new UnsupportedOperationException(\"empty.max\") reduceLeft((x, y) =&gt; if (cmp.gteq(x, y)) x else y)&#125; scala.collection.TraversableLike 1234567891011121314// å¯¹é›†åˆä¸­çš„æ¯ä¸ªå…ƒç´ æ–½åŠ ä¸€ä¸ªfæ“ä½œï¼Œæ•°æ®ç±»å‹å‘ç”Ÿäº†ä»Aåˆ°Bçš„å˜åŒ–ï¼Œ// è¿”å›ç»“æœæ˜¯ä¸€ä¸ªsizeä¸€æ ·çš„é›†åˆï¼Œä½†æ˜¯å…ƒç´ ç±»å‹ä¸ä¸€æ ·// [1,2,3,4] [f(1),f(2),f(3),f(4)]// [[1,2,3],[4,5,6],[7,8]] [f([1,2,3]),f([4,5,6]),f([7,8])]def map[B, That](f: A =&gt; B)(implicit bf: CanBuildFrom[Repr, B, That]): That = &#123; def builder = &#123; val b = bf(repr) b.sizeHint(this) b &#125; val b = builder for (x &lt;- this) b += f(x) b.result&#125; 123456789// åŸç†ä¸mapç±»ä¼¼ï¼Œä½†æ˜¯å¢åŠ äº†ä¸€ä¸ªæ‰å¹³åŒ–çš„å¤„ç†ï¼š// æ•ˆæœå¦‚ä¸‹ï¼š[[1,2,3],[4,5,6],[7,8]] // [f([1,2,3])[0],f([1,2,3])[1],f([1,2,3])[2],f([4,5,6])[0],f([4,5,6])[1],f([4,5,6])[2],f([7,8])[0],f([7,8])[1],f([7,8])[2]]def flatMap[B, That](f: A =&gt; GenTraversableOnce[B])(implicit bf: CanBuildFrom[Repr, B, That]): That = &#123; def builder = bf(repr) val b = builder for (x &lt;- this) b ++= f(x).seq b.result&#125; 123456789// è¿‡æ»¤å‡ºæ¥é›†åˆä¸­å…ƒç´ æ»¡è¶³pæ¡ä»¶çš„å…ƒç´ ï¼Œç»“æœä¸ºä¸€ä¸ªæ–°çš„é›†åˆprivate def filterImpl(p: A =&gt; Boolean, isFlipped: Boolean): Repr = &#123; val b = newBuilder for (x &lt;- this) if (p(x) != isFlipped) b += x b.result &#125;def filter(p: A =&gt; Boolean): Repr = filterImpl(p, isFlipped = false)","categories":[{"name":"Scalaå­¦ä¹ ","slug":"Scalaå­¦ä¹ ","permalink":"https://shang.at/categories/Scalaå­¦ä¹ /"}],"tags":[{"name":"å‡½æ•°å¼ç¼–ç¨‹","slug":"å‡½æ•°å¼ç¼–ç¨‹","permalink":"https://shang.at/tags/å‡½æ•°å¼ç¼–ç¨‹/"}]},{"title":"Scalaå­¦ä¹ -ç¼–ç¨‹Tips","slug":"Scalaå­¦ä¹ -ç¼–ç¨‹Tips","date":"2020-07-27T17:53:33.000Z","updated":"2021-04-11T01:23:52.378Z","comments":true,"path":"post/Scalaå­¦ä¹ -ç¼–ç¨‹Tips/","link":"","permalink":"https://shang.at/post/Scalaå­¦ä¹ -ç¼–ç¨‹Tips/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š å’Œpythonä¸€æ ·ä¸éœ€è¦åˆ†å·ï¼Œä½†æ˜¯å¦‚æœåœ¨ä¸€è¡Œæœ‰å¤šæ¡è¯­å¥ï¼Œåˆ™éœ€è¦åŠ åˆ†å·ã€‚å¦‚ 1val s = \"hello\"; println(s) scalaä¸­çš„Symbol ç¬¦å·ï¼Œå‚è€ƒjava-String-intern åœ¨scalaä¸­å¯ä»¥ä½¿ç”¨&#39;abcè¿™æ ·çš„å½¢å¼åˆ›å»ºä¸€ä¸ªSymbolå¯¹è±¡ï¼Œå®ƒæ˜¯ä½¿ç”¨çš„Scala&#39;s built-in quote mechanism Symbolçš„ä¼˜ç‚¹ï¼š èŠ‚çœå†…å­˜ï¼šåœ¨Scalaä¸­ï¼ŒSymbolç±»å‹çš„å¯¹è±¡æ˜¯è¢«æ‹˜ç¦çš„(interned)ï¼Œä»»æ„çš„åŒåsymbolséƒ½æŒ‡å‘åŒä¸€ä¸ªSymbolå¯¹è±¡ï¼Œé¿å…äº†å› å†—ä½™è€Œé€ æˆçš„å†…å­˜å¼€é”€ã€‚è€Œå¯¹äºStringç±»å‹ï¼Œåªæœ‰ç¼–è¯‘æ—¶ç¡®å®šçš„å­—ç¬¦ä¸²æ˜¯è¢«æ‹˜ç¦çš„(interned)ã€‚Scalaæµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š 12345val s = 'aSymbol//è¾“å‡ºtrueprintln( s == 'aSymbol)//è¾“å‡ºtrueprintln( s == Symbol(\"aSymbol\")) å¿«é€Ÿæ¯”è¾ƒï¼šç”±äºSymbolç±»å‹çš„å¯¹è±¡æ˜¯è¢«æ‹˜ç¦çš„(interned)ï¼Œä»»æ„çš„åŒåsymbolséƒ½æŒ‡å‘åŒä¸€ä¸ªSymbolå¯¹è±¡ï¼Œè€Œä¸åŒåçš„symbolsä¸€å®šæŒ‡å‘ä¸åŒçš„Symbolå¯¹è±¡ï¼Œæ‰€ä»¥symbolså¯¹è±¡ä¹‹é—´å¯ä»¥ä½¿ç”¨æ“ä½œç¬¦==å¿«é€Ÿåœ°è¿›è¡Œç›¸ç­‰æ€§æ¯”è¾ƒï¼Œå¸¸æ•°æ—¶é—´å†…ä¾¿å¯ä»¥å®Œæˆï¼Œè€Œå­—ç¬¦ä¸²çš„equalsæ–¹æ³•éœ€è¦é€ä¸ªå­—ç¬¦æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œæ‰§è¡Œæ—¶é—´å–å†³äºä¸¤ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œé€Ÿåº¦å¾ˆæ…¢ã€‚(å®é™…ä¸Šï¼ŒString.equalsæ–¹æ³•ä¼šå…ˆæ¯”è¾ƒå¼•ç”¨æ˜¯å¦ç›¸åŒï¼Œä½†æ˜¯åœ¨è¿è¡Œæ—¶äº§ç”Ÿçš„å­—ç¬¦ä¸²å¯¹è±¡ï¼Œå¼•ç”¨ä¸€èˆ¬æ˜¯ä¸åŒçš„) æ¯”å¦‚ï¼šSymbolç±»å‹ä¸€èˆ¬ç”¨äºå¿«é€Ÿæ¯”è¾ƒï¼Œä¾‹å¦‚ç”¨äºMapç±»å‹ï¼šMap,æ ¹æ®ä¸€ä¸ªSymbolå¯¹è±¡ï¼Œå¯ä»¥å¿«é€ŸæŸ¥è¯¢ç›¸åº”çš„Data, è€ŒMapçš„æŸ¥è¯¢æ•ˆç‡åˆ™ä½å¾ˆå¤šã€‚ ç›¸è¾ƒäºString.intern()çš„ä¼˜ç‚¹ï¼šåˆ©ç”¨Stringçš„internæ–¹æ³•ä¹Ÿå¯ä»¥å®ç°Mapçš„é”®å€¼å¿«é€Ÿæ¯”è¾ƒï¼Œä½†æ˜¯ç”±äºéœ€è¦æ˜¾å¼åœ°è°ƒç”¨intern()æ–¹æ³•ï¼Œåœ¨ç¼–ç æ—¶ä¼šé€ æˆå¾ˆå¤šçš„éº»çƒ¦ï¼Œè€Œä¸”å¦‚æœå¿˜äº†è°ƒç”¨intern()æ–¹æ³•ï¼Œè¿˜ä¼šé€ æˆéš¾ä»¥å¯»æ‰¾çš„bugã€‚ä»è¿™ä¸ªè§’åº¦çœ‹ï¼ŒScalaçš„Symbolç±»å‹ä¸ä»…æœ‰æ•ˆç‡ä¸Šçš„æå‡ï¼Œè€Œä¸”ä¹Ÿç®€åŒ–äº†ç¼–ç çš„å¤æ‚åº¦ã€‚ scalaä¸­çš„self =&gt;å†™æ³• å…¶ä»–çš„ä¸€äº›æƒ…å†µå‚è€ƒ çœ‹scalaçš„æºç çš„è¯å¾ˆå‘ç°å¾ˆå¤šæºç å¼€å¤´éƒ½æœ‰ä¸€å¥ï¼šself =&gt; ã€‚è¿™å¥ç›¸å½“äºç»™thisèµ·äº†ä¸€ä¸ªåˆ«åä¸ºself 12345678class SparkSession private( @transient val sparkContext: SparkContext, @transient private val existingSharedState: Option[SharedState], @transient private val parentSessionState: Option[SessionState], @transient private[sql] val extensions: SparkSessionExtensions) extends Serializable with Closeable with Logging &#123; self =&gt;// ... &#125; ä½œä¸ºthiså…³é”®å­—çš„åˆ«åï¼Œå¦‚ 1234567891011121314151617181920class Self &#123; self =&gt; //ä»£è¡¨thisæŒ‡é’ˆ ï¼Œä¹Ÿå°±æ˜¯è¯´ self å°± thisçš„åˆ«å // anc =&gt; // ä½œç”¨ä¸self =&gt; ä¸€æ ·ï¼Œåªä¸è¿‡äººä»¬ä¹ æƒ¯äºç”¨self =&gt; çš„å†™æ³• val tmp = \"scala\" def foo: String = self.tmp + this.tmp&#125;// å†…éƒ¨ç±»class Outer &#123; out =&gt; val v1 = \"spark\" class Inner &#123; println(out.v1) // ç”¨outerè¡¨ç¤ºå¤–éƒ¨ç±»ï¼Œç›¸å½“äºOuter.this v1 &#125;&#125; è‡ªèº«ç±»å‹ï¼šæ··å…¥traitï¼Œå¼ºåˆ¶è¦æ±‚ S2çš„å®ç°ç±» å»å®ç° S1ï¼Œå¦‚ï¼š 123456789101112131415trait S1/** * this ä¸èƒ½ç§°å½“åˆ«åï¼Œè¿™é‡Œthis:S1 æ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œå°±æ˜¯è¯´å®ä¾‹åŒ–S2æ—¶ï¼Œè¦æ±‚S1å¿…é¡»æ··å…¥ */class S2 &#123; this: S1 =&gt;&#125; // æ··å…¥trait S1ï¼Œå¼ºåˆ¶è¦æ±‚ S2çš„å®ç°ç±» å»å®ç° S1class S3 extends S2 with S1trait T &#123; this: S1 =&gt;&#125;object S4 extends T with S1 this:S1 =&gt; è¦æ±‚S2åœ¨å®ä¾‹åŒ–æ—¶æˆ–å®šä¹‰S2çš„å­ç±»æ—¶ï¼Œå¿…é¡»æ··å…¥æŒ‡å®šçš„S1 ç±»å‹ï¼Œè¿™ä¸ªXç±»å‹ä¹Ÿå¯ä»¥æŒ‡å®šä¸ºå½“å‰ç±»å‹ è‡ªèº«ç±»å‹çš„å­˜åœ¨ç›¸å½“äºè®©å½“å‰ç±»å˜å¾—æŠ½è±¡äº†ï¼Œå®ƒå‡è®¾å½“å‰å¯¹è±¡(this)ä¹Ÿç¬¦åˆæŒ‡å®šçš„ç±»å‹ï¼Œå› ä¸ºè‡ªèº«ç±»å‹ this:S1 =&gt;çš„å­˜åœ¨ï¼Œå½“å‰ç±»æ„é€ å®ä¾‹æ—¶éœ€è¦åŒæ—¶æ»¡è¶³S1ç±»å‹ scalaä¸­çš„=&gt;ï¼Œå‚è€ƒèµ„æ–™ï¼Œä¾‹å­æ¥è‡ªäºè¿™é‡Œ In a value, it introduces a function literal, or lambda. e.g. the bit inside the curly braces in List(1,2,3).map { (x: Int) =&gt; x * 2 } ç”¨åœ¨å‡½æ•°å£°æ˜ä¸Šï¼šè¿æ¥å‚æ•°å’Œå‡½æ•°ä½“ In a type, with symbols on both sides of the arrow (e.g. A =&gt; T, (A,B) =&gt; T, (A,B,C) =&gt; T, etc.) itâ€™s sugar for Function&lt;n&gt;[A[,B,...],T], that is, a function that takes parameters of type A[,B...], and returns a value of type T. Empty parens on the left hand side (e.g. () =&gt; T) indicate that the function takes no parameters (also sometimes called a â€œthunkâ€); Empty parens on the right hand side denote that it returns ()â€”the sole value of type Unit, whose name can also be written ()â€”confused yet? :) A function that returns Unit is also known as a procedure, normally a method thatâ€™s called only for its side effect. ç”¨åœ¨ç±»å‹å£°æ˜ä¸Šï¼šè¡¨ç¤ºç±»å‹çš„è½¬æ¢ï¼Œä¸€èˆ¬ç”¨æ¥è¡¨ç¤ºå‡½æ•°çš„ç­¾å In the type declaration for a method or function parameter, with no symbol on the left hand side (e.g. def f(param: =&gt; T)) itâ€™s a â€œby-name parameterâ€, meaning that is evaluated every time itâ€™s used within the body of the function, and not before. Ordinary â€œby-valueâ€ parameters are evaluated before entry into the function/method. ç”¨åœ¨ä¼ åå‚æ•°ä¸Šï¼šè¿™ç§ç”¨æ³•å’Œå…¶ä»–ä¸‰ç§éƒ½ä¸ä¸€æ ·ï¼Œæ¯”è¾ƒç‰¹æ®Šï¼Œè®²çš„æ˜¯ ç”¨=&gt;ä¿®é¥°å‡½æ•°å‚æ•°æ—¶ï¼Œæ„å‘³ç€åªæœ‰è¯¥å‚æ•°åœ¨å‡½æ•°ä½“å†…ç¬¬ä¸€æ¬¡è¢«ä½¿ç”¨æ—¶ï¼Œæ‰ä¼šå»è®¡ç®—å®ƒ(lazy initializing)(ä¸”æ¯è¿›å…¥ä¸€æ¬¡å‡½æ•°ä½“å°±ä¼šè¢«è®¡ç®—)ï¼Œä¹Ÿè¢«ç§°ä¸ºä¼ åå‚æ•°(by-name parameters)ã€‚ä¸ä¹‹å¯¹åº”çš„æ˜¯ä¼ å€¼å‚æ•°(by-value parameters)ï¼Œä¼ å€¼å‚æ•°ä¼šè¢«ç«‹åˆ»è®¡ç®—ä¸€æ¬¡ï¼Œä¸”åªä¼šè®¡ç®—ä¸€æ¬¡ã€‚ å¦‚ä¸‹é¢çš„ä¾‹å­ 1234567891011121314151617181920212223object TestFuncParameter &#123; def whileLoop(condition: =&gt; Boolean)(body: =&gt; Unit): Unit = &#123; println(condition) if (condition) &#123; body whileLoop(condition)(body) &#125; &#125; def main(args: Array[String]): Unit = &#123; var i = 2 whileLoop(i &gt; 0) &#123; // body println(i) i -= 1 &#125; &#125;&#125;// prints // true// 2 // false// 1 æ­£å¸¸æƒ…å†µä¸‹ä¼šæ‰“å°ä¸Šé¢å†™åˆ°çš„ç»“æœã€‚å¦‚æœæŠŠcondition: =&gt; Booleanæ”¹æˆcondition: Booleanï¼Œåˆ™ä¼šæ°¸è¿œæ­»å¾ªç¯ä¸‹å»ï¼Œå› ä¸ºconditionæ°¸è¿œéƒ½æ˜¯trueï¼Œå®ƒåªè¢«è®¡ç®—äº†ä¸€æ¬¡ã€‚ å…¶ä¸­(body: =&gt; Unit)å¿…é¡»åŠ =&gt;ä¿®é¥°ï¼Œè¿™é‡ŒbodyæŒ‡å‘çš„æ˜¯{println(i);i-=1}ï¼Œå®ƒæ˜¯ä¸€ä¸ªUnitç±»å‹çš„å˜é‡ï¼Œå¯ä»¥ç†è§£æˆå®ƒæŒ‡å‘äº†ä¸€ä¸ªä»£ç å—ï¼Œä½†æ˜¯ä»–ä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå°±æ˜¯ä¸€ä¸ªå˜é‡ã€‚å†åŠ ä¸Š=&gt;å…³é”®å­—çš„ä¿®é¥°ï¼Œbodyåœ¨whileLoopä¸­ç¬¬ä¸€æ¬¡é‡è§bodyçš„æ—¶å€™ï¼Œå°±ä¼šè®¡ç®—å®ƒä¸€æ¬¡(æ‰§è¡Œä¸€æ¬¡å®ƒæ‰€æŒ‡å‘çš„ä»£ç å—)ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥çœ‹æˆscalaä¸­çš„ä¸€ç§ç‰¹æ®Šçš„è¯­æ³•ç³–ã€‚ åœ¨sparkä¸­å¯ä»¥çœ‹åˆ°è¿™ç§ç”¨æ³•ï¼šrddçš„å‡ ä¹æ‰€æœ‰æ–¹æ³•éƒ½æœ‰withScopeè¿™ä¹ˆä¸€ä¸ªè°ƒç”¨ï¼Œå¦‚ 1234def map[U: ClassTag](f: T =&gt; U): RDD[U] = withScope &#123; val cleanF = sc.clean(f) new MapPartitionsRDD[U, T](this, (context, pid, iter) =&gt; iter.map(cleanF))&#125; withScopeæ˜¯è¿™æ ·å®šä¹‰çš„ï¼š body: =&gt; U 1private[spark] def withScope[U](body: =&gt; U): U = RDDOperationScope.withScope[U](sc)(body) å†æ¥çœ‹ä¸€ä¸‹org.apache.spark.rdd.RDDOperationScope#withScopeçš„å®šä¹‰ï¼š body: =&gt; T 1234private[spark] def withScope[T]( sc: SparkContext, allowNesting: Boolean = false)(body: =&gt; T): T = &#123;&#125; å…³äºbody: =&gt; Unit åšäº†å¦‚ä¸‹çš„æµ‹è¯•ï¼š è¿™çš„Unitæ˜¯æ ¹æ®bodyçš„å…·ä½“ç±»å‹å¯ä»¥æ¨æ–­å‡ºæ¥ï¼ŒbodyæŒ‡å‘äº†ä¸€ä¸ªä»£ç å—ï¼Œè¿™ä¸ªä»£ç å—å¦‚æœæœ‰è¿”å›å€¼ï¼Œé‚£ä¹ˆbodyå°±æ˜¯é‚£ä¸ªè¿”å›çš„ç±»å‹ï¼Œå¦‚æœæ²¡æœ‰è¿”å›å€¼ï¼Œé‚£ä¹ˆbodyå°±æ˜¯Unitç±»å‹ã€‚ä¸Šé¢çš„å†™æ³•å°±æ˜¯æ²¡æœ‰è¿”å›å€¼ï¼Œä¸‹é¢çš„å†™æ³•è¿”å›äº†ä¸€ä¸ªIntç±»å‹çš„å€¼ï¼Œä¸”è¿™ä¸ªå€¼å¯ä»¥åœ¨å‡½æ•°ä½“å†…è‡ªç”±ä½¿ç”¨ï¼Œ=&gt; åˆ™ä½¿åœ¨å‡½æ•°å†…ç¬¬ä¸€æ¬¡è°ƒç”¨çš„æ—¶å€™è¢«è®¡ç®— 12345678910111213141516171819202122232425262728object TestFuncParameter &#123; def whileLoop(condition: =&gt; Boolean)(body: =&gt; Int): Unit = &#123; println(condition) if (condition) &#123; val tmp: Int = body println(\"tmp:\" + tmp) whileLoop(condition)(body) &#125; &#125; def main(args: Array[String]): Unit = &#123; var i: Int = 2 whileLoop(i &gt; 0) &#123; println(i) i -= 1 i &#125; // prints 2 1 &#125;&#125;// true// 2// tmp:1// true// 1// tmp:0// false ä¼ åå‚æ•°çš„ä¼˜ç‚¹ï¼š å¦‚æœå‚æ•°æ˜¯è®¡ç®—å¯†é›†å‹æˆ–é•¿æ—¶é—´è¿è¡Œçš„ä»£ç å—ï¼Œå¦‚è·å– URLèµ„æºï¼Œè¿™ç§å»¶è¿Ÿè®¡ç®—å‚æ•°ç›´åˆ°å®ƒè¢«ä½¿ç”¨æ—¶æ‰è®¡ç®—çš„èƒ½åŠ›å¯ä»¥å¸®åŠ©æé«˜æ€§èƒ½ã€‚ In a case clause, they separate the pattern (and optional guard) from the result expression, e.g. case x =&gt; y. ç”¨åœ¨æ¨¡å¼åŒ¹é…ä¸Šï¼šå¯ä»¥ç†è§£æˆå’Œå‡½æ•°ä¸€æ ·çš„ä½œç”¨ï¼Œç”¨æ¥è¿æ¥æ¨¡å¼å’Œå…·ä½“çš„é€»è¾‘å— é™¤æ­¤ä¹‹å¤–ï¼Œ=&gt;è¿˜æœ‰ä¸€ä¸ªä½¿ç”¨åœºæ™¯ï¼šç”¨åœ¨ç±»çš„å£°æ˜ä¸­ï¼Œç”¨ä½œthisåˆ«åæˆ–è€…è‡ªèº«ç±»å‹(self-type)ï¼Œè¯¦æƒ…è¯·å‚è€ƒä¸Šä¸€æ¡çš„æ€»ç»“","categories":[{"name":"Scalaå­¦ä¹ ","slug":"Scalaå­¦ä¹ ","permalink":"https://shang.at/categories/Scalaå­¦ä¹ /"}],"tags":[{"name":"Scalaç¼–ç¨‹Tips","slug":"Scalaç¼–ç¨‹Tips","permalink":"https://shang.at/tags/Scalaç¼–ç¨‹Tips/"}]},{"title":"Scalaå­¦ä¹ -9-Iteratorè®¾è®¡æ¨¡å¼","slug":"Scalaå­¦ä¹ -9-Iteratorè®¾è®¡æ¨¡å¼","date":"2020-07-26T08:26:23.000Z","updated":"2021-05-13T01:55:05.640Z","comments":true,"path":"post/Scalaå­¦ä¹ -9-Iteratorè®¾è®¡æ¨¡å¼/","link":"","permalink":"https://shang.at/post/Scalaå­¦ä¹ -9-Iteratorè®¾è®¡æ¨¡å¼/","excerpt":"ç®€ä»‹ï¼šIteratorçš„æ•°æ®å¤„ç†æ¨¡å¼è´¯ç©¿äº†å¤§æ•°æ®å¤„ç†æµç¨‹çš„å§‹ç»ˆï¼Œæ˜¯ä¸€ä¸ªéå¸¸å€¼å¾—å€Ÿé‰´çš„è®¾è®¡æ¨¡å¼","text":"ç®€ä»‹ï¼šIteratorçš„æ•°æ®å¤„ç†æ¨¡å¼è´¯ç©¿äº†å¤§æ•°æ®å¤„ç†æµç¨‹çš„å§‹ç»ˆï¼Œæ˜¯ä¸€ä¸ªéå¸¸å€¼å¾—å€Ÿé‰´çš„è®¾è®¡æ¨¡å¼ ç°è±¡ä½¿ç”¨scalaç¼–å†™äº†ä¸€æ®µwordcountçš„ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415object TestIterator &#123; def main(args: Array[String]): Unit = &#123; val listStr = List( \"hello world\", \"hello msb\", \"good idea\" ) val flatMap: List[String] = listStr.flatMap((x: String) =&gt; x.split(\" \")) flatMap.foreach(println) val mapList: List[(String, Int)] = flatMap.map((_, 1)) mapList.foreach(println) &#125;&#125; åˆ†æä¸€ä¸‹ä¸Šé¢ç¨‹åºçš„æ‰§è¡Œè¿‡ç¨‹ï¼š åˆ›å»ºlistStrå¯¹è±¡ listStrè°ƒç”¨flatMapï¼Œä½œç”¨æ˜¯å°†listStrçš„æ¯ä¸ªå…ƒç´ ä½¿ç”¨ç©ºæ ¼åˆ†éš”ï¼Œç„¶ååˆå¹¶æˆä¸€ä¸ªå¤§çš„list ç»§ç»­è°ƒç”¨mapï¼Œå°†æ¯ä¸ªå…ƒç´ è½¬æ¢æˆä¸€ä¸ª[String,Int]çš„äºŒå…ƒç»„ æ‰“å°ç»“æœ ä»¥ä¸Šä»£ç æœ‰ä¸€ä¸ªè‡´å‘½çš„é—®é¢˜ï¼šåœ¨æ•°æ®é‡éå¸¸çš„çš„æ—¶å€™ï¼Œä¼šæ€¥å‰§çš„æ¶ˆè€—å†…å­˜ç©ºé—´ã€‚ä¸ºä»€ä¹ˆï¼Ÿç®€å•åˆ†æä¸‹ï¼šç¬¬ä¸€æ­¥ç©ºé—´å¤æ‚åº¦ä¸ºO(N)ï¼Œç¬¬äºŒæ­¥åˆç”Ÿæˆäº†ä¸€ä¸ªå…¨æ–°çš„List[String]å¯¹è±¡ï¼Œåˆæ˜¯O(N)çš„ç©ºé—´å¤æ‚åº¦ï¼Œç¬¬ä¸‰æ­¥ä¸­åˆç”Ÿæˆäº†ä¸€ä¸ªList[(String,Int)]å¯¹è±¡ï¼Œç©ºé—´å¤æ‚åº¦ä¾ç„¶æ˜¯O(N)ã€‚é€šè¿‡åˆ†æå¯çŸ¥ï¼Œåœ¨æ•°æ®ç»Ÿè®¡çš„è¿‡ç¨‹ä¸­ï¼Œè²Œä¼¼å¹¶æ²¡æœ‰å¿…è¦å°†ä¸­é—´è¿‡ç¨‹çš„æ•°æ®å­˜å‚¨ä¸‹æ¥ï¼Œä¸ä½†å ç”¨ç©ºé—´ï¼Œè¿˜æ²¡æœ‰ä»»ä½•ç”¨å¤„ã€‚ äºæ˜¯ï¼Œæˆ‘ä»¬æƒ³åˆ°äº†ä¸€ç§è®¾è®¡æ¨¡å¼-è¿­ä»£å™¨æ¨¡å¼ã€‚è¿­ä»£å™¨æ¨¡å¼åœ¨å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªæŒ‡é’ˆï¼Œå®é™…ä¸Šå¹¶ä¸ä¼šå­˜å‚¨æ•°æ®ï¼Œåœ¨éå†æ•°æ®é›†çš„æ—¶å€™ï¼Œä¸æ–­çš„æ¶ˆè€—å½“å‰æŒ‡é’ˆã€‚ ç°åœ¨å¼€å§‹å¤ä¹ ä¸€ä¸‹è¿­ä»£å™¨æ¨¡å¼è¿­ä»£å™¨ä¸€å®šæœ‰ä¸¤ä¸ªæ–¹æ³•ï¼š 12345public interface Iterator&lt;E&gt; &#123; //Element E //Type T //Key K //Value V boolean hasNext(); // æ˜¯å¦è¿˜æœ‰ä¸‹ä¸€ä¸ªå…ƒç´  E next(); // è·å–ä¸‹ä¸€ä¸ªå…ƒç´ &#125; é›†åˆç±»ä¸€å®šæœ‰ä¸€ä¸ªè¿”å›è¿­ä»£å™¨çš„å‡½æ•° 123456public interface Collection&lt;E&gt; &#123; void add(E o); int size(); Iterator iterator();&#125; å…·ä½“çš„é›†åˆç±»å®ç°Collectionæ¥å£ 1234567891011121314151617181920212223242526272829303132333435363738394041class ArrayList&lt;E&gt; implements Collection&lt;E&gt; &#123; E[] objects = (E[]) new Object[10]; private int index = 0; public void add(E o) &#123; if (index == objects.length) &#123; E[] newObjects = (E[]) new Object[objects.length * 2]; System.arraycopy(objects, 0, newObjects, 0, objects.length); objects = newObjects; &#125; objects[index] = o; index++; &#125; public int size() &#123; return index; &#125; @Override public Iterator&lt;E&gt; iterator() &#123; return new ArrayListIterator(); &#125; private class ArrayListIterator&lt;E&gt; implements Iterator&lt;E&gt; &#123; private int currentIndex = 0; @Override public boolean hasNext() &#123; if (currentIndex &gt;= index) return false; return true; &#125; @Override public E next() &#123; E o = (E) objects[currentIndex]; currentIndex++; return o; &#125; &#125;&#125; å¯ä»¥å‘ç°ï¼Œè¿­ä»£å™¨ä¸­ä¸ä¼šå­˜æ•°æ®ï¼Œåªæ˜¯ä¿å­˜äº†ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘å½“å‰éå†åˆ°äº†å“ªä¸€ä¸ªç´¢å¼•ï¼Œåªæœ‰çœŸæ­£å¼€å§‹éå†çš„æ—¶å€™ï¼ŒæŒ‡é’ˆæ‰ä¼šå¼€å§‹ç§»åŠ¨ï¼Œå¹¶ä¸”æ²¡æœ‰å›é€€çš„æ–¹æ³•ï¼Œå³è¿­ä»£å™¨åªèƒ½éå†ä¸€æ¬¡(å¦æœ‰è®¾è®¡çš„é™¤å¤–)ã€‚ è§£å†³æ–¹æ¡ˆä½¿ç”¨è¿­ä»£å™¨å®ç°ä¸Šé¢çš„åŠŸèƒ½ 123456789101112131415161718192021object TestIterator &#123; def main(args: Array[String]): Unit = &#123; val listStr = List( \"hello world\", \"hello msb\", \"good idea\" ) val iter: Iterator[String] = listStr.iterator //ä»€ä¹ˆæ˜¯è¿­ä»£å™¨ï¼Œä¸ºä»€ä¹ˆä¼šæœ‰è¿­ä»£å™¨æ¨¡å¼ï¼Ÿ è¿­ä»£å™¨é‡Œä¸å­˜æ•°æ®ï¼ val iterFlatMap = iter.flatMap((x: String) =&gt; x.split(\" \")) // iterFlatMap.foreach(println) // ä¸­é€”ä¸èƒ½æ‰“å°ï¼Œå¦åˆ™åç»­å°±è¯»å–ä¸åˆ°æ•°æ®äº† val iterMapList = iterFlatMap.map((_, 1)) while (iterMapList.hasNext) &#123; val tuple: (String, Int) = iterMapList.next() println(tuple) &#125; //1.listStrçœŸæ­£çš„æ•°æ®é›†ï¼Œæœ‰æ•°æ®çš„ //2.iter.flatMap æ²¡æœ‰å‘ç”Ÿè®¡ç®—ï¼Œè¿”å›äº†ä¸€ä¸ªæ–°çš„è¿­ä»£å™¨ &#125;&#125; åˆ†æï¼šåŸºäºè¿­ä»£å™¨çš„æ–¹æ¡ˆä¸­ï¼Œé™¤äº†listSträ¸­å­˜å‚¨äº†æ•°æ®ï¼Œä¸­é—´çš„è¿‡ç¨‹ä¸­åªæœ‰è®¡ç®—é€»è¾‘æ²¡æœ‰å­˜å‚¨æ•°æ®(faltMapä¼šæœ‰ä¸€ç‚¹å°‘å°‘çš„æ•°æ®ç¼“å†²å­˜å‚¨)ã€‚è¿™å’Œsparkä¸­çš„ç®—å­çš„æ€æƒ³ä¸€æ ·å•Šï¼Œä¹Ÿå¯ä»¥è¯´sparkæ˜¯å€Ÿé‰´äº†è¿­ä»£å™¨çš„ç¼–ç¨‹æ¨¡å¼ã€‚ Sparkçš„transformationç®—å­ï¼šç±»æ¯”è¿™é‡Œçš„flatMap/map Sparkçš„actionç®—å­ï¼šç±»æ¯”è¿™é‡Œçš„foreach å…³äºscalaä¸­flatMapã€mapã€foreachçš„è¿‡ç¨‹åˆ†æ iter = listStr.iterator 12345678def iterator: Iterator[A] = new AbstractIterator[A] &#123; var these = self def hasNext: Boolean = !these.isEmpty def next(): A = if (hasNext) &#123; val result = these.head; these = these.tail; result &#125; else Iterator.empty.next()&#125; iteratorè¿”å›çš„æ˜¯ä¸€ä¸ªAbstractIteratorå¯¹è±¡ï¼Œé‡å†™äº†hasNextå’Œnextå‡½æ•°ï¼š hasNextï¼šè°ƒç”¨listStrçš„isEmptyæ–¹æ³•ï¼Œå¦‚æœä¸ºç©ºåˆ™è¿”å›false nextï¼š å…ˆæ£€æµ‹æ˜¯å¦æœ‰å…ƒç´ ï¼Œæœ‰çš„è¯è¿”å›listStrçš„å¤´ç»“ç‚¹ï¼Œå¹¶ä¸”ç§»åŠ¨theseåˆ°å‰©ä½™éƒ¨åˆ†çš„å¤´éƒ¨ï¼› å¦åˆ™è¿”å›ç©ºã€‚æŒ‰ç†è¯´ä¸ä¼šä¸ºç©ºï¼Œå› ä¸ºéƒ½æ˜¯å…ˆåˆ¤æ–­äº†hasNextä¸ºtrueæ‰ä¼šè°ƒç”¨next iterFlatMap = iter.flatMap((x:String) =&gt; x.split(â€œ â€œ)) 1234567891011121314def flatMap[B](f: A =&gt; GenTraversableOnce[B]): Iterator[B] = new AbstractIterator[B] &#123; private var cur: Iterator[B] = empty private def nextCur() &#123; cur = f(self.next()).toIterator &#125; def hasNext: Boolean = &#123; // Equivalent to cur.hasNext || self.hasNext &amp;&amp; &#123; nextCur(); hasNext &#125; // but slightly shorter bytecode (better JVM inlining!) while (!cur.hasNext) &#123; if (!self.hasNext) return false nextCur() &#125; true &#125; def next(): B = (if (hasNext) cur else empty).next()&#125; flatMapè¿”å›çš„ä¹Ÿæ˜¯ä¸€ä¸ªAbstractIteratorï¼Œä¹Ÿé‡å†™äº†hasNextå’Œnextå‡½æ•°ï¼š å®ƒåœ¨è¿™é‡Œç»´æŠ¤äº†ä¸€ä¸ªcurçš„å°è¿­ä»£å™¨ï¼Œä¹‹æ‰€ä»¥è¯´å°ï¼Œæ˜¯å› ä¸ºå®ƒä¼šç¼“å­˜ä¸Šä¸€ä¸ªè°ƒç”¨èŠ‚ç‚¹çš„ä¸€æ¡è®°å½•ç»è¿‡få¤„ç†ä¹‹åçš„ç»“æœ hasNextï¼šé‡ç‚¹çœ‹è¿™ä¸ªå‡½æ•° è¿™é‡Œä¼šå…ˆåˆ¤æ–­curæ˜¯å¦æœ‰å…ƒç´ ï¼Œæœ‰çš„è¯ç›´æ¥è¿”å›trueï¼› å¦åˆ™çš„è¯ï¼Œè°ƒç”¨çˆ¶ç±»çš„hasNextï¼Œåˆ¤æ–­æ˜¯å¦è¿˜æœ‰å€¼ï¼Œæ²¡æœ‰çš„è¯ï¼Œè¿”å›falseï¼› å¦åˆ™çš„è¯è°ƒç”¨çˆ¶ç±»çš„nextè·å–ä¸€æ¡æ–°çš„è®°å½•ï¼Œå¹¶äº¤ç»™å¤„ç†å‡½æ•°få¤„ç†ï¼Œå¤„ç†å®Œä¹‹åäº¤ç»™curç¼“å­˜èµ·æ¥ nextï¼šå¦‚æœæœ‰å€¼ï¼Œåˆ™ç›´æ¥ä»curä¸­å–å€¼ï¼Œè€Œä¸”æ°¸è¿œéƒ½åªä»curä¸­å–å€¼ iterMapList = iterFlatMap.map((_, 1)) 1234def map[B](f: A =&gt; B): Iterator[B] = new AbstractIterator[B] &#123; def hasNext = self.hasNext def next() = f(self.next())&#125; mapè¿”å›çš„ä¹Ÿæ˜¯ä¸€ä¸ªAbstractIteratorï¼Œä¹Ÿé‡å†™äº†hasNextå’Œnextå‡½æ•°ï¼Œä¸è¿‡ä»–è¿™é‡Œçš„é€»è¾‘æ¯”è¾ƒç®€å•äº†ï¼Œå› ä¸ºmapåªæ˜¯å®Œæˆäº†ä¸€ä¸ªæ˜ å°„çš„è¿‡ç¨‹ iterMapList.foreach(println) æ‰“å°æ”¶å·¥ã€‚","categories":[{"name":"Scalaå­¦ä¹ ","slug":"Scalaå­¦ä¹ ","permalink":"https://shang.at/categories/Scalaå­¦ä¹ /"}],"tags":[{"name":"Scala-Iteratorè®¾è®¡æ¨¡å¼","slug":"Scala-Iteratorè®¾è®¡æ¨¡å¼","permalink":"https://shang.at/tags/Scala-Iteratorè®¾è®¡æ¨¡å¼/"}]},{"title":"Scalaå­¦ä¹ -éšå¼è½¬æ¢","slug":"Scalaå­¦ä¹ -8-éšå¼è½¬æ¢","date":"2020-07-26T08:21:03.000Z","updated":"2021-04-10T23:21:32.090Z","comments":true,"path":"post/Scalaå­¦ä¹ -8-éšå¼è½¬æ¢/","link":"","permalink":"https://shang.at/post/Scalaå­¦ä¹ -8-éšå¼è½¬æ¢/","excerpt":"ç®€ä»‹ï¼šä¸€ä¸ªä»ç±»å‹ S åˆ°ç±»å‹ T çš„éšå¼è½¬æ¢ç”±ä¸€ä¸ªå‡½æ•°ç±»å‹ S =&gt; T çš„éšå¼å€¼æ¥å®šä¹‰ï¼Œæˆ–è€…ç”±ä¸€ä¸ªå¯è½¬æ¢æˆæ‰€éœ€å€¼çš„éšå¼æ–¹æ³•æ¥å®šä¹‰ã€‚ éšå¼è½¬æ¢æ˜¯scalaä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„ç‰¹æ€§ï¼Œä½†åŒæ—¶ä¹Ÿæ˜¯æŒºéš¾ç†è§£çš„ä¸€ä¸ªç‰¹æ€§ã€‚ éšå¼è½¬æ¢ä½¿ç”¨ä¸å½“å°†ä¼šå¯¼è‡´å¾ˆéš¾æ£€æŸ¥çš„bug","text":"ç®€ä»‹ï¼šä¸€ä¸ªä»ç±»å‹ S åˆ°ç±»å‹ T çš„éšå¼è½¬æ¢ç”±ä¸€ä¸ªå‡½æ•°ç±»å‹ S =&gt; T çš„éšå¼å€¼æ¥å®šä¹‰ï¼Œæˆ–è€…ç”±ä¸€ä¸ªå¯è½¬æ¢æˆæ‰€éœ€å€¼çš„éšå¼æ–¹æ³•æ¥å®šä¹‰ã€‚ éšå¼è½¬æ¢æ˜¯scalaä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„ç‰¹æ€§ï¼Œä½†åŒæ—¶ä¹Ÿæ˜¯æŒºéš¾ç†è§£çš„ä¸€ä¸ªç‰¹æ€§ã€‚ éšå¼è½¬æ¢ä½¿ç”¨ä¸å½“å°†ä¼šå¯¼è‡´å¾ˆéš¾æ£€æŸ¥çš„bug ç°è±¡ä¾‹å¦‚åœ¨scalaé¡¹ç›®ä½¿ç”¨åˆ›å»ºäº†ä¸€ä¸ªLinkedListå¯¹è±¡ï¼Œæˆ‘ä»¬æƒ³è¦å¯¹è¯¥å¯¹è±¡è°ƒç”¨foreachæ–¹æ³•ï¼Œä½†æ˜¯å´å‘ç°è°ƒç”¨çš„æ—¶å€™ä¼šæŠ¥é”™ï¼Œå› ä¸ºå®ƒæ²¡æœ‰è¯¥æ–¹æ³• 12345678import java.utilobject TestImplicit &#123; def main(args: Array[String]): Unit = &#123; val list = new util.LinkedList[Int]() list.foreach(println) // è¿™é‡Œä¼šæŠ¥ï¼šCannot resolve symbol foreach &#125;&#125; é‚£ä¹ˆæˆ‘ä»¬åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿå®é™…ä¸Šæˆ‘ä»¬å¯ä»¥æœ‰ä»¥ä¸‹å‡ ç§è§£å†³æ–¹æ¡ˆ ä¸éœ€è¦ä¿®æ”¹LinkedListçš„æºä»£ç (ä¹Ÿä¿®æ”¹ä¸äº†) è§£å†³æ–¹æ¡ˆåˆ†æä¸€ä¸‹list.foreach(println)ï¼Œå‘ç°è¿™ä¸€å¥ä¸­åŒ…å«äº†ä¸‰ä¸ªå†…å®¹ï¼šæ•°æ®é›†listã€éå†è¡Œä¸ºforeachã€å¤„ç†å‡½æ•°printlnï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦é€šè¿‡æŸç§æ–¹æ¡ˆå°†è¿™ä¸‰ä¸ªå…ƒç´ ç»„è£…å¥½å°±å¯ä»¥äº† æ–¹æ¡ˆä¸€å®šä¹‰ä¸€ä¸ªforeachå‡½æ•°å¸®åŠ©å®Œæˆéå† 123456789101112131415161718object TestImplicit &#123; def main(args: Array[String]): Unit = &#123; val list = new util.LinkedList[Int]() list.add(3) list.add(4) list.add(5) // list.foreach(println) def foreach[T](list: util.LinkedList[T], f: (T) =&gt; Unit): Unit = &#123; val iter: util.Iterator[T] = list.iterator() while (iter.hasNext) f(iter.next()) &#125; foreach(list, println) &#125;&#125; æ–¹æ¡ˆäºŒé€šè¿‡æ–¹æ¡ˆä¸€çœ‹ä¼¼å¯ä»¥æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸æƒ³é€šè¿‡æŠŠlistå½“åšforeachçš„å‚æ•°æ¥å®Œæˆéå†ï¼Œæˆ‘ä»¬å°±æƒ³é€šè¿‡è°ƒç”¨obj.foreachçš„å½¢å¼æ¥å®Œæˆè¿™ä¸ªæ“ä½œã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡å®šä¹‰ä¸€ä¸ªclassæ¥åŒ…è£…ä¸‹listå¯¹è±¡ï¼Œå³åœ¨æ–°å®šä¹‰çš„classä¸­æä¾›foreachçš„æ–¹æ³•è°ƒç”¨ï¼Œç„¶åæœ‰ä¸€ä¸ªlistçš„å±æ€§ï¼Œé‚£ä¹ˆå°±å¯ä»¥è¿™æ ·åš 123456789101112131415161718class XXX[T](list: util.LinkedList[T]) &#123; def foreach(f: (T) =&gt; Unit): Unit = &#123; val iter: util.Iterator[T] = list.iterator() while (iter.hasNext) f(iter.next()) &#125;&#125;object TestImplicit &#123; def main(args: Array[String]): Unit = &#123; val list = new util.LinkedList[Int]() list.add(3) list.add(4) list.add(5) val xx = new XXX(list) xx.foreach(println) &#125;&#125; æ–¹æ¡ˆä¸‰æ–¹æ¡ˆäºŒä¸­é€šè¿‡ä¸€ä¸ªæ–°çš„classåšåˆ°äº†ç±»ä¼¼obj.foreachçš„è°ƒç”¨å½¢å¼ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜ä¸æ»¡è¶³ï¼Œæˆ‘ä»¬ä¸æƒ³ç”¨å…¶ä»–çš„å¯¹è±¡æ¥è°ƒç”¨foreachï¼Œå°±æ˜¯æƒ³ç›´æ¥list.foreachï¼Œç”¨listå¯¹è±¡æœ¬èº«ç›´æ¥è°ƒç”¨ï¼Œé‚£è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿé¦–å…ˆåœ¨åŸå§‹çš„LinkedListç±»ä¸­æ˜¯æ²¡æœ‰foreachæ–¹æ³•çš„ï¼Œæˆ‘ä»¬åˆä¸èƒ½å»ä¿®æ”¹LinkedListçš„æºç ã€‚å®é™…ä¸Šåœ¨scalaä¸­ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§æ›´åŠ æ–¹ä¾¿å¿«æ·çš„æ–¹æ¡ˆï¼Œå¯ä»¥åœ¨ä¸ä¾µå…¥æºç çš„æƒ…å†µä¸‹ï¼Œç»™ä¸€ä¸ªå¯¹è±¡èµ‹äºˆæ–°çš„æ–¹æ³•ã€‚é‚£å°±æ˜¯éšå¼è½¬æ¢(implicit)ï¼Œå®é™…ä¸Šscalaä¸­çš„éšå¼è½¬æ¢åœ¨æŸç§ç¨‹åº¦ä¸Šä¸æˆ‘ä»¬ä¸Šé¢çš„ä¸¤ç§æ–¹æ¡ˆæœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ï¼Œä½†æ˜¯å®ƒåœ¨ç¼–è¯‘å™¨å±‚é¢åšäº†ä¼˜åŒ–ï¼Œæ˜¯è¯­è¨€å±‚é¢çš„æ”¯æŒï¼Œå³æˆ‘ä»¬å¯ä»¥é€šè¿‡implicitå…³é”®å­—ç›´æ¥å‘Šè¯‰ç¼–è¯‘å™¨ï¼šæˆ‘è¿™ä¸ªå¯¹è±¡ä¸å­˜åœ¨å½“å‰æˆ‘è¦è°ƒç”¨çš„æ–¹æ³•ï¼Œä½†æ˜¯æˆ‘æœ‰åœ¨å…¶ä»–åœ°æ–¹å®šä¹‰äº†ä¸€ä¸ªæ–¹æ³•è½¬æ¢ï¼Œå¯ä»¥è®©æˆ‘æ‹¥æœ‰è¿™ä¸ªæ–¹æ³•ã€‚ 1234567891011121314151617181920212223object TestImplicit &#123; def main(args: Array[String]): Unit = &#123; val list = new util.LinkedList[Int]() list.add(3) list.add(4) list.add(5) //éšå¼è½¬æ¢ï¼š éšå¼è½¬æ¢æ–¹æ³•:æ¥å—ä¸€ä¸ªç±»å‹ï¼Œè¿”å›å¦å¤–ä¸€ä¸ªåŒ…å«ç‰¹å®šæ–¹æ³•çš„ç±»å‹ implicit def sdfsdf[T](list: util.LinkedList[T]) = &#123; new XXX(list) &#125; list.foreach(println) &#125;&#125;class XXX[T](list: util.LinkedList[T]) &#123; def foreach(f: (T) =&gt; Unit): Unit = &#123; val iter: util.Iterator[T] = list.iterator() while (iter.hasNext) f(iter.next()) &#125;&#125; ä½ å¯ä»¥å‘ç°æˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªæ–°çš„å…³é”®å­—implicitï¼Œå®ƒä¿®é¥°äº†ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”æˆ‘ä»¬æ–°åˆ›å»ºçš„è¿™ä¸ªå‡½æ•°ï¼Œå®ƒçš„åå­—å¾ˆç‰¹æ®Šï¼Œåªæ˜¯ä¸€ä¸ªä¹±å†™çš„å­—ç¬¦ä¸²ï¼Œä¹Ÿè®¸ä½ å¯ä»¥çŒœå‡ºæ¥äº†ï¼Œè¿™ä¸ªå‡½æ•°çš„åå­—å¯¹æˆ‘ä»¬æ¥è¯´æ²¡æœ‰ç”¨å¤„ï¼Œå¯¹çš„ï¼Œåœ¨scalaä¸­çš„éšå¼è½¬æ¢åªå…³å¿ƒç±»å‹ï¼Œå¹¶ä¸å…³å¿ƒåç§°ã€‚ä½†æ˜¯åœ¨å®é™…åº”ç”¨ä¸­ä¸€å®šä¸è¦å¦‚æ­¤éšä¾¿çš„å‘½åï¼Œè¿™é‡Œåªæ˜¯åšæ¼”ç¤ºã€‚ implicitå…³é”®å­—å¦‚æ³¨é‡Šä¸­è¯´çš„é‚£æ ·ï¼šæ¥å—ä¸€ä¸ªç±»å‹ï¼Œè¿”å›å¦ä¸€ä¸ªåŒ…å«ç‰¹å®šæ–¹æ³•çš„ç±»å‹ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸éœ€è¦ä½¿ç”¨æ–°çš„ç±»å‹å¯¹è±¡æ¥è°ƒç”¨foreachï¼Œè¿™æ˜¯å› ä¸ºscalaåœ¨ç¼–è¯‘çš„é˜¶æ®µå¸®æˆ‘ä»¬åšäº†æ”¹å†™ï¼Œå…¶æ‰§è¡Œè¿‡ç¨‹å¤§è‡´å¦‚ä¸‹ï¼š scalaç¼–è¯‘å™¨å‘ç°listå¯¹è±¡å¹¶æ²¡æœ‰foreachæ–¹æ³• ä½†æ˜¯å¹¶ä¸ä¼šç«‹é©¬æŠ¥é”™ å®ƒå›å»å¯»æ‰¾æœ‰æ²¡æœ‰implicitå®šä¹‰çš„æ–¹æ³•ï¼Œä¸”æ–¹æ³•çš„å‚æ•°æ­£å¥½æ˜¯listå¯¹è±¡å¯¹åº”çš„ç±»å‹ å¦‚æœæ‰¾åˆ°äº†ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç¼–è¯‘é€šè¿‡ï¼›å¦åˆ™å°±ä¼šæŠ¥é”™ æ€»è€Œè¨€ä¹‹ï¼Œscalaç¼–è¯‘å™¨å¸®åŠ©æˆ‘ä»¬å®Œæˆäº†listç±»å‹çš„è½¬æ¢ï¼Œä¹Ÿå¯ä»¥ç†è§£æˆç¼–è¯‘å™¨å¸®æˆ‘ä»¬æŠŠä»£ç æ”¹å†™äº†ï¼Œä½†æ˜¯è¿™ä¸€æ­¥éª¤æ˜¯æˆ‘ä»¬æ‰€çœ‹ä¸åˆ°ï¼Œæ‰€ä»¥è¯´æ˜¯éšå¼çš„(ä¸ªäººè¿™ä¹ˆç†è§£) æ–¹æ¡ˆä¸‰ä»‹ç»çš„åªæ˜¯scalaçš„ä¸€ç§éšå¼è½¬æ¢ï¼šéšå¼è½¬æ¢æ–¹æ³• é™¤æ­¤ä¹‹å¤–ï¼Œscalaä¸­è¿˜æœ‰å…¶ä»–éšå¼è½¬æ¢å½¢å¼ï¼šéšå¼è½¬æ¢ç±»ã€éšå¼è½¬æ¢å‚æ•° éšå¼è½¬æ¢ç±»12345678910111213141516171819object TestImplicit &#123; //éšå¼è½¬æ¢ç±» implicit class KKK[T](list: util.LinkedList[T]) &#123; def foreach(f: (T) =&gt; Unit): Unit = &#123; val iter: util.Iterator[T] = list.iterator() while (iter.hasNext) f(iter.next()) &#125; &#125; def main(args: Array[String]): Unit = &#123; val list = new util.LinkedList[Int]() list.add(3) list.add(4) list.add(5) list.foreach(println) &#125;&#125; æ³¨ï¼šè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼šimplicitåªèƒ½ç”¨åœ¨ç±»å†…éƒ¨æˆ–è€…å‡½æ•°å†…éƒ¨ï¼Œä¸èƒ½ä½¿ç”¨åœ¨top-levelçš„objectsä¸Šã€‚å¦åˆ™ä¼šæŠ¥å¦‚ä¸‹çš„é”™è¯¯&#39;implicit&#39; modifier cannot be used for top-level objects éšå¼è½¬æ¢å‚æ•°æœ€åè¿™ä¸€ç§éšå¼è½¬æ¢çš„å½¢å¼å®é™…ä¸Šå¯¹è¿™ä¸ªä¾‹å­æ²¡æœ‰ä½œç”¨ï¼Œä»–æ˜¯åœ¨å¦å¤–ä¸€äº›ä½¿ç”¨åœºæ™¯æœ‰ä½¿ç”¨ æ–¹æ³•å¯ä»¥å…·æœ‰ éšå¼ å‚æ•°åˆ—è¡¨ï¼Œç”±å‚æ•°åˆ—è¡¨å¼€å¤´çš„ implicit å…³é”®å­—æ ‡è®°ã€‚ å¦‚æœå‚æ•°åˆ—è¡¨ä¸­çš„å‚æ•°æ²¡æœ‰åƒå¾€å¸¸ä¸€æ ·ä¼ é€’ï¼Œ Scala å°†æŸ¥çœ‹å®ƒæ˜¯å¦å¯ä»¥è·å¾—æ­£ç¡®ç±»å‹çš„éšå¼å€¼ï¼Œå¦‚æœå¯ä»¥ï¼Œåˆ™è‡ªåŠ¨ä¼ é€’ã€‚ implicitå¦‚æœå‡ºç°åœ¨å‡½æ•°çš„å‚æ•°åˆ—è¡¨ä¸­ï¼Œå¦‚def func(implicit name:String)ï¼Œé‚£ä¹ˆè¡¨ç¤ºåœ¨è°ƒç”¨funcå‡½æ•°çš„æ—¶å€™ï¼Œnameå‚æ•°å¯ä»¥ä¸ä¼ ï¼Œä¹Ÿå¯ä»¥ä¼ ã€‚ä¼ ä¸ä¸ä¼ çš„åŒºåˆ«å¦‚ä¸‹ï¼š ä¼ ï¼šé‚£ä¹ˆç›´æ¥ä½¿ç”¨ä¼ é€’çš„å‚æ•°ï¼Œå’Œæ™®é€šçš„å‡½æ•°æ²¡æœ‰ä»»ä½•åŒºåˆ« ä¸ä¼ ï¼šè¿™ç§æƒ…å†µä¸‹ï¼Œå¿…é¡»å­˜åœ¨ä¸€ä¸ªéšå¼çš„Stringç±»å‹çš„å˜é‡è¢«å£°æ˜ï¼Œå¦åˆ™ä¼šç¼–è¯‘æŠ¥é”™ ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š 12345678910111213object TestImplicit &#123; def main(args: Array[String]): Unit = &#123; implicit val str: String = \"lisi\" def func(implicit name: String): Unit = &#123; println(name) &#125; func // æ‰“å° lisi func(\"zhangsan\") // æ‰“å° zhangsan &#125;&#125; éšå¼è½¬æ¢å‚æ•°ä½¿ç”¨çš„æ—¶å€™éœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ å¦‚æœå‚æ•°åˆ—è¡¨ä¸­æœ‰implicitï¼Œé‚£ä¹ˆæ‰€æœ‰çš„å‚æ•°è¦ä¹ˆéƒ½ä¼ è¦ä¹ˆéƒ½å®šä¹‰éšå¼è½¬æ¢å˜é‡ 123def func(implicit name: String, age: Int): Unit = &#123; println(name)&#125; åŒä¸€ç§ç±»å‹çš„éšç§è½¬æ¢å˜é‡åªèƒ½å®šä¹‰ä¸€ä¸ªï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼Œä¾‹å¦‚ä¸‹é¢å®šä¹‰äº†ä¸¤ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„éšå¼å˜é‡ 12345678implicit val a:String = \"wangwu\"implicit val b:String = \"lisi\"// ç”Ÿå‘½æœŸé—´ä¸ä¼šæŠ¥é”™ï¼Œä½†æ˜¯ä»£ç æ‰§è¡ŒæœŸé—´ï¼Œç³»ç»Ÿå¯»æ‰¾éšå¼è½¬æ¢çš„æ—¶å€™ä¼šæŠ¥é”™ï¼Œå¦‚ä¸‹&lt;console&gt;:15: error: ambiguous implicit values: both value a of type =&gt; String and value b of type =&gt; String match expected type String å¦‚æœæœ‰äº›å‚æ•°æœ‰éšå¼è½¬æ¢å˜é‡å®šä¹‰ï¼Œä½†æ˜¯å…¶ä»–çš„å‚æ•°ä¸éœ€è¦å®šä¹‰ï¼Œè¯¥å¦‚ä½•è§£å†³å‘¢ï¼Ÿ è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨scalaçš„å‡½æ•°æŸ¯é‡ŒåŒ–(CURRYING)ç‰¹æ€§ 123456implicit val a:String = \"123\"def func(age: Int)(implicit name: String): Unit = &#123; println(name + \" \" + age)&#125;func(66)(\"jkljkl\") // jkljkl 66func(66) // 123 66 éšå¼è½¬æ¢çš„ä½œç”¨åŸŸStackOverFlow éšå¼è½¬æ¢æœ¬èº«æ˜¯ä¸€ç§ä»£ç æŸ¥æ‰¾æœºåˆ¶ï¼Œæ‰€ä»¥ä¸‹é¢ä¼šä»‹ç»éšå¼è½¬æ¢çš„æŸ¥æ‰¾èŒƒå›´ï¼š -å½“å‰ä»£ç ä½œç”¨åŸŸã€‚æœ€ç›´æ¥çš„å°±æ˜¯éšå¼å®šä¹‰å’Œå½“å‰ä»£ç å¤„åœ¨åŒä¸€ä½œç”¨åŸŸä¸­ã€‚ -å½“ç¬¬ä¸€ç§è§£ææ–¹å¼æ²¡æœ‰æ‰¾åˆ°åˆé€‚çš„éšå¼è½¬æ¢æ—¶ï¼Œç¼–è¯‘å™¨ä¼šç»§ç»­åœ¨éšå¼å‚æ•°ç±»å‹çš„éšå¼ä½œç”¨åŸŸé‡ŒæŸ¥æ‰¾ã€‚ä¸€ä¸ªç±»å‹çš„éšå¼ä½œç”¨åŸŸæŒ‡çš„æ˜¯ä¸è¯¥ç±»å‹ç›¸å…³è”çš„æ‰€æœ‰çš„ä¼´ç”Ÿå¯¹è±¡ã€‚ å¯¹äºä¸€ä¸ªç±»å‹Tå®ƒçš„éšå¼æœç´¢åŒºåŸŸåŒ…æ‹¬å¦‚ä¸‹ï¼š -å‡å¦‚Tæ˜¯è¿™æ ·å®šä¹‰çš„ï¼šT extends A with B with Cï¼Œé‚£ä¹ˆA, B, Cçš„ä¼´ç”Ÿå¯¹è±¡éƒ½æ˜¯Tçš„æœç´¢åŒºåŸŸã€‚ -å¦‚æœTæ˜¯ç±»å‹å‚æ•°ï¼Œé‚£ä¹ˆå‚æ•°ç±»å‹å’ŒåŸºç¡€ç±»å‹éƒ½æ˜¯Tçš„æœç´¢éƒ¨åˆ†ã€‚æ¯”å¦‚å¯¹äºç±»å‹List[Foo]ï¼ŒListå’ŒFooéƒ½æ˜¯æœç´¢åŒºåŸŸ -å¦‚æœTæ˜¯ä¸€ä¸ªå•ä¾‹ç±»å‹p.Tï¼Œé‚£ä¹ˆpå’ŒTéƒ½æ˜¯æœç´¢åŒºåŸŸã€‚ -å¦‚æœTæ˜¯ç±»å‹æ³¨å…¥p#Tï¼Œé‚£ä¹ˆpå’ŒTéƒ½æ˜¯æœç´¢åŒºåŸŸã€‚ æ‰€ä»¥ï¼Œåªè¦åœ¨ä¸Šè¿°çš„ä»»ä½•ä¸€ä¸ªåŒºåŸŸä¸­æœç´¢åˆ°åˆé€‚çš„éšå¼è½¬æ¢ï¼Œç¼–è¯‘å™¨éƒ½å¯ä»¥ä½¿ç¼–è¯‘é€šè¿‡ã€‚ scalaä¸­é¢„å®šä¹‰çš„éšå¼è½¬æ¢scala.Predefï¼šscalaçš„é¢„å®šä¹‰å¯¹è±¡ï¼Œé¢„å®šä¹‰äº†å¾ˆå¤šç±»å‹ (ä¾‹å¦‚ Pair) å’Œæ–¹æ³• (ä¾‹å¦‚ assert)ï¼ŒåŒæ—¶ä¹Ÿå£°æ˜äº†ä¸€äº›éšå¼è½¬æ¢ã€‚","categories":[{"name":"Scalaå­¦ä¹ ","slug":"Scalaå­¦ä¹ ","permalink":"https://shang.at/categories/Scalaå­¦ä¹ /"}],"tags":[{"name":"Scalaéšå¼è½¬æ¢","slug":"Scalaéšå¼è½¬æ¢","permalink":"https://shang.at/tags/Scalaéšå¼è½¬æ¢/"}]},{"title":"Scalaå­¦ä¹ -åå‡½æ•°","slug":"Scalaå­¦ä¹ -7-åå‡½æ•°","date":"2020-07-26T08:20:55.000Z","updated":"2020-11-27T02:22:59.475Z","comments":true,"path":"post/Scalaå­¦ä¹ -7-åå‡½æ•°/","link":"","permalink":"https://shang.at/post/Scalaå­¦ä¹ -7-åå‡½æ•°/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š 123456789101112131415object TestPartialFunction &#123; def main(args: Array[String]): Unit = &#123; def xxx: PartialFunction[Any, String] = &#123; case \"hello\" =&gt; \"val is hello\" case x: Int =&gt; s\"$x...is int\" case _ =&gt; \"none\" &#125; val str: String = xxx(44) println(str) println(xxx(\"hello\")) println(xxx(\"hi\")) &#125;&#125;","categories":[{"name":"Scalaå­¦ä¹ ","slug":"Scalaå­¦ä¹ ","permalink":"https://shang.at/categories/Scalaå­¦ä¹ /"}],"tags":[{"name":"Scalaåå‡½æ•°","slug":"Scalaåå‡½æ•°","permalink":"https://shang.at/tags/Scalaåå‡½æ•°/"}]},{"title":"Scalaå­¦ä¹ -æ¨¡å¼åŒ¹é…","slug":"Scalaå­¦ä¹ -6-æ¨¡å¼åŒ¹é…","date":"2020-07-26T08:20:13.000Z","updated":"2021-05-19T02:16:09.986Z","comments":true,"path":"post/Scalaå­¦ä¹ -6-æ¨¡å¼åŒ¹é…/","link":"","permalink":"https://shang.at/post/Scalaå­¦ä¹ -6-æ¨¡å¼åŒ¹é…/","excerpt":"ç®€ä»‹ï¼šscalaçš„æ¨¡å¼åŒ¹é…åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œå¯ä»¥æ”¯æŒå€¼åŒ¹é…ï¼Œç±»å‹åŒ¹é…ç­‰","text":"ç®€ä»‹ï¼šscalaçš„æ¨¡å¼åŒ¹é…åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œå¯ä»¥æ”¯æŒå€¼åŒ¹é…ï¼Œç±»å‹åŒ¹é…ç­‰ 12345678910111213141516171819202122object Lesson06_match &#123; def main(args: Array[String]): Unit = &#123; val tup: (Double, Int, String, Boolean, Int, Option[Int]) = (1.0, 88, \"abc\", false, 44, Option(1)) val iter: Iterator[Any] = tup.productIterator val res: Iterator[Unit] = iter.map( (x) =&gt; &#123; x match &#123; case 1 =&gt; println(s\"$x...is 1\") case 88 =&gt; println(s\"$x ...is 88\") case false =&gt; println(s\"$x...is false\") case w: Int if w &gt; 50 =&gt; println(s\"$w...is &gt; 50\") case Some(n) =&gt; println(s\"$x... is Option(1)\") case _ =&gt; println(\"wo ye bu zhi dao sha lei xing \") &#125; &#125; ) while (res.hasNext) println(res.next()) &#125;&#125; Optionç±»å‹ä¸­çš„æ¨¡å¼åŒ¹é… 123456789101112131415161718192021222324/** * Optionç±»å‹ä¸­çš„æ¨¡å¼åŒ¹é… * Optionç±»å‹æœ‰ä¸¤ä¸ªå­ç±»ï¼Œåˆ†åˆ«æ˜¯Someå’ŒNoneï¼ˆå•ä¾‹å¯¹è±¡ï¼‰ * Noneæ˜¯ä¸€ä¸ªcase objectï¼Œå®ƒåŒSomeä¸€æ ·éƒ½extends Optionç±»ï¼Œåªä¸è¿‡Someæ˜¯case classï¼Œ * å¯¹äºcase classæˆ‘ä»¬å·²ç»å¾ˆç†Ÿæ‚‰äº†ï¼Œé‚£case objectåˆæ˜¯æ€ä¹ˆæ ·çš„å‘¢ï¼Ÿ * å¯¹æ¯”åç¼–è¯‘ä¹‹åçš„ä»£ç å¯ä»¥çœ‹å‡ºï¼Œcase objectä¸case classæ‰€ä¸åŒçš„æ˜¯ï¼š * case objectå¯¹åº”åç¼–è¯‘åçš„CaseObject$.classä¸­ä¸å­˜åœ¨applyã€unapplyæ–¹æ³•ï¼Œ * è¿™æ˜¯å› ä¸ºNoneä¸éœ€è¦åˆ›å»ºå¯¹è±¡åŠè¿›è¡Œå†…å®¹æå–ï¼Œä»è¿™ä¸ªè§’åº¦è®²ï¼Œå®ƒè¢«å®šä¹‰ä¸ºcase objectæ˜¯ååˆ†åˆç†çš„ã€‚ */object OptionDemo &#123; def main(args: Array[String]): Unit = &#123; val map = Map(\"hadoop\" -&gt; 1, \"spark\" -&gt; 2, \"flink\" -&gt; 3) //scalaè¯­è¨€å¯ä»¥åœ¨ä¸€ä¸ªå‡½æ•°ä¸­å®šä¹‰å¦å¤–ä¸€ä¸ªå‡½æ•° def mapPattern(key: String): Unit = &#123; //get(key)æ–¹æ³•ä¸­ï¼Œé€šè¿‡keyå€¼è·å–ä¸ä¹‹ç›¸å¯¹åº”çš„valueå€¼ map.get(key) match &#123; case Some(x)=&gt;println(x);x case None=&gt;println(\"None\");-1 &#125; &#125; println(mapPattern(\"hive\")) println(mapPattern(\"spark\")) &#125;&#125; https://stackoverflow.com/questions/7519140/pattern-matching-on-class-type https://stackoverflow.com/questions/7157143/how-can-i-match-classes-in-a-scala-match-statement","categories":[{"name":"Scalaå­¦ä¹ ","slug":"Scalaå­¦ä¹ ","permalink":"https://shang.at/categories/Scalaå­¦ä¹ /"}],"tags":[{"name":"Scalaæ¨¡å¼åŒ¹é…","slug":"Scalaæ¨¡å¼åŒ¹é…","permalink":"https://shang.at/tags/Scalaæ¨¡å¼åŒ¹é…/"}]},{"title":"Scalaå­¦ä¹ -æ¡ˆä¾‹ç±»","slug":"Scalaå­¦ä¹ -5-æ¡ˆä¾‹ç±»","date":"2020-07-26T08:19:58.000Z","updated":"2021-04-12T04:37:57.808Z","comments":true,"path":"post/Scalaå­¦ä¹ -5-æ¡ˆä¾‹ç±»/","link":"","permalink":"https://shang.at/post/Scalaå­¦ä¹ -5-æ¡ˆä¾‹ç±»/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š 123456789101112131415case class Dog(name:String,age:Int)&#123;&#125;object TestCaseClass &#123; def main(args: Array[String]): Unit = &#123; val dog1 = Dog(\"hsq\",18) val dog2 = Dog(\"hsq\",18) println(dog1.equals(dog2)) println(dog1 == dog2) val dog3: Dog = dog2.copy(age=10) println(dog3) &#125;&#125; case classæ„Ÿè§‰ä¸Šç±»ä¼¼äºtupleï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼šå±æ€§éƒ½æ˜¯publicçš„valçš„(ä¸å¯å˜)ï¼Œä½†æ˜¯case classå¯ä»¥å°†valæ”¹æˆvar 12345678scala&gt; christina.nameres0: String = Christina// can't mutate the `name` fieldscala&gt; christina.name = \"Fred\"&lt;console&gt;:10: error: reassignment to val christina.name = \"Fred\" ^ case classæ„é€ çš„æ—¶å€™ä¸éœ€è¦ä½¿ç”¨newå…³é”®å­—ä¹Ÿå¯ä»¥ï¼Œå› ä¸ºcase classæœ‰ä¸€ä¸ªé»˜è®¤çš„applyæ–¹æ³•æ¥è´Ÿè´£å¯¹è±¡çš„åˆ›å»ºã€‚ 12case class Person(name: String, relation: String)val christina = Person(\"Christina\", \"niece\") case class è‡ªå¸¦unapplyæ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥ç”¨äºæ¨¡å¼åŒ¹é…ä¸­ 123456789101112trait Person &#123; def name: String&#125;case class Student(name: String, year: Int) extends Personcase class Teacher(name: String, specialty: String) extends Persondef getPrintableString(p: Person): String = p match &#123; case Student(name, year) =&gt; s\"$name is a student in Year $year.\" case Teacher(name, whatTheyTeach) =&gt; s\"$name teaches $whatTheyTeach.\"&#125; case classåœ¨æ¯”è¾ƒçš„æ—¶å€™æ˜¯æŒ‰å€¼æ¯”è¾ƒè€ŒéæŒ‰å¼•ç”¨æ¯”è¾ƒï¼šåœ¨æ¶ˆæ¯ä¼ é€’çš„æ—¶å€™éå¸¸æœ‰ç”¨ï¼Œä¸å…³å¿ƒå¼•ç”¨ï¼Œåªå…³å¿ƒå€¼ 1234567891011scala&gt; case class Person(name: String, relation: String)defined class Personscala&gt; val christina = Person(\"Christina\", \"niece\")christina: Person = Person(Christina,niece)scala&gt; val hannah = Person(\"Hannah\", \"niece\")hannah: Person = Person(Hannah,niece)scala&gt; christina == hannahres1: Boolean = false å¯ä»¥é€šè¿‡copyæ–¹æ³•åˆ›å»ºä¸€ä¸ªæ¡ˆä¾‹ç±»å®ä¾‹çš„æµ…æ‹·è´ï¼ŒåŒæ—¶å¯ä»¥æŒ‡å®šæ„é€ å‚æ•°æ¥åšä¸€äº›æ”¹å˜ã€‚ 12345678scala&gt; case class BaseballTeam(name: String, lastWorldSeriesWin: Int)defined class BaseballTeamscala&gt; val cubs1908 = BaseballTeam(\"Chicago Cubs\", 1908)cubs1908: BaseballTeam = BaseballTeam(Chicago Cubs,1908)scala&gt; val cubs2016 = cubs1908.copy(lastWorldSeriesWin = 2016)cubs2016: BaseballTeam = BaseballTeam(Chicago Cubs,2016) toStringæ–¹æ³• 12scala&gt; christinares0: Person = Person(Christina,niece) The biggest advantage While all of these features are great benefits to functional programming, as they write in the book, Programming in Scala (Odersky, Spoon, and Venners), â€œthe biggest advantage of case classes is that they support pattern matching.â€ Pattern matching is a major feature of FP languages, and Scalaâ€™s case classes provide a simple way to implement pattern matching in match expressions and other areas","categories":[{"name":"Scalaå­¦ä¹ ","slug":"Scalaå­¦ä¹ ","permalink":"https://shang.at/categories/Scalaå­¦ä¹ /"}],"tags":[{"name":"Scalaæ¡ˆä¾‹ç±»","slug":"Scalaæ¡ˆä¾‹ç±»","permalink":"https://shang.at/tags/Scalaæ¡ˆä¾‹ç±»/"}]},{"title":"Scalaå­¦ä¹ -ç‰¹è´¨å’ŒæŠ½è±¡ç±»å‹","slug":"Scalaå­¦ä¹ -4-ç‰¹è´¨å’ŒæŠ½è±¡ç±»å‹","date":"2020-07-26T08:19:37.000Z","updated":"2021-04-11T03:55:08.507Z","comments":true,"path":"post/Scalaå­¦ä¹ -4-ç‰¹è´¨å’ŒæŠ½è±¡ç±»å‹/","link":"","permalink":"https://shang.at/post/Scalaå­¦ä¹ -4-ç‰¹è´¨å’ŒæŠ½è±¡ç±»å‹/","excerpt":"ç®€ä»‹ï¼šç‰¹è´¨ (Traits) ç”¨äºåœ¨ç±» (Class)ä¹‹é—´å…±äº«ç¨‹åºæ¥å£ (Interface)å’Œå­—æ®µ (Fields)ã€‚ å®ƒä»¬ç±»ä¼¼äºJava 8çš„æ¥å£ã€‚ ç±»å’Œå¯¹è±¡ (Objects)å¯ä»¥æ‰©å±•ç‰¹è´¨ï¼Œä½†æ˜¯ç‰¹è´¨ä¸èƒ½è¢«å®ä¾‹åŒ–ï¼Œå› æ­¤ç‰¹è´¨æ²¡æœ‰å‚æ•°ã€‚","text":"ç®€ä»‹ï¼šç‰¹è´¨ (Traits) ç”¨äºåœ¨ç±» (Class)ä¹‹é—´å…±äº«ç¨‹åºæ¥å£ (Interface)å’Œå­—æ®µ (Fields)ã€‚ å®ƒä»¬ç±»ä¼¼äºJava 8çš„æ¥å£ã€‚ ç±»å’Œå¯¹è±¡ (Objects)å¯ä»¥æ‰©å±•ç‰¹è´¨ï¼Œä½†æ˜¯ç‰¹è´¨ä¸èƒ½è¢«å®ä¾‹åŒ–ï¼Œå› æ­¤ç‰¹è´¨æ²¡æœ‰å‚æ•°ã€‚ 12345678910111213141516171819202122232425262728293031323334353637trait God&#123; def say(): Unit =&#123; println(\"god...say\") &#125;&#125;trait Mg&#123; def ku(): Unit =&#123; println(\"mg...say\") &#125; def haiRen():Unit&#125;class Person(name:String) extends God with Mg&#123; def hello(): Unit =&#123; println(s\"$name say hello\") &#125; override def haiRen(): Unit = &#123; println(\"ziji shixian ....\") &#125;&#125;object Lesson04_trait &#123; def main(args: Array[String]): Unit = &#123; val p = new Person(\"zhangsan\") p.hello() p.say() p.ku() p.haiRen() &#125;&#125; traitå°±ç±»ä¼¼äºjava8ä¸­çš„æ¥å£ï¼Œç‰¹æ€§å’Œæ¥å£çš„æ€§è´¨ç›¸ä¼¼ ä¸€æ¬¡ç»§æ‰¿å¤šæ¬¡å®ç°ï¼šåªèƒ½ç»§æ‰¿ä¸€ä¸ªçˆ¶ç±»ï¼Œä½†æ˜¯å¯ä»¥å®ç°å¤šä¸ªtraitï¼Œä½¿ç”¨å…³é”®å­—extends(å’Œjavaä¸­ä¸åŒ) traitå¯ä»¥æœ‰é»˜è®¤å®ç°","categories":[{"name":"Scalaå­¦ä¹ ","slug":"Scalaå­¦ä¹ ","permalink":"https://shang.at/categories/Scalaå­¦ä¹ /"}],"tags":[{"name":"Scalaç‰¹è´¨å’ŒæŠ½è±¡ç±»å‹","slug":"Scalaç‰¹è´¨å’ŒæŠ½è±¡ç±»å‹","permalink":"https://shang.at/tags/Scalaç‰¹è´¨å’ŒæŠ½è±¡ç±»å‹/"}]},{"title":"Scalaå­¦ä¹ -é›†åˆ","slug":"Scalaå­¦ä¹ -3-é›†åˆ","date":"2020-07-26T08:19:27.000Z","updated":"2021-04-11T03:54:16.716Z","comments":true,"path":"post/Scalaå­¦ä¹ -3-é›†åˆ/","link":"","permalink":"https://shang.at/post/Scalaå­¦ä¹ -3-é›†åˆ/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š åœ¨scalaä¸­åˆ†ä¸ºä¸¤ç§é›†åˆç±»å‹ï¼šimmutable(ä¸å¯å˜çš„)ã€mutable(å¯å˜çš„) é»˜è®¤åˆ›å»ºå‡ºæ¥çš„é›†åˆç±»å¦‚ï¼š immutableçš„APIéƒ½æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡è¿”å› mutableçš„APIå…·æœ‰add set putç­‰æ“ä½œï¼Œå¯ä»¥ä¿®æ”¹å¯¹è±¡å†…å®¹ scalaä¸­çš„é˜Ÿåˆ—å’Œæ ˆï¼š 1.ä½¿ç”¨é˜Ÿåˆ—é˜Ÿåˆ—æ˜¯ä¸€ç§é‚£ä¸ªå…ˆè¿›å…ˆå‡ºçš„é˜Ÿåˆ—ã€‚1)åˆ›å»ºä¸€ä¸ªé˜Ÿåˆ—ã€‚ 123456789101112scala&gt; import scala.collection.mutable.Queuescala&gt; var fruits = Queue[String]()fruits: scala.collection.mutable.Queue[String] = Queue() scala&gt; fruits += \"apple\"res66: scala.collection.mutable.Queue[String] = Queue(apple) scala&gt; fruits += (\"orange\",\"banana\")res67: scala.collection.mutable.Queue[String] = Queue(apple, orange, banana) scala&gt; fruits ++= List(\"cherry\",\"cocount\")res68: scala.collection.mutable.Queue[String] = Queue(apple, orange, banana, cherry, cocount) scala&gt; fruits.enqueue(\"pine\") scala&gt; fruitsres70: scala.collection.mutable.Queue[String] = Queue(apple, orange, banana, cherry, cocount, pine) 2)dequeueæ¯æ¬¡ä»é˜Ÿåˆ—å¤´éƒ¨åˆ é™¤ä¸€ä¸ªå…ƒç´ ã€‚ 1234scala&gt; val next = fruits.dequeuenext: String = apple scala&gt; fruitsres72: scala.collection.mutable.Queue[String] = Queue(orange, banana, cherry, cocount, pine) 3)dequeueFirstå’ŒdequeueAllæ–¹æ³•å¯ä»¥ä»é˜Ÿåˆ—ä¸­åˆ é™¤å¤šä¸ªå…ƒç´ ã€‚ 12345678910111213scala&gt; var fruits = Queue[String]()fruits: scala.collection.mutable.Queue[String] = Queue() scala&gt; fruits ++= List(\"cherry\",\"cocount\")res76: scala.collection.mutable.Queue[String] = Queue(cherry, cocount) scala&gt; fruits ++= List(\"orange\",\"apple\")res77: scala.collection.mutable.Queue[String] = Queue(cherry, cocount, orange, apple) scala&gt; fruits.dequeueFirst(_.startsWith(\"a\"))res79: Option[String] = Some(apple) scala&gt; fruitsres80: scala.collection.mutable.Queue[String] = Queue(cherry, cocount, orange)scala&gt; fruits.dequeueAll(_.length &gt; 6)res81: scala.collection.mutable.Seq[String] = ArrayBuffer(cocount)scala&gt; fruitsres82: scala.collection.mutable.Queue[String] = Queue(cherry, orange) 2.ä½¿ç”¨æ ˆæ ˆæ˜¯ä¸€ç§åè¿›å…ˆå‡ºçš„æ•°æ®ç»“æ„ã€‚ç”¨pushæ–¹æ³•å°†å…ƒç´ å…¥æ ˆï¼Œç”¨popæ–¹æ³•å°†å…ƒç´ å‡ºæ ˆã€‚1)åˆ›å»ºä¸€ä¸ªä»»æ„æ•°æ®ç±»å‹ç©ºçš„å¯å˜æ ˆã€‚ 123scala&gt; import scala.collection.mutable.Stackscala&gt; var ints = Stack[Int]()ints: scala.collection.mutable.Stack[Int] = Stack() 2)åœ¨åˆ›å»ºæ—¶ç»™æ ˆåˆå§‹å…ƒç´ ã€‚ 12scala&gt; val ints = Stack(1,2,3)ints: scala.collection.mutable.Stack[Int] = Stack(1, 2, 3) 3)ç”¨pushæ–¹æ³•å‘æ ˆä¸­å¡«å……å…ƒç´ ã€‚ 123456scala&gt; var fruits = Stack[String]()fruits: scala.collection.mutable.Stack[String] = Stack() scala&gt; fruits.push(\"apple\")res2: scala.collection.mutable.Stack[String] = Stack(apple)scala&gt; fruits.push(\"apple\",\"orange\",\"banana\")res3: scala.collection.mutable.Stack[String] = Stack(banana, orange, apple, apple) 4)ç”¨popæ–¹æ³•å°†å…ƒç´ å‡ºæ ˆã€‚ 1234scala&gt; val next = fruits.popnext: String = bananascala&gt; fruitsres4: scala.collection.mutable.Stack[String] = Stack(orange, apple, apple) 5)ç”¨topæ–¹æ³•æŸ¥çœ‹ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚ 1234scala&gt; fruits.topres5: String = orangescala&gt; fruitsres6: scala.collection.mutable.Stack[String] = Stack(orange, apple, apple) 6)ç”¨clearæ¸…ç©ºä¸€ä¸ªå¯å˜æ ˆã€‚ 123scala&gt; fruits.clearscala&gt; fruitsres8: scala.collection.mutable.Stack[String] = Stack() https://www.cnblogs.com/zhaohadoopone/p/9534996.html#)","categories":[{"name":"Scalaå­¦ä¹ ","slug":"Scalaå­¦ä¹ ","permalink":"https://shang.at/categories/Scalaå­¦ä¹ /"}],"tags":[{"name":"Scalaé›†åˆ","slug":"Scalaé›†åˆ","permalink":"https://shang.at/tags/Scalaé›†åˆ/"}]},{"title":"Scalaå­¦ä¹ -æ–¹æ³•","slug":"Scalaå­¦ä¹ -2-æ–¹æ³•","date":"2020-07-26T08:19:20.000Z","updated":"2020-11-26T02:24:10.038Z","comments":true,"path":"post/Scalaå­¦ä¹ -2-æ–¹æ³•/","link":"","permalink":"https://shang.at/post/Scalaå­¦ä¹ -2-æ–¹æ³•/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203import java.utilimport java.util.Dateobject Lesson02_Functions &#123; //æˆå‘˜æ–¹æ³• def ooxx(): Unit = &#123; println(\"hello object\") &#125; def main(args: Array[String]): Unit = &#123; // æ–¹æ³• å‡½æ•° println(\"-------1.basic----------\") //è¿”å›å€¼ï¼Œå‚æ•°ï¼Œå‡½æ•°ä½“ def fun01() &#123; println(\"hello world\") &#125; fun01() var x = 3 var y = fun01() println(y) //æƒ³æœ‰è¿”å› // public void sdfsd()&#123;&#125; // public String sdfsdf()&#123;&#125; //æœ‰returnå¿…é¡»ç»™å‡ºè¿”å›ç±»å‹ def fun02() = &#123; new util.LinkedList[String]() &#125; //å‚æ•°ï¼šå¿…é¡»ç»™å‡ºç±»å‹ï¼Œæ˜¯val //class æ„é€ ï¼Œæ˜¯varï¼Œval def fun03(a: Int): Unit = &#123; println(a) &#125; fun03(33) println(\"-------2.é€’å½’å‡½æ•°----------\") //é€’å½’å…ˆå†™è§¦åº•ï¼ è§¦å‘ä»€ä¹ˆæŠ¥é”™å‘€ def fun04(num: Int): Int = &#123; if (num == 1) &#123; num &#125; else &#123; num * fun04(num - 1) &#125; &#125; val i: Int = fun04(4) println(i) println(\"-------3.é»˜è®¤å€¼å‡½æ•°----------\") def fun05(a: Int = 8, b: String = \"abc\"): Unit = &#123; println(s\"$a\\t$b\") &#125; // fun05(9,\"def\") fun05(22) fun05(b = \"ooxx\") println(\"-------4.åŒ¿åå‡½æ•°----------\") //å‡½æ•°æ˜¯ç¬¬ä¸€ç±»å€¼ //å‡½æ•°ï¼š //1ï¼Œç­¾å ï¼š(Int,Int)=&gt;Int ï¼š ï¼ˆå‚æ•°ç±»å‹åˆ—è¡¨ï¼‰=&gt; è¿”å›å€¼ç±»å‹ //2ï¼ŒåŒ¿åå‡½æ•°ï¼š (a:Int,b:Int) =&gt; &#123; a+b &#125; ï¼šï¼ˆå‚æ•°å®ç°åˆ—è¡¨ï¼‰=&gt; å‡½æ•°ä½“ var xx: Int = 3 var yy: (Int, Int) =&gt; Int = (a: Int, b: Int) =&gt; &#123; a + b &#125; val w: Int = yy(3, 4) println(w) println(\"--------5.åµŒå¥—å‡½æ•°---------\") def fun06(a: String): Unit = &#123; def fun05(): Unit = &#123; println(a) &#125; fun05() &#125; fun06(\"hello\") println(\"--------6.ååº”ç”¨å‡½æ•°---------\") def fun07(date: Date, tp: String, msg: String): Unit = &#123; println(s\"$date\\t$tp\\t$msg\") &#125; fun07(new Date(), \"info\", \"ok\") var info = fun07(_: Date, \"info\", _: String) var error = fun07(_: Date, \"error\", _: String) info(new Date, \"ok\") error(new Date, \"error...\") println(\"--------7.å¯å˜å‚æ•°---------\") def fun08(a: Int*): Unit = &#123; for (e &lt;- a) &#123; println(e) &#125; // def foreach[U](f: A =&gt; U): Unit // a.foreach( (x:Int)=&gt;&#123;println(x)&#125; ) // a.foreach( println(_) ) a.foreach(println) &#125; fun08(2) fun08(1, 2, 3, 4, 5, 6) println(\"--------å°†æ•°ç»„ä¸­çš„å…ƒç´ å½“åšå˜é•¿å‚æ•°-----------\") def max(values: Int*) = values.foldLeft(values(0)) &#123; Math.max &#125; val numbers = Array(2, 5, 3, 7, 1, 6) println(max(numbers:_*)) // éœ€è¦ä½¿ç”¨:_*ç¬¦å·ç»„åˆ println(\"--------8.é«˜é˜¶å‡½æ•°---------\") //å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå‡½æ•°ä½œä¸ºè¿”å›å€¼ //å‡½æ•°ä½œä¸ºå‚æ•° def computer(a: Int, b: Int, f: (Int, Int) =&gt; Int): Unit = &#123; val res: Int = f(a, b) println(res) &#125; computer(3, 8, (x: Int, y: Int) =&gt; &#123; x + y &#125;) computer(3, 8, (x: Int, y: Int) =&gt; &#123; x * y &#125;) computer(3, 8, _ * _) //å‡½æ•°ä½œä¸ºè¿”å›å€¼ï¼š def factory(i: String): (Int, Int) =&gt; Int = &#123; def plus(x: Int, y: Int): Int = &#123; x + y &#125; if (i.equals(\"+\")) &#123; plus &#125; else &#123; (x: Int, y: Int) =&gt; &#123; x * y &#125; &#125; &#125; computer(3, 8, factory(\"-\")) println(\"--------9.æŸ¯é‡ŒåŒ–---------\") def fun09(a: Int)(b: Int)(c: String): Unit = &#123; println(s\"$a\\t$b\\t$c\") &#125; fun09(3)(8)(\"sdfsdf\") def fun10(a: Int*)(b: String*): Unit = &#123; a.foreach(println) b.foreach(println) &#125; fun10(1, 2, 3)(\"sdfs\", \"sss\") println(\"--------*.æ–¹æ³•---------\") //æ–¹æ³•ä¸æƒ³æ‰§è¡Œï¼Œèµ‹å€¼ç»™ä¸€ä¸ªå¼•ç”¨ æ–¹æ³•å+ç©ºæ ¼+ä¸‹åˆ’çº¿ val funa = ooxx println(funa) val func = ooxx _ func() //è¯­æ³• -&gt; ç¼–è¯‘å™¨ -&gt; å­—èŠ‚ç  &lt;- jvmè§„åˆ™ //ç¼–è¯‘å™¨ï¼Œè¡”æ¥ äºº æœºå™¨ //java ä¸­ +ï¼š å…³é”®å­— //scalaä¸­+ï¼š æ–¹æ³•/å‡½æ•° //scalaè¯­æ³•ä¸­ï¼Œæ²¡æœ‰åŸºæœ¬ç±»å‹ï¼Œæ‰€ä»¥ä½ å†™ä¸€ä¸ªæ•°å­— 3 ç¼–è¾‘å™¨/è¯­æ³•ï¼Œå…¶å®æ˜¯æŠŠ 3 çœ‹å¾…æˆIntè¿™ä¸ªå¯¹è±¡ // 3 + 2 // 3.+(2) // 3:Int &#125;&#125;","categories":[{"name":"Scalaå­¦ä¹ ","slug":"Scalaå­¦ä¹ ","permalink":"https://shang.at/categories/Scalaå­¦ä¹ /"}],"tags":[{"name":"Scalaæ–¹æ³•","slug":"Scalaæ–¹æ³•","permalink":"https://shang.at/tags/Scalaæ–¹æ³•/"}]},{"title":"Scalaå­¦ä¹ -for-yield","slug":"Scalaå­¦ä¹ -1-æ§åˆ¶è¯­å¥-for-yield","date":"2020-07-26T08:19:07.000Z","updated":"2021-04-18T23:38:15.852Z","comments":true,"path":"post/Scalaå­¦ä¹ -1-æ§åˆ¶è¯­å¥-for-yield/","link":"","permalink":"https://shang.at/post/Scalaå­¦ä¹ -1-æ§åˆ¶è¯­å¥-for-yield/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š scalaè¯­è¨€çš„forè¯­æ³•å¾ˆçµæ´». é™¤äº†æ™®é€šçš„ç›´æ¥å¯¹é›†åˆçš„å¾ªç¯, ä»¥åŠå¾ªç¯ä¸­çš„åˆ¤æ–­å’Œå€¼è¿”å›. éå¸¸çµæ´». for å¯ä»¥é€šè¿‡yield(ç”Ÿäº§)è¿”å›å€¼, æœ€ç»ˆç»„æˆforå¾ªç¯çš„å¯¹è±¡ç±»å‹.for å¾ªç¯ä¸­çš„ yield ä¼šæŠŠå½“å‰çš„å…ƒç´ è®°ä¸‹æ¥ï¼Œä¿å­˜åœ¨é›†åˆä¸­ï¼Œå¾ªç¯ç»“æŸåå°†è¿”å›è¯¥é›†åˆã€‚å¦‚æœè¢«å¾ªç¯çš„æ˜¯ Mapï¼Œè¿”å›çš„å°±æ˜¯Mapï¼Œè¢«å¾ªç¯çš„æ˜¯ Listï¼Œè¿”å›çš„å°±æ˜¯Listï¼Œä»¥æ­¤ç±»æ¨ã€‚ å®ˆå«( guards) (for loop â€˜ifâ€™ conditions) å¯ä»¥åœ¨ for å¾ªç¯ç»“æ„ä¸­åŠ ä¸Š â€˜ifâ€™ è¡¨è¾¾å¼, å’Œyieldè”åˆèµ·æ¥ç”¨. æ™®é€šå¯¹é›†åˆæˆ–è¿­ä»£å¾ªç¯1234567891011scala&gt; for(i&lt;- 1 to 5) println(i)12345scala&gt; for(i&lt;- 1 until 5) println(i)1234 yieldè¿”å›å€¼1234567891011121314151617181920212223scala&gt; for (i &lt;- 1 to 5) yield ires0: scala.collection.immutable.IndexedSeq[Int] = Vector(1, 2, 3, 4, 5)scala&gt; val a= for (i &lt;- 1 to 5) yield ia: scala.collection.immutable.IndexedSeq[Int] = Vector(1, 2, 3, 4, 5)scala&gt; ares1: scala.collection.immutable.IndexedSeq[Int] = Vector(1, 2, 3, 4, 5)scala&gt; val a= for (i &lt;- 1 until 5) yield ia: scala.collection.immutable.IndexedSeq[Int] = Vector(1, 2, 3, 4)scala&gt; ares2: scala.collection.immutable.IndexedSeq[Int] = Vector(1, 2, 3, 4)scala&gt; val a= for (i &lt;- 1 until 5) yield i*2a: scala.collection.immutable.IndexedSeq[Int] = Vector(2, 4, 6, 8)scala&gt; val a = Array(1, 2, 3, 4, 5)a: Array[Int] = Array(1, 2, 3, 4, 5)scala&gt; for ( e &lt;- a) yield eres3: Array[Int] = Array(1, 2, 3, 4, 5) å¾ªç¯è¿‡æ»¤ if åˆ¤æ–­, å¹¶è¿”å›å€¼123456789101112131415161718192021222324252627282930313233343536scala&gt; for ( e &lt;- a if e%2 == 0) yield eres4: Array[Int] = Array(2, 4)scala&gt; ares10: Array[Int] = Array(1, 2, 3, 4, 5)scala&gt; val b = 6 to 7b: scala.collection.immutable.Range.Inclusive = Range 6 to 7scala&gt; for &#123; | x &lt;-a | y &lt;-b | &#125; yield (x,y)res11: Array[(Int, Int)] = Array((1,6), (1,7), (2,6), (2,7), (3,6), (3,7), (4,6), (4,7), (5,6), (5,7))scala&gt; for &#123; | y &lt;- b | x &lt;- a | &#125; yield (x,y)res12: scala.collection.immutable.IndexedSeq[(Int, Int)] = Vector((1,6), (2,6), (3,6), (4,6), (5,6), (1,7), (2,7), (3,7), (4,7), (5,7))val m = Map[String,String](\"a\"-&gt;1, \"b\"-&gt;2)for &#123; item &lt;- m&#125; yield &#123; println(item) (item._1+\"4\", item._2+1)&#125;res4: scala.collection.immutable.Map[String,Int] = Map(a4 -&gt; 2, b4 -&gt; 3)for &#123; item &lt;- m&#125; yield &#123; println(item) item._2+1&#125;res5: scala.collection.immutable.Iterable[Int] = List(2, 3) for å¤æ‚å®ä¾‹æ‰¾å‡º.txtåç¼€æ–‡ä»¶ 12345678910scala&gt; def getTextFile(path:String) : Array[java.io.File] = | for &#123; | file &lt;- new File(path).listFiles | if file.isFile | if file.getName.endsWith(\".txt\") | &#125; yield filegetTextFile: (path: String)Array[java.io.File]scala&gt; getTextFile(\".\")res9: Array[java.io.File] = Array(./a.txt, ./test.txt) æ‘˜è¦ï¼šæœ¬æ–‡è¯¦ç»†ä»‹ç» Scala çš„ For æ¨å¯¼å¼çš„å†…éƒ¨åŸç† åŸºç¡€çŸ¥è¯†123456789101112131415161718192021222324252627282930// src/main/scala/progscala2/forcomps/RemoveBlanks.scalapackage progscala2.forcompsobject RemoveBlanks &#123; /** * Remove blank lines from the specified input file. */ def apply(path: String, compressWhiteSpace: Boolean = false): Seq[String] = for &#123; // è¿™æ˜¯ä¸€ä¸ªç”Ÿæˆå™¨ line &lt;- scala.io.Source.fromFile(path).getLines.toSeq // &lt;1&gt; if line.matches(\"\"\"^\\s*$\"\"\") == false // &lt;2&gt; line2 = if (compressWhiteSpace) line replaceAll (\"\\\\s+\", \" \") // &lt;3&gt; else line &#125; yield line2 // &lt;4&gt; /** * Remove blank lines from the specified input files and echo the remaining * lines to standard output, one after the other. * @param args list of file paths. Prefix each with an optional \"-\" to * compress remaining whitespace in the file. */ def main(args: Array[String]) = for &#123; path2 &lt;- args // &lt;5&gt; (compress, path) = if (path2 startsWith \"-\") (true, path2.substring(1)) else (false, path2) // &lt;6&gt; line &lt;- apply(path, compress) &#125; println(line) // &lt;7&gt;&#125; ç”±äº for æ¨å¯¼å¼æ— æ³•è¿”å› Iterator å¯¹è±¡ï¼Œ for æ¨å¯¼å¼çš„è¿”å›ç±»å‹ç”±åˆå§‹çš„ç”Ÿæˆå™¨æ‰€å†³å®šï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»å°†å…¶è½¬åŒ–æˆä¸€ä¸ªåºåˆ—ã€‚ è¿‡æ»¤ç©ºè¡Œï¼Œä¹Ÿå°±æ˜¯è¯´è¿™å¥è¯æ˜¯ä½¿ç”¨ä¸Šä¸€å¥çš„è¾“å‡ºç»“æœ æ˜¯ä¸€ä¸ª guardï¼Œ é€šè¿‡æŸä¸ªæ¡ä»¶å¯¹è¿›è¿‡è¿›è¡Œå¤„ç†ï¼Œå¹¶èµ‹å€¼ç»™å¦å¤–çš„ä¸´æ—¶å˜é‡ è¾“å‡ºæœ€åçš„ç»“æœ For æ¨å¯¼å¼åŸç†For æ¨å¯¼å¼å®é™…ä¸Šæ˜¯è¯­æ³•ç³–ï¼Œæ˜¯ç»„åˆäº† map withFilter flatMap çš„åŸºç¡€æ“ä½œï¼Œä¸‹é¢ç»™å‡ºä¸€ä¸ªç­‰ä»·çš„è¡¨ç¤ºæ–¹æ³•ï¼š æ¡ˆä¾‹1123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263case class Person(name:String, isMale:Boolean, children: Person*)val lara = Person(\"Lara\", isMale = false)val bob = Person(\"Bob\", isMale = true)val julie = Person(\"Julie\", false, lara, bob)val gulie = Person(\"Gulie\", false, julie)val persons = List(lara, bob, julie, gulie)var temp1 = persons filter (p =&gt; !p.isMale)var temp11 = temp1 flatMap (k =&gt; k.name)var temp12 = temp1 flatMap (k =&gt; k.children)var temp2 = temp1 flatMap (p =&gt; p.children map (c =&gt; (p.name, c.name)))println(temp1)println(temp11)println(temp12)println(temp2)val temp3 = persons withFilter (p =&gt; !p.isMale) flatMap (p =&gt; p.children map (c =&gt; (p.name, c.name)))println(temp3)val temp4 = for &#123; p &lt;- persons if !p.isMale c &lt;- p.children&#125; yield (p.name, c.name)println(temp4)val temp44 = for &#123; p &lt;- persons if !p.isMale n = p.name if n startsWith \"Gu\" c &lt;- p.children&#125; yield (p.name, c.name)val temp5 = for &#123; p &lt;- persons // a generator n = p.name // a definition if n startsWith \"To\" // a filter&#125; yield nprintln(temp5)val temp6 = for ( x &lt;- List(1, 2); y &lt;- List(\"one\", \"two\");) yield (x, y)println(temp6)val temp6Equivalence = List(1, 2) flatMap (p =&gt; &#123; List(\"one\", \"two\") map ( k =&gt; (p,k))&#125;)println(temp6Equivalence)val temp7 = for ( x &lt;- List(1, 2); y &lt;- List(\"one\", \"two\"); z &lt;- List(\"a\", \"b\")) yield (x, y, z)println(temp7)val temp7Equivalence = List(1, 2) flatMap (p =&gt; &#123; List(\"one\", \"two\") flatMap ( k =&gt; &#123; List(\"a\", \"b\") map (l =&gt; (p,k,l))&#125;)&#125;)println(temp7Equivalence) æ¡ˆä¾‹2æ²¡æœ‰ yield12345678910val states = List(\"Alabama\", \"Alaska\", \"Virginia\", \"Wyoming\")for &#123;s &lt;- states&#125; println(s)// ç»“æœå€¼:// Alabama// Alaska// Virginia// Wyomingstates foreach println å«æœ‰ yield1234567val states = List(\"Alabama\", \"Alaska\", \"Virginia\", \"Wyoming\")for &#123;s &lt;- states&#125; yield s.toUpperCase// ç»“æœå€¼: List(ALABAMA, ALASKA, VIRGINIA, WYOMING)states map (_.toUpperCase) // æœ‰ç‚¹ç±»ä¼¼äº Java Lambda çš„ ::Method æ“ä½œï¼Œå¦‚æœåœ¨ `map` æ“ä½œä¸­åªæ‰§è¡Œäº†ä¸€ä¸ªæ–¹æ³•ã€‚// ç»“æœå€¼: List(ALABAMA, ALASKA, VIRGINIA, WYOMING) å¤šä¸ªç”Ÿæˆå™¨123456789101112val states = List(\"Alabama\", \"Alaska\", \"Virginia\", \"Wyoming\")val temp8 = for &#123; s &lt;- states c &lt;- s&#125; yield s\"$c-$&#123;c.toUpper&#125;\"// ç»“æœå€¼: List(\"A-A\", \"l-L\", \"a-A\", \"b-B\", ...)val temp8Equivalence = states flatMap (_.toSeq map (c =&gt; s\"$c-$&#123;c.toUpper&#125;\"))val temp8Equivalence2 = states flatMap (p =&gt; p map (c =&gt; s\"$c-$&#123;c.toUpper&#125;\"))// ç»“æœå€¼: List(\"A-A\", \"l-L\", \"a-A\", \"b-B\", ...)println(temp8)println(temp8Equivalence)println(temp8Equivalence2) åŠ å…¥ä¿æŠ¤å¼1234567891011121314val temp9 = for &#123; s &lt;- states c &lt;- s if c.isLower&#125; yield s\"$c-$&#123;c.toUpper&#125;\"// ç»“æœå€¼: List(\"l-L\", \"a-A\", \"b-B\", ...)val temp9Equivalence = states flatMap (_.toSeq withFilter (_.isLower) map (c =&gt; s\"$c-$&#123;c.toUpper&#125;\"))val temp9Equivalence2 = states flatMap (p =&gt; p withFilter (k =&gt; k.isLower) map (c =&gt; s\"$c-$&#123;c.toUpper&#125;\"))val temp9Equivalence3 = states flatMap (p =&gt; p filter (k =&gt; k.isLower) map (c =&gt; s\"$c-$&#123;c.toUpper&#125;\"))println(temp9)println(temp9Equivalence)println(temp9Equivalence2)println(temp9Equivalence3)// ç»“æœå€¼: List(\"l-L\", \"a-A\", \"b-B\", ...) åŠ å…¥å®šä¹‰12345678910111213val states = List(\"Alabama\", \"Alaska\", \"Virginia\", \"Wyoming\")for &#123; s &lt;- states c &lt;- s if c.isLower c2 = s\"$c-$&#123;c.toUpper&#125; \"&#125; yield c2// ç»“æœå€¼: List(\"l-L\", \"a-A\", \"b-B\", ...)states flatMap (_.toSeq withFilter (_.isLower) map &#123; c =&gt; val c2 = s\"$c-$&#123;c.toUpper&#125; \" c2&#125;)// ç»“æœå€¼: List(\"l-L\", \"a-A\", \"b-B\", ...) æ€»ç»“å†…éƒ¨æœºåˆ¶ç»“åˆ ã€ŠScala ç¨‹åºè®¾è®¡ç¬¬2ç‰ˆã€‹ 7.2ç« èŠ‚å’Œä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬æ€»ç»“ for æ¨å¯¼å¼çš„å†…éƒ¨æœºåˆ¶å¦‚ä¸‹ï¼š withFilter æ•ˆç‡æ¯” filter é«˜ï¼Œ å› ä¸ºå®ƒä¸ä¼šç”Ÿæˆä¸€æ¬¡ä¸­é—´çš„ä¸´æ—¶çš„å®¹å™¨ï¼Œè€Œæ˜¯å’Œåç»­æ“ä½œç»“åˆä½¿ç”¨ã€‚è€Œä¸” withFilter ä¼šé™åˆ¶ä¼ é€’ç»™åç»­ç»„åˆå™¨çš„å…ƒç´ ç±»å‹åŸŸã€‚ yield å®é™…æ˜¯ä¸€æ¬¡ map æ“ä½œï¼Œå…·ä½“ map çš„æ“ä½œæ–¹æ³•æ˜¯æ ¹æ® yield çš„è¡¨è¾¾å¼ï¼Œæ¯”å¦‚æ¡ˆä¾‹1ä¸­æ˜¯yield å…ƒç»„ï¼Œè€Œæ¡ˆä¾‹2ä¸­æ˜¯ yield ä¸€ä¸ª toUpperCase æ“ä½œã€‚ å¤šä¸ªç”Ÿæˆå™¨ï¼Œé™¤äº†æœ€åä¸€ä¸ªï¼Œå…¶ä»–çš„ç”Ÿæˆå™¨éƒ½ä¼šè½¬åŒ–ä¸º flatMapï¼Œæœ€åä¸€ä¸ªç”Ÿæˆå™¨å¯¹åº”è¿™ map è°ƒç”¨ã€‚ toSeq å¯ä»¥ç”¨æ¥ç®€åŒ–é’ˆå¯¹ Seq çš„ map åé¢çš„æ“ä½œï¼Œå®é™…ä¸Šå°±æ˜¯ p =&gt; p do something å®šä¹‰å˜é‡å°†ä¼šåœ¨ map è¡¨è¾¾å¼ä¸­å®šä¹‰ ï¼ˆflatmap ä¹Ÿå¯ä»¥å—ï¼Ÿï¼‰ æ·±å±‚ç†è§£åœ¨åƒ pat &lt;- expr è¿™æ ·çš„ç”Ÿæˆå™¨è¡¨è¾¾å¼ä¸­ï¼Œpat å®é™…ä¸Šæ˜¯ä¸€ä¸ªæ¨¡å¼è¡¨è¾¾å¼ï¼ˆ pattern expressionï¼‰ï¼Œä¾‹å¦‚ï¼š (x,y) &lt;- List((1,2),(3,4))ã€‚ Scala ä¼šä»¥ç±»ä¼¼çš„æ–¹å¼å¯¹å€¼å®šä¹‰è¯­å¥ pat2 = expr è¿›è¡Œå¤„ç†ï¼Œè¯¥è¯­å¥ä¹Ÿä¼šè¢«è§†ä¸ºæŸä¸€æ¨¡å¼ã€‚ 12// pat &lt;- exprpat &lt;- expr.withFilter &#123; case pat =&gt; true; case _ =&gt; false &#125; Scala åœ¨è½¬åŒ– for æ¨å¯¼å¼æ—¶ï¼Œè¦åšçš„ç¬¬ä¸€ä»¶äº‹ä¾¿æ˜¯å°† pat &lt;- expr è¯­å¥è½¬åŒ–ä¸ºä¸Šè¿°è¯­å¥ï¼Œç„¶åï¼Œ Scala å°†é‡å¤æ‰§è¡Œä¸‹åˆ—è½¬åŒ–è§„åˆ™ï¼Œç›´åˆ°æ‰€æœ‰çš„æ¨å¯¼è¡¨è¾¾å¼éƒ½è¢«æ›¿æ¢æ‰ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒæŸäº›è½¬åŒ–ä¼šç”Ÿæˆæ–°çš„ for æ¨å¯¼å¼ï¼Œè€Œåç»­çš„è¿­ä»£åˆ™ä¼šè´Ÿè´£å¯¹è¿™äº›æ¨å¯¼å¼è¿›è¡Œè½¬åŒ–ã€‚ å¦‚æœ for æ¨å¯¼å¼ä¸­åŒ…å«äº†ä¸€ä¸ªç”Ÿæˆå™¨å’Œä¸€ä¸ª yield è¡¨è¾¾å¼ï¼Œé‚£ä¹ˆè¯¥è¡¨è¾¾å¼å°†è¢«è½¬åŒ–ä¸ºä¸‹åˆ—è¯­å¥ï¼š 12// for ( pat &lt;- expr1 ) yield expr2expr map &#123; case pat =&gt; expr2 &#125; å¦‚æœ for å¾ªç¯ä¸­æœªä½¿ç”¨ yield è¯­å¥ï¼Œä½†æ‰§è¡Œçš„ä»£ç å…·æœ‰å‰¯ä½œç”¨ï¼Œé‚£ä¹ˆè¯¥è¯­å¥å°†è¢«è½¬åŒ–ä¸ºï¼š 12// for ( pat &lt;- expr1 ) expr2expr foreach &#123; case pat =&gt; expr2 &#125; åŒ…å«å¤šä¸ªç”Ÿæˆå™¨ï¼ˆåŒæ—¶åŒ…å« yield è¡¨è¾¾å¼ï¼‰çš„ for æ¨å¯¼å¼å°†è¢«è½¬åŒ–æˆä¸‹åˆ—è¯­å¥ï¼š 12// for ( pat1 &lt;- expr1; pat2 &lt;- expr2; ... ) yield exprNexpr1 flatMap &#123; case pat1 =&gt; for (pat2 &lt;- expr2 ...) yield exprN &#125; è¯·ç•™æ„ï¼ŒåµŒå¥—çš„ç”Ÿæˆå™¨ä¼šè¢«è½¬åŒ–æˆåµŒå¥—çš„ for æ¨å¯¼å¼ã€‚è¿™äº›åµŒå¥—çš„ for æ¨å¯¼å¼ä¼šåœ¨ä¸‹ä¸€æ¬¡æ‰§è¡Œè½¬åŒ–è§„åˆ™æ—¶è¢«è½¬åŒ–æˆæ–¹æ³•è°ƒç”¨ã€‚ä¸Šé¢ç¤ºä¾‹ä¸­ (â€¦) ä»£è¡¨äº†çœç•¥çš„è¡¨è¾¾å¼ï¼Œè¿™äº›è¡¨è¾¾å¼å¯èƒ½æ˜¯å…¶ä»–çš„ç”Ÿæˆå™¨ï¼Œä¹Ÿå¯èƒ½æ˜¯å€¼å®šä¹‰æˆ–ä¿æŠ¤å¼ï¼ˆ guardï¼‰ã€‚ åŒ…å«å¤šä¸ªç”Ÿæˆå™¨çš„ for å¾ªç¯å°†è¢«ç¿»è¯‘æˆä¸‹åˆ—è¯­å¥ï¼š 12// for ( pat1 &lt;- expr1; pat2 &lt;- expr2; ... ) exprNexpr1 foreach &#123; case pat1 =&gt; for (pat2 &lt;- expr2 ...) yield exprN &#125; æˆ‘ä»¬ä¹‹å‰æ‰€è§çš„ç¤ºä¾‹ä¸­åŒ…å«ä¿æŠ¤å¼ï¼ˆ guardï¼‰è¡¨è¾¾å¼ï¼Œè¯¥è¡¨è¾¾å¼è¢«ç¼–å†™åœ¨å•ç‹¬çš„ä¸€è¡Œä¸­ã€‚äº‹å®ä¸Šï¼Œ guard ä»¥åŠä¸Šä¸€è¡Œä¸­çš„ä»£ç å¯ä»¥ç¼–å†™åœ¨ä¸€è¡Œä¸­ï¼Œä¾‹å¦‚ï¼š pat1 &lt;- expr1 if guardã€‚ åé¢è·Ÿç€ä¿æŠ¤å¼çš„ç”Ÿæˆå™¨ä¼šè¢«ç¿»è¯‘æˆä¸‹åˆ—è¯­å¥ï¼š 12// pat1 &lt;- expr1 if guardpat1 &lt;- expr1 withFilter ((arg1, arg2, ...) =&gt; guard) æ­¤å¤„ï¼Œå˜é‡ argN ä»£è¡¨äº†ä¼ é€’ç»™ withFilter æ–¹æ³•çš„å‚æ•°ã€‚å¯¹äºå¤§å¤šæ•°çš„å®¹å™¨è€Œè¨€ï¼Œä¼ å…¥çš„æ–¹æ³•ä¸­åªå«æœ‰ä¸€ä¸ªå‚æ•° ç”Ÿæˆå™¨åå°¾éšä¸€ä¸ªå€¼å®šä¹‰å¦‚æœç”Ÿæˆå™¨åé¢å°¾éšç€ä¸€ä¸ªå€¼å®šä¹‰ï¼Œé‚£ä¹ˆè½¬åŒ–è¿™ä¸ªç”Ÿæˆå™¨çš„å¤æ‚åº¦ä¼šä»¤äººæƒŠå¥‡ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š 1234567// pat1 &lt;- expr1; pat2 = expr2(pat1, pat2) &lt;- for &#123; // âŠ x1 @ pat1 &lt;- expr1 // â‹ &#125; yield &#123; val x2 @ pat2 = expr2 // âŒ (x1, x2) // â&#125; âŠ for æ¨å¯¼å¼å°†è¿”å›åŒ…å«ä¸¤ä¸ªæ¨¡å¼çš„ pair å¯¹è±¡ã€‚â‹ x1 @ pat1 è¯­å¥ä¼šå°†æ•´ä¸ªè¡¨è¾¾å¼ä¸­ pat1 æ‰€åŒ¹é…çš„å€¼èµ‹ç»™å˜é‡ x1ï¼Œè¯¥å€¼å¯èƒ½åŒ…å«å¦ä¸€ä¸ªå˜é‡çš„æŸä¸€éƒ¨åˆ†ã€‚å‡å¦‚ pat1 æ˜¯ä¸€ä¸ªä¸å¯å˜å˜é‡åï¼Œ x1 å’Œ pat1 çš„èµ‹å€¼å°†ä¼šæ˜¯å†—ä½™çš„ã€‚âŒ å°† pat2 å€¼èµ‹ç»™ x2ã€‚â è¿”å›å…ƒç»„ã€‚ ä¸‹é¢çš„ REPL ä¼šè¯ä¸­åŒ…å«äº† x @ pat = expr è¯­å¥çš„å¯¹åº”ç¤ºä¾‹ï¼š 1234scala&gt; val z @ (x, y) = (1 -&gt; 2)z: (Int, Int) = (1,2)x: Int = 1y: Int = 2 å˜é‡ z çš„å€¼ä¸ºå…ƒç»„ (1,2)ï¼Œè€Œå˜é‡ x å’Œå˜é‡ y åˆ™å¯¹åº”äº†å…ƒç»„ä¸­å„ä¸ªç»„æˆéƒ¨åˆ†çš„å€¼ã€‚ ä¸€ä¸ªå…·ä½“æ¡ˆä¾‹1234567891011121314151617val map = Map(\"one\" -&gt; 1, \"two\" -&gt; 2)val list1 = for &#123; (key, value) &lt;- map // æœ¬è¡Œå’Œä¸‹ä¸€è¡Œå°†ä¼šè¢«ç¿»è¯‘æˆä»€ä¹ˆè¯­å¥å‘¢ï¼Ÿ i10 = value + 10&#125; yield (i10)// æ‰§è¡Œç»“æœå€¼: list1: scala.collection.immutable.Iterable[Int] = List(11, 12)// ç¿»è¯‘åçš„è¯­å¥:val list2 = for &#123; (i, i10) &lt;- for &#123; x1 @ (key, value) &lt;- map &#125; yield &#123; val x2 @ i10 = value + 10 (x1, x2) &#125;&#125; yield (i10)// æ‰§è¡Œç»“æœ: list2: scala.collection.immutable.Iterable[Int] = List(11, 12) ä¹¦ä¸­ç»™å‡ºçš„è§£é‡Šå°±åˆ°è¿™ä¸€æ­¥ï¼Œè¿™å®é™…ä¸Šè¿˜æ˜¯ä¸€ä¸ªåµŒå¥—çš„ for è¡¨è¾¾å¼ï¼Œä¸‹é¢æˆ‘ä»¬è¿›ä¸€æ­¥æŠŠå®ƒè½¬åŒ–ä¸º mapã€‚ é¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“å¦‚ä½•æŠŠ map ä¸­çš„å…ƒç´ æ˜ å°„ä¸ºå…ƒç»„ï¼Œå¾ˆç®€ç­”ï¼Œåªéœ€è¦ä½¿ç”¨ val (x,y) = pï¼Œå…¶ä¸­ p æ˜¯ map çš„å…ƒç´ ï¼Œxå’Œyå°±æ˜¯å…ƒç»„å€¼ï¼Œåé¢å°±å¯ä»¥ä½¿ç”¨ x å’Œ y è¿›ä¸€æ­¥è®¡ç®—äº†ã€‚ æˆ‘ä»¬è¿™é‡Œåˆ†ä¸¤æ­¥è½¬åŒ–ï¼Œé¦–å…ˆè½¬åŒ–å†…éƒ¨çš„ for æ¨å¯¼å¼ 123456789101112131415161718192021222324252627val list2Inter = for &#123; x1@(key, value) &lt;- map&#125; yield &#123; val x2@i10 = value + 10 (x1, x2)&#125;val z@(x, y) = 1 -&gt; 2println(\"z: \" + z)val list2InterEqual = map map &#123; p =&gt; &#123; val (x, y) = p (x, y) -&gt; (y + 10) &#125;&#125;val list2InterEqual2 = map map &#123; p =&gt; &#123; val (x, y) = p ((x, y), y + 10) &#125;&#125;println(list2Inter)println(list2InterEqual)println(list2InterEqual2) æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå†…éƒ¨çš„æ¨å¯¼å¼ yield äº†ä¸€ä¸ªå…ƒç»„ï¼Œæ‰€ä»¥è¿˜æ˜¯è¿”å›äº†ä¸€ä¸ª mapï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ map çš„è¿”å›å€¼ä¹Ÿåº”æ˜¯ä¸€ä¸ªmap æˆ–å…ƒç»„ ï¼ˆä»£ç ä¸­æœ‰ä¸¤ä¸ªç­‰ä»·è¡¨è¾¾å¼ï¼‰ã€‚ åœ¨å†…éƒ¨çš„ for æ¨å¯¼å¼çš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬è¿›ä¸€æ­¥æ˜ å°„ 123456789101112131415val list2Equal = map map &#123; p =&gt; &#123; val (x, y) = p (x, y) -&gt; (y + 10)&#125;&#125; map &#123; k =&gt; &#123; val (m, n) = k n&#125;&#125;val list2Equal2 = map map &#123; p =&gt; &#123; val (_, y) = p y + 10&#125;&#125; ç¬¬ä¸€ä¸ªæ˜¯çº¯ç²¹ä½¿ç”¨ä¸Šä¸€æ­¥çš„çš„å†…éƒ¨æ¨å¯¼å¼çš„è½¬æ¢ç»“æœå†æ¬¡è¿›è¡Œ map å¾—åˆ°çš„ã€‚å¤–å±‚çš„ for æ¨å¯¼å¼åªæ˜¯å°†å…ƒç»„çš„ç¬¬äºŒä¸ªå€¼è¿”å›ã€‚æ‰€ä»¥æˆ‘ä»¬ç¬¬äºŒä¸ªè¡¨è¾¾å¼ç®€åŒ–äº†è¿‡ç¨‹ï¼Œç›´æ¥åœ¨å†…éƒ¨çš„ map å°±åªè¿”å›å…ƒç»„çš„ç¬¬äºŒä¸ªå€¼ã€‚å½“ç„¶å¦‚æœç¬¬äºŒå±‚ for æ¨å¯¼å¼æ›´åŠ å¤æ‚ï¼Œå°±ä»ç„¶éœ€è¦ä½¿ç”¨ç¬¬ä¸€ä¸ªè¡¨è¾¾å¼æ¥ç­‰ä»·ç¿»è¯‘ï¼Œè€Œä¸”å¯¹äº scala æœ¬èº«åº”è¯¥ä¹Ÿæ˜¯ä½¿ç”¨ç¬¬ä¸€ä¸ªè¡¨è¾¾å¼è¿›è¡Œç¿»è¯‘ã€‚ For çš„åº”ç”¨å®¹å™¨ä¸€èˆ¬æˆ‘ä»¬éƒ½æ˜¯ä½¿ç”¨æ˜æ˜¾çš„å®¹å™¨ï¼Œæ¯”å¦‚ List, Array ä»¥åŠ Mapï¼Œå®é™…ä¸Šåªè¦å®¹å™¨æ”¯æŒ foreachï¼Œmapï¼Œflat å’Œ withFilter çš„æ“ä½œéƒ½å¯ä»¥ä½¿ç”¨ for æ¨å¯¼å¼ã€‚æ¯”å¦‚ Optionï¼Œ Eitherï¼Œ Try ç­‰ç­‰ã€‚","categories":[{"name":"Scalaå­¦ä¹ ","slug":"Scalaå­¦ä¹ ","permalink":"https://shang.at/categories/Scalaå­¦ä¹ /"}],"tags":[{"name":"Scala-for-yield","slug":"Scala-for-yield","permalink":"https://shang.at/tags/Scala-for-yield/"}]},{"title":"Scalaå­¦ä¹ -ç±»å‹","slug":"Scalaå­¦ä¹ -0-ç±»å‹","date":"2020-07-26T08:18:55.000Z","updated":"2021-04-14T08:22:37.397Z","comments":true,"path":"post/Scalaå­¦ä¹ -0-ç±»å‹/","link":"","permalink":"https://shang.at/post/Scalaå­¦ä¹ -0-ç±»å‹/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š W3CSchool Scalaçš„æ•™ç¨‹ åœ¨Scalaä¸­ï¼Œæ‰€æœ‰çš„å€¼éƒ½æœ‰ç±»å‹ï¼ŒåŒ…æ‹¬æ•°å€¼å’Œå‡½æ•° Scalaç±»å‹å±‚æ¬¡ç»“æ„Anyæ˜¯æ‰€æœ‰ç±»å‹çš„è¶…ç±»å‹ï¼Œä¹Ÿç§°ä¸ºé¡¶çº§ç±» å‹ã€‚å®ƒå®šä¹‰äº†ä¸€äº›é€šç”¨çš„æ–¹æ³•å¦‚equalsã€hashCodeå’ŒtoStringã€‚Anyæœ‰ä¸¤ä¸ªç›´æ¥å­ç±»ï¼šAnyValå’ŒAnyRefã€‚ AnyValä»£è¡¨å€¼ç±»å‹ã€‚æœ‰9ä¸ªé¢„å®šä¹‰çš„éç©ºçš„å€¼ç±»å‹åˆ†åˆ«æ˜¯ï¼šDoubleã€Floatã€Longã€Intã€Shortã€Byteã€Charã€Unitå’ŒBooleanã€‚Unitæ˜¯ä¸å¸¦ä»»ä½•æ„ä¹‰çš„å€¼ç±»å‹ï¼Œå®ƒä»…æœ‰ä¸€ä¸ªå®ä¾‹å¯ä»¥åƒè¿™æ ·å£°æ˜ï¼š()ã€‚æ‰€æœ‰çš„å‡½æ•°å¿…é¡»æœ‰è¿”å›ï¼Œæ‰€ä»¥è¯´æœ‰æ—¶å€™Unitä¹Ÿæ˜¯æœ‰ç”¨çš„è¿”å›ç±»å‹ã€‚ AnyRefä»£è¡¨å¼•ç”¨ç±»å‹ã€‚æ‰€æœ‰éå€¼ç±»å‹éƒ½è¢«å®šä¹‰ä¸ºå¼•ç”¨ç±»å‹ã€‚åœ¨Scalaä¸­ï¼Œæ¯ä¸ªç”¨æˆ·è‡ªå®šä¹‰çš„ç±»å‹éƒ½æ˜¯AnyRefçš„å­ç±»å‹ã€‚å¦‚æœScalaè¢«åº”ç”¨åœ¨Javaçš„è¿è¡Œç¯å¢ƒä¸­ï¼ŒAnyRefç›¸å½“äºjava.lang.Objectã€‚ ç±»å‹è½¬æ¢å€¼ç±»å‹å¯ä»¥æŒ‰ç…§ä¸‹é¢çš„æ–¹å‘è¿›è¡Œè½¬æ¢ï¼š scalaä¸­é»˜è®¤å­˜åœ¨ä»¥ä¸‹çš„å€¼ç±»å‹çš„éšå¼è½¬æ¢ Nothingå’ŒNullNothingæ˜¯æ‰€æœ‰ç±»å‹çš„å­ç±»å‹ï¼Œä¹Ÿç§°ä¸ºåº•éƒ¨ç±»å‹ã€‚æ²¡æœ‰ä¸€ä¸ªå€¼æ˜¯Nothingç±»å‹çš„ã€‚å®ƒçš„ç”¨é€”ä¹‹ä¸€æ˜¯ç»™å‡ºéæ­£å¸¸ç»ˆæ­¢çš„ä¿¡å·ï¼Œå¦‚æŠ›å‡ºå¼‚å¸¸ã€ç¨‹åºé€€å‡ºæˆ–è€…ä¸€ä¸ªæ— é™å¾ªç¯ï¼ˆå¯ä»¥ç†è§£ä¸ºå®ƒæ˜¯ä¸€ä¸ªä¸å¯¹å€¼è¿›è¡Œå®šä¹‰çš„è¡¨è¾¾å¼çš„ç±»å‹ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªä¸èƒ½æ­£å¸¸è¿”å›çš„æ–¹æ³•ï¼‰ã€‚ Nullæ˜¯æ‰€æœ‰å¼•ç”¨ç±»å‹çš„å­ç±»å‹ï¼ˆå³AnyRefçš„ä»»æ„å­ç±»å‹ï¼‰ã€‚å®ƒæœ‰ä¸€ä¸ªå•ä¾‹å€¼ç”±å…³é”®å­—nullæ‰€å®šä¹‰ã€‚Nullä¸»è¦æ˜¯ä½¿å¾—Scalaæ»¡è¶³å’Œå…¶ä»–JVMè¯­è¨€çš„äº’æ“ä½œæ€§ï¼Œä½†æ˜¯å‡ ä¹ä¸åº”è¯¥åœ¨Scalaä»£ç ä¸­ä½¿ç”¨ã€‚æˆ‘ä»¬å°†åœ¨åé¢çš„ç« èŠ‚ä¸­ä»‹ç»nullçš„æ›¿ä»£æ–¹æ¡ˆã€‚","categories":[{"name":"Scalaå­¦ä¹ ","slug":"Scalaå­¦ä¹ ","permalink":"https://shang.at/categories/Scalaå­¦ä¹ /"}],"tags":[{"name":"Scalaç±»å‹","slug":"Scalaç±»å‹","permalink":"https://shang.at/tags/Scalaç±»å‹/"}]},{"title":"å·¥å…·ä½¿ç”¨-ç¼–è¯‘å·¥å…·-maven","slug":"å·¥å…·ä½¿ç”¨-ç¼–è¯‘å·¥å…·-maven","date":"2020-07-24T10:06:19.000Z","updated":"2021-04-12T05:34:55.736Z","comments":true,"path":"post/å·¥å…·ä½¿ç”¨-ç¼–è¯‘å·¥å…·-maven/","link":"","permalink":"https://shang.at/post/å·¥å…·ä½¿ç”¨-ç¼–è¯‘å·¥å…·-maven/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š mavené…ç½®settings123456789101112131415161718192021222324252627282930313233343536373839404142434445&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;settings&gt; &lt;!--éœ€è¦æ”¹æˆè‡ªå·±çš„mavençš„æœ¬åœ°ä»“åº“åœ°å€--&gt; &lt;localRepository&gt;~/.m2/repository&lt;/localRepository&gt; &lt;mirrors&gt; &lt;mirror&gt; &lt;id&gt;alimaven&lt;/id&gt; &lt;name&gt;aliyun maven&lt;/name&gt; &lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public/&lt;/url&gt; &lt;mirrorOf&gt;central&lt;/mirrorOf&gt; &lt;/mirror&gt; &lt;/mirrors&gt; &lt;profiles&gt; &lt;profile&gt; &lt;id&gt;nexus&lt;/id&gt; &lt;repositories&gt; &lt;repository&gt; &lt;id&gt;nexus&lt;/id&gt; &lt;name&gt;local private nexus&lt;/name&gt; &lt;url&gt;http://maven.oschina.net/content/groups/public/&lt;/url&gt; &lt;releases&gt; &lt;enabled&gt;true&lt;/enabled&gt; &lt;/releases&gt; &lt;snapshots&gt; &lt;enabled&gt;false&lt;/enabled&gt; &lt;/snapshots&gt; &lt;/repository&gt; &lt;/repositories&gt; &lt;pluginRepositories&gt; &lt;pluginRepository&gt; &lt;id&gt;nexus&lt;/id&gt; &lt;name&gt;local private nexus&lt;/name&gt; &lt;url&gt;http://maven.oschina.net/content/groups/public/&lt;/url&gt; &lt;releases&gt; &lt;enabled&gt;true&lt;/enabled&gt; &lt;/releases&gt; &lt;snapshots&gt; &lt;enabled&gt;false&lt;/enabled&gt; &lt;/snapshots&gt; &lt;/pluginRepository&gt; &lt;/pluginRepositories&gt; &lt;/profile&gt; &lt;/profiles&gt;&lt;/settings&gt; localRepository â€‹ æœ¬åœ°mavenä»“åº“è·¯å¾„ pluginGroups proxies â€‹ ä»£ç†è®¾ç½® servers mirrors profiles activeProfiles pom.xmlScope compileï¼šé»˜è®¤çš„scopeï¼Œè¿è¡ŒæœŸæœ‰æ•ˆï¼Œéœ€è¦æ‰“å…¥åŒ…ä¸­ providedï¼šç¼–è¯‘æœŸæœ‰æ•ˆï¼Œè¿è¡ŒæœŸä¸éœ€è¦æä¾›ï¼Œä¸ä¼šæ‰“å…¥åŒ…ä¸­ runtimeï¼šç¼–è¯‘ä¸éœ€è¦ï¼Œåœ¨è¿è¡ŒæœŸæœ‰æ•ˆï¼Œéœ€è¦å¯¼å…¥åŒ…ä¸­ã€‚ï¼ˆæ¥å£ä¸å®ç°åˆ†ç¦»ï¼‰ testï¼šæµ‹è¯•éœ€è¦ï¼Œä¸ä¼šæ‰“å…¥åŒ…ä¸­ systemï¼šéæœ¬åœ°ä»“åº“å¼•å…¥ã€å­˜åœ¨ç³»ç»Ÿçš„æŸä¸ªè·¯å¾„ä¸‹çš„jarã€‚ï¼ˆä¸€èˆ¬ä¸ä½¿ç”¨ï¼‰ mavençš„å¸¸è§å‘½ä»¤é¡¹ç›®ç¼–è¯‘ï¼šmvn clean package -Dmaven.test.skip ä½¿ç”¨æŒ‡å®šçš„setting.xmlæ–‡ä»¶ï¼šmvn clean package --settings ~/.m2/settings.xml.fast -Dmaven.test.skip æ”¶é›†é¡¹ç›®æ‰€ä¾èµ–çš„libï¼šmvn dependency:copy-dependencies -DoutputDirectory=lib ä¸‹è½½æºç ï¼šmvn dependency:sources å°†jaråŒ…å®‰è£…åˆ°æœ¬åœ°ä»“åº“mvn install:install-file -Dfile=... -DgroupId=... -DartifactId=... -Dversion=... -Dpackaging=jar å¦‚ï¼šmvn install:install-file -Dfile=IKAnalyzer2012_FF.jar -DgroupId=org.wltea.ik-analyzer -DartifactId=ik-analyzer -Dversion=5.0.0 -Dpackaging=jar å°†jaråŒ…å‘å¸ƒåˆ°ç§æœmvn deploy:deploy-file -DgroupId=... -DartifactId=... -Dversion=... -Dgenertatepom=true -Dpackaging=jar -Dfile=... -Durl=... mvn deploy:deploy-file --settings ~/.m2/settings.xml -DgroupId=sqlline -DartifactId=sqlline -Dversion=1.1.8 -Dgenertatepom=true -Dpackaging=jar -Dfile=/Users/wangshang/.m2/repository/sqlline/sqlline/1.1.8/sqlline-1.1.8.jar -Durl=... -DrepositoryId=archiva.internal å¦‚æœæ˜¯æœ¬åœ°é¡¹ç›®æ‰“åŒ…ä¸Šä¼ éœ€è¦åˆ°ç§æœï¼Œéœ€è¦åœ¨pom.xmlæ–‡ä»¶å’Œmavençš„settings.xmlé…ç½®æ–‡ä»¶ä¸­åšç±»ä¼¼å¦‚ä¸‹çš„é…ç½®ï¼š pom.xml é…ç½®è¦ä¸Šä¼ çš„ç§æœåœ°å€ 123456789101112&lt;distributionManagement&gt; &lt;repository&gt; &lt;id&gt;archiva.internal&lt;/id&gt; &lt;name&gt;Internal Release Repository&lt;/name&gt; &lt;url&gt;...&lt;/url&gt; &lt;/repository&gt; &lt;snapshotRepository&gt; &lt;id&gt;archiva.snapshots&lt;/id&gt; &lt;name&gt;Internal Snapshot Repository&lt;/name&gt; &lt;url&gt;...&lt;/url&gt; &lt;/snapshotRepository&gt; &lt;/distributionManagement&gt; settings.xml é…ç½®ç§æœçš„è®¤è¯ä¿¡æ¯ 123456789101112&lt;servers&gt; &lt;server&gt; &lt;id&gt;archiva.internal&lt;/id&gt; &lt;username&gt;...&lt;/username&gt; &lt;password&gt;...&lt;/password&gt; &lt;/server&gt; &lt;server&gt; &lt;id&gt;archiva.snapshots&lt;/id&gt; &lt;username&gt;...&lt;/username&gt; &lt;password&gt;...&lt;/password&gt; &lt;/server&gt; &lt;/servers&gt;","categories":[{"name":"å·¥å…·ä½¿ç”¨","slug":"å·¥å…·ä½¿ç”¨","permalink":"https://shang.at/categories/å·¥å…·ä½¿ç”¨/"}],"tags":[{"name":"maven","slug":"maven","permalink":"https://shang.at/tags/maven/"}]},{"title":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°12-æš´åŠ›é€’å½’åˆ°åŠ¨æ€è§„åˆ’1-4","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°12-æš´åŠ›è§„åˆ’åˆ°åŠ¨æ€è§„åˆ’1-4","date":"2020-07-23T04:19:14.000Z","updated":"2020-07-23T06:00:30.532Z","comments":true,"path":"post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°12-æš´åŠ›è§„åˆ’åˆ°åŠ¨æ€è§„åˆ’1-4/","link":"","permalink":"https://shang.at/post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°12-æš´åŠ›è§„åˆ’åˆ°åŠ¨æ€è§„åˆ’1-4/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š","categories":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://shang.at/categories/æ•°æ®ç»“æ„ä¸ç®—æ³•/"}],"tags":[{"name":"å·¦ç¥å­¦ä¹ ç¬”è®°","slug":"å·¦ç¥å­¦ä¹ ç¬”è®°","permalink":"https://shang.at/tags/å·¦ç¥å­¦ä¹ ç¬”è®°/"}]},{"title":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°11-åŠ¨æ€è§„åˆ’","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°11-åŠ¨æ€è§„åˆ’","date":"2020-07-23T04:18:52.000Z","updated":"2020-07-23T06:00:26.672Z","comments":true,"path":"post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°11-åŠ¨æ€è§„åˆ’/","link":"","permalink":"https://shang.at/post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°11-åŠ¨æ€è§„åˆ’/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š","categories":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://shang.at/categories/æ•°æ®ç»“æ„ä¸ç®—æ³•/"}],"tags":[{"name":"å·¦ç¥å­¦ä¹ ç¬”è®°","slug":"å·¦ç¥å­¦ä¹ ç¬”è®°","permalink":"https://shang.at/tags/å·¦ç¥å­¦ä¹ ç¬”è®°/"}]},{"title":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°10-æš´åŠ›é€’å½’","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°10-æš´åŠ›é€’å½’","date":"2020-07-23T04:18:43.000Z","updated":"2020-07-23T06:00:24.432Z","comments":true,"path":"post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°10-æš´åŠ›é€’å½’/","link":"","permalink":"https://shang.at/post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°10-æš´åŠ›é€’å½’/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š","categories":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://shang.at/categories/æ•°æ®ç»“æ„ä¸ç®—æ³•/"}],"tags":[{"name":"å·¦ç¥å­¦ä¹ ç¬”è®°","slug":"å·¦ç¥å­¦ä¹ ç¬”è®°","permalink":"https://shang.at/tags/å·¦ç¥å­¦ä¹ ç¬”è®°/"}]},{"title":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°9-å¹¶æŸ¥é›†&å›¾","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°9-å¹¶æŸ¥é›†-å›¾","date":"2020-07-23T04:18:31.000Z","updated":"2021-01-21T01:13:06.122Z","comments":true,"path":"post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°9-å¹¶æŸ¥é›†-å›¾/","link":"","permalink":"https://shang.at/post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°9-å¹¶æŸ¥é›†-å›¾/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š å¹¶æŸ¥é›†ï¼šå¯ä»¥è§£å†³è¿é€šæ€§é—®é¢˜ï¼Œ","categories":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://shang.at/categories/æ•°æ®ç»“æ„ä¸ç®—æ³•/"}],"tags":[{"name":"å·¦ç¥å­¦ä¹ ç¬”è®°","slug":"å·¦ç¥å­¦ä¹ ç¬”è®°","permalink":"https://shang.at/tags/å·¦ç¥å­¦ä¹ ç¬”è®°/"}]},{"title":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°8-è´ªå¿ƒç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°8-è´ªå¿ƒç®—æ³•","date":"2020-07-23T04:18:15.000Z","updated":"2020-07-23T06:00:18.411Z","comments":true,"path":"post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°8-è´ªå¿ƒç®—æ³•/","link":"","permalink":"https://shang.at/post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°8-è´ªå¿ƒç®—æ³•/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š","categories":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://shang.at/categories/æ•°æ®ç»“æ„ä¸ç®—æ³•/"}],"tags":[{"name":"å·¦ç¥å­¦ä¹ ç¬”è®°","slug":"å·¦ç¥å­¦ä¹ ç¬”è®°","permalink":"https://shang.at/tags/å·¦ç¥å­¦ä¹ ç¬”è®°/"}]},{"title":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°7-äºŒå‰æ ‘çš„é€’å½’å¥—è·¯","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°7-äºŒå‰æ ‘çš„é€’å½’å¥—è·¯","date":"2020-07-23T04:18:05.000Z","updated":"2020-07-23T06:00:15.894Z","comments":true,"path":"post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°7-äºŒå‰æ ‘çš„é€’å½’å¥—è·¯/","link":"","permalink":"https://shang.at/post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°7-äºŒå‰æ ‘çš„é€’å½’å¥—è·¯/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š","categories":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://shang.at/categories/æ•°æ®ç»“æ„ä¸ç®—æ³•/"}],"tags":[{"name":"å·¦ç¥å­¦ä¹ ç¬”è®°","slug":"å·¦ç¥å­¦ä¹ ç¬”è®°","permalink":"https://shang.at/tags/å·¦ç¥å­¦ä¹ ç¬”è®°/"}]},{"title":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°6-é“¾è¡¨ç›¸å…³é¢è¯•é¢˜","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°6-é“¾è¡¨ç›¸å…³é¢è¯•é¢˜","date":"2020-07-23T04:17:43.000Z","updated":"2020-07-24T10:06:39.139Z","comments":true,"path":"post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°6-é“¾è¡¨ç›¸å…³é¢è¯•é¢˜/","link":"","permalink":"https://shang.at/post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°6-é“¾è¡¨ç›¸å…³é¢è¯•é¢˜/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š","categories":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://shang.at/categories/æ•°æ®ç»“æ„ä¸ç®—æ³•/"}],"tags":[{"name":"å·¦ç¥å­¦ä¹ ç¬”è®°","slug":"å·¦ç¥å­¦ä¹ ç¬”è®°","permalink":"https://shang.at/tags/å·¦ç¥å­¦ä¹ ç¬”è®°/"}]},{"title":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°5-Trie&æ¡¶æ’åº&æ’åºæ€»ç»“","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°5-Trie-æ¡¶æ’åº-æ’åºæ€»ç»“","date":"2020-07-23T04:17:29.000Z","updated":"2020-07-23T06:00:10.925Z","comments":true,"path":"post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°5-Trie-æ¡¶æ’åº-æ’åºæ€»ç»“/","link":"","permalink":"https://shang.at/post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°5-Trie-æ¡¶æ’åº-æ’åºæ€»ç»“/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š","categories":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://shang.at/categories/æ•°æ®ç»“æ„ä¸ç®—æ³•/"}],"tags":[{"name":"å·¦ç¥å­¦ä¹ ç¬”è®°","slug":"å·¦ç¥å­¦ä¹ ç¬”è®°","permalink":"https://shang.at/tags/å·¦ç¥å­¦ä¹ ç¬”è®°/"}]},{"title":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°4-æ¯”è¾ƒå™¨&å †","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°4-æ¯”è¾ƒå™¨-å †","date":"2020-07-23T04:17:04.000Z","updated":"2020-12-04T02:47:43.775Z","comments":true,"path":"post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°4-æ¯”è¾ƒå™¨-å †/","link":"","permalink":"https://shang.at/post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°4-æ¯”è¾ƒå™¨-å †/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š å †æ˜¯ä¸€ç§ç‰¹æ®Šçš„äºŒå‰æ ‘ç»“æ„-å®Œå…¨äºŒå‰æ ‘ï¼Œå®ƒå¯ä»¥ä½¿ç”¨è¿ç»­çš„æ•°ç»„æ¥è¡¨ç¤º å®Œå…¨äºŒå‰æ ‘:äºŒå‰æ ‘çš„æ¯ä¸€å±‚éƒ½æ˜¯ä»å·¦åˆ°å³å¡«å……","categories":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://shang.at/categories/æ•°æ®ç»“æ„ä¸ç®—æ³•/"}],"tags":[{"name":"å·¦ç¥å­¦ä¹ ç¬”è®°","slug":"å·¦ç¥å­¦ä¹ ç¬”è®°","permalink":"https://shang.at/tags/å·¦ç¥å­¦ä¹ ç¬”è®°/"}]},{"title":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°3-å½’å¹¶&éšæœºå¿«æ’","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°3-å½’å¹¶-éšæœºå¿«æ’","date":"2020-07-23T04:16:44.000Z","updated":"2020-07-23T06:00:06.044Z","comments":true,"path":"post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°3-å½’å¹¶-éšæœºå¿«æ’/","link":"","permalink":"https://shang.at/post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°3-å½’å¹¶-éšæœºå¿«æ’/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š","categories":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://shang.at/categories/æ•°æ®ç»“æ„ä¸ç®—æ³•/"}],"tags":[{"name":"å·¦ç¥å­¦ä¹ ç¬”è®°","slug":"å·¦ç¥å­¦ä¹ ç¬”è®°","permalink":"https://shang.at/tags/å·¦ç¥å­¦ä¹ ç¬”è®°/"}]},{"title":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°2-é“¾è¡¨&æ ˆ&é˜Ÿåˆ—&é€’å½’&å“ˆå¸Œè¡¨","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°2-é“¾è¡¨-æ ˆ-é˜Ÿåˆ—-é€’å½’-å“ˆå¸Œè¡¨","date":"2020-07-23T04:16:10.000Z","updated":"2020-07-23T06:00:03.558Z","comments":true,"path":"post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°2-é“¾è¡¨-æ ˆ-é˜Ÿåˆ—-é€’å½’-å“ˆå¸Œè¡¨/","link":"","permalink":"https://shang.at/post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°2-é“¾è¡¨-æ ˆ-é˜Ÿåˆ—-é€’å½’-å“ˆå¸Œè¡¨/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š","categories":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://shang.at/categories/æ•°æ®ç»“æ„ä¸ç®—æ³•/"}],"tags":[{"name":"å·¦ç¥å­¦ä¹ ç¬”è®°","slug":"å·¦ç¥å­¦ä¹ ç¬”è®°","permalink":"https://shang.at/tags/å·¦ç¥å­¦ä¹ ç¬”è®°/"}]},{"title":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°1-å¤æ‚åº¦&å¯¹æ•°å™¨&äºŒåˆ†æ³•&ä½è¿ç®—","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°1-å¤æ‚åº¦-å¯¹æ•°å™¨-äºŒåˆ†æ³•-ä½è¿ç®—","date":"2020-07-23T04:15:02.000Z","updated":"2020-11-06T09:30:44.702Z","comments":true,"path":"post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°1-å¤æ‚åº¦-å¯¹æ•°å™¨-äºŒåˆ†æ³•-ä½è¿ç®—/","link":"","permalink":"https://shang.at/post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°1-å¤æ‚åº¦-å¯¹æ•°å™¨-äºŒåˆ†æ³•-ä½è¿ç®—/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š å¤æ‚åº¦å¯¹æ•°å™¨äºŒåˆ†æ³•ä½è¿ç®—","categories":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://shang.at/categories/æ•°æ®ç»“æ„ä¸ç®—æ³•/"}],"tags":[{"name":"å·¦ç¥å­¦ä¹ ç¬”è®°","slug":"å·¦ç¥å­¦ä¹ ç¬”è®°","permalink":"https://shang.at/tags/å·¦ç¥å­¦ä¹ ç¬”è®°/"}]},{"title":"å¤§æ•°æ®-aws","slug":"å¤§æ•°æ®-aws","date":"2020-07-23T01:08:29.000Z","updated":"2020-07-23T01:13:53.160Z","comments":true,"path":"post/å¤§æ•°æ®-aws/","link":"","permalink":"https://shang.at/post/å¤§æ•°æ®-aws/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š AWSå¸¸è§å‘½ä»¤aws s3 [commend] help aws s3 ls [â€”recursive] [â€”human-readable] [â€”summarize] aws s3 rm s3_path [â€”recursive] aws s3 cp s3_path target_path [â€”recursive]","categories":[{"name":"å¤§æ•°æ®","slug":"å¤§æ•°æ®","permalink":"https://shang.at/categories/å¤§æ•°æ®/"}],"tags":[{"name":"aws","slug":"aws","permalink":"https://shang.at/tags/aws/"}]},{"title":"Pythonå­¦ä¹ -æ–‡ä»¶æ“ä½œ","slug":"Pythonå­¦ä¹ -æ–‡ä»¶æ“ä½œ","date":"2020-07-22T03:24:24.000Z","updated":"2020-07-22T06:20:32.279Z","comments":true,"path":"post/Pythonå­¦ä¹ -æ–‡ä»¶æ“ä½œ/","link":"","permalink":"https://shang.at/post/Pythonå­¦ä¹ -æ–‡ä»¶æ“ä½œ/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š æ‰“å¼€æ–‡ä»¶ï¼šopen(filename, &#39;r|w|x|a|b|t|+&#39;, buffering=4096,) æ£€æµ‹è·¯å¾„æ˜¯å¦å­˜åœ¨ï¼šos.path.exists(path) åˆ›å»ºç›®å½•ï¼šos.mkdir(path) é€’å½’åˆ›å»ºè·¯å¾„ï¼šos.makedirs(path) åˆ é™¤ç›®å½•ï¼šos.rmdir(path) é€’å½’åˆ é™¤ç›®å½•ï¼šshutil.rmtree(path) è·å–å½“å‰çš„å·¥ä½œç›®å½•ï¼šos.getcwd() åˆ¤æ–­ç»™å®šçš„è·¯å¾„æ˜¯å¦ä¸ºç›®å½•ï¼šos.path.isdir(source) è·å–ç»™å®šæ–‡ä»¶å…¨è·¯å¾„çš„ä¸€çº§ç›®å½•ï¼šos.path.dirname(source) è·å–ç»™å®šæ–‡ä»¶å…¨è·¯å¾„çš„æ–‡ä»¶åï¼šos.path.basename(source) ä¿®æ”¹å·¥ä½œç›®å½•ï¼šos.chdir(source_dir) æ‹¼æ¥è·¯å¾„ï¼šos.path.join(path1, path2) æ‰§è¡Œshellå‘½ä»¤ï¼šos.system(cmd) å¾ªç¯éå†æŒ‡å®šç›®å½•ä¸‹ çš„(ç›´å±çš„)æ‰€æœ‰æ–‡ä»¶(å¤¹)ï¼šos.listdir(path) é€’å½’éå†æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶(å¤¹)ï¼šos.walk(path)ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªgenerator 12345#conding=utf8 import os for path,dir_list,file_list in os.walk(path): for file_name in file_list: print(os.path.join(path, file_name))","categories":[{"name":"Python","slug":"Python","permalink":"https://shang.at/categories/Python/"}],"tags":[{"name":"æ–‡ä»¶æ“ä½œ","slug":"æ–‡ä»¶æ“ä½œ","permalink":"https://shang.at/tags/æ–‡ä»¶æ“ä½œ/"}]},{"title":"æ“ä½œç³»ç»Ÿ-ç½‘ç»œçš„é…ç½®","slug":"æ“ä½œç³»ç»Ÿ-ç½‘ç»œçš„é…ç½®","date":"2020-07-15T14:24:58.000Z","updated":"2020-12-11T07:58:56.809Z","comments":true,"path":"post/æ“ä½œç³»ç»Ÿ-ç½‘ç»œçš„é…ç½®/","link":"","permalink":"https://shang.at/post/æ“ä½œç³»ç»Ÿ-ç½‘ç»œçš„é…ç½®/","excerpt":"ç®€ä»‹ï¼šæœ¬ä¾‹ä¸­ä»¥CentOS 7ä¸¾ä¾‹è¯´æ˜å¦‚ä½•è®¾ç½®Linuxå¼€æœºè‡ªåŠ¨è·å–IPåœ°å€å’Œè®¾ç½®å›ºå®šIPåœ°å€ã€‚","text":"ç®€ä»‹ï¼šæœ¬ä¾‹ä¸­ä»¥CentOS 7ä¸¾ä¾‹è¯´æ˜å¦‚ä½•è®¾ç½®Linuxå¼€æœºè‡ªåŠ¨è·å–IPåœ°å€å’Œè®¾ç½®å›ºå®šIPåœ°å€ã€‚ è‡ªåŠ¨è·å–åŠ¨æ€IPåœ°å€1.è¾“å…¥â€œip addrâ€å¹¶æŒ‰å›è½¦é”®ç¡®å®šï¼Œå‘ç°æ— æ³•è·å–IP(CentOS 7é»˜è®¤æ²¡æœ‰ifconfigå‘½ä»¤)ï¼Œè®°å½•ä¸‹ç½‘å¡åç§°ï¼ˆæœ¬ä¾‹ä¸­ä¸ºens33ï¼‰ã€‚ 2.è¾“å…¥â€œcd /etc/sysconfig/network-scripts/â€æŒ‰å›è½¦é”®ç¡®å®šï¼Œç»§ç»­è¾“å…¥â€œlsâ€æŒ‰å›è½¦é”®æŸ¥çœ‹æ–‡ä»¶ã€‚ 3.è¾“å…¥â€œvi ifcfg-ens33â€å¹¶æŒ‰å›è½¦é”®ç¡®å®šï¼ˆç½‘å¡åç§°å¯èƒ½ä¸åŒï¼‰ã€‚äº¦å¯åœ¨ç¬¬äºŒæ­¥ç›´æ¥è¾“å…¥â€œcd /etc/sysconfig/network-scripts/ifcfg-ens33â€ç›´æ¥ç¼–è¾‘æ–‡ä»¶ã€‚ 4.æŸ¥çœ‹æœ€åä¸€é¡¹ï¼ˆè“è‰²æ¡†å†…ï¼‰ï¼Œå‘ç°ä¸ºâ€œONBOOT=noâ€ã€‚ 5.æŒ‰â€œiâ€é”®è¿›å…¥ç¼–è¾‘çŠ¶æ€ï¼Œå°†æœ€åä¸€è¡Œâ€œnoâ€ä¿®æ”¹ä¸ºâ€œyesâ€ï¼Œç„¶åæŒ‰â€œESCâ€é”®é€€å‡ºç¼–è¾‘çŠ¶æ€ï¼Œå¹¶è¾“å…¥â€œ:xâ€ä¿å­˜é€€å‡ºã€‚ 6.è¾“å…¥â€œservice network restartâ€é‡å¯æœåŠ¡,äº¦å¯è¾“å…¥â€œsystemctl restart netwrokâ€ã€‚ 7.å†æ¬¡è¾“å…¥â€œip addrâ€æŸ¥çœ‹ï¼Œç°å·²å¯è‡ªåŠ¨è·å–IPåœ°å€ã€‚ è®¾ç½®é™æ€IPåœ°å€8.è¾“å…¥â€œcd /etc/sysconfig/network-scripts/â€æŒ‰å›è½¦é”®ç¡®å®šï¼Œç»§ç»­è¾“å…¥â€œlsâ€æŒ‰å›è½¦é”®æŸ¥çœ‹æ–‡ä»¶ï¼Œç¡®å®šç½‘å¡åç§°ã€‚ 9.è¾“å…¥â€œvi ifcfg-ens33â€å¹¶æŒ‰å›è½¦é”®ç¡®å®šï¼ˆç½‘å¡åç§°å¯èƒ½ä¸åŒï¼‰ã€‚å¦‚ç¡®çŸ¥ç½‘å¡åç§°å¯ç›´æ¥è¾“å…¥â€œcd /etc/sysconfig/network-scripts/ifcfg-ens33â€ç¼–è¾‘æ–‡ä»¶ã€‚ 10.æŒ‰â€œiâ€è¿›å…¥ç¼–è¾‘çŠ¶æ€ï¼Œè®¾ç½®ä¸ºâ€œBOOTPROTO=â€™staticâ€™â€ï¼ˆå¦‚è®¾ç½®ä¸ºnoneåˆ™ç¦æ­¢DHCPï¼Œstaticåˆ™å¯ç”¨é™æ€IPåœ°å€ï¼Œè®¾ç½®ä¸ºdhcpåˆ™ä¸ºå¼€å¯DHCPæœåŠ¡ï¼‰ï¼Œå¹¶ä¿®æ”¹å…¶ä»–éƒ¨åˆ†ä¸ºæ‚¨çš„è®¾ç½®ï¼Œ æœ¬ä¾‹ä¸­ä¸º192.168.1.200/24ï¼ŒGW:192.168.1.1ï¼Œå¯æ ¹æ®æ‚¨çš„éœ€è¦é…ç½®IPV6éƒ¨åˆ†ã€‚ æ³¨æ„ï¼šNM_CONTROLLED=noå’ŒONBOOT=yeså¯æ ¹æ®æ‚¨çš„éœ€æ±‚è¿›è¡Œè®¾ç½®ã€‚ 11.ç¡®è®¤æ— è¯¯åæŒ‰â€œESCâ€é€€å‡ºç¼–è¾‘çŠ¶æ€ï¼Œå¹¶è¾“å…¥â€œ:xâ€ä¿å­˜é€€å‡ºï¼Œè¾“å…¥â€œservice network restartâ€é‡å¯æœåŠ¡åè¾“å…¥â€œifconfigâ€æŸ¥çœ‹ç½‘ç»œé…ç½®ã€‚ 12.å¦‚éœ€è®¾ç½®DNS(éœ€åœ¨ç¬¬9æ­¥è®¾ç½®NM_CONTROLLED=no)åˆ™è¾“å…¥â€œvi /etc/resolv.confâ€å¹¶æŒ‰å›è½¦é”®æ‰§è¡Œå‘½ä»¤ï¼ˆå¦‚å·²åœ¨ç¬¬9æ­¥é…ç½®DNSåˆ™å¯çœç•¥æ­¤æ­¥éª¤ï¼‰ã€‚ 13.åœ¨æ­¤æ–‡ä»¶é‡Œé¢è¾“å…¥DNSæœåŠ¡å™¨åœ°å€ï¼ˆæœ¬ä¾‹ä¸­ä»¥å¹¿ä¸œç”µä¿¡ä¸ºä¾‹ï¼Œäº¦å¯è¾“å…¥è·¯ç”±å™¨DNSåœ°å€ï¼‰å¹¶ä¿å­˜é€€å‡ºã€‚","categories":[{"name":"æ“ä½œç³»ç»Ÿ","slug":"æ“ä½œç³»ç»Ÿ","permalink":"https://shang.at/categories/æ“ä½œç³»ç»Ÿ/"}],"tags":[{"name":"ç½‘ç»œçš„é…ç½®","slug":"ç½‘ç»œçš„é…ç½®","permalink":"https://shang.at/tags/ç½‘ç»œçš„é…ç½®/"}]},{"title":"å·¥å…·ä½¿ç”¨-UML","slug":"å·¥å…·ä½¿ç”¨-UML","date":"2020-07-15T03:36:56.000Z","updated":"2020-12-11T08:09:12.465Z","comments":true,"path":"post/å·¥å…·ä½¿ç”¨-UML/","link":"","permalink":"https://shang.at/post/å·¥å…·ä½¿ç”¨-UML/","excerpt":"ç®€ä»‹ï¼šç»Ÿä¸€å»ºæ¨¡è¯­è¨€ï¼ˆUnified Modeling Languageï¼Œç¼©å†™UMLï¼‰ï¼Œæ˜¯éä¸“åˆ©çš„ç¬¬ä¸‰ä»£å»ºæ¨¡å’Œè§„çº¦è¯­è¨€ã€‚UMLæ˜¯ä¸€ç§å¼€æ”¾çš„æ–¹æ³•ï¼Œç”¨äºè¯´æ˜ã€å¯è§†åŒ–ã€æ„å»ºå’Œç¼–å†™ä¸€ä¸ªæ­£åœ¨å¼€å‘çš„ã€é¢å‘å¯¹è±¡çš„ã€è½¯ä»¶å¯†é›†ç³»ç»Ÿçš„åˆ¶å“çš„å¼€æ”¾æ–¹æ³•ã€‚","text":"ç®€ä»‹ï¼šç»Ÿä¸€å»ºæ¨¡è¯­è¨€ï¼ˆUnified Modeling Languageï¼Œç¼©å†™UMLï¼‰ï¼Œæ˜¯éä¸“åˆ©çš„ç¬¬ä¸‰ä»£å»ºæ¨¡å’Œè§„çº¦è¯­è¨€ã€‚UMLæ˜¯ä¸€ç§å¼€æ”¾çš„æ–¹æ³•ï¼Œç”¨äºè¯´æ˜ã€å¯è§†åŒ–ã€æ„å»ºå’Œç¼–å†™ä¸€ä¸ªæ­£åœ¨å¼€å‘çš„ã€é¢å‘å¯¹è±¡çš„ã€è½¯ä»¶å¯†é›†ç³»ç»Ÿçš„åˆ¶å“çš„å¼€æ”¾æ–¹æ³•ã€‚ æ¨èä½¿ç”¨https://app.lucidchart.com/åœ¨çº¿å·¥å…·è¿›è¡Œç»˜åˆ¶ UMLæ¨¡å‹å’Œå›¾å½¢ UMLåˆ†ä¸ºæ¨¡å‹å’Œå›¾å½¢ä¸¤å¤§ç±»ã€‚åŒºåˆ†UMLæ¨¡å‹å’ŒUMLå›¾æ˜¯éå¸¸é‡è¦çš„ï¼ŒUMLå›¾ï¼ˆåŒ…æ‹¬ç”¨ä¾‹å›¾ã€åä½œå›¾ã€æ´»åŠ¨å›¾ã€åºåˆ—å›¾ã€éƒ¨ç½²å›¾ã€æ„ä»¶å›¾ã€ç±»å›¾ã€çŠ¶æ€å›¾ï¼‰æ˜¯æ¨¡å‹ä¸­ä¿¡æ¯çš„å›¾è¡¨è¡¨è¾¾å½¢å¼ï¼Œä½†æ˜¯UMLæ¨¡å‹ç‹¬ç«‹äºUMLå›¾å­˜åœ¨ã€‚ åœ¨UMLç³»ç»Ÿå¼€å‘ä¸­æœ‰ä¸‰ä¸ªä¸»è¦çš„æ¨¡å‹ï¼š åŠŸèƒ½æ¨¡å‹ï¼šä»ç”¨æˆ·çš„è§’åº¦å±•ç¤ºç³»ç»Ÿçš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬ç”¨ä¾‹å›¾ã€‚ å¯¹è±¡æ¨¡å‹ï¼šé‡‡ç”¨å¯¹è±¡ï¼Œå±æ€§ï¼Œæ“ä½œï¼Œå…³è”ç­‰æ¦‚å¿µå±•ç¤ºç³»ç»Ÿçš„ç»“æ„å’ŒåŸºç¡€ï¼ŒåŒ…æ‹¬ç±»åˆ«å›¾ã€å¯¹è±¡å›¾ã€‚ åŠ¨æ€æ¨¡å‹ï¼šå±•ç°ç³»ç»Ÿçš„å†…éƒ¨è¡Œä¸ºã€‚åŒ…æ‹¬åºåˆ—å›¾ï¼Œæ´»åŠ¨å›¾ï¼ŒçŠ¶æ€å›¾ã€‚ UML2.2ä¸­ä¸€å…±å®šä¹‰äº†14ç§å›¾ç¤ºã€‚ ç»“æ„æ€§å›¾å½¢ï¼ˆStructure diagramsï¼‰å¼ºè°ƒçš„æ˜¯ç³»ç»Ÿå¼çš„å»ºæ¨¡ï¼š é™æ€å›¾ï¼ˆstatic diagram)ï¼šåŒ…æ‹¬ç±»å›¾ã€å¯¹è±¡å›¾ã€åŒ…å›¾ å®ç°å›¾ï¼ˆimplementation diagramï¼‰ï¼šåŒ…æ‹¬ç»„ä»¶å›¾ã€éƒ¨ç½²å›¾ å‰–é¢å›¾ å¤åˆç»“æ„å›¾ è¡Œä¸ºå¼å›¾å½¢ï¼ˆBehavior diagramsï¼‰å¼ºè°ƒç³»ç»Ÿæ¨¡å‹ä¸­è§¦å‘çš„äº‹ä»¶ æ´»åŠ¨å›¾ çŠ¶æ€å›¾ ç”¨ä¾‹å›¾ äº¤äº’æ€§å›¾å½¢ï¼ˆInteraction diagramsï¼‰ï¼Œå±äºè¡Œä¸ºå›¾å½¢çš„å­é›†åˆï¼Œå¼ºè°ƒç³»ç»Ÿæ¨¡å‹ä¸­çš„èµ„æ–™æµç¨‹ é€šä¿¡å›¾ äº¤äº’æ¦‚è¿°å›¾ æ—¶åºå›¾ æ—¶é—´å›¾ 2 UMLç±»å›¾ä½œç”¨UMLå±•ç°äº†ä¸€ç³»åˆ—æœ€ä½³å·¥ç¨‹å®è·µï¼Œè¿™äº›æœ€ä½³å®è·µåœ¨å¯¹å¤§è§„æ¨¡ï¼Œå¤æ‚ç³»ç»Ÿè¿›è¡Œå»ºæ¨¡æ–¹é¢ï¼Œç‰¹åˆ«æ˜¯è½¯ä»¶æ¶æ„å±‚æ¬¡æ–¹é¢å·²ç»è¢«éªŒè¯æœ‰æ•ˆã€‚ æˆ‘ä»¬è¿™æ¬¡ä»‹ç»çš„ä¸»è¦æ˜¯ç±»å›¾ï¼Œä¸ºäº†è§£æé¡¹ç›®çš„ç³»ç»Ÿç»“æ„å’Œæ¶æ„å±‚æ¬¡ï¼Œå¯ä»¥ç®€æ´æ˜äº†çš„å¸®åŠ©æˆ‘ä»¬ç†è§£é¡¹ç›®ä¸­ç±»ä¹‹é—´çš„å…³ç³»ã€‚ ç±»å›¾çš„ä½œç”¨ï¼š ï¼ˆ1ï¼‰ï¼šåœ¨è½¯ä»¶å·¥ç¨‹ä¸­ï¼Œç±»å›¾æ˜¯ä¸€ç§é™æ€çš„ç»“æ„å›¾ï¼Œæè¿°äº†ç³»ç»Ÿçš„ç±»çš„é›†åˆï¼Œç±»çš„å±æ€§å’Œç±»ä¹‹é—´çš„å…³ç³»ï¼Œå¯ä»¥ç®€åŒ–äº†äººä»¬å¯¹ç³»ç»Ÿçš„ç†è§£ï¼› ï¼ˆ2ï¼‰ï¼šç±»å›¾æ˜¯ç³»ç»Ÿåˆ†æå’Œè®¾è®¡é˜¶æ®µçš„é‡è¦äº§ç‰©ï¼Œæ˜¯ç³»ç»Ÿç¼–ç å’Œæµ‹è¯•çš„é‡è¦æ¨¡å‹ã€‚ 3 ç±»å›¾æ ¼å¼åœ¨UMLç±»å›¾ä¸­ï¼Œç±»ä½¿ç”¨åŒ…å«ç±»åã€å±æ€§(field) å’Œæ–¹æ³•(method) ä¸”å¸¦æœ‰åˆ†å‰²çº¿çš„çŸ©å½¢æ¥è¡¨ç¤ºï¼Œ ä¸¾ä¸ªæ —å­ã€‚ä¸€ä¸ªAnimalç±»ï¼Œå®ƒåŒ…å«name,age,state,isPetè¿™4ä¸ªå±æ€§ï¼Œä»¥åŠnameç›¸å…³æ–¹æ³•ã€‚ 1234567891011121314151617181920212223class Animal: NSObject &#123; public var name: String? internal var isPet: Bool? fileprivate var state: String? private var age: Int? = 0 override init() &#123; self.name = \"no name\" self.age = 0 self.isPet = true self.state = \"dead\" &#125; public func getName() -&gt; String &#123; return self.name! &#125; internal func setName(name: String?) &#123; self.name = name &#125;&#125;å¤åˆ¶ä»£ç  å¯¹åº”UMLç±»å›¾ï¼š ç±»åï¼šç²—ä½“ï¼Œå¦‚æœæ˜¯ç±»æ˜¯æŠ½è±¡ç±»åˆ™ç±»åæ˜¾ç¤ºä¸ºæ–œä½“ï¼ å±æ€§ï¼š å¯è§æ€§ åç§°ï¼šç±»å‹[=é»˜è®¤å€¼] å¯è§æ€§ä¸€èˆ¬ä¸ºpublicã€privateå’Œprotectedï¼Œåœ¨ç±»å›¾åˆ†åˆ«ç”¨+ã€-å’Œ#è¡¨ç¤ºï¼Œåœ¨Swiftä¸­æ²¡æœ‰ä¸protectedå®Œå…¨å¯¹åº”çš„å¯è§æ§åˆ¶ï¼Œå› æ­¤é€‰ç”¨çš„æ˜¯internalå¯¹åº”ä¸º#ï¼›åç§°ä¸ºå±æ€§çš„åç§°ï¼›ç±»å‹ä¸ºæ•°æ®ç±»å‹ï¼›é»˜è®¤å€¼å¦‚å˜é‡ ageé»˜è®¤å€¼ä¸º0ã€‚ æ–¹æ³•ï¼š å¯è§æ€§ åç§°ï¼ˆå‚æ•°åˆ—è¡¨ å‚æ•°1ï¼Œå‚æ•°2ï¼‰ ï¼šè¿”å›ç±»å‹ å¯è§æ€§å¦‚ä¸Šåç§°è¡¨è¾¾å¼çš„ä»‹ç»ï¼Œåç§°å°±æ˜¯æ–¹æ³•åï¼Œå‚æ•°åˆ—è¡¨æ˜¯å¯é€‰çš„é¡¹ï¼Œå¤šå‚æ•°çš„è¯å‚æ•°ç›´æ¥ç”¨è‹±æ–‡é€—å·éš”å¼€ï¼›è¿”å›å€¼ä¹Ÿæ˜¯ä¸ªå¯é€‰é¡¹ï¼Œè¿”å›å€¼ç±»å‹å¯ä»¥è¯´åŸºæœ¬çš„æ•°æ®ç±»å‹ã€ç”¨æˆ·è‡ªå®šä¹‰ç±»å‹å’Œvoidã€‚å¦‚æœæ˜¯æ„é€ æ–¹æ³•ï¼Œåˆ™æ— è¿”å›ç±»å‹ï¼ 4ç±»ä¸ç±»ä¹‹é—´çš„å…³ç³»è¡¨è¾¾ç±»å›¾ä¸­ç±»ä¸ç±»ä¹‹é—´çš„å…³ç³»ä¸»è¦ç”±ï¼šç»§æ‰¿ã€å®ç°ã€ä¾èµ–ã€å…³è”ã€èšåˆã€ç»„åˆè¿™å…­å¤§ç±»å‹ã€‚è¡¨ç¤ºæ–¹å¼å¦‚ä¸‹å›¾ï¼š (1)ç»§æ‰¿å…³ç³»ï¼ˆGeneralization/extendsï¼‰ç»§æ‰¿å…³ç³»ä¹Ÿå«æ³›åŒ–å…³ç³»ï¼ŒæŒ‡çš„æ˜¯ä¸€ä¸ªç±»ï¼ˆç§°ä¸ºå­ç±»ã€å­æ¥å£ï¼‰ç»§æ‰¿å¦å¤–çš„ä¸€ä¸ªç±»ï¼ˆç§°ä¸ºçˆ¶ç±»ã€çˆ¶æ¥å£ï¼‰çš„åŠŸèƒ½ï¼Œå¹¶å¯ä»¥å¢åŠ å®ƒè‡ªå·±çš„æ–°åŠŸèƒ½çš„èƒ½åŠ›ï¼Œç»§æ‰¿æ˜¯ç±»ä¸ç±»æˆ–è€…æ¥å£ä¸æ¥å£ä¹‹é—´æœ€å¸¸è§çš„å…³ç³»ã€‚ ç»§æ‰¿ç”¨å®çº¿ç©ºå¿ƒç®­å¤´è¡¨ç¤ºï¼Œç”±å­ç±»æŒ‡å‘çˆ¶ç±»ã€‚ ä¸‹é¢å†™ä¸¤ä¸ªå­ç±»ï¼ŒFishå’ŒCatåˆ†åˆ«ç»§æ‰¿è‡ªAnimalã€‚ 1234567891011121314class Fish: Animal &#123; public var fishType: String? func swim() &#123; &#125;&#125;class Cat: Animal &#123; public var hasFeet: Bool? func playToy(doll:Doll) &#123; doll.toyMoved() &#125;&#125;å¤åˆ¶ä»£ç  (2)å®ç°å…³ç³»ï¼ˆimplementsï¼‰æŒ‡çš„æ˜¯ä¸€ä¸ªclassç±»å®ç°interfaceæ¥å£ï¼ˆå¯ä»¥æ˜¯å¤šä¸ªï¼‰çš„åŠŸèƒ½ï¼›å®ç°æ˜¯ç±»ä¸æ¥å£ä¹‹é—´æœ€å¸¸è§çš„å…³ç³»ï¼›åœ¨Javaä¸­æ­¤ç±»å…³ç³»é€šè¿‡å…³é”®å­—implementsæ˜ç¡®æ ‡è¯†ï¼Œåœ¨iOSä¸­æˆ‘å°†å…¶ç†è§£æˆä»£ç†çš„å®ç°ã€‚ å†™ä¸€ä¸ªæ´‹å¨ƒå¨ƒç±»Dollï¼Œè¯¥ç±»éµå¾ªäº†ToyActionåè®®ï¼Œå®ç°äº†ç©å…·ç§»åŠ¨çš„æ–¹æ³•ã€‚ 1234567891011121314protocol ToyAction &#123; func toyMoved() -&gt; Void&#125;class Doll: NSObject,ToyAction &#123; public var body: Body? public var cloth: Cloth? func toyMoved() &#123; //æ´‹å¨ƒå¨ƒç©å…·åŠ¨ä½œå…·ä½“å®ç° &#125;&#125;å¤åˆ¶ä»£ç  (3)ä¾èµ–å…³ç³»ï¼ˆDependencyï¼‰å¯ä»¥ç®€å•çš„ç†è§£ï¼Œå°±æ˜¯ä¸€ä¸ªç±»Aä½¿ç”¨åˆ°äº†å¦ä¸€ä¸ªç±»Bï¼Œè€Œè¿™ç§ä½¿ç”¨å…³ç³»æ˜¯å…·æœ‰å¶ç„¶æ€§çš„ã€ã€ä¸´æ—¶æ€§çš„ã€éå¸¸å¼±çš„ï¼Œä½†æ˜¯Bç±»çš„å˜åŒ–ä¼šå½±å“åˆ°Aï¼›æ¯”å¦‚æŸäººè¦è¿‡æ²³ï¼Œéœ€è¦å€Ÿç”¨ä¸€æ¡èˆ¹ï¼Œæ­¤æ—¶äººä¸èˆ¹ä¹‹é—´çš„å…³ç³»å°±æ˜¯ä¾èµ–ï¼›è¡¨ç°åœ¨ä»£ç å±‚é¢ï¼Œä¸ºç±»Bä½œä¸ºå‚æ•°è¢«ç±»Aåœ¨æŸä¸ªmethodæ–¹æ³•ä¸­ä½¿ç”¨ã€‚ åœ¨æˆ‘ä»¬çš„ä¸Šè¿°ä»£ç ä¸­Catçš„playToyæ–¹æ³•ä¸­å‚æ•°å¼•ç”¨äº†Dollï¼Œå› æ­¤ä»–ä»¬æ˜¯ä¾èµ–å…³ç³»ã€‚ (4)å…³è”å…³ç³»ï¼ˆAssociationï¼‰ä»–ä½“ç°çš„æ˜¯ä¸¤ä¸ªç±»ã€æˆ–è€…ç±»ä¸æ¥å£ä¹‹é—´è¯­ä¹‰çº§åˆ«çš„ä¸€ç§å¼ºä¾èµ–å…³ç³»ï¼Œæ¯”å¦‚æˆ‘å’Œæˆ‘çš„æœ‹å‹ï¼›è¿™ç§å…³ç³»æ¯”ä¾èµ–æ›´å¼ºã€ä¸å­˜åœ¨ä¾èµ–å…³ç³»çš„å¶ç„¶æ€§ã€å…³ç³»ä¹Ÿä¸æ˜¯ä¸´æ—¶æ€§çš„ï¼Œä¸€èˆ¬æ˜¯é•¿æœŸæ€§çš„ï¼Œè€Œä¸”åŒæ–¹çš„å…³ç³»ä¸€èˆ¬æ˜¯å¹³ç­‰çš„ã€å…³è”å¯ä»¥æ˜¯å•å‘ã€åŒå‘çš„ï¼›è¡¨ç°åœ¨ä»£ç å±‚é¢ï¼Œä¸ºè¢«å…³è”ç±»Bä»¥ç±»å±æ€§çš„å½¢å¼å‡ºç°åœ¨å…³è”ç±»Aä¸­ï¼Œä¹Ÿå¯èƒ½æ˜¯å…³è”ç±»Aå¼•ç”¨äº†ä¸€ä¸ªç±»å‹ä¸ºè¢«å…³è”ç±»Bçš„å…¨å±€å˜é‡ï¼› å†™ä¸€ä¸ªPersonç±»ï¼Œä»–æ‹¥æœ‰ä¸€ä¸ªå® ç‰©çŒ«ï¼Œä»–ä»¬ä¹‹é—´çš„å…³ç³»æ˜¯å…³è”ã€‚ 123456789class Head: NSObject &#123; &#125;class Person: NSObject &#123; public var pet: Cat? public var head: Head?&#125;å¤åˆ¶ä»£ç  (5)èšåˆå…³ç³»ï¼ˆAggregationï¼‰èšåˆæ˜¯å…³è”å…³ç³»çš„ä¸€ç§ç‰¹ä¾‹ï¼Œä»–ä½“ç°çš„æ˜¯æ•´ä½“ä¸éƒ¨åˆ†ã€æ‹¥æœ‰çš„å…³ç³»ï¼Œå³has-açš„å…³ç³»ï¼Œæ­¤æ—¶æ•´ä½“ä¸éƒ¨åˆ†ä¹‹é—´æ˜¯å¯åˆ†ç¦»çš„ï¼Œä»–ä»¬å¯ä»¥å…·æœ‰å„è‡ªçš„ç”Ÿå‘½å‘¨æœŸï¼Œéƒ¨åˆ†å¯ä»¥å±äºå¤šä¸ªæ•´ä½“å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥ä¸ºå¤šä¸ªæ•´ä½“å¯¹è±¡å…±äº«ï¼›æ¯”å¦‚è®¡ç®—æœºä¸CPUã€å…¬å¸ä¸å‘˜å·¥çš„å…³ç³»ç­‰ï¼›è¡¨ç°åœ¨ä»£ç å±‚é¢ï¼Œå’Œå…³è”å…³ç³»æ˜¯ä¸€è‡´çš„ï¼Œåªèƒ½ä»è¯­ä¹‰çº§åˆ«æ¥åŒºåˆ†ï¼› 12345678class Cloth: NSObject &#123; &#125;class Body: NSObject &#123; &#125;å¤åˆ¶ä»£ç  åœ¨ä¸Šè¿°ä»£ç ä¸­Dollç”±Bodyå’ŒClothç»„æˆï¼Œä¸”å³ä½¿å¤±å»Clothï¼ŒDollä¹Ÿå¯ä»¥æ­£å¸¸å­˜åœ¨ã€‚ (6)ç»„åˆå…³ç³»ï¼ˆCompositionï¼‰ç»„åˆä¹Ÿæ˜¯å…³è”å…³ç³»çš„ä¸€ç§ç‰¹ä¾‹ï¼Œä»–ä½“ç°çš„æ˜¯ä¸€ç§contains-açš„å…³ç³»ï¼Œè¿™ç§å…³ç³»æ¯”èšåˆæ›´å¼ºï¼Œä¹Ÿç§°ä¸ºå¼ºèšåˆï¼›ä»–åŒæ ·ä½“ç°æ•´ä½“ä¸éƒ¨åˆ†é—´çš„å…³ç³»ï¼Œä½†æ­¤æ—¶æ•´ä½“ä¸éƒ¨åˆ†æ˜¯ä¸å¯åˆ†çš„ï¼Œæ•´ä½“çš„ç”Ÿå‘½å‘¨æœŸç»“æŸä¹Ÿå°±æ„å‘³ç€éƒ¨åˆ†çš„ç”Ÿå‘½å‘¨æœŸç»“æŸï¼›æ¯”å¦‚ä½ å’Œä½ çš„å¤§è„‘ï¼›è¡¨ç°åœ¨ä»£ç å±‚é¢ï¼Œå’Œå…³è”å…³ç³»æ˜¯ä¸€è‡´çš„ï¼Œåªèƒ½ä»è¯­ä¹‰çº§åˆ«æ¥åŒºåˆ†ï¼› ä¸Šè¿°ä»£ç ä¸­çš„Personæ‹¥æœ‰Headï¼Œå¹¶ä¸”è¿™ä¸ªæ•´ä½“å’Œéƒ¨åˆ†æ˜¯ä¸å¯åˆ†å‰²çš„ã€‚ æœ€åæ¥çœ‹çœ‹è¿™ä¸ªä¾‹å­ä¸­çš„æ•´ä½“å…³ç³»ï¼š å…¶å®ç†è§£äº†ä¹‹åæˆ‘ä»¬å‘ç°è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œå­¦ä¼šäº†ä¹‹åå°±å¯ä»¥æŠ•å…¥å®è·µä¸­äº†ï¼Œä¸¾ä¸€ä¸ªç®€å•ç¬¬ä¸‰æ–¹åº“çš„ç±»å›¾ä¾‹å­ï¼Œä¸‹å›¾æ˜¯Masonryçš„ç±»å›¾æ•´ç†ï¼Œå¯ä»¥çœ‹åˆ°é¡¹ç›®ç»“æ„å¾ˆæ¸…æ™°çš„å±•ç¤ºäº†å‡ºæ¥ã€‚ 12345è½¬è‡ªä½œè€…ï¼šzhengyié“¾æ¥ï¼šhttps://juejin.im/post/5d318b485188255957377ac3æ¥æºï¼šæ˜é‡‘è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚","categories":[{"name":"å·¥å…·ä½¿ç”¨","slug":"å·¥å…·ä½¿ç”¨","permalink":"https://shang.at/categories/å·¥å…·ä½¿ç”¨/"}],"tags":[{"name":"UML","slug":"UML","permalink":"https://shang.at/tags/UML/"}]},{"title":"Javaå­¦ä¹ -è®¾è®¡æ¨¡å¼","slug":"Javaå­¦ä¹ -è®¾è®¡æ¨¡å¼","date":"2020-07-14T09:26:40.000Z","updated":"2020-12-11T08:22:04.244Z","comments":true,"path":"post/Javaå­¦ä¹ -è®¾è®¡æ¨¡å¼/","link":"","permalink":"https://shang.at/post/Javaå­¦ä¹ -è®¾è®¡æ¨¡å¼/","excerpt":"ç®€ä»‹ï¼šJavaä¸­23ç§è®¾è®¡æ¨¡å¼ï¼Œåˆ†ä¸ºåˆ›å»ºå‹ã€ç»“æ„å‹å’Œè¡Œä¸ºå‹","text":"ç®€ä»‹ï¼šJavaä¸­23ç§è®¾è®¡æ¨¡å¼ï¼Œåˆ†ä¸ºåˆ›å»ºå‹ã€ç»“æ„å‹å’Œè¡Œä¸ºå‹ åˆ›å»ºå‹ å¯¹è±¡å®ä¾‹åŒ–çš„æ¨¡å¼ï¼Œåˆ›å»ºå‹æ¨¡å¼ç”¨äºè§£è€¦å¯¹è±¡çš„å®ä¾‹åŒ–è¿‡ç¨‹ã€‚ Singletonå•ä¾‹æ¨¡å¼ æŸä¸ªç±»åªèƒ½æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œæä¾›ä¸€ä¸ªå…¨å±€çš„è®¿é—®ç‚¹ã€‚ å®ç°1 é¥¿æ±‰å¼123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051/** * é¥¿æ±‰å¼ * ç±»åŠ è½½åˆ°å†…å­˜åï¼Œå°±å®ä¾‹åŒ–ä¸€ä¸ªå•ä¾‹ï¼ŒJVMä¿è¯çº¿ç¨‹å®‰å…¨ * ç®€å•å®ç”¨ï¼Œæ¨èä½¿ç”¨ï¼ * å”¯ä¸€ç¼ºç‚¹ï¼šä¸ç®¡ç”¨åˆ°ä¸å¦ï¼Œç±»è£…è½½æ—¶å°±å®Œæˆå®ä¾‹åŒ– * Class.forName(\"\") * ï¼ˆè¯è¯´ä½ ä¸ç”¨çš„ï¼Œä½ è£…è½½å®ƒå¹²å•¥ï¼‰ */public class Mgr01 &#123; private static final Mgr01 INSTANCE = new Mgr01(); private Mgr01() &#123;&#125;; public static Mgr01 getInstance() &#123; return INSTANCE; &#125; public void m() &#123; System.out.println(\"m\"); &#125; public static void main(String[] args) &#123; Mgr01 m1 = Mgr01.getInstance(); Mgr01 m2 = Mgr01.getInstance(); System.out.println(m1 == m2); &#125;&#125;// æˆ–è€…ä½¿ç”¨é™æ€ä»£ç å—è¿›è¡Œåˆå§‹åŒ–ï¼Œå’ŒMgr01ä¸€æ ·public class Mgr02 &#123; private static final Mgr02 INSTANCE; static &#123; INSTANCE = new Mgr02(); &#125; private Mgr02() &#123;&#125;; public static Mgr02 getInstance() &#123; return INSTANCE; &#125; public void m() &#123; System.out.println(\"m\"); &#125; public static void main(String[] args) &#123; Mgr02 m1 = Mgr02.getInstance(); Mgr02 m2 = Mgr02.getInstance(); System.out.println(m1 == m2); &#125;&#125; åŠ è½½jdbcé©±åŠ¨çš„æ—¶å€™ï¼Œå°±æ˜¯ç”¨çš„Class.forName(â€œcom.mysql.jdbc.Driverâ€)ï¼Œåœ¨com.mysql.jdbc.Driverä¸­å°±æ˜¯åœ¨é™æ€ä»£ç å—ä¸­å¯¹com.mysql.jdbc.Driverè¿›è¡Œçš„æ³¨å†Œ å®ç°2 æ‡’æ±‰å¼123456789101112131415161718192021222324252627282930313233343536373839404142/** * lazy loading * ä¹Ÿç§°æ‡’æ±‰å¼ï¼Œéœ€è¦æ—¶æ‰åŠ è½½ * éœ€è¦æ³¨æ„çš„ç‚¹ï¼š * 1ã€DCL * 2ã€å®ä¾‹éœ€è¦åŠ volatileä¿®é¥° */public class Mgr06 &#123; private static volatile Mgr06 INSTANCE; //JIT private Mgr06() &#123; &#125; public static Mgr06 getInstance() &#123; if (INSTANCE == null) &#123; //åŒé‡æ£€æŸ¥ synchronized (Mgr06.class) &#123; if(INSTANCE == null) &#123; try &#123; Thread.sleep(1); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; INSTANCE = new Mgr06(); &#125; &#125; &#125; return INSTANCE; &#125; public void m() &#123; System.out.println(\"m\"); &#125; public static void main(String[] args) &#123; for(int i=0; i&lt;100; i++) &#123; new Thread(()-&gt;&#123; System.out.println(Mgr06.getInstance().hashCode()); &#125;).start(); &#125; &#125;&#125; å¯¹äºæ‡’æ±‰å¼çš„å•ä¾‹æ¨¡å¼çš„è¯¦ç»†è§£è¯»ï¼š1ã€æ‡’æ±‰å¼ä¸€ï¼šsynchronizedåŠ åœ¨getInstance()ä¸Šï¼Œæ¯æ¬¡è°ƒç”¨getInstanceéƒ½ä¼šè¿›è¡Œä¸€æ¬¡åŠ é”è¡Œä¸ºï¼Œä¼šå¯¼è‡´æ•ˆç‡ä½ä¸‹2ã€æ‡’æ±‰å¼äºŒï¼šDCLæ¨¡å¼ï¼ŒDouble Check Lockï¼ŒåŒé‡æ£€æŸ¥é”å®šâ€‹ a. ç¬¬ä¸€æ­¥æ£€æŸ¥ï¼Œå¦‚æœå‘ç°INSTANCEä¸ä¸ºnullï¼Œç›´æ¥è¿”å›ï¼Œä¸ä¼šäº§ç”ŸåŠ é”çš„è¡Œä¸ºï¼Œæé«˜æ•ˆç‡â€‹ b. ç¬¬äºŒæ­¥åŠ é”ï¼ŒåŒæ—¶åªèƒ½ç”±ä¸€ä¸ªçº¿ç¨‹è·å¾—é”ï¼Œä¹Ÿåªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æœ€ç»ˆåˆ›å»ºå®ä¾‹å¯¹è±¡â€‹ c. ç¬¬ä¸‰æ­¥æ£€æŸ¥ï¼ŒåŠ å®Œé”ä¹‹åå†æ¬¡æ£€æŸ¥ï¼Œé˜²æ­¢æœ‰å¤šä¸ªçº¿ç¨‹åœ¨ç¬¬ä¸€æ­¥æ£€æŸ¥æ—¶åŒæ—¶ç«äº‰é”ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹å®Œæˆäº†å®ä¾‹çš„åˆ›å»ºï¼Œé‚£ä¹ˆå…¶ä»–çš„çº¿ç¨‹å†æ¬¡è·å¾—é”æ—¶ï¼Œå‘ç°å®ä¾‹å·²ç»ä¸ä¸ºç©ºï¼Œé‚£ä¹ˆé€€å‡ºä¸´ç•ŒåŒºä¸”è¿”å›å®ä¾‹å¯¹è±¡3ã€INSTANCEå¯¹è±¡éœ€è¦ä½¿ç”¨volatileå…³é”®å­—ä¿®é¥°â€‹ è²Œä¼¼ä»¥ä¸Šçš„æ“ä½œå·²ç»æ²¡æœ‰ä»€ä¹ˆé—®é¢˜äº†ã€‚ä½†æ˜¯è¿™é‡Œè¿˜æ˜¯æœ‰ä¸€ä¸ªéšè—çš„bugï¼šä¹Ÿå°±æ˜¯CPUçš„ä¹±åºæ‰§è¡Œï¼ŒæŒ‡ä»¤é‡æ‹ã€‚ç”±äºCPUçš„ä¹±åºæ‰§è¡Œä¼šå¯¼è‡´å®ä¾‹å¯¹è±¡çš„åŠåˆå§‹åŒ–çŠ¶æ€ï¼šå³å¯¹è±¡å®ä¾‹è™½å·²åˆ›å»ºï¼Œåœ¨å†…å­˜ä¸­æœ‰å¯¹åº”çš„ç©ºé—´ï¼Œä½†æ˜¯è¿™æ—¶å€™æ˜¯è¿˜æ²¡æœ‰åˆå§‹åŒ–å®ä¾‹å±æ€§ï¼Œå®ä¾‹å±æ€§éƒ½æ˜¯åˆå§‹å€¼ã€‚åœ¨javaä¸­ï¼ŒåŸºç¡€ç±»å‹çš„å˜é‡éƒ½æœ‰å„è‡ªçš„åˆå§‹å€¼ï¼Œä½†æ˜¯å¼•ç”¨ç±»å‹çš„åˆå§‹å€¼éƒ½æ˜¯nullï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœå…¶ä»–çš„çº¿ç¨‹æ‹¿åˆ°äº†å®ä¾‹å¯¹è±¡ï¼Œå°±ä¼šå¯¼è‡´NullPointerExceptionã€‚æ‰€ä»¥INSTANCEå¯¹è±¡éœ€è¦å¢åŠ volatileå…³é”®å­—ä¿®é¥°ï¼Œvalatileå…³é”®å­—å¯ä»¥ç¦ç”¨CPUçš„ä¹±åºæ‰§è¡Œã€‚å…·ä½“è¯¦æƒ…éœ€è¦ç»“åˆç¼–è¯‘æˆçš„jvmæŒ‡ä»¤é›†æŸ¥çœ‹ å®ç°3 é™æ€å†…éƒ¨ç±»123456789101112131415161718192021222324252627282930/** * é™æ€å†…éƒ¨ç±»æ–¹å¼ * JVMä¿è¯å•ä¾‹ * åŠ è½½å¤–éƒ¨ç±»æ—¶ä¸ä¼šåŠ è½½å†…éƒ¨ç±»ï¼Œè¿™æ ·å¯ä»¥å®ç°æ‡’åŠ è½½ */public class Mgr07 &#123; private Mgr07() &#123; &#125; private static class Mgr07Holder &#123; private final static Mgr07 INSTANCE = new Mgr07(); &#125; public static Mgr07 getInstance() &#123; return Mgr07Holder.INSTANCE; &#125; public void m() &#123; System.out.println(\"m\"); &#125; public static void main(String[] args) &#123; for(int i=0; i&lt;100; i++) &#123; new Thread(()-&gt;&#123; System.out.println(Mgr07.getInstance().hashCode()); &#125;).start(); &#125; &#125;&#125; å®ç°4 æšä¸¾å•ä¾‹12345678910111213141516171819202122232425262728293031323334353637383940/** * ä¸ä»…å¯ä»¥è§£å†³çº¿ç¨‹åŒæ­¥ï¼Œè¿˜å¯ä»¥é˜²æ­¢ååºåˆ—åŒ–ã€‚ * JVM ä¼šé˜»æ­¢åå°„è·å–æšä¸¾ç±»çš„ç§æœ‰æ„é€ æ–¹æ³•ï¼Œå³å¯ä»¥ é¿å…ä½¿ç”¨è€…ä½¿ç”¨åå°„çš„æ–¹å¼ç ´åå•ä¾‹çš„å”¯ä¸€æ€§ */public enum Mgr08 &#123; INSTANCE; public void m() &#123;&#125; public static void main(String[] args) &#123; for(int i=0; i&lt;100; i++) &#123; new Thread(()-&gt;&#123; System.out.println(Mgr08.INSTANCE.hashCode()); &#125;).start(); &#125; &#125;&#125;/** * å†…éƒ¨éšè—çš„enumæ¥ç”Ÿæˆå•ä¾‹å¯¹è±¡ */public class SingletonObject7 &#123; private SingletonObject7()&#123;&#125; /** * æšä¸¾ç±»å‹æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¹¶ä¸”åªä¼šè£…è½½ä¸€æ¬¡ */ private enum Singleton&#123; INSTANCE; private final SingletonObject7 instance; Singleton()&#123; instance = new SingletonObject7(); &#125; private SingletonObject7 getInstance()&#123; return instance; &#125; &#125; public static SingletonObject7 getInstance()&#123; return Singleton.INSTANCE.getInstance(); &#125;&#125; ä½†æ˜¯ä¸èƒ½è®¾ç½®å±æ€§å‘¢ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ å¦‚ä½•é˜²æ­¢ç”¨æˆ·ç ´åå•ä¾‹çš„å”¯ä¸€æ€§ï¼Ÿ 1ã€é€šè¿‡åå°„çš„æ–¹å¼ç ´åå•ä¾‹,åå°„æ˜¯é€šè¿‡è°ƒç”¨æ„é€ æ–¹æ³•ç”Ÿæˆæ–°çš„å¯¹è±¡ 2ã€å¦‚æœå•ä¾‹ç±»å®ç°äº†åºåˆ—åŒ–æ¥å£Serializable, å°±å¯ä»¥é€šè¿‡ååºåˆ—åŒ–ç ´åå•ä¾‹ï¼Œ 3ã€ä½¿ç”¨æšä¸¾å•ä¾‹ FactoryMethodå·¥å‚æ¨¡å¼AbstractFactoryæŠ½è±¡å·¥å‚æ¨¡å¼Builderæ„å»ºå™¨PrototypeåŸå‹ç»“æ„æ€§ æŠŠç±»æˆ–å¯¹è±¡ç»“åˆåœ¨ä¸€èµ·å½¢æˆä¸€ä¸ªæ›´å¤§çš„ç»“æ„ã€‚ Facadeé—¨é¢ æ¨¡å¼Decoratorè£…é¥°å™¨ æ¨¡å¼Compositeç»„åˆæ¨¡å¼Flyweightäº«å…ƒAdapteré€‚é…å™¨Bridgeæ¡¥æ¥Proxyé™æ€ä»£ç†ä¸åŠ¨æ€ä»£ç†è¡Œä¸ºå‹ ç±»å’Œå¯¹è±¡å¦‚ä½•äº¤äº’ï¼ŒåŠåˆ’åˆ†è´£ä»»å’Œç®—æ³•ã€‚ Strategryç­–ç•¥æ¨¡å¼ChainOfResponsibilityè´£ä»»é“¾ æ¨¡å¼Observerè§‚å¯Ÿè€… æ¨¡å¼Mediatorè°ƒåœè€… æ¨¡å¼Iteratorè¿­ä»£å™¨ æ¨¡å¼Visitorè®¿é—®è€… æ¨¡å¼Commandå‘½ä»¤ æ¨¡å¼Mementoå¤‡å¿˜å½• æ¨¡å¼TemplateMethodæ¨¡æ¿æ–¹æ³•StateçŠ¶æ€ æ¨¡å¼Intepreterè§£é‡Šå™¨ æ¨¡å¼","categories":[{"name":"JAVAå­¦ä¹ ","slug":"JAVAå­¦ä¹ ","permalink":"https://shang.at/categories/JAVAå­¦ä¹ /"}],"tags":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://shang.at/tags/è®¾è®¡æ¨¡å¼/"}]},{"title":"å®¹å™¨-Docker","slug":"å®¹å™¨-Docker","date":"2020-07-13T23:36:10.000Z","updated":"2021-05-20T11:39:16.441Z","comments":true,"path":"post/å®¹å™¨-Docker/","link":"","permalink":"https://shang.at/post/å®¹å™¨-Docker/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š ä»¥æŸ¥æ‰¾å¹¶å®‰è£… Selenium-hubå®¹å™¨ä¸ºä¾‹ï¼Œè®°å½•dockerçš„å¸¸ç”¨å‘½ä»¤ é¦–å…ˆè®¾ç½®å›½å†…docker hubé•œåƒ âœ ~ docker search hub åœ¨docker hubä¸­æŸ¥æ‰¾æŒ‡å®šçš„é•œåƒ âœ ~ docker ps æŸ¥çœ‹æœ¬æœºè¿è¡Œçš„æ‰€æœ‰dockeré•œåƒè¿›ç¨‹ âœ ~ docker ps -a æŸ¥çœ‹æœ¬æœºçš„æ‰€æœ‰dockeré•œåƒè¿›ç¨‹ âœ ~ docker pull selenium/hub ä¸‹è½½æŒ‡å®šçš„é•œåƒ âœ ~ docker search selenium âœ ~ docker pull selenium/node-chrome âœ ~ docker images æŸ¥çœ‹æœ¬åœ°ä¸‹è½½çš„æ‰€æœ‰é•œåƒ âœ ~ docker run -d -P â€”name selenium-hub selenium/hub å¯åŠ¨selenium/hubé•œåƒï¼Œä¸æŒ‡å®šç«¯å£æ˜ å°„ï¼Œdockerä¼šè‡ªåŠ¨å°†å®¹å™¨çš„ç«¯å£æ˜ å°„åˆ°æœ¬æœºçš„ä¸€ä¸ªç©ºé—²ç«¯å£ âœ ~ docker run -d -p 4444:4444 â€”name selenium-hub selenium/hub å¯åŠ¨selenium/hubé•œåƒï¼ŒæŒ‡å®šç«¯å£æ˜ å°„ âœ ~ docker stop f16ee70391f5 åœæ­¢ä¸€ä¸ªè¿è¡Œä¸­çš„dockerå®¹å™¨ âœ ~ docker rm f16ee70391f5 åˆ é™¤ä¸€ä¸ªåœæ­¢çš„dockerå®¹å™¨ âœ ~ docker exec -it a98b84585114 /bin/bash è¿›å…¥ä¸€ä¸ªè¿è¡Œä¸­å®¹å™¨bashå‘½ä»¤è¡Œ âœ ~ docker run -d â€”link selenium-hub:hub selenium/node-chrome å¯åŠ¨å®¹å™¨å¹¶é“¾æ¥åˆ°æŒ‡å®šçš„å®¹å™¨ âœ ~ docker run -d â€”link selenium-hub:hub -e NODE_MAX_INSTANCES=5 -e NODE_MAX_SESSION=5 selenium/node-chrome å¯åŠ¨å®¹å™¨å¹¶é“¾æ¥åˆ°æŒ‡å®šçš„å®¹å™¨ï¼ŒæŒ‡å®šç¯å¢ƒå˜é‡ å®¹å™¨åŒ–æŠ€æœ¯ä»‹ç»ç‰©ç†æœºæ—¶ä»£ éƒ¨ç½²éå¸¸æ…¢ æˆæœ¬å¾ˆé«˜ èµ„æºæµªè´¹ éš¾äºæ‰©å±•ä¸è¿ç§» å—åˆ¶äºç¡¬ä»¶ è™šæ‹Ÿæœºæ—¶ä»£ å¤šéƒ¨ç½² èµ„æºæ±  èµ„æºéš”ç¦» å¾ˆå®¹æ˜“æ‰©å±• VMéœ€è¦å®‰è£…æ“ä½œç³»ç»Ÿ å®¹å™¨åŒ–æ—¶ä»£ åˆè¯†DockerDockeræ˜¯ä¸€ä¸ªå¹³å°ï¼Œå…¶ä¸Šæ‰¿è½½äº†å®¹å™¨ å¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼ŒåŸºäº Go è¯­è¨€å¼€å‘ å®¹å™¨æ˜¯å®Œå…¨ä½¿ç”¨æ²™ç®±æœºåˆ¶,åˆ›å»ºå’Œé”€æ¯å®¹å™¨å¼€é”€æä½ Dockerå°±æ˜¯å®¹å™¨åŒ–æŠ€æœ¯çš„ä»£åè¯ Dockerä¹Ÿå…·å¤‡ä¸€å®šè™šæ‹ŸåŒ–èŒèƒ½ï¼Œåˆ©ç”¨Dockerä¸ä»…å¯ä»¥åˆ›å»ºå®¹å™¨ï¼Œè¿˜èƒ½å‘æœ¬åœ°çš„ç‰©ç†æœºç”³è¯·CPUã€å†…å­˜ç­‰è®¡ç®—èµ„æº æ ‡å‡†åŒ–çš„åº”ç”¨æ‰“åŒ…æä¾›äº†ä¸€ç§æ ‡å‡†åŒ–çš„åº”ç”¨æ‰“åŒ…æ–¹å¼ï¼Œä¸€ä¸ªé•œåƒæ–‡ä»¶åŒ…å«äº†ä¸€ä¸ªåº”ç”¨è¿è¡Œæ‰€éœ€è¦çš„æ‰€æœ‰ä¿¡æ¯ï¼Œå¼€ç®±å³ç”¨ï¼ŒåŒæ—¶ä»–è¿˜æè¿°äº†è¿è¡Œè¿™äº›åº”ç”¨éœ€è¦å“ªäº›ç¡¬ä»¶ä¸Šçš„è¦æ±‚ï¼Œæ¯”å¦‚CPUã€å†…å­˜ã€ç¡¬ç›˜ é˜¿é‡Œäº‘Dockeré•œåƒåŠ é€ŸDockerçš„åŸºæœ¬æ¦‚å¿µ Dockerå¼•æ“åŒ…å«ä¸‰ä¸ªéƒ¨åˆ†ï¼š Server - docker daemonï¼šå®¹å™¨çš„ç®¡ç† Rest API - åŸºäºHTTPåè®® Client - docker cli serverå’Œclientå¯ä»¥ä¸åœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Š - CSæ¨¡å¼ å®¹å™¨ä¸é•œåƒ é•œåƒï¼šæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œæ˜¯åªè¯»çš„ï¼Œä¸å¯è¿è¡Œï¼Œæä¾›äº†è¿è¡Œç¨‹åºå®Œæ•´çš„è½¯ç¡¬ä»¶èµ„æºï¼Œæ˜¯åº”ç”¨ç¨‹åºçš„é›†è£…ç®± å®¹å™¨ï¼šæ˜¯é•œåƒçš„å®ä¾‹ï¼Œç”±Dockerè´Ÿè´£åˆ›å»ºï¼Œå®¹å™¨ä¹‹é—´å½¼æ­¤éš”ç¦» Dockerçš„æ‰§è¡Œæµç¨‹ Clientï¼šå®¢æˆ·ç«¯ï¼Œç”¨æˆ·æäº¤å‘½ä»¤çš„åœ°æ–¹ Docker Host Docker daemonï¼šDockerçš„å®ˆæŠ¤è¿›ç¨‹ï¼Œç®¡ç†è¯¥èŠ‚ç‚¹ä¸Šçš„é•œåƒä¸å®¹å™¨ Imagesï¼šé•œåƒæ–‡ä»¶ Containersï¼šè¿è¡Œçš„å®¹å™¨å®ä¾‹ Registryï¼šæ³¨å†Œä¸­å¿ƒï¼Œè¿œç¨‹ä»“åº“ï¼Œä¿å­˜äº†å„ç§å„æ ·çš„é•œåƒæ–‡ä»¶ Dockerå¸¸ç”¨å‘½ä»¤ docker pull é•œåƒå&lt;:tags&gt; - ä»è¿œç¨‹ä»“åº“æŠ½å–é•œåƒ docker images - æŸ¥çœ‹æœ¬åœ°é•œåƒ docker run é•œåƒå&lt;:tags&gt; - åˆ›å»ºå®¹å™¨ï¼Œå¯åŠ¨åº”ç”¨ docker ps - æŸ¥çœ‹æ­£åœ¨è¿è¡Œä¸­çš„é•œåƒ docker rm &lt;-f&gt; å®¹å™¨id - åˆ é™¤å®¹å™¨ docker rmi &lt;-f&gt; é•œåƒå&lt;:tags&gt; - åˆ é™¤é•œåƒ Docker Hub: Dockerå®¿ä¸»æœºä¸å®¹å™¨é€šä¿¡","categories":[{"name":"å®¹å™¨","slug":"å®¹å™¨","permalink":"https://shang.at/categories/å®¹å™¨/"}],"tags":[{"name":"Docker","slug":"Docker","permalink":"https://shang.at/tags/Docker/"}]},{"title":"","slug":"æ“ä½œç³»ç»Ÿ-CentOS7ä¸Šçš„å¼€å‘ç¯å¢ƒé…ç½®","date":"2020-07-13T14:02:29.000Z","updated":"2020-08-10T04:05:09.112Z","comments":true,"path":"post/æ“ä½œç³»ç»Ÿ-CentOS7ä¸Šçš„å¼€å‘ç¯å¢ƒé…ç½®/","link":"","permalink":"https://shang.at/post/æ“ä½œç³»ç»Ÿ-CentOS7ä¸Šçš„å¼€å‘ç¯å¢ƒé…ç½®/","excerpt":"ç®€ä»‹ï¼šåœ¨Centosä¸Šè¿›è¡Œå¼€å‘çš„ç¯å¢ƒæ­å»º","text":"ç®€ä»‹ï¼šåœ¨Centosä¸Šè¿›è¡Œå¼€å‘çš„ç¯å¢ƒæ­å»º Linux Tools Quick Tutorial å®‰è£…å¿…è¦çš„è½¯ä»¶å‡çº§ yumæº&amp;å®‰è£…ç›¸å…³ä¾èµ–åŒ…123sudo yum -y updatesudo yum -y upgradesudo yum install -y net-tools rsync mlocate wget vim ntpdate telnet gcc zlib-dev openssl-devel sqlite-devel bzip2-devel binutils qt make patch libgomp glibc-headers glibc-devel kernel-headers kernel-devel dkms strace è™šæ‹Ÿæœºè½¯ä»¶Vagrantè¿™é‡ŒæŸ¥çœ‹vagrantçš„è¯¦ç»†ä½¿ç”¨ 123wget https://releases.hashicorp.com/vagrant/2.2.9/vagrant_2.2.9_x86_64.rpmrpm -ivh vagrant_2.2.9_x86_64.rpm vagrantæ˜¯åŸºäºVirtualBoxçš„è™šæ‹Ÿæœºç®¡ç†è½¯ä»¶ VirualBox1wget https://download.virtualbox.org/virtualbox/6.1.10/VirtualBox-6.1-6.1.10_138449_el7-1.x86_64.rpm rpm -ivh VirtualBox-6.1-6.1.10_138449_el7-1.x86_64.rpm æŠ¥é”™å¦‚ä¸‹ï¼šlibSDL-1.2.so.0()(64bit) è¢« VirtualBox-6.1-6.1.10_138449_el7-1.x86_64 éœ€è¦é‚£ä¹ˆï¼Œéœ€è¦å®‰è£…SDLï¼Œyum install -y SDL åŒæ—¶è¦ä¿è¯å®‰è£…çš„kernel-headerå’Œkernelçš„ç‰ˆæœ¬ä¸€è‡´ã€‚å®‰è£…å®Œkernelä¹‹åï¼Œéœ€è¦é‡å¯ï¼Œå¯ä»¥ä½¿ç”¨uname -r æŸ¥çœ‹kernelç‰ˆæœ¬ è‡ªå®šä¹‰VirtualBoxçš„ä¿å­˜è·¯å¾„ï¼š 1VBoxManage setproperty machinefolder ç›®æ ‡è·¯å¾„ è€çš„è™šæ‹Ÿæœºä½ç½®ä¸ä¼šå˜ï¼Œæ–°å»ºçš„è™šæ‹Ÿæœºä¼šå­˜åœ¨æ–°çš„è·¯å¾„ä¸‹ å¸¸è§çš„å‘½ä»¤ï¼š åˆ›å»ºè™šæ‹Ÿæœº åˆ›å»ºå¹¶æ³¨å†Œ 1VBoxManage createvm --name learnAsm --register åˆ é™¤è™šæ‹Ÿæœº ï¼ˆï¼ï¼ï¼ä¼šåˆ é™¤æ‰€æœ‰è™šæ‹Ÿç¡¬ç›˜ï¼Œè°¨æ…æ“ä½œï¼ï¼ï¼ï¼‰ 1VBoxManage unregistervm --delete learnAsm æ³¨å†Œè™šæ‹Ÿæœº å‡å¦‚ä½ æ³¨é”€äº†ï¼Œæˆ–è€…ä»åˆ«äººé‚£é‡Œå¤åˆ¶æ¥çš„è™šæ‹Ÿæœºæ–‡ä»¶ï¼Œå¯ä»¥é‡æ–°æ³¨å†Œå®ƒ 1VBoxManage registervm &lt;your vms path&gt;/learnAsm.vbox ä»…æ³¨é”€è™šæ‹Ÿæœº æ³¨é”€ä¹‹åVirtualBoxåˆ—è¡¨ä¸­æ˜¾ç¤ºäº† 1VBoxManage unregistervm learnAsm åˆ—å‡ºå·²æœ‰çš„è™šæ‹Ÿæœº 1VBoxManage list vms æŸ¥çœ‹è™šæ‹Ÿæœºä¿¡æ¯ 123456VBoxManage -vVBoxManage list vms #åˆ—å‡ºè™šæ‹ŸæœºVBoxManage list runningvms #åˆ—å‡ºæ­£åœ¨è¿è¡Œçš„è™šæ‹ŸæœºVBoxManage showvminfo learnAsm #æ˜¾ç¤ºè™šæ‹ŸæœºlearnAsmçš„ä¿¡æ¯VBoxManage list hdds #åˆ—å‡ºç¡¬ç›˜VBoxManage list dvds #åˆ—å‡ºdvd Dockerè¿™é‡ŒæŸ¥çœ‹Dockerçš„è¯¦ç»†ä½¿ç”¨ 123456789101112131415161718192021222324252627282930# å®‰è£…å·¥å…·åŒ…yum install -y yum-utils device-mapper-persistent-data lvm2# å®‰è£…aliæºyum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo# åˆ·æ–°å®‰è£…æºyum makecache fast# å®‰è£… docker-ceyum -y install docker-ce# å¯åŠ¨dockersystemctl start docker# åœæ­¢dockersystemctl stop docker# å¼€æœºè‡ªå¯åŠ¨systemctl enable docker# é…ç½®aliyunçš„å®¹å™¨é•œåƒåŠ é€Ÿå™¨ # ç™»å½•aliyun.com æœç´¢å®¹å™¨é•œåƒæœåŠ¡ï¼Œè¿›å…¥ç®¡ç†åå°ï¼Œåœ¨å·¦ä¾§èœå•æ ä¸‹é¢å¯ä»¥æ‰¾åˆ° é•œåƒåŠ é€Ÿå™¨ é€‰é¡¹sudo mkdir -p /etc/dockersudo tee /etc/docker/daemon.json &lt;&lt;-'EOF'&#123; \"registry-mirrors\": [\"https://oooxxxoox.mirror.aliyuncs.com\"]&#125;EOFsudo systemctl daemon-reloadsudo systemctl restart docker å®æ—¶ç›‘æ§ç½‘é€Ÿ1234567891011# å®‰è£…ä¹‹å‰å‡éœ€è¦å®‰è£…epelæºï¼Œyum -y install epel-release# å®‰è£…iftopå·¥å…·yum install iftop -y# æŸ¥çœ‹å¼€å¯çš„ç½‘å¡ifconfig # ä½¿ç”¨iftopç›‘æ§ï¼Œä¼šè¿›å…¥ä¸€ä¸ªç±»ä¼¼topå‘½ä»¤çš„ç•Œé¢ï¼Œç›‘æ§è¿æ¥çš„åœ°å€ä»¥åŠç½‘é€Ÿiftop -i em4 systemctlå‘½ä»¤è¯¦è§£123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107Systemctlæ˜¯ä¸€ä¸ªç³»ç»Ÿç®¡ç†å®ˆæŠ¤è¿›ç¨‹ã€å·¥å…·å’Œåº“çš„é›†åˆï¼Œç”¨äºå–ä»£System Vã€serviceå’Œchkconfigå‘½ä»¤ï¼Œåˆå§‹è¿›ç¨‹ä¸»è¦è´Ÿè´£æ§åˆ¶systemdç³»ç»Ÿå’ŒæœåŠ¡ç®¡ç†å™¨ã€‚é€šè¿‡Systemctl â€“helpå¯ä»¥çœ‹åˆ°è¯¥å‘½ä»¤ä¸»è¦åˆ†ä¸ºï¼šæŸ¥è¯¢æˆ–å‘é€æ§åˆ¶å‘½ä»¤ç»™systemdæœåŠ¡ï¼Œç®¡ç†å•å…ƒæœåŠ¡çš„å‘½ä»¤ï¼ŒæœåŠ¡æ–‡ä»¶çš„ç›¸å…³å‘½ä»¤ï¼Œä»»åŠ¡ã€ç¯å¢ƒã€å¿«ç…§ç›¸å…³å‘½ä»¤ï¼ŒsystemdæœåŠ¡çš„é…ç½®é‡è½½ï¼Œç³»ç»Ÿå¼€æœºå…³æœºç›¸å…³çš„å‘½ä»¤ã€‚ 1. åˆ—å‡ºæ‰€æœ‰å¯ç”¨å•å…ƒ # systemctl list-unit-files2. åˆ—å‡ºæ‰€æœ‰è¿è¡Œä¸­å•å…ƒ # systemctl list-units3. åˆ—å‡ºæ‰€æœ‰å¤±è´¥å•å…ƒ # systemctl â€“failed4. æ£€æŸ¥æŸä¸ªå•å…ƒï¼ˆå¦‚ crond.serviceï¼‰æ˜¯å¦å¯ç”¨ # systemctl is-enabled crond.service 5. åˆ—å‡ºæ‰€æœ‰æœåŠ¡ # systemctl list-unit-files â€“type=service6. Linuxä¸­å¦‚ä½•å¯åŠ¨ã€é‡å¯ã€åœæ­¢ã€é‡è½½æœåŠ¡ä»¥åŠæ£€æŸ¥æœåŠ¡ï¼ˆå¦‚ httpd.serviceï¼‰çŠ¶æ€ # systemctl start httpd.service# systemctl restart httpd.service# systemctl stop httpd.service# systemctl reload httpd.service# systemctl status httpd.serviceæ³¨æ„ï¼šå½“æˆ‘ä»¬ä½¿ç”¨systemctlçš„startï¼Œrestartï¼Œstopå’Œreloadå‘½ä»¤æ—¶ï¼Œç»ˆç«¯ä¸ä¼šè¾“å‡ºä»»ä½•å†…å®¹ï¼Œåªæœ‰statuså‘½ä»¤å¯ä»¥æ‰“å°è¾“å‡ºã€‚7. å¦‚ä½•æ¿€æ´»æœåŠ¡å¹¶åœ¨å¼€æœºæ—¶å¯ç”¨æˆ–ç¦ç”¨æœåŠ¡ï¼ˆå³ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨å¯åŠ¨mysqld.serviceæœåŠ¡ï¼‰ # systemctl is-active mysqld.service# systemctl enable mysqld.service# systemctl disable mysqld.service8. å¦‚ä½•å±è”½ï¼ˆè®©å®ƒä¸èƒ½å¯åŠ¨ï¼‰æˆ–æ˜¾ç¤ºæœåŠ¡ï¼ˆå¦‚ntpdate.serviceï¼‰ # systemctl mask ntpdate.serviceln -s â€˜/dev/nullâ€/etc/systemd/system/ntpdate.serviceâ€™# systemctl unmask ntpdate.servicerm â€˜/etc/systemd/system/ntpdate.serviceâ€™9. ä½¿ç”¨systemctlå‘½ä»¤æ€æ­»æœåŠ¡ # systemctl killcrond 10. åˆ—å‡ºæ‰€æœ‰ç³»ç»ŸæŒ‚è½½ç‚¹ # systemctl list-unit-files â€“type=mount11. æŒ‚è½½ã€å¸è½½ã€é‡æ–°æŒ‚è½½ã€é‡è½½ç³»ç»ŸæŒ‚è½½ç‚¹å¹¶æ£€æŸ¥ç³»ç»Ÿä¸­æŒ‚è½½ç‚¹çŠ¶æ€ # systemctl start tmp.mount# systemctl stop tmp.mount# systemctl restart tmp.mount# systemctl reload tmp.mount# systemctl status tmp.mount12. åœ¨å¯åŠ¨æ—¶æ¿€æ´»ã€å¯ç”¨æˆ–ç¦ç”¨æŒ‚è½½ç‚¹ï¼ˆç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨æŒ‚è½½ï¼‰ # systemctl is-active tmp.mount# systemctl enable tmp.mount# systemctl disable tmp.mount13. åœ¨Linuxä¸­å±è”½ï¼ˆè®©å®ƒä¸èƒ½å¯ç”¨ï¼‰æˆ–å¯è§æŒ‚è½½ç‚¹ # systemctl mask tmp.mountln -s â€˜/dev/nullâ€/etc/systemd/system/tmp.mountâ€™# systemctl unmask tmp.mountrm â€˜/etc/systemd/system/tmp.mountâ€™14. åˆ—å‡ºæ‰€æœ‰å¯ç”¨ç³»ç»Ÿå¥—æ¥å£ # systemctl list-unit-files â€“type=socket15. æ£€æŸ¥æŸä¸ªæœåŠ¡çš„æ‰€æœ‰é…ç½®ç»†èŠ‚ # systemctl show mysqld16. è·å–æŸä¸ªæœåŠ¡ï¼ˆhttpdï¼‰çš„ä¾èµ–æ€§åˆ—è¡¨ # systemctl list-dependencies httpd.service17. å¯åŠ¨æ•‘æ´æ¨¡å¼ # systemctl rescue18. è¿›å…¥ç´§æ€¥æ¨¡å¼ # systemctl emergency19. åˆ—å‡ºå½“å‰ä½¿ç”¨çš„è¿è¡Œç­‰çº§ # systemctl get-default20. å¯åŠ¨è¿è¡Œç­‰çº§5ï¼Œå³å›¾å½¢æ¨¡å¼ # systemctl isolate runlevel5.targetæˆ–# systemctl isolate graphical.target21. å¯åŠ¨è¿è¡Œç­‰çº§3ï¼Œå³å¤šç”¨æˆ·æ¨¡å¼ï¼ˆå‘½ä»¤è¡Œï¼‰ # systemctl isolate runlevel3.targetæˆ–# systemctl isolate multiuser.target22. è®¾ç½®å¤šç”¨æˆ·æ¨¡å¼æˆ–å›¾å½¢æ¨¡å¼ä¸ºé»˜è®¤è¿è¡Œç­‰çº§ # systemctl set-default runlevel3.target# systemctl set-default runlevel5.target23. é‡å¯ã€åœæ­¢ã€æŒ‚èµ·ã€ä¼‘çœ ç³»ç»Ÿæˆ–ä½¿ç³»ç»Ÿè¿›å…¥æ··åˆç¡çœ  # systemctl reboot# systemctl halt# systemctl suspend# systemctl hibernate# systemctl hybrid-sleepå¯¹äºä¸çŸ¥è¿è¡Œç­‰çº§ä¸ºä½•ç‰©çš„äººï¼Œè¯´æ˜å¦‚ä¸‹ã€‚Runlevel 0 : å…³é—­ç³»ç»ŸRunlevel 1 : æ•‘æ´ï¼Œç»´æŠ¤æ¨¡å¼Runlevel 3 : å¤šç”¨æˆ·ï¼Œæ— å›¾å½¢ç³»ç»ŸRunlevel 4 : å¤šç”¨æˆ·ï¼Œæ— å›¾å½¢ç³»ç»ŸRunlevel 5 : å¤šç”¨æˆ·ï¼Œå›¾å½¢åŒ–ç³»ç»ŸRunlevel 6 : å…³é—­å¹¶é‡å¯æœºå™¨ Centosé‡å¯ä¸å…³æœº Linux centosé‡å¯å‘½ä»¤ï¼š 1ã€reboot 2ã€shutdown -r now ç«‹åˆ»é‡å¯(rootç”¨æˆ·ä½¿ç”¨) 3ã€shutdown -r 10 è¿‡10åˆ†é’Ÿè‡ªåŠ¨é‡å¯(rootç”¨æˆ·ä½¿ç”¨) 4ã€shutdown -r 20:35 åœ¨æ—¶é—´ä¸º20:35æ—¶å€™é‡å¯(rootç”¨æˆ·ä½¿ç”¨) å¦‚æœæ˜¯é€šè¿‡shutdownå‘½ä»¤è®¾ç½®é‡å¯çš„è¯ï¼Œå¯ä»¥ç”¨shutdown -cå‘½ä»¤å–æ¶ˆé‡å¯ Linux centoså…³æœºå‘½ä»¤ï¼š 1ã€halt ç«‹åˆ»å…³æœº 2ã€poweroff ç«‹åˆ»å…³æœº 3ã€shutdown -h now ç«‹åˆ»å…³æœº(rootç”¨æˆ·ä½¿ç”¨) 4ã€shutdown -h 10 10åˆ†é’Ÿåè‡ªåŠ¨å…³æœº å¦‚æœæ˜¯é€šè¿‡shutdownå‘½ä»¤è®¾ç½®å…³æœºçš„è¯ï¼Œå¯ä»¥ç”¨shutdown -cå‘½ä»¤å–æ¶ˆé‡å¯","categories":[{"name":"æ“ä½œç³»ç»Ÿ","slug":"æ“ä½œç³»ç»Ÿ","permalink":"https://shang.at/categories/æ“ä½œç³»ç»Ÿ/"}],"tags":[{"name":"Centoså¼€å‘ç¯å¢ƒ","slug":"Centoså¼€å‘ç¯å¢ƒ","permalink":"https://shang.at/tags/Centoså¼€å‘ç¯å¢ƒ/"}]},{"title":"æ“ä½œç³»ç»Ÿ-CentOS7æ—¶åŒºè®¾ç½®","slug":"æ“ä½œç³»ç»Ÿ-CentOS7æ—¶åŒºè®¾ç½®","date":"2020-07-04T14:20:22.000Z","updated":"2020-07-26T03:29:55.319Z","comments":true,"path":"post/æ“ä½œç³»ç»Ÿ-CentOS7æ—¶åŒºè®¾ç½®/","link":"","permalink":"https://shang.at/post/æ“ä½œç³»ç»Ÿ-CentOS7æ—¶åŒºè®¾ç½®/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š https://www.cnblogs.com/zhangeamon/p/5500744.html","categories":[{"name":"æ“ä½œç³»ç»Ÿ","slug":"æ“ä½œç³»ç»Ÿ","permalink":"https://shang.at/categories/æ“ä½œç³»ç»Ÿ/"}],"tags":[{"name":"centos7æ—¶åŒºè®¾ç½®","slug":"centos7æ—¶åŒºè®¾ç½®","permalink":"https://shang.at/tags/centos7æ—¶åŒºè®¾ç½®/"}]},{"title":"Linux-ssh","slug":"Linux-ssh","date":"2020-07-04T14:13:25.000Z","updated":"2020-07-04T14:13:59.375Z","comments":true,"path":"post/Linux-ssh/","link":"","permalink":"https://shang.at/post/Linux-ssh/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š http://feihu.me/blog/2014/env-problem-when-ssh-executing-command-on-remote/","categories":[{"name":"Linux","slug":"Linux","permalink":"https://shang.at/categories/Linux/"}],"tags":[{"name":"ssh","slug":"ssh","permalink":"https://shang.at/tags/ssh/"}]},{"title":"Pythonå­¦ä¹ -deque","slug":"Pythonå­¦ä¹ -deque","date":"2020-07-02T15:52:28.000Z","updated":"2020-07-02T15:52:52.037Z","comments":true,"path":"post/Pythonå­¦ä¹ -deque/","link":"","permalink":"https://shang.at/post/Pythonå­¦ä¹ -deque/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š https://zhuanlan.zhihu.com/p/63502912","categories":[{"name":"Python","slug":"Python","permalink":"https://shang.at/categories/Python/"}],"tags":[{"name":"deque","slug":"deque","permalink":"https://shang.at/tags/deque/"}]},{"title":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°-é«˜çº§1-å•è°ƒæ ˆå’Œçª—å£åŠå…¶æ›´æ–°ç»“æ„","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°-é«˜çº§1-å•è°ƒæ ˆå’Œçª—å£åŠå…¶æ›´æ–°ç»“æ„","date":"2020-07-02T11:07:20.000Z","updated":"2020-08-19T08:09:18.921Z","comments":true,"path":"post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°-é«˜çº§1-å•è°ƒæ ˆå’Œçª—å£åŠå…¶æ›´æ–°ç»“æ„/","link":"","permalink":"https://shang.at/post/æ•°æ®ç»“æ„ä¸ç®—æ³•-å·¦ç¥å­¦ä¹ ç¬”è®°-é«˜çº§1-å•è°ƒæ ˆå’Œçª—å£åŠå…¶æ›´æ–°ç»“æ„/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š","categories":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://shang.at/categories/æ•°æ®ç»“æ„ä¸ç®—æ³•/"}],"tags":[{"name":"å·¦ç¥å­¦ä¹ ç¬”è®°","slug":"å·¦ç¥å­¦ä¹ ç¬”è®°","permalink":"https://shang.at/tags/å·¦ç¥å­¦ä¹ ç¬”è®°/"}]},{"title":"Pythonå­¦ä¹ -æ ‡å‡†åº“å­¦ä¹ ","slug":"Pythonå­¦ä¹ -æ ‡å‡†åº“å­¦ä¹ ","date":"2020-07-01T09:17:07.000Z","updated":"2020-07-05T01:38:22.197Z","comments":true,"path":"post/Pythonå­¦ä¹ -æ ‡å‡†åº“å­¦ä¹ /","link":"","permalink":"https://shang.at/post/Pythonå­¦ä¹ -æ ‡å‡†åº“å­¦ä¹ /","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š https://docs.python.org/zh-cn/3/library/index.html","categories":[{"name":"Python","slug":"Python","permalink":"https://shang.at/categories/Python/"}],"tags":[{"name":"Pythonæ ‡å‡†åº“","slug":"Pythonæ ‡å‡†åº“","permalink":"https://shang.at/tags/Pythonæ ‡å‡†åº“/"}]},{"title":"Pythonå­¦ä¹ -itertools","slug":"Pythonå­¦ä¹ -itertools","date":"2020-07-01T09:16:51.000Z","updated":"2021-01-25T10:20:52.122Z","comments":true,"path":"post/Pythonå­¦ä¹ -itertools/","link":"","permalink":"https://shang.at/post/Pythonå­¦ä¹ -itertools/","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š https://docs.python.org/zh-cn/3/library/itertools.html 12345678910# itertools.productdef product(*args, repeat=1): # product('ABCD', 'xy') --&gt; Ax Ay Bx By Cx Cy Dx Dy # product(range(2), repeat=3) --&gt; 000 001 010 011 100 101 110 111 pools = [tuple(pool) for pool in args] * repeat result = [[]] for pool in pools: result = [x+[y] for x in result for y in pool] for prod in result: yield tuple(prod) 1234567891011121314151617181920212223242526272829// js ç‰ˆæœ¬çš„ç¬›å¡å°”ç§¯// [[1,2,3], 2]// argsçš„å®šä¹‰ï¼šå¯ä»¥ä¼ å…¥å¤šä¸ªæ•°ç»„ï¼Œæœ€åä¸€ä¸ªå‚æ•°è¡¨ç¤ºé‡å¤æ¬¡æ•°// æ¯”å¦‚æƒ³å¾—åˆ°0-2çš„ç¬›å¡å°”ç§¯ï¼š// product([1,2], 2) -- è¿”å›11 12 21 22// product([1,2], 3) -- è¿”å›111 211 121 221 112 212 122 222// product(['A', 'B', 'C', 'D'], ['x', 'y'], 1) -- è¿”å›Ax Ay Bx By Cx Cy Dx Dyfunction product(...args) &#123; var repeat = args[args.length - 1] var pools = args.slice(0, args.length - 1) var pools1 = pools.concat() for (let i = 1; i &lt; repeat; i++) &#123; pools = pools.concat(pools1) &#125; console.log(pools) // pools: [[1,2,3],[1,2,3]] var result = [[]] pools.forEach(pool =&gt; &#123; // pool: [1,2,3] var temp = [] pool.forEach(y =&gt; &#123; result.forEach(x =&gt; &#123; temp.push(x.concat([y])) &#125;) &#125;) result = temp &#125;); return result&#125;","categories":[{"name":"Python","slug":"Python","permalink":"https://shang.at/categories/Python/"}],"tags":[{"name":"itertools","slug":"itertools","permalink":"https://shang.at/tags/itertools/"}]},{"title":"Sparkåº”ç”¨-å¤§æ•°æ®é›†çš„å¤„ç†","slug":"Sparkåº”ç”¨-å¤§æ•°æ®é›†çš„å¤„ç†","date":"2020-07-01T09:12:03.000Z","updated":"2021-05-19T02:15:09.669Z","comments":true,"path":"post/Sparkåº”ç”¨-å¤§æ•°æ®é›†çš„å¤„ç†/","link":"","permalink":"https://shang.at/post/Sparkåº”ç”¨-å¤§æ•°æ®é›†çš„å¤„ç†/","excerpt":"ç®€ä»‹ï¼šåœ¨sparkä¸Šå¤„ç†è¶…å¤§æ•°æ®é›†çš„æ—¶å€™ï¼Œæœ‰æ—¶å€™éœ€è¦ä¸å¤–ç•Œç³»ç»Ÿè¿›è¡Œäº¤äº’æˆ–è€…éœ€è¦å°†å¤§æ•°æ®é‡å¯¼å‡ºï¼Œä¸‹é¢è®²è§£å‡ ç§è¾ƒæ–¹ä¾¿çš„æ–¹æ¡ˆ","text":"ç®€ä»‹ï¼šåœ¨sparkä¸Šå¤„ç†è¶…å¤§æ•°æ®é›†çš„æ—¶å€™ï¼Œæœ‰æ—¶å€™éœ€è¦ä¸å¤–ç•Œç³»ç»Ÿè¿›è¡Œäº¤äº’æˆ–è€…éœ€è¦å°†å¤§æ•°æ®é‡å¯¼å‡ºï¼Œä¸‹é¢è®²è§£å‡ ç§è¾ƒæ–¹ä¾¿çš„æ–¹æ¡ˆ rdd.mapPartitions()https://stackoverflow.com/questions/21185092/apache-spark-map-vs-mappartitions ä¸šåŠ¡åœºæ™¯ï¼šéœ€è¦ç»™å¤§æ‰¹é‡çš„æ•°æ®è¿›è¡Œè§£å¯†æ“ä½œï¼Œç¬¬ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯å°†æ•°æ®loadåˆ°driverç«¯(4Gå†…å­˜)ï¼Œç„¶åè¿›è¡Œè§£å¯†ï¼Œä½†æ˜¯å½“æ•°æ®é‡è¾¾åˆ°ä¸€å®šçš„é‡çº§ï¼Œdriverä¾¿ä¼šOOMäº†ï¼Œæ‰€ä»¥æœ‰äº†ç¬¬äºŒç§æ–¹æ¡ˆï¼šä½¿ç”¨rdd.mapPartitions()ï¼Œåœ¨excutorç«¯è¿›è¡Œè§£å¯†æ“ä½œã€‚åŸºæœ¬åŸç†æ˜¯æ¯ä¸ªpartitionæ‰§è¡Œä¸€æ¬¡è§£å¯†æ“ä½œï¼Œæ¯ä¸ªpartitionçš„æ•°æ®é‡åŸºæœ¬ä¸ä¼šå¯¼è‡´ excutor OOMäº†ã€‚ é‡åˆ°çš„é—®é¢˜ï¼š 1ã€å¯¹äºrdd.mapPartitions() æ¥å£å†…éƒ¨çš„æ•°æ®ç±»å‹ä¸ç†Ÿæ‚‰ â€‹ rdd.mapPartitions()æ¥å—çš„å‡½æ•°å¯¹è±¡funcï¼Œåœ¨è¢«è°ƒèµ·çš„æ—¶å€™ï¼Œä¼šæœ‰ä¸€ä¸ªé»˜è®¤çš„å‚æ•°ä¼ é€’ç»™å®ƒï¼Œæ˜¯ä¸€ä¸ªiteratorå¯¹è±¡ï¼Œå¯ä»¥æ¥æˆè¿™ä¸€ä¸ªpartitionçš„æ•°æ®é›†åˆï¼Œæ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªRowç±»å‹çš„å˜é‡ï¼Œå¯ä»¥ä½¿ç”¨asDict()å‡½æ•°å°†å…¶è½¬æ¢æˆmapå¯¹è±¡æ¥æ“ä½œã€‚ â€‹ å¯ä»¥è¿™æ ·ç†è§£ï¼Œå®é™…ä¸Šå°±æ˜¯åœ¨è¿œç¨‹çš„excutorä¸Šæ“ä½œäº†ä¸€ä¸ªé›†åˆï¼Œå¤„ç†å®Œåå†å°†ç»“æœè¿”å› 2ã€å› ä¸ºè°ƒç”¨è§£å¯†æ¥å£çš„æ—¶å€™éœ€è¦åŠ¨æ€ä¼ é€’ä¸€ä¸ªå‚æ•°åˆ°è§£å¯†æœåŠ¡ï¼Œä½†æ˜¯rdd.mapPartitions() æ‰§è¡Œé€»è¾‘çš„æ—¶å€™å®é™…ä¸Šæ˜¯åœ¨excutorç«¯æ‰§è¡Œçš„ï¼Œå› æ­¤ä¼ é€’ç»™rdd.mapPartitions() çš„å‡½æ•°å¹¶ä¸èƒ½æ¥æ”¶å‚æ•° â€‹ rdd.mapPartitions()çš„å‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨pythonä¸­å«åšé«˜é˜¶å‡½æ•°ï¼Œå¦‚æœç†Ÿæ‚‰javaçš„è¯ï¼Œé‚£å®é™…ä¸Šç±»ä¼¼äºjava8(åŠä»¥å)ä¸­lambdaè¡¨è¾¾å¼æˆ–è€…javaä¸­çš„å‡½æ•°å›è°ƒã€‚é«˜é˜¶å‡½æ•°å¯ä»¥æ¥æ”¶å‡½æ•°å¯¹è±¡ä½œä¸ºå‚æ•°ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥è¿”å›ä¸€ä¸ªå‡½æ•°å¯¹è±¡ã€‚è¿™é‡Œå°±åˆ©ç”¨é«˜é˜¶å‡½æ•°çš„è¿™ä¸ªç‰¹æ€§ï¼Œåœ¨funcå¤–å±‚åŒ…è£…ä¸€ä¸ªmake_func()å‡½æ•°ï¼Œç”¨å®ƒæ¥æ¥æ”¶å¤–éƒ¨ä¼ æ¥çš„å‚æ•°ï¼Œç„¶ååœ¨funcå†…éƒ¨ä½¿ç”¨make_funcæ¥æ”¶çš„å‚æ•°ï¼Œè¿™ç§ç‰¹æ€§å«åšé—­åŒ…ï¼Œé—­åŒ…è¿˜æœ‰ä¸€äº›å…¶ä»–çš„é™·é˜±ï¼Œè¯·è§è¿™é‡Œ åœ¨scalaä¸­ä¹Ÿå¯ä»¥å®ç°è¯¥è¿‡ç¨‹ï¼Œåœ¨scalaä¸­æœ‰ä¸€ç§æŸ¯é‡ŒåŒ–çš„æ–¹æ¡ˆã€‚çœ‹è¿™é‡Œ 3ã€è§£å¯†çš„å­—æ®µä»…ä»…æ˜¯æä¸ªåˆ«çš„å­—æ®µ â€‹ è§£å†³æ–¹æ¡ˆï¼šå…ˆå°†éœ€è¦è§£å¯†çš„å­—æ®µåŠ ä¸€ä¸ªç‰¹æ®Šçš„åç¼€(æ³¨æ„è¦é¿å…å…¶ä»–çš„å­—æ®µæœ‰ç›¸åŒçš„åç¼€)ï¼›ç„¶ååœ¨funcä¸­æ‹¿åˆ°æœ‰ç‰¹å®šåç¼€çš„å­—æ®µï¼Œå°†å…¶å–å‡ºï¼Œå¹¶ä¸”è°ƒç”¨è§£å¯†æœåŠ¡ï¼›æœ€åå°†å­—æ®µé‡æ–°å‘½åå›æ¥ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576import copyimport jsonfrom pyspark.rdd import RDDfrom pyspark.sql import DataFramefrom pyspark.sql.types import Rowfrom asiacredit.conf.request import reqConffrom asiacredit.util.requeset.http_request import RequestKP_CHANNEL = 'XXXXXX'def make_func(channel): def func(iterator): request_obj = Request(url=reqConf.decryptConf.url, ak=reqConf.decryptConf.ak, sk=reqConf.decryptConf.sk) request_body = json.loads('&#123;\"encryptDataList\":\"\", \"decryptionChannel\":\"%s\"&#125;' % channel) _iterator = [item.asDict() for item in iterator] if len(_iterator) &lt;= 0: return [Row(**item) for item in _iterator] encrypted_columns = [k for k, v in _iterator[0].items() if '_encrypted' in k] for col in encrypted_columns: arr = [item[col] for item in _iterator if item[col] if arr: copy_request_body = copy.copy(request_body) copy_request_body['encryptDataList'] = arr request_obj.body = json.dumps(copy_request_body) encrypted_res = request_obj.request() col_res = &#123;line['encryptStr']: line['decryptStr'] for line in encrypted_res['decryptDataList']&#125; for i in range(len(_iterator)): if _iterator[i][col]: _iterator[i][col] = col_res[_iterator[i][col]] yield [Row(**item) for item in _iterator] return funcclass DecryptData: def __init__(self, encrypt_data: DataFrame, columns: list, decryption_channel=KP_CHANNEL, partition_num=0): \"\"\" å°†è§£å¯†æ“ä½œæ”¾åˆ°é›†ç¾¤èŠ‚ç‚¹ä¸Šè¿›è¡Œ å¦‚æœä¸æŒ‡å®špartition_numï¼Œä¼šè‡ªåŠ¨æŒ‰ç…§é»˜è®¤çš„åˆ†åŒºæ•°è¿›è¡Œè§£å¯† :param encrypt_data: è¦è§£å¯†çš„DataFrame :param columns: è¢«åŠ å¯†çš„å­—æ®µåˆ—è¡¨ :param decryption_channel: åŠ å¯†çš„channel :param partition_num: ä¸º1æ—¶ï¼Œå’Œç¬¬ä¸€ç‰ˆçš„æ¥å£æ•ˆæœä¸€è‡´ï¼Œä½†æ˜¯è¿™é‡Œå ç”¨çš„æ˜¯executorçš„èµ„æºï¼Œdriverä¸ä¼šå› ä¸ºæ•°æ®é‡è¿‡å¤§äºŒOOM executorçš„å†…å­˜ä¸€èˆ¬ä¼šæ¯”driverå¤§å¾ˆå¤šï¼Œæ‰€ä»¥OOMçš„æ¦‚ç‡ä¼šé™ä½ æˆ–è€… è¿™é‡Œåœ¨å¤–å±‚å¯ä»¥åŠ¨æ€è®¡ç®—æ•°æ®é‡è®¾ç½®ä¸€ä¸ªåˆé€‚çš„partition num \"\"\" self.columns = columns self.columns1 = [f'&#123;col&#125;_encrypted' for col in columns] self.source_columns = [col_name for col_name, _ in encrypt_data.dtypes] for old, new in zip(self.columns, self.columns1): encrypt_data = encrypt_data.withColumnRenamed(old, new) self.enough_data = encrypt_data.count() &gt; 0 self.encrypt_data = encrypt_data self.partition_num = partition_num if decryption_channel is None: raise AttributeError('decryption_channel can not be none') self.decryption_channel = decryption_channel def decrypt(self): if self.enough_data: encrypt_data_rdd: RDD = self.encrypt_data.rdd \\ if self.partition_num == 0 else self.encrypt_data.repartition(self.partition_num).rdd print('partition nums:' + str(encrypt_data_rdd.getNumPartitions())) res_df = encrypt_data_rdd.mapPartitions(make_func(self.decryption_channel)).flatMap( lambda line: line).toDF() else: print(\"there's no data to decrypt\") res_df = self.encrypt_data for old, new in zip(self.columns1, self.columns): res_df = res_df.withColumnRenamed(old, new) return res_df.select(*self.source_columns).distinct() toLocalIetator()https://www.waitingforcode.com/apache-spark/collecting-part-data-driver-rdd-tolocaiIterator/read toLocalIetator()çš„å·¥ä½œåŸç†ç±»ä¼¼äºpythonä¸­çš„itertools.chain(*iterables)ï¼Œç±»ä¼¼äºä¸‹é¢çš„æ–¹å¼ï¼š 12345def chain(*iterables): # chain('ABC', 'DEF') --&gt; A B C D E F for it in iterables: for element in it: yield element å®ƒæ˜¯å°†æ‰€æœ‰çš„partitionå½¢æˆä¸€ä¸ªç±»ä¼¼äºIetatorçš„å½¢å¼ï¼Œä½¿ç”¨çš„æ—¶å€™ï¼Œsparkä¼šå°†æ•°æ®æ•°æ®ä¸€éƒ¨åˆ†ä¸€éƒ¨åˆ†çš„ä»excutorç«¯æ”¶é›†åˆ°driverç«¯(ä»sparkuiä¸Šä¹Ÿå¯ä»¥çœ‹å‡ºæ¥)ï¼Œå¹¶ä¸ä¼šä¸€æ¬¡æ€§å°†æ‰€æœ‰partitionçš„æ•°æ®å…¨é‡æ”¶é›†åˆ°driverç«¯ï¼Œå¯¼è‡´driverç«¯çš„OOMï¼Œè¿™ä¹Ÿæ˜¯ä¸€ç§å¯¼å‡ºå¤§é‡æ•°æ®æ—¶å€™çš„é€‰æ‹©ï¼Œä½†æ˜¯æ•°æ®éœ€è¦ç»å†ä¸€ä¸ªä»excutorå‘driverä¼ è¾“çš„è¿‡ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯æ¯”è¾ƒè´¹æ—¶çš„ã€‚ä¸€ä¸ªä½¿ç”¨æ¡ˆä¾‹å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233import shutildef _mkdir(base_dir, filename, delete=False): path = os.path.join(base_dir, filename) if os.path.exists(path) and delete: shutil.rmtree(path, True) if not os.path.exists(path): os.makedirs(path) return pathimport csvdef to_csv(df:DataFrame, filename, threshold=1000000, base_dir='result/'): row_num = 0 index = 0 csvwrite = None csvfile = None first = True for val in df.toLocalIterator():# print(type(val.asDict()))# print(val.asDict())# print([v for k,v in val.asDict().items()]) if first or row_num&gt;=threshold: print(filename + ' write ' + str(index) + '...' + str(threshold*index)) file_path = _mkdir(base_dir, filename, first) csvfile = open(os.path.join(file_path, filename+'_%04d.csv' % index), 'w', buffering=4096) csvwrite = csv.writer(csvfile) index += 1 row_num = 0 first = False csvwrite.writerow(val) csvfile.flush() row_num += 1 é‡åˆ†åŒºå†™å…¥é›†ç¾¤ï¼Œç„¶åä¸‹è½½è¿™ç§æ–¹æ¡ˆæ˜¯ï¼šç›´æ¥åœ¨é›†ç¾¤å†…éƒ¨è®¾ç½®é€‚å½“çš„åˆ†åŒºæ•°ï¼Œç„¶åå°†æ•°æ®å†™å…¥é›†ç¾¤å†…ï¼Œæœ€åå°†ç”Ÿæˆçš„æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ã€‚è¿™ç§æ–¹å¼åœ¨æ•°æ®é‡ååˆ†å¤§çš„æƒ…å†µä¸‹ï¼Œrepartitionçš„è¿‡ç¨‹ä¹Ÿæ˜¯å¾ˆè´¹æ—¶çš„ã€‚ soï¼Œæ³¨æ„å°½é‡ä¸è¦ä½¿ç”¨repartition(numPartition, *col)ï¼Œè€Œæ˜¯é€‰æ‹©ä½¿ç”¨coalesce(numPartition)ã€‚è¿™äºŒè€…æœ‰å¾ˆå¤§åŒºåˆ«ï¼šrepartitionä¼šå¯¼è‡´shuffleï¼Œä¼šå¯¼è‡´é›†ç¾¤å†…éƒ¨å¤§é‡çš„æ•°æ®ä¼ è¾“ï¼Œéå¸¸è€—è´¹æ—¶é—´ï¼›å¦‚æœä»…ä»…æ˜¯å°†å¤§é‡çš„partitionåˆå¹¶æˆè¾ƒå°‘é‡çš„partitionï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨coalesceï¼Œcoalesceçš„åŸç†æ˜¯å°†å¤šä¸ªpartitionç›´æ¥åˆå¹¶æˆä¸€ä¸ªpartitionï¼Œæ˜¯ä¸€ä¸ªçª„ä¾èµ–ï¼Œä¸ä¼šå‘ç”Ÿsuffleï¼Œå¦‚æœä¼ å…¥çš„å‚æ•°å¤§äºå½“å‰çš„åˆ†åŒºæ•°ï¼Œé‚£ä¹ˆåˆ†åŒºæ•°ä¸ä¼šå‘ç”Ÿå˜åŒ–ã€‚","categories":[{"name":"Sparkåº”ç”¨","slug":"Sparkåº”ç”¨","permalink":"https://shang.at/categories/Sparkåº”ç”¨/"}],"tags":[{"name":"Sparkå¤§æ•°æ®é›†é˜²æ­¢driver OOM","slug":"Sparkå¤§æ•°æ®é›†é˜²æ­¢driver-OOM","permalink":"https://shang.at/tags/Sparkå¤§æ•°æ®é›†é˜²æ­¢driver-OOM/"}]},{"title":"Pythonå­¦ä¹ -ç±»çš„ç‰¹æ®Šæ–¹æ³•","slug":"Pythonå­¦ä¹ -ç±»çš„ç‰¹æ®Šæ–¹æ³•","date":"2020-07-01T02:22:24.000Z","updated":"2020-07-01T06:03:54.974Z","comments":true,"path":"post/Pythonå­¦ä¹ -ç±»çš„ç‰¹æ®Šæ–¹æ³•/","link":"","permalink":"https://shang.at/post/Pythonå­¦ä¹ -ç±»çš„ç‰¹æ®Šæ–¹æ³•/","excerpt":"ç®€ä»‹ï¼šé€šè¿‡å®šä¹‰å…·æœ‰ç‰¹æ®Šåç§°çš„æ–¹æ³•ï¼Œç±»å¯ä»¥å®ç°æŸäº›é€šè¿‡ç‰¹æ®Šè¯­æ³•è°ƒç”¨çš„æ“ä½œï¼ˆä¾‹å¦‚ç®—æœ¯è¿ç®—æˆ–ä¸‹æ ‡å’Œåˆ‡ç‰‡ï¼‰ã€‚è¿™æ˜¯Pythonè¿ç®—ç¬¦é‡è½½çš„æ–¹æ³•ï¼Œå®ƒå…è®¸ç±»é’ˆå¯¹è¯­è¨€è¿ç®—ç¬¦å®šä¹‰è‡ªå·±çš„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªç±»å®šä¹‰äº†ä¸€ä¸ªåä¸º__getitem__()çš„æ–¹æ³•ï¼Œå¹¶ä¸”xæ˜¯è¯¥ç±»çš„å®ä¾‹ï¼Œåˆ™x[i]å¤§è‡´ç­‰æ•ˆäºtype(x).__getitem__(x, i)ã€‚é™¤éå¦æœ‰è¯´æ˜ï¼Œå¦åˆ™å½“æœªå®šä¹‰é€‚å½“çš„æ–¹æ³•ï¼ˆé€šå¸¸ä¸ºAttributeErroræˆ–TypeErrorï¼‰æ—¶ï¼Œå°è¯•æ‰§è¡Œæ“ä½œä¼šå¼•å‘å¼‚å¸¸ã€‚ å°†ç‰¹æ®Šæ–¹æ³•è®¾ç½®ä¸ºNoneè¡¨ç¤ºç›¸åº”çš„æ“ä½œä¸å¯ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªç±»å°†__iter__()è®¾ç½®ä¸ºNoneï¼Œåˆ™è¯¥ç±»ä¸å¯è¿­ä»£ï¼Œå› æ­¤åœ¨å…¶å®ä¾‹ä¸Šè°ƒç”¨iter()ä¼šå¼•å‘TypeErrorï¼ˆè€Œä¸ä¼šå›åˆ°__getitem__()ï¼‰ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰çš„ç±»ï¼Œå®ƒçš„è¿™äº›ç‰¹æ®Šæ–¹æ³•éƒ½æœ‰é»˜è®¤çš„å®ç°ã€‚","text":"ç®€ä»‹ï¼šé€šè¿‡å®šä¹‰å…·æœ‰ç‰¹æ®Šåç§°çš„æ–¹æ³•ï¼Œç±»å¯ä»¥å®ç°æŸäº›é€šè¿‡ç‰¹æ®Šè¯­æ³•è°ƒç”¨çš„æ“ä½œï¼ˆä¾‹å¦‚ç®—æœ¯è¿ç®—æˆ–ä¸‹æ ‡å’Œåˆ‡ç‰‡ï¼‰ã€‚è¿™æ˜¯Pythonè¿ç®—ç¬¦é‡è½½çš„æ–¹æ³•ï¼Œå®ƒå…è®¸ç±»é’ˆå¯¹è¯­è¨€è¿ç®—ç¬¦å®šä¹‰è‡ªå·±çš„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªç±»å®šä¹‰äº†ä¸€ä¸ªåä¸º__getitem__()çš„æ–¹æ³•ï¼Œå¹¶ä¸”xæ˜¯è¯¥ç±»çš„å®ä¾‹ï¼Œåˆ™x[i]å¤§è‡´ç­‰æ•ˆäºtype(x).__getitem__(x, i)ã€‚é™¤éå¦æœ‰è¯´æ˜ï¼Œå¦åˆ™å½“æœªå®šä¹‰é€‚å½“çš„æ–¹æ³•ï¼ˆé€šå¸¸ä¸ºAttributeErroræˆ–TypeErrorï¼‰æ—¶ï¼Œå°è¯•æ‰§è¡Œæ“ä½œä¼šå¼•å‘å¼‚å¸¸ã€‚ å°†ç‰¹æ®Šæ–¹æ³•è®¾ç½®ä¸ºNoneè¡¨ç¤ºç›¸åº”çš„æ“ä½œä¸å¯ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªç±»å°†__iter__()è®¾ç½®ä¸ºNoneï¼Œåˆ™è¯¥ç±»ä¸å¯è¿­ä»£ï¼Œå› æ­¤åœ¨å…¶å®ä¾‹ä¸Šè°ƒç”¨iter()ä¼šå¼•å‘TypeErrorï¼ˆè€Œä¸ä¼šå›åˆ°__getitem__()ï¼‰ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰çš„ç±»ï¼Œå®ƒçš„è¿™äº›ç‰¹æ®Šæ–¹æ³•éƒ½æœ‰é»˜è®¤çš„å®ç°ã€‚ å‚è€ƒå®˜ç½‘ https://docs.python.org/zh-cn/3/reference/datamodel.html Basic customization__new____init____del____repr__Customizing attribute accessCustomizing module attribute accessImplementing DescriptorsCustomizing class creationMetaclassesCustomizing instance and subclass checksEmulating generic typesEmulating callable objectsEmulating container typesEmulating numeric typesWith Statement Context ManagersSpecial method lookup","categories":[{"name":"Python","slug":"Python","permalink":"https://shang.at/categories/Python/"}],"tags":[{"name":"Pythonç±»çš„ç‰¹æ®Šæ–¹æ³•","slug":"Pythonç±»çš„ç‰¹æ®Šæ–¹æ³•","permalink":"https://shang.at/tags/Pythonç±»çš„ç‰¹æ®Šæ–¹æ³•/"}]},{"title":"Javaå­¦ä¹ -JMH","slug":"Javaå­¦ä¹ -JMH","date":"2020-06-30T15:13:41.000Z","updated":"2020-07-05T01:38:55.632Z","comments":true,"path":"post/Javaå­¦ä¹ -JMH/","link":"","permalink":"https://shang.at/post/Javaå­¦ä¹ -JMH/","excerpt":"ç®€ä»‹ï¼šæœ¬èŠ‚å­¦ä¹ Javaå‡†æµ‹è¯•å·¥å…·å¥—ä»¶-JMH","text":"ç®€ä»‹ï¼šæœ¬èŠ‚å­¦ä¹ Javaå‡†æµ‹è¯•å·¥å…·å¥—ä»¶-JMH å®˜ç½‘ï¼šhttp://openjdk.java.net/projects/code-tools/jmh/ å®˜æ–¹æ ·ä¾‹ï¼šhttp://hg.openjdk.java.net/code-tools/jmh/file/tip/jmh-samples/src/main/java/org/openjdk/jmh/samples/ åšå®¢ï¼šhttps://www.xncoding.com/2018/01/07/java/jmh.html","categories":[{"name":"JAVAå­¦ä¹ ","slug":"JAVAå­¦ä¹ ","permalink":"https://shang.at/categories/JAVAå­¦ä¹ /"}],"tags":[{"name":"JAVA-JMH","slug":"JAVA-JMH","permalink":"https://shang.at/tags/JAVA-JMH/"}]},{"title":"ç®—æ³•-åŠ¨æ€è§„åˆ’","slug":"ç®—æ³•-åŠ¨æ€è§„åˆ’","date":"2020-06-29T17:54:22.000Z","updated":"2020-07-13T23:48:37.398Z","comments":true,"path":"post/ç®—æ³•-åŠ¨æ€è§„åˆ’/","link":"","permalink":"https://shang.at/post/ç®—æ³•-åŠ¨æ€è§„åˆ’/","excerpt":"ç®€ä»‹ï¼šåŠ¨æ€è§„åˆ’æ˜¯é«˜çº§çš„ç®—æ³•æ€æƒ³ï¼Œæœ¬èŠ‚ä¸»è¦è®°å½•DPçš„åˆ†ææ€è·¯","text":"ç®€ä»‹ï¼šåŠ¨æ€è§„åˆ’æ˜¯é«˜çº§çš„ç®—æ³•æ€æƒ³ï¼Œæœ¬èŠ‚ä¸»è¦è®°å½•DPçš„åˆ†ææ€è·¯ åŠ¨æ€è§„åˆ’ å…¶æœ¬è´¨æ˜¯åŠ¨æ€é€’æ¨ é¿å…äººè‚‰é€’å½’ã€‚å¯ä»¥å°è¯•ç”»å‡ºé€’å½’æ ‘ æ‰¾åˆ°æœ€è¿‘æœ€ç®€æ–¹æ³•ï¼Œå°†å…¶æ‹†è§£æˆå¯é‡å¤è§£å†³çš„é—®é¢˜ å¦‚ä½•æ‰¾åˆ°æœ€è¿‘æœ€ç®€æ–¹æ³•ï¼šæ•°å­¦å½’çº³æ³•æ€ç»´ å¦‚ä½•åŒºåˆ†DPé—®é¢˜ï¼šDPä¸€èˆ¬ä¼šè¢«ç”¨æ¥æ±‚è§£æœ€å€¼é—®é¢˜ DPä¸é€’å½’å’Œåˆ†æ²»çš„è”ç³» DPä¸ é€’å½’æˆ–è€…åˆ†æ²»æ²¡æœ‰æ ¹æœ¬ä¸Šçš„å´åˆ« å…±æ€§ï¼šæ‰¾åˆ°é‡å¤å­é—®é¢˜ å·®å¼‚æ€§ï¼šDPæœ‰æœ€ä¼˜å­ç»“æ„ï¼Œä¸­é€”å¯ä»¥æ·˜æ±°æ¬¡ä¼˜è§£ å®æˆ˜ä¾‹é¢˜509. æ–æ³¢é‚£å¥‘æ•° å‚»é€’å½’ - è‡ªé¡¶å‘ä¸‹ ç”»å‡ºé€’å½’æ ‘ æ—¶é—´å¤æ‚åº¦ï¼šæ¯è®¡ç®—ä¸€ä¸ªèŠ‚ç‚¹ï¼Œéœ€è¦è®¡ç®—å…¶ä½™çš„ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œä»¥æ­¤ç±»æ¨ä¸‹å»ï¼Œè¿™æ˜¯ä¸€ä¸ªäºŒå‰æ ‘çš„ç»“æ„ï¼Œæ‰€ä»¥å®ƒçš„æ—¶é—´å¤æ‚åº¦æ˜¯O($2^n$)çš„ ä¼˜åŒ–ï¼š åŠ å…¥å¤‡å¿˜å½• åœ¨å‚»é€’å½’çš„åŸºç¡€ä¸Šï¼ŒåŠ å…¥ä¸€ä¸ªç¼“å­˜ï¼Œä»¥è¾¾åˆ°é¿å…é‡å¤å­é—®é¢˜çš„é‡å¤è®¡ç®—çš„é—®é¢˜ ä½¿ç”¨DPçš„æ€ç»´è§£å†³ - è‡ªåº•å‘ä¸Š DPä¸‰æ­¥æ›² æ‰¾åˆ°é‡å¤å­é—®é¢˜ æ ¹æ®æ•°å­¦å½’çº³æ³•ï¼šè¦è®¡ç®—ç¬¬nä¸ªæ–æ³¢é‚£å¥‘æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦è®¡ç®—ç¬¬n-1å’Œn-2ä¸ªæ–æ³¢é‚£å¥‘æ•°å°±å¯ä»¥äº† çŠ¶æ€å®šä¹‰ - ä¸”æ‰¾åˆ°base case å‡è®¾ä½¿ç”¨a[i]è¡¨ç¤ºç¬¬iä¸ªæ–æ³¢é‚£å¥‘æ•°ï¼Œé‚£ä¹ˆf[i] = f[i-1]+f[i-2] ä¸”f[0]=0,f[1]=1 DPæ–¹ç¨‹ f(n)=\\left\\{ \\begin{aligned} 0 &,& n=0 \\\\ 1 &,& n=1 \\\\ f(n-1)+f(n-2) &,& n>1 \\end{aligned} \\right. 70. çˆ¬æ¥¼æ¢¯ è€ƒè™‘ä¸‹å˜ä½“ï¼š ä¸æ­¢å¯ä»¥ä¸Š1é˜¶æˆ–2é˜¶ï¼šå¯ä»¥ä¸Š1ã€2ã€3é˜¶ç­‰ å¯ä»¥ä¸Š1 2 3é˜¶ï¼Œä¸”ç›¸é‚»çš„ä¸¤ä¸ªæ­¥ä¼ä¸èƒ½ç›¸åŒï¼Œè¯¥å¦‚ä½•è®¾è®¡ æœ¬ä½“ï¼š f(n)=\\left\\{ \\begin{aligned} 1 &,& n=1 \\\\ 2 &,& n=2 \\\\ f(n-1)+f(n-2) &,& n>2 \\end{aligned} \\right.å˜ä½“1ï¼š f(n)=\\left\\{ \\begin{aligned} 1 &,& n=1 \\\\ 2 &,& n=2 \\\\ 4 &,& n=3 \\\\ f(n-1)+f(n-2)+f(n-3) &,& n>3 \\end{aligned} \\right.å˜ä½“2ï¼š å®šä¹‰dp[0â€¦2][i]ï¼Œ â€‹ dp[0][i]è¡¨ç¤ºåˆ°è¾¾iæœ€åä¸€æ¬¡èµ°äº†1æ­¥ï¼› â€‹ dp[1][i]è¡¨ç¤ºåˆ°è¾¾iæœ€åä¸€æ¬¡èµ°äº†2æ­¥ï¼› â€‹ dp[2][i]è¡¨ç¤ºåˆ°è¾¾iæœ€åä¸€æ¬¡èµ°äº†3æ­¥ é‚£ä¹ˆ â€‹ dp[0][i]=dp[1][i-1]+dp[2][i-1]ï¼›åˆ°å½“å‰å°é˜¶èµ°äº†1æ­¥ï¼Œé‚£ä¹ˆå‰é¢åªèƒ½å†é€‰æœ€åä¸€æ¬¡èµ°äº†2æ­¥å’Œ3æ­¥çš„ â€‹ dp[1][i]=dp[0][i-2]+dp[2][i-2]ï¼›åˆ°å½“å‰å°é˜¶èµ°äº†2æ­¥ï¼Œé‚£ä¹ˆå‰é¢åªèƒ½å†é€‰æœ€åä¸€æ¬¡èµ°äº†1æ­¥å’Œ3æ­¥ â€‹ dp[2][i]=dp[0][i-3]+dp[1][i-3] åˆ°å½“å‰å°é˜¶èµ°äº†3æ­¥ï¼Œé‚£ä¹ˆå‰é¢åªèƒ½å†é€‰æœ€åä¸€æ¬¡èµ°äº†1æ­¥å’Œ2æ­¥çš„ ç»“æœä¸ºï¼šdp[0][-1]+dp[1][-1]+dp[2][-1]ï¼Œå³åˆ°è¾¾nçš„æ‰€æœ‰æ­¥ä¼çš„æ€»å’Œ 1234567891011121314151617181920212223def changeClimbStairs(self, n: int) -&gt; int: if n == 1: return 1 if n == 2: return 1 if n == 3: return 3 # dp[0][i] æœ€åä¸€æ¬¡èµ°äº†1æ­¥åˆ°è¾¾ i # dp[1][i] æœ€åä¸€æ¬¡èµ°äº†2æ­¥åˆ°è¾¾ i # dp[2][i] æœ€åä¸€æ¬¡èµ°äº†3æ­¥åˆ°è¾¾ i dp = [ [1, 0, 1] + [0] * (n - 3), # æœ€åä¸€æ¬¡èµ°1æ­¥ [0, 1, 1] + [0] * (n - 3), # æœ€åä¸€æ¬¡èµ°2æ­¥ [0, 0, 1] + [0] * (n - 3) # æœ€åä¸€æ¬¡èµ°3æ­¥ ] for i in range(3, n): # åˆ°å½“å‰å°é˜¶èµ°äº†1æ­¥ï¼Œé‚£ä¹ˆå‰é¢åªèƒ½å†é€‰æœ€åä¸€æ¬¡èµ°äº†2æ­¥å’Œ3æ­¥çš„ dp[0][i] = dp[1][i - 1] + dp[2][i - 1] # åˆ°å½“å‰å°é˜¶èµ°äº†2æ­¥ï¼Œé‚£ä¹ˆå‰é¢åªèƒ½å†é€‰æœ€åä¸€æ¬¡èµ°äº†1æ­¥å’Œ3æ­¥çš„ dp[1][i] = dp[0][i - 2] + dp[2][i - 2] # åˆ°å½“å‰å°é˜¶èµ°äº†3æ­¥ï¼Œé‚£ä¹ˆå‰é¢åªèƒ½å†é€‰æœ€åä¸€æ¬¡èµ°äº†1æ­¥å’Œ2æ­¥çš„ dp[2][i] = dp[0][i - 3] + dp[1][i - 3] return dp[0][-1] + dp[1][-1] + dp[2][-1] 322. é›¶é’±å…‘æ¢ ç•¥è¿‡é€’å½’æ–¹æ¡ˆï¼Œç›´æ¥ä¸ŠDP DPé—®é¢˜ä¸‰æ­¥æ›² æ‰¾åˆ°é‡å¤å­é—®é¢˜ æ ¹æ®æ•°å­¦å½’çº³æ³•ï¼šå·²çŸ¥æŸé‡‘é¢æ‰€éœ€çš„æœ€å°‘ç¡¬å¸æ•°ï¼Œå¯å¾—å…¶ä»–é‡‘é¢çš„æ‰€éœ€æœ€å°‘ç¡¬å¸æ•° çŠ¶æ€å®šä¹‰ å‡è®¾dp[i]è¡¨ç¤ºï¼Œé‡‘é¢ä¸ºiæ—¶éœ€è¦çš„æœ€å°‘ç¡¬å¸æ•°ï¼Œé‚£ä¹ˆå› ä¸ºæœ‰coinsä¸ªç¡¬å¸å¯é€‰ï¼Œæ‰€ä»¥dp[i]=min(dp[i-k] for k in coins) + 1ï¼ŒåŠ 1è¡¨ç¤ºè¦é€‰æ‹©ä¸€ä¸ªé¢å€¼ä¸ºkçš„ç¡¬å¸ dpåˆå§‹å€¼ä¸ºmount+1ï¼Œå› ä¸ºé‡‘é¢ä¸ºamoutï¼Œæ‰€éœ€ç¡¬å¸æœ€å¤šä¸ºamoutä¸ª1å…ƒç¡¬å¸ï¼Œé•¿åº¦ä¸ºamout+1 dp[0]=0ï¼Œè¡¨ç¤ºå½“é‡‘é¢ä¸º0æ—¶ï¼Œéœ€è¦çš„ç¡¬å¸æ•°ä¹Ÿä¸º0 æœ€ç»ˆç»“æœï¼šdp[amout] DPæ–¹ç¨‹ f(n) = \\left\\{ \\begin{aligned} 0 &,& n=0 \\\\ 1 &,& n=1 \\\\ min(f(n-k))+1 &,& k \\in coins \\\\ \\end{aligned} \\right.123456789101112class Solution: def coinChange(self, coins: List[int], amount: int) -&gt; int: dp = [amount + 1] * (amount + 1) dp[0] = 0 for i in range(1, amount + 1): for coin in coins: if coin &lt;= i: dp[i] = min(dp[i], dp[i - coin] + 1) return dp[amount] if dp[amount] &lt; amount + 1 else -1 62. ä¸åŒè·¯å¾„ ç›´æ¥DPä¸‰æ­¥æ›² æ‰¾åˆ°é‡å¤å­é—®é¢˜ è¦æ±‚ä»ä½ç½®(i,j)åˆ°ENDçš„ä¸åŒè·¯å¾„æ•°ï¼Œç”±äºä»æŸä¸ªä½ç½®å‡ºå‘åªèƒ½å‘å³æˆ–å‘ä¸‹èµ°ï¼Œå¦‚æœæˆ‘çŸ¥é“äº†ä»(i+1, j)å’Œä»(i,j+1)åˆ°ENDçš„è·¯å¾„æ•°ï¼Œé‚£ä¹ˆæˆ‘å°±èƒ½å¾—åˆ°path_{i,j}ï¼Œpath_{i,j}=path_{i+1,j}+path_{i,j+1} çŠ¶æ€å®šä¹‰ å®šä¹‰dp[m][n]æ•°ç»„ï¼Œè¡¨ç¤ºæ£‹ç›˜ï¼Œæ¯ä¸ªå…ƒç´ è¡¨ç¤ºä»è¯¥ä½ç½®å‡ºå‘ï¼Œåˆ°ENDçš„ä¸åŒè·¯å¾„æ•° dp[][n]=1ï¼Œå³è¾¹ç•Œå…¨ä¸º1ï¼Œå› ä¸ºå³è¾¹ç•Œçš„ä½ç½®åˆ°ENDï¼Œè·¯å¾„æ•°éƒ½æ˜¯1 dp[m][]=1ï¼Œä¸‹è¾¹ç•Œå…¨ä¸º1ï¼Œå› ä¸ºä¸‹è¾¹ç•Œçš„ä½ç½®åˆ°ENDï¼Œè·¯å¾„æ•°éƒ½æ˜¯1 éå†æ–¹å‘ï¼šä»ENDä½ç½®å¼€å§‹å‘ä¸Šéå† æœ€ç»ˆç»“æœï¼šdp[0][0] DPæ–¹ç¨‹ f(x,y) = \\left\\{ \\begin{aligned} 1 &,& x=m\\\\ 1 &,& y=n\\\\ f(x+1, y)+f(x, y+1) &,& 0 \\leq x < m \\& 0 \\leq y < n \\end{aligned} \\right.123456789101112131415161718192021class Solution: def uniquePaths(self, m: int, n: int) -&gt; int: if n == 1: return 1 # åˆå§‹åŒ–dpæ•°ç»„ï¼Œå·¦è¾¹ç•Œå’Œå³è¾¹ç•Œéƒ½åˆå§‹åŒ–ä¸º1 dp = [[1 if j == m - 1 or i == n - 1 else 0 for j in range(m)] for i in range(n)] for i in range(n - 2, -1, -1): for j in range(m - 2, -1, -1): dp[i][j] = dp[i + 1][j] + dp[i][j + 1] return dp[0][0] # ç©ºé—´å‹ç¼©ï¼šæˆ‘ä»¬åªéœ€è¦ä¸€ç»´çš„æ•°ç»„å°±å¯ä»¥å­˜ä¸‹è·¯å¾„çš„å˜åŒ– def uniquePaths(self, m: int, n: int) -&gt; int: if n == 1: return 1 # åˆå§‹åŒ–dpæ•°ç»„ä¸º 1 dp = [1] * m for i in range(n - 2, -1, -1): for j in range(m - 2, -1, -1): dp[j] = dp[j] + dp[j + 1] return dp[0] 63. ä¸åŒè·¯å¾„ II ç›´æ¥DPä¸‰æ­¥æ›² æ‰¾åˆ°é‡å¤å­é—®é¢˜ è¦æ±‚ä»ä½ç½®(i,j)åˆ°ENDçš„ä¸åŒè·¯å¾„æ•°ï¼Œç”±äºä»æŸä¸ªä½ç½®å‡ºå‘åªèƒ½å‘å³æˆ–å‘ä¸‹èµ°ï¼Œå¦‚æœæˆ‘çŸ¥é“äº†ä»(i+1, j)å’Œä»(i,j+1)åˆ°ENDçš„è·¯å¾„æ•°ï¼Œé‚£ä¹ˆæˆ‘å°±èƒ½å¾—åˆ°path_{i,j}ï¼Œpath_{i,j}=path_{i+1,j}+path_{i,j+1} çŠ¶æ€å®šä¹‰ å®šä¹‰dp[m][n]æ•°ç»„ï¼Œè¡¨ç¤ºæ£‹ç›˜ï¼Œæ¯ä¸ªå…ƒç´ è¡¨ç¤ºä»è¯¥ä½ç½®å‡ºå‘ï¼Œåˆ°ENDçš„ä¸åŒè·¯å¾„æ•° dp[][n]=1ï¼Œå³è¾¹ç•Œæœ€åä¸€ä¸ªéšœç¢ç‰©ä¹‹åå…¨ä¸º1ï¼Œæœ€åä¸€ä¸ªéšœç¢ç‰©åŠä¹‹å‰çš„ä½ç½®å…¨ä¸º0ï¼Œå› ä¸ºå³è¾¹ç•Œä¸€æ—¦å‡ºç°äº†éšœç¢ç‰©ï¼Œé‚£ä¹ˆåœ¨è¿™ä¹‹å‰çš„ä½ç½®çš„è·¯å¾„å°±éƒ½è¢«æˆªæ–­äº† dp[m][]=1ï¼Œä¸‹è¾¹ç•Œæœ€åä¸€ä¸ªéšœç¢ç‰©ä¹‹åå…¨ä¸º1ï¼Œæœ€åä¸€ä¸ªéšœç¢ç‰©åŠä¹‹å‰çš„ä½ç½®å…¨ä¸º0ï¼Œå› ä¸ºä¸‹è¾¹ç•Œä¸€æ—¦å‡ºç°äº†éšœç¢ç‰©ï¼Œé‚£ä¹ˆåœ¨è¿™ä¹‹å‰çš„ä½ç½®çš„è·¯å¾„å°±éƒ½è¢«æˆªæ–­äº† éœ€è¦æ³¨æ„çš„æ˜¯ï¼šæ£‹ç›˜ä¸Šä¸º1çš„ä½ç½®ä¸èƒ½èµ°ï¼Œé‚£ä¸ªä½ç½®çš„è·¯å¾„æ•°ä¸º0 éå†æ–¹å‘ï¼šä»ENDä½ç½®å¼€å§‹éå† æœ€ç»ˆç»“æœï¼šdp[0][0] DPæ–¹ç¨‹ f(x,y) = \\left\\{ \\begin{aligned} 0 &,& x=m\\&x\\leq lastcol(lastrowè¡¨ç¤ºä¸‹è¾¹ç•Œæœ€åä¸€ä¸ªéšœç¢ç‰©çš„ä½ç½®)\\\\ 0 &,& y=n\\&y\\leq lastrow(lastrowè¡¨ç¤ºå³è¾¹ç•Œæœ€åä¸€ä¸ªéšœç¢ç‰©çš„ä½ç½®)\\\\ 1 &,& x=m\\&x>lastcol(lastrowè¡¨ç¤ºä¸‹è¾¹ç•Œæœ€åä¸€ä¸ªéšœç¢ç‰©çš„ä½ç½®)\\\\ 1 &,& y=n\\&y>lastrow(lastrowè¡¨ç¤ºå³è¾¹ç•Œæœ€åä¸€ä¸ªéšœç¢ç‰©çš„ä½ç½®)\\\\ 0 &,& obstacleGrid(x, y)=1\\\\ f(x-1, y)+f(x, y-1) &,& 0 \\leq x < m \\& 0 \\leq y < n \\end{aligned} \\right.123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687class Solution: def uniquePathsWithObstacles(self, obstacleGrid: List[List[int]]) -&gt; int: m, n = len(obstacleGrid[0]), len(obstacleGrid) # if obstacleGrid[-1][-1] == 1 or obstacleGrid[0][0] == 1: return 0 # èµ·ç‚¹å’Œç»ˆç‚¹ä¸º1ï¼Œç›´æ¥è¿”å›0 # if n == 1: # åªæœ‰ä¸€è¡Œ # if sum(obstacleGrid[0]) &gt;= 1: # è¡Œå‡ºç°äº†1 # return 0 # else: # return 1 # if m == 1: # åªæœ‰ä¸€åˆ— # if sum(list(chain(*obstacleGrid))) &gt;= 1: # åˆ—å‡ºç°äº†1 # return 0 # else: # return 1 # å¦‚æœ æœ€åä¸€è¡Œæˆ–æœ€åä¸€åˆ—å‡ºç°äº†1ï¼Œé‚£ä¹ˆ1å‡ºç°çš„ä½ç½®åŠä¹‹å‰çš„ä½ç½®å’Œ1æ²¡æœ‰åŒºåˆ« last_row, last_col = -1, -1 # æ ‡è®°æœ€åä¸€è¡Œ(åˆ—)å‡ºç°éšœç¢çš„ä½ç½® for i in range(n - 1, -1, -1): if obstacleGrid[i][-1] == 1: last_row = i break for i in range(m - 1, -1, -1): if obstacleGrid[-1][i] == 1: last_col = i break # æ ¹æ®æ£‹ç›˜çš„æœ€åä¸€è¡Œå’Œæœ€åä¸€åˆ—åˆå§‹åŒ– dpæ•°ç»„ # åŒ…å«äº† èµ·ç‚¹å’Œç»ˆç‚¹ä¸º1 çš„æƒ…å†µ # åŒ…å«äº† åªæœ‰ä¸€è¡Œå’Œåªæœ‰ä¸€åˆ—çš„æƒ…å†µ dp = [[1 if i &gt; last_col and j == n - 1 or j &gt; last_row and i == m - 1 else 0 for i in range(m)] for j in range(n)] for i in range(n - 2, -1, -1): for j in range(m - 2, -1, -1): if obstacleGrid[i][j] == 1: dp[i][j] = 0 else: dp[i][j] = dp[i + 1][j] + dp[i][j + 1] return dp[0][0] def uniquePathsWithObstacles1(self, obstacleGrid: List[List[int]]) -&gt; int: if not obstacleGrid or not obstacleGrid[0]: return 0 m, n = len(obstacleGrid), len(obstacleGrid[0]) # çŠ¶æ€å®šä¹‰ - base case # dp[i][j] è¡¨ç¤ºä»i,jåˆ°è¾¾finishä½ç½®çš„è·¯å¾„æ•° # åˆå§‹åŒ–ä¸º0 dp = [[0] * n for _ in range(m)] # ç‰¹æ®Šè€ƒè™‘å³è¾¹ç•Œå’Œä¸‹è¾¹ç•Œ:æ‰¾åˆ°å³è¾¹ç•Œå’Œä¸‹è¾¹ç•Œæœ€åä¸€ä¸ªéšœç¢ç‰©çš„ä½ç½® # ä»åå¾€å‰æ‰¾ï¼Œä¸ç”¨ä»å‰å¾€å å…¨éƒ¨éå† last_col, last_row = -1, -1 # éå†çŠ¶æ€ for i in range(m-1, -1, -1): for j in range(n-1, -1, -1): if obstacleGrid[i][j] == 1: # é‡åˆ°éšœç¢ç‰© dp[i][j] = 0 # åœ¨éå†çŠ¶æ€çš„è¿‡ç¨‹ä¸­è®°å½• å³è¾¹ç•Œå’Œä¸‹è¾¹ç•Œ æœ€åä¸€ä¸ªéšœç¢ç‰©çš„ä½ç½® last_col = max(last_col, j) if i==m-1 else last_col last_row = max(last_row, i) if j==n-1 else last_row else: # æ­£å¸¸çš„æ ¼å­ if i&lt;m-1 and j&lt;n-1: # ä¸åœ¨å³è¾¹ç•Œå’Œä¸‹è¾¹ç•Œ dp[i][j] = dp[i+1][j] + dp[i][j+1] elif i==m-1: # ä¸‹è¾¹ç•Œ:å¦‚æœå½“å‰ä½ç½®æ˜¯åœ¨ä¸‹è¾¹ç•Œçš„æœ€åä¸€ä¸ªéšœç¢ç‰©ä¹‹åï¼Œé‚£ä¹ˆèµ‹å€¼1ï¼Œå¦åˆ™èµ‹å€¼0 dp[i][j] = 1 if j&gt;last_col else 0 elif j==n-1: # å³è¾¹ç•Œ:å¦‚æœå½“å‰ä½ç½®æ˜¯åœ¨å³è¾¹ç•Œçš„æœ€åä¸€ä¸ªéšœç¢ç‰©ä¹‹åï¼Œé‚£ä¹ˆèµ‹å€¼1ï¼Œå¦åˆ™èµ‹å€¼0 dp[i][j] = 1 if i&gt;last_row else 0 # ç­”æ¡ˆä¸ºdp[0][0] # print(last_col, last_row) return dp[0][0] # dpç©ºé—´å‹ç¼©ï¼šå®é™…ä¸Šæˆ‘ä»¬åœ¨è¿›è¡Œé€’æ¨çš„æ—¶å€™ï¼Œåªéœ€è¦ä¸€ç»´æ•°ç»„å°±å¯ä»¥ # ä¸ºä»€ä¹ˆèƒ½åšåˆ°è¿™æ ·çš„ç©ºé—´å‹ç¼©ï¼Ÿ # å½“å¼€å§‹éå†ä¸Šä¸€å±‚(i--)ï¼Œdp[j]çš„å€¼æ˜¯ä¿ç•™äº†ä¸‹ä¸€å±‚çš„å€¼ï¼Œæ‰€ä»¥dp[j] += dp[j+1]æ˜¯ç›¸å½“äºä¹‹å‰çš„ dp[i][j] = dp[i+1][j] + dp[i][j+1] ~~~ï¼ï¼ï¼ï¼ # åŒæ—¶ä¹Ÿå¯ä»¥é¿å…å³è¾¹ç•Œå’Œä¸‹è¾¹ç•Œçš„ ç‰¹æ®Šæƒ…å†µï¼Œå› ä¸ºä¸€ç»´çš„æƒ…å†µä¸‹ ç›¸å½“äºæ˜¯å·²ç»è‡ªåŠ¨åŠ äº†é™åˆ¶ def uniquePathsWithObstacles(self, obstacleGrid: List[List[int]]) -&gt; int: m, n = len(obstacleGrid[0]), len(obstacleGrid) dp = [0] * m dp[m - 1] = 1 for i in range(n - 1, -1, -1): for j in range(m - 1, -1, -1): if obstacleGrid[i][j] == 1: # å½“å‰ä½ç½®ä¸ºéšœç¢ç‰© dp[j] = 0 elif j &lt; m - 1: # å› ä¸ºè¦ä½¿ç”¨ä¸‹ä¸€ä¸ªåæ ‡ï¼Œè¿™é‡Œè¦æ£€æµ‹åæ ‡çš„åˆæ³•æ€§ï¼Œé˜²æ­¢æŒ‡é’ˆè¶Šç•Œ dp[j] += dp[j + 1] return dp[0] 1143. æœ€é•¿å…¬å…±å­åºåˆ— æ€ç»´ï¼šDPæœ€ç»ˆä¼šå½’ç»“åˆ°ä¸€ä¸ªçŠ¶æ€æ•°ç»„ä¸­ï¼Œæ‰€ä»¥æ‹¿åˆ°ä¸€ä¸ªè¿™æ ·çš„é¢˜ç›®åï¼Œå°±å¾€ä¸€ç»´çŠ¶æ€æ•°ç»„ä¸Šé æ‹¢ï¼Œä¸€ç»´æä¸å®šï¼Œå°±å°è¯•ç”¨äºŒç»´æ•°ç»„ï¼Œå†ä¸è¡Œå°±ä¸‰ç»´â€¦ç„¶åä¾é æ•°å­¦å½’çº³æ³•è¿›è¡Œæ¨å¯¼ï¼Œçœ‹æ˜¯å¦èƒ½æ ¹æ®å·²çŸ¥å†…å®¹çš„ä½ç½® æ¨å¯¼å‡ºå½“å‰ä½ç½®çš„å€¼ ç›´æ¥ä¸ŠDPä¸‰æ­¥æ›² æ‰¾åˆ°é‡å¤å­é—®é¢˜ abcdeå’Œabcçš„é—®é¢˜å¯ä»¥ç”±ä¸‹åˆ—çš„äºŒç»´è¡¨æ ¼æè¿°ï¼Œå¦‚æœè¦æ±‚æŸä¸ªä½ç½®çš„å€¼ï¼Œåªéœ€è¦çŸ¥é“å®ƒä¹‹å‰çš„æŸäº›ä½ç½®å³å¯ - a b c d e a LCS(a,a)=1 LCS(a,ab)=1 LCS(a,abc)=1 LCS(a,aabcd)=1 LCS(a,abcde)=1 c LCS(ac,a)=1 LCS(ac,ab)=1 LCS(ac,abc)=2 2 2 e 1 1 2 2 LCS(ace,abcde)=3 å®šä¹‰çŠ¶æ€ dp[i][j]ï¼Œiè¡¨ç¤ºç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²çš„ä½ç½®ç¼–å·ï¼Œjè¡¨ç¤ºç¬¬äºŒä¸ªå­—ç¬¦ä¸²çš„ä½ç½®ç¼–å·ï¼Œæ•´ä½“è¡¨ç¤ºä¸¤ä¸ªå­ä¸²çš„æœ€é•¿å…¬å…±å­åºåˆ—çš„é•¿åº¦ dpé•¿åº¦åˆå§‹åŒ–ä¸ºtext1.length+1*text2.length+1ï¼Œå› ä¸ºè‡³å°‘è¦åŒ…å«æ²¡æœ‰å­—ç¬¦çš„æƒ…å†µ åˆå§‹å€¼ï¼šdp[0][0]=0 éå†æ–¹å‘ï¼šä»å‰å¾€åã€‚å› ä¸ºbase caseåœ¨å‰éƒ¨ æœ€ç»ˆç»“æœï¼šdp[text1.length][text2.length] DPæ–¹ç¨‹ f(x, y) = \\left\\{ \\begin{aligned} 0 &,& x=0\\&y=0 \\\\ max(f(x-1, y), f(x, y-1)) &,& text1(x)!=text2(y) \\\\ f(x-1, y-1)+1 &,& text1(x)=text2(y) \\\\ \\end{aligned} \\right.1234567891011121314151617181920212223242526272829303132333435class Solution: def longestCommonSubsequence1(self, text1: str, text2: str) -&gt; int: m, n = len(text1), len(text2) dp = [[0 for _ in range(m + 1)] for _ in range(n + 1)] for i in range(1, n + 1): for j in range(1, m + 1): if text1[j - 1] == text2[i - 1]: # å½“å‰ä½ç½®çš„ä¸¤ä¸ªå­—ç¬¦ä¸€æ ·ï¼Œå–å¯¹è§’çš„å€¼å†åŠ 1(åŠ ä¸Šè‡ªèº«) dp[i][j] = dp[i - 1][j - 1] + 1 else: # å½“å‰ä½ç½®çš„ä¸¤ä¸ªå­—ç¬¦ä¸ä¸€æ ·ï¼Œå–ä¸¤ä¸ªå­—ç¬¦å¯¹åº”çš„æœ€å¤§å€¼ dp[i][j] = max(dp[i - 1][j], dp[i][j - 1]) return dp[n][m] # dpç©ºé—´å‹ç¼©ï¼šå‘ç°æ±‚å½“å‰ä½ç½®çš„å€¼ï¼Œåªéœ€è¦leftå’Œlast_lineçš„å€¼ def longestCommonSubsequence(self, text1: str, text2: str) -&gt; int: m, n = len(text1), len(text2) # å½“å‰ä½ç½®ï¼Œå½“å‰ä½ç½®çš„å·¦ä¸€ä½ç½® curr, left = 0, 0 # ä¸Šä¸€è¡Œçš„å€¼ last_line = [0] * (m + 1) for i in range(1, n + 1): for j in range(1, m + 1): if text1[j - 1] == text2[i - 1]: # å½“å‰ä½ç½®çš„ä¸¤ä¸ªå­—ç¬¦ä¸€æ ·ï¼Œå–å¯¹è§’çš„å€¼å†åŠ 1(åŠ ä¸Šè‡ªèº«) curr = last_line[j - 1] + 1 else: # å½“å‰ä½ç½®çš„ä¸¤ä¸ªå­—ç¬¦ä¸ä¸€æ ·ï¼Œå–ä¸¤ä¸ªå­—ç¬¦å¯¹åº”çš„æœ€å¤§å€¼ curr = max(last_line[j], left) # æ ¹æ®å½“å‰è®¡ç®—çš„ç»“æœ æ›´æ–°ä¸Šä¸€è¡Œï¼Œéå†åˆ°ä¸‹ä¸€è¡Œçš„æ—¶å€™ï¼Œæ­£å¥½å¯ä»¥ç”¨ if j == m: # æ¢è¡Œï¼šå¯ä»¥æ›´æ–°å½“å‰ä½ç½®çš„upä½ç½®å…ƒç´ ï¼Œä¸”æŠŠlefté‡ç½®ä¸º0 last_line[j - 1], last_line[j], left = left, curr, 0 else: # ä¸æ¢è¡Œï¼šä¸èƒ½æ›´æ–°upä½ç½®ï¼Œå› ä¸ºåœ¨åŒä¸€è¡Œä¸­éå†çš„æ—¶å€™ï¼Œè¦ä½¿ç”¨åŸå§‹çš„å€¼ last_line[j - 1], left = left, curr return curr 120. ä¸‰è§’å½¢æœ€å°è·¯å¾„å’Œ ç›´æ¥DPä¸‰æ­¥æ›² æ‰¾åˆ°é‡å¤å­é—®é¢˜ è¦æƒ³æ±‚å¾—åˆ°è¾¾å½“å‰ä½ç½®çš„æœ€å°è·¯å¾„å’Œï¼Œé‚£ä¹ˆæˆ‘åªéœ€è¦çŸ¥é“åˆ°è¾¾å½“å‰ä½ç½®çš„upå’Œup_leftæœ€å°è·¯å¾„å’Œå³å¯ çŠ¶æ€å®šä¹‰ dp[i][j]ï¼Œiå’Œjåˆ†åˆ«è¡¨ç¤ºçŸ©é˜µçš„åæ ‡ï¼Œæ•´ä½“è¡¨ç¤ºåˆ°è¾¾è¯¥åæ ‡çš„æœ€å°è·¯å¾„å’Œ dp[0][0]ä¸ºçŸ©é˜µçš„ç¬¬ä¸€ä¸ªå…ƒç´ å€¼ æœ€ç»ˆç»“æœï¼šmin(dp[-1]) DPæ–¹ç¨‹ f(x, y) = \\left\\{ \\begin{aligned} matrix(0, 0) &, & x=0\\&y=0 \\\\ min(f(x-1, y), f(x-1, y-1)) + matrix(x,y) &,& 0\\leq x \\& 0\\leq y \\end{aligned} \\right.123456789101112131415161718192021222324252627class Solution: def minimumTotal1(self, triangle: List[List[int]]) -&gt; int: m, n = len(triangle[-1]), len(triangle) dp = [[0 for _ in row] for row in triangle] dp[0][0] = triangle[0][0] for i in range(1, n): for j, val in enumerate(triangle[i]): if j == 0: dp[i][j] = dp[i - 1][j] + val elif j == len(triangle[i]) - 1: dp[i][j] = dp[i - 1][j - 1] + val else: dp[i][j] = min(dp[i - 1][j], dp[i - 1][j - 1]) + val return min(dp[-1]) # dpç©ºé—´å‹ç¼© def minimumTotal(self, triangle: List[List[int]]) -&gt; int: m, n = len(triangle[-1]), len(triangle) dp = triangle for i in range(1, n): for j, val in enumerate(triangle[i]): if j == 0: dp[i][j] = dp[i - 1][j] + val elif j == len(triangle[i]) - 1: dp[i][j] = dp[i - 1][j - 1] + val else: dp[i][j] = min(dp[i - 1][j], dp[i - 1][j - 1]) + val return min(dp[-1]) 221. æœ€å¤§æ­£æ–¹å½¢ DPä¸‰æ­¥æ›² æ‰¾åˆ°é‡å¤å­é—®é¢˜ ä»¥æŸä¸ªä½ç½®(i,j)ä¸ºå³ä¸‹è§’çš„æ­£æ–¹å½¢çš„è¾¹é•¿ï¼Œå¯ä»¥æ ¹æ®å½“å‰ä½ç½®çš„upã€leftã€left_upä¸‰ä¸ªä½ç½®ç¡®å®šå‡ºæ¥ çŠ¶æ€å®šä¹‰ dp[i][j]è¡¨ç¤ºä»¥(i,j)ä¸ºå³ä¸‹è§’çš„æ­£æ–¹å½¢çš„è¾¹é•¿ï¼Œé‚£ä¹ˆå¦‚æœ(i,j)ä¸º0ï¼Œdp[i][j]=0ï¼›å¦åˆ™dp[i][j]=min(up,left,up_left)+1 åŠ 1çš„ç›®çš„æ˜¯ï¼Œè‡³å°‘åŒ…å«å®ƒæœ¬èº« DPæ–¹ç¨‹ 123456789101112131415class Solution: def maximalSquare(self, matrix: List[List[str]]) -&gt; int: if not matrix or not matrix[0]: return 0 m, n = len(matrix[0]), len(matrix) dp = [[0 for _ in range(m)] for _ in range(n)] max_edge = dp[0][0] = int(matrix[0][0]) for i in range(0, n): for j in range(0, m): if i == 0 or j == 0: dp[i][j] = 0 if matrix[i][j] == '0' else 1 else: dp[i][j] = 0 if matrix[i][j] == '0' else min(dp[i - 1][j], dp[i][j - 1], dp[i - 1][j - 1]) + 1 max_edge = max(dp[i][j], max_edge) return max_edge * max_edge 312. æˆ³æ°”çƒ DPä¸‰æ­¥æ›² æ‰¾åˆ°é‡å¤å­é—®é¢˜ å½“åªæœ‰ä¸€ä¸ªæ°”çƒæ—¶ï¼Œåªéœ€è¦æˆ³ä¸€æ¬¡å³å¯ å½“æœ‰ä¸¤ä¸ªæ°”çƒæ—¶ï¼Œä¹Ÿåªéœ€è¦æˆ³ä¸€æ¬¡ å½“æœ‰ä¸‰ä¸ªæ°”çƒæ—¶ï¼Œé‚£ä¹ˆè‚¯å®šè¦å…ˆæˆ³ä¸­é—´é‚£ä¸€ä¸ª å½“æœ‰å››ä¸ªæ°”çƒæ—¶ï¼Œé‚£ä¹ˆå°±è¦ çŠ¶æ€å®šä¹‰ æ°”çƒçš„ä¸ªæ•°ä¸ºn å‡è®¾dp[i][j]è¡¨ç¤ºåºå·åœ¨(i,j)ä¹‹é—´çš„è·å¾—çš„ç¡¬å¸æœ€å¤§å€¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦é€šè¿‡éå†(i,j)ä¹‹é—´çš„æ‰€æœ‰åºå·ï¼Œæ±‚å‡ºdp[i][k]å’Œdp[k][j]ï¼Œå› ä¸ºdp[i][j]=dp[i][k]+dp[k][j]+kï¼Œ æœ€ç»ˆç»“æœï¼šdp[0][n+1] DPæ–¹ç¨‹ 198. æ‰“å®¶åŠ«èˆ ç•¥è¿‡é€’å½’æ–¹æ¡ˆï¼Œç›´æ¥ä¸ŠDP DPé—®é¢˜ä¸‰æ­¥æ›² æ‰¾åˆ°é‡å¤å­é—®é¢˜ æ ¹æ®æ•°å­¦å½’çº³æ³•ï¼šå¦‚æœå·²çŸ¥å°å·åœ¨ç¬¬i-1ä¸ªæˆ¿é—´å¯¹åº”çš„æœ€é«˜é‡‘é¢ï¼Œé‚£ä¹ˆå°å·åœ¨ç¬¬iä¸ªæˆ¿é—´çš„å¯¹åº”çš„æœ€é«˜é‡‘é¢æœ‰ä»¥ä¸‹ä¸¤ç§æƒ…å†µ å°å·å·äº†ç¬¬i-1æˆ¿é—´ï¼šé‚£ä¹ˆå°å·åŠ¿å¿…ä¸èƒ½å·ç¬¬iä¸ªæˆ¿é—´ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°å·å·çš„é‡‘é¢åº”è¯¥ç»§æ‰¿ä¸Šä¸€ä¸ªå€¼ å°å·æ²¡æœ‰å·ç¬¬i-1æˆ¿é—´ï¼šé‚£ä¹ˆå°å·ä¸€å®šè¦å·ç¬¬iä¸ªæˆ¿é—´(å› ä¸ºæ˜¯æ±‚çš„æœ€å¤§å€¼)ï¼Œè¿™ä¸ªæ—¶å€™å°å·å·çš„é‡‘é¢åº”è¯¥æ˜¯ä¸Šä¸€ä¸ªå€¼åŠ ä¸Šç¬¬iä¸ªæˆ¿é—´çš„é‡‘é¢ çŠ¶æ€å®šä¹‰ é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆè¡¨ç¤ºæŸä¸€ä¸ªæˆ¿é—´å·ä¸ä¸å·å‘¢ï¼Ÿæ­¤æ—¶æˆ‘ä»¬å¯ä»¥è€ƒè™‘åœ¨ä¸€ç»´çš„åŸºç¡€ä¹‹ä¸ŠåŠ ä¸€ç»´é™„åŠ è¿™ä¸ªçŠ¶æ€ï¼Œç”¨dp[i][0]è¡¨ç¤ºæ²¡æœ‰å·ç¬¬iä¸ªæˆ¿é—´ï¼Œdp[i][1]è¡¨ç¤ºå·äº†ç¬¬iä¸ªæˆ¿é—´ï¼Œnums[i]è¡¨ç¤ºç¬¬ié—´æˆ¿çš„é‡‘é¢ï¼Œé‚£ä¹ˆ è®¡ç®—æ²¡æœ‰å·iæˆ¿çš„æ—¶å€™åœ¨içš„æœ€å¤§é‡‘é¢ï¼šdp[i][0]=max(dp[i-1][0], dp[i-1][1]) è®¡ç®—å·iæˆ¿çš„æ—¶å€™åœ¨içš„æœ€å¤§é‡‘é¢ï¼šdp[i][1]=dp[i-1][0]+nums[i] dpçš„åˆå§‹å€¼ä¸ºå…¨ä¸º0ï¼Œé•¿åº¦ä¸ºn+1ï¼Œ ç¬¬0ä¸ªå…ƒç´ è¡¨ç¤ºæˆ¿é—´æ•°ä¸º0æ—¶ï¼Œèƒ½å·åˆ°çš„é‡‘é¢ä¸º0ï¼Œ ç¬¬nä¸ªå…ƒç´ è¡¨ç¤ºåˆ°è¾¾æœ€åä¸€ä¸ªæˆ¿é—´ï¼Œèƒ½å·åˆ°çš„é‡‘é¢ä¸ºå¤šå°‘ éå†ä»1å¼€å§‹ æœ€ç»ˆçš„ç»“æœï¼šmax(dp[n][0], dp[n][1]) DPæ–¹ç¨‹å®šä¹‰ f(n,0) =\\left\\{ \\begin{aligned} 0 &,& n=0 \\\\ max(f(n-1, 0), f(n-1, 1)) &,& n>1 \\end{aligned} \\right. f(n,1) =\\left\\{ \\begin{aligned} 0 &,& n=0 \\\\ f(n-1, 0)+nums(n) &,& n>1 \\end{aligned} \\right. res = max(f(n, 0), f(n, 1))1234567891011class Solution: def rob(self, nums: List[int]) -&gt; int: n = len(nums) # æˆ¿é—´ä¸ªæ•° dp = [[0 for _ in range(2)] for _ in range(n + 1)] for i in range(1, n + 1): dp[i][0] = max(dp[i - 1][0], dp[i - 1][1]) # ä¸å·ç¬¬ié—´æˆ¿ dp[i][1] = dp[i - 1][0] + nums[i - 1] # å·ç¬¬ié—´æˆ¿ return max(dp[n][0], dp[n][1]) # è¿”å›ç¬¬ié—´æˆ¿ å·ä¸ä¸å·çš„æœ€å¤§é‡‘é¢ DPé—®é¢˜ä¸‰æ­¥æ›²-version2 ç¬¬ä¸€ä¸ªç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬è€ƒè™‘çš„æ—¶å€™ï¼Œå¹¶ä¸çŸ¥é“å°å·æœ‰æ²¡æœ‰å·æŸä¸ªæˆ¿é—´ï¼Œæ‰€ä»¥åŠ äº†ä¸€ä¸ªç»´åº¦è¡¨ç¤ºæŸä¸ªæˆ¿é—´å·ä¸ä¸å·çš„ å¯¹åº”çš„æœ€å¤§é‡‘é¢ è¿™ä¸ªç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬æ¢ä¸ªæ€è·¯ï¼Œå¯ä»¥è‚¯å®šçš„æ˜¯ï¼Œå°å·ä¸€å®šä¼šå·å…¶ä¸­ä¸€é—´æˆ¿ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬å‡å®šæŸé—´æˆ¿å¿…å·çš„è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ€ç»ˆçš„ç»“æœåº”è¯¥æ˜¯æ‰€æœ‰ç»“æœçš„æœ€å¤§å€¼ æ‰¾åˆ°é‡å¤å­é—®é¢˜ æ ¹æ®æ•°å­¦å½’çº³æ³•ï¼šç”±äºå°å·ä¸èƒ½å·è¿ç»­çš„ä¸¤é—´æˆ¿ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚æœè¦è®¡ç®—ç¬¬ié—´æˆ¿æœ€å¤§é‡‘é¢ï¼Œè¯¥æ€ä¹ˆè®¡ç®—å‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™ï¼Œå‰ä¸€é—´æˆ¿è¦ä¹ˆå·äº†ï¼Œè¦ä¹ˆæ²¡å·ï¼Œå¦‚æœå‰ä¸€é—´æˆ¿æ²¡å·ï¼Œé‚£ä¹ˆçœ‹å‰ä¸¤é—´æˆ¿å·æ²¡å·ï¼Œå‰ä¸¤é—´æˆ¿å¦‚æœæ²¡å·ï¼Œé‚£å°±ç»§ç»­å¾€å‰æ¨ çŠ¶æ€å®šä¹‰-DPæ•°ç»„å«ä¹‰åŠbase case dp[i]è¡¨ç¤ºå½“å·åˆ°ç¬¬ié—´æˆ¿æ—¶çš„æœ€å¤§é‡‘é¢ï¼Œä¸ç®¡ç¬¬ié—´æˆ¿å·ä¸ä¸å·ï¼Œ dp[i]=max(dp[i-1], dp[i-2]+nums[i]) è¡¨ç¤ºï¼šå·ä¸ä¸å·i-1çš„æ—¶å€™ï¼Œåœ¨ç¬¬ié—´æˆ¿çš„æœ€å¤§é‡‘é¢ dpåˆå§‹åŒ–å…¨ä¸º0ï¼Œé•¿åº¦ä¸ºn+2 dp[0], dp[1]è¡¨ç¤ºç¬¬1é—´æˆ¿å‰1é—´ã€ä¸¤é—´çš„é‡‘é¢éƒ½ä¸º0 éå†ä»2å¼€å§‹ æœ€ç»ˆç»“æœï¼šmax(dp) DPæ–¹ç¨‹ f(n) = \\left\\{ \\begin{aligned} 0 &,& n=-1 \\\\ 0 &,& n=0 \\\\ max(f(n-1), f(n-2)+nums(n)) &,& n>0 \\end{aligned} \\right.12345678910111213141516171819202122232425class Solution: def robnn(self, nums: List[int]) -&gt; int: n = len(nums) dp = [0] * (n + 2) for i in range(2, n + 2): dp[i] = max(dp[i - 1], dp[i - 2] + nums[i - 2]) return max(dp) # ====&gt; ä¼˜åŒ–ï¼Œå»æ‰æœ€åçš„å–æœ€å¤§å€¼çš„å‡½æ•°ï¼Œä¸”é™ä½ç©ºé—´å¤æ‚åº¦ def rob(self, nums: List[int]) -&gt; int: n = len(nums) i_2, i_1, res = 0, 0, 0 # å‰ä¸¤é—´æˆ¿çš„æœ€å¤§é‡‘é¢ï¼Œå‰ä¸€é—´æˆ¿çš„æœ€å¤§é‡‘é¢ï¼Œå½“å‰æˆ¿é—´çš„æœ€å¤§é‡‘é¢ for i in range(n): # dp[i] = max(dp[i - 1], dp[i - 2] + nums[i - 2]) # æ›´æ–°å·åˆ°å½“å‰æˆ¿é—´çš„æœ€å¤§é‡‘é¢ res = max(i_1, i_2 + nums[i]) # ä¸Šä¸€ä¸ªreså˜æˆå‰ä¸€é—´æˆ¿ # ä¸Šä¸€ä¸ªi_1å˜æˆå‰ä¸¤é—´æˆ¿ i_1, i_2 = res, i_1 return res 44. é€šé…ç¬¦åŒ¹é… DPä¸‰æ­¥æ›² æ‰¾åˆ°é‡å¤å­é—®é¢˜ è¦æƒ³çŸ¥é“p[1â€¦j]æ˜¯å¦åŒ¹é…s[1â€¦i]ï¼Œé‚£ä¹ˆéœ€è¦çŸ¥é“p[0â€¦j-1]ä¸s[0â€¦i-1]æ˜¯å¦åŒ¹é… çŠ¶æ€å®šä¹‰-DPæ•°ç»„å«ä¹‰åŠbase case dp[i][j]è¡¨ç¤ºp[1â€¦j]æ˜¯å¦åŒ¹é…s[1â€¦i] dp[0][0]=True å¦‚æœpå’Œséƒ½æ˜¯ç©ºå­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆä¸¤è€…æ˜¯åŒ¹é…çš„ï¼Œç›´æ¥è¿”å›True å¦‚æœsä¸ºç©ºï¼Œpä¸ä¸ºç©ºä¸”åªåŒ…å«*è¿™ä¸€ç§å­—ç¬¦ï¼Œåˆ™ä¸¤è€…åŒ¹é…ï¼Œç›´æ¥è¿”å›True å¦‚æœpä¸ºç©ºï¼Œsä¸ä¸ºç©ºï¼Œåˆ™ä¸¤è€…ä¸åŒ¹é…ï¼Œç›´æ¥è¿”å›False å¦‚æœsä¸ºç©ºï¼Œpä¸ä¸ºç©ºä¸”ä¸æ­¢åŒ…å«*è¿™ä¸€ç§å­—ç¬¦ï¼Œåˆ™ä¸¤è€…ä¸åŒ¹é…ï¼Œç›´æ¥è¿”å›False çŠ¶æ€è½¬ç§»æ–¹ç¨‹ dp[i][j] = \\left\\{ \\begin{aligned} dp[i-1][j-1] &,& s[i]=p[j] \\\\ dp[i-1][j] âˆ¨ dp[i][j-1] &,& p[j]='*' \\\\ dp[i-1][j-1] &,& p[j]='?' \\end{aligned} \\right. 1234567891011121314151617181920class Solution: def isMatch(self, s: str, p: str) -&gt; bool: if not p and not s: return True if not p and s: return False if not s and ('*' not in set(p) or len(set(p))&gt;1): return False dp = [[False]*(len(p)+1) for _ in range(len(s)+1)] dp[0][0] = True for j in range(1, len(p)+1): if p[j-1]=='*': dp[0][j] = dp[0][j-1] else: break for i in range(1, len(s)+1): for j in range(1, len(p)+1): if s[i-1]==p[j-1] or p[j-1]=='?': dp[i][j] = dp[i-1][j-1] elif p[j-1]=='*': dp[i][j] = dp[i][j-1] | dp[i-1][j] print(dp) return dp[len(s)][len(p)]","categories":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://shang.at/categories/æ•°æ®ç»“æ„ä¸ç®—æ³•/"}],"tags":[{"name":"åŠ¨æ€è§„åˆ’","slug":"åŠ¨æ€è§„åˆ’","permalink":"https://shang.at/tags/åŠ¨æ€è§„åˆ’/"}]},{"title":"Pythonå­¦ä¹ -python3.6-dictæœ‰åºä¸”æ•ˆç‡æ›´é«˜","slug":"Pythonå­¦ä¹ -python3-6-dictæœ‰åºä¸”æ•ˆç‡æ›´é«˜","date":"2020-06-28T23:22:42.000Z","updated":"2020-07-02T15:49:24.809Z","comments":true,"path":"post/Pythonå­¦ä¹ -python3-6-dictæœ‰åºä¸”æ•ˆç‡æ›´é«˜/","link":"","permalink":"https://shang.at/post/Pythonå­¦ä¹ -python3-6-dictæœ‰åºä¸”æ•ˆç‡æ›´é«˜/","excerpt":"","text":"https://www.cnblogs.com/xieqiankun/p/python_dict.html","categories":[{"name":"Python","slug":"Python","permalink":"https://shang.at/categories/Python/"}],"tags":[{"name":"pythonçš„dict","slug":"pythonçš„dict","permalink":"https://shang.at/tags/pythonçš„dict/"}]},{"title":"Hadoopå­¦ä¹ ","slug":"Hadoopå­¦ä¹ ","date":"2020-06-26T16:34:48.000Z","updated":"2020-07-15T09:10:12.865Z","comments":true,"path":"post/Hadoopå­¦ä¹ /","link":"","permalink":"https://shang.at/post/Hadoopå­¦ä¹ /","excerpt":"ç®€ä»‹ï¼š","text":"ç®€ä»‹ï¼š å¤§æ•°æ® åˆ†å¸ƒå¼æ•°æ®å­˜å‚¨ â€‹ æ•°æ®ä¸€è‡´æ€§ - CAP - poxes ä¸»ä» â€‹ å•ç‚¹æ•…éšœ - HA â€‹ å†…å­˜å‹åŠ› - åˆ†ç‰‡ç®¡ç† åˆ†å¸ƒå¼è®¡ç®— - è®¡ç®—å‘æ•°æ®ç§»åŠ¨ â€‹ mapreduce æ•°æ®ä»¥ä¸€æ¡è®°å½•ä¸ºå•ä½åŠç»è¿‡mapæ–¹æ³•æ˜ å°„æˆKVï¼Œç›¸åŒçš„Kä¸ºä¸€ç»„ï¼Œè¿™ä¸€ç»„æ•°æ®æ¡ç”¨ä¸€æ¬¡reduceæ–¹æ³•ï¼Œåœ¨æ–¹æ³•å†…è¿­ä»£è®¡ç®—ä¸€ç»„æ•°æ®ã€‚ è¿­ä»£å™¨æ¨¡å¼ï¼Œæ•°æ®é›†ä¸€èˆ¬æ˜¯ç”¨è¿­ä»£è®¡ç®—çš„æ–¹å¼ â€‹ ä¸ºä»€ä¹ˆè¦æœ‰splitï¼Ÿsplitåªæ˜¯ä¸€ä¸ªé€»è¾‘ä¸Šçš„æ¦‚å¿µã€‚ â€‹ ä¸æ•°æ®ç‰©ç†å­˜å‚¨ä¸Šçš„blockè§£è€¦(è½¯ä»¶å·¥ç¨‹ä¸Šï¼šåŠ ä¸€å±‚è§£è€¦)ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œsplitç­‰äºblockï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥å°äºblockï¼Œä¹Ÿå¯èƒ½å¤§äºblock é›†ç¾¤å†…éƒ¨çš„é€šä¿¡é‡‡ç”¨RPCçš„æ–¹å¼ï¼ŒåŒæ—¶åªä¼šå‘ç”Ÿclientå‘serverå‘é€è¯·æ±‚ï¼Œserverå¤„ç†å®Œä¹‹åè¿”å›clientå“åº”ç»“æœï¼Œseverä¸ä¼šä¸»åŠ¨å‘clientå‘é€æ¶ˆæ¯","categories":[{"name":"Hadoopå­¦ä¹ ","slug":"Hadoopå­¦ä¹ ","permalink":"https://shang.at/categories/Hadoopå­¦ä¹ /"}],"tags":[{"name":"Hadoop","slug":"Hadoop","permalink":"https://shang.at/tags/Hadoop/"}]},{"title":"Hadoopå­¦ä¹ -Yarn-Scheduler","slug":"Hadoopå­¦ä¹ -Yarn-Scheduler","date":"2020-06-25T06:24:45.000Z","updated":"2020-06-25T06:25:31.320Z","comments":true,"path":"post/Hadoopå­¦ä¹ -Yarn-Scheduler/","link":"","permalink":"https://shang.at/post/Hadoopå­¦ä¹ -Yarn-Scheduler/","excerpt":"","text":"","categories":[{"name":"Hadoopå­¦ä¹ ","slug":"Hadoopå­¦ä¹ ","permalink":"https://shang.at/categories/Hadoopå­¦ä¹ /"}],"tags":[{"name":"Yarn-Scheduler","slug":"Yarn-Scheduler","permalink":"https://shang.at/tags/Yarn-Scheduler/"}]},{"title":"Hadoopå­¦ä¹ -Yarn-Container","slug":"Hadoopå­¦ä¹ -Yarn-Container","date":"2020-06-25T06:24:29.000Z","updated":"2020-06-25T06:25:23.223Z","comments":true,"path":"post/Hadoopå­¦ä¹ -Yarn-Container/","link":"","permalink":"https://shang.at/post/Hadoopå­¦ä¹ -Yarn-Container/","excerpt":"","text":"","categories":[{"name":"Hadoopå­¦ä¹ ","slug":"Hadoopå­¦ä¹ ","permalink":"https://shang.at/categories/Hadoopå­¦ä¹ /"}],"tags":[{"name":"Yarn-Container","slug":"Yarn-Container","permalink":"https://shang.at/tags/Yarn-Container/"}]},{"title":"Hadoopå­¦ä¹ -å¦‚ä½•å®ç°ä¸€ä¸ªåœ¨Yarnä¸Šçš„Application","slug":"Hadoopå­¦ä¹ -å¦‚ä½•å®ç°ä¸€ä¸ªåœ¨Yarnä¸Šçš„Application","date":"2020-06-25T01:27:51.000Z","updated":"2020-06-25T01:28:09.068Z","comments":true,"path":"post/Hadoopå­¦ä¹ -å¦‚ä½•å®ç°ä¸€ä¸ªåœ¨Yarnä¸Šçš„Application/","link":"","permalink":"https://shang.at/post/Hadoopå­¦ä¹ -å¦‚ä½•å®ç°ä¸€ä¸ªåœ¨Yarnä¸Šçš„Application/","excerpt":"","text":"","categories":[{"name":"Hadoopå­¦ä¹ ","slug":"Hadoopå­¦ä¹ ","permalink":"https://shang.at/categories/Hadoopå­¦ä¹ /"}],"tags":[{"name":"å®ç°ä¸€ä¸ªåœ¨Yarnä¸Šçš„Application","slug":"å®ç°ä¸€ä¸ªåœ¨Yarnä¸Šçš„Application","permalink":"https://shang.at/tags/å®ç°ä¸€ä¸ªåœ¨Yarnä¸Šçš„Application/"}]},{"title":"Hadoopå­¦ä¹ -Mapreduceç¼–ç¨‹æ¨¡å¼","slug":"Hadoopå­¦ä¹ -Mapreduceç¼–ç¨‹æ¨¡å¼","date":"2020-06-25T01:26:50.000Z","updated":"2020-12-18T10:02:58.291Z","comments":true,"path":"post/Hadoopå­¦ä¹ -Mapreduceç¼–ç¨‹æ¨¡å¼/","link":"","permalink":"https://shang.at/post/Hadoopå­¦ä¹ -Mapreduceç¼–ç¨‹æ¨¡å¼/","excerpt":"","text":"Hadoop-2.7.3","categories":[{"name":"Hadoopå­¦ä¹ ","slug":"Hadoopå­¦ä¹ ","permalink":"https://shang.at/categories/Hadoopå­¦ä¹ /"}],"tags":[{"name":"Mapreduceç¼–ç¨‹æ¨¡å¼","slug":"Mapreduceç¼–ç¨‹æ¨¡å¼","permalink":"https://shang.at/tags/Mapreduceç¼–ç¨‹æ¨¡å¼/"}]},{"title":"Hiveå­¦ä¹ -å®‰è£…","slug":"Hiveå­¦ä¹ -å®‰è£…","date":"2020-06-24T07:41:54.000Z","updated":"2020-07-04T14:15:46.359Z","comments":true,"path":"post/Hiveå­¦ä¹ -å®‰è£…/","link":"","permalink":"https://shang.at/post/Hiveå­¦ä¹ -å®‰è£…/","excerpt":"","text":"é…ç½®è¿‡ç¨‹ mysql å®‰è£… é…ç½®å¯ä»¥è¿œç¨‹è¿æ¥ jdbc driver hiveä½¿ç”¨çš„jdbc driveè¦ä¸mysqlçš„ç‰ˆæœ¬åŒ¹é… hiveé…ç½® 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556&lt;!-- hive-site.xml --&gt;&lt;configuration&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt; &lt;value&gt;jdbc:mysql://hostmachine:3306/metastore?createDatabaseIfNotExist=true&lt;/value&gt; &lt;description&gt;the URL of the MySQL database&lt;/description&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt; &lt;value&gt;com.mysql.jdbc.Driver&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt; &lt;value&gt;hive&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt; &lt;value&gt;hive1234&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;datanucleus.autoCreateSchema&lt;/name&gt; &lt;value&gt;true&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;datanucleus.fixedDatastore&lt;/name&gt; &lt;value&gt;true&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;datanucleus.autoStartMechanism&lt;/name&gt; &lt;value&gt;SchemaTable&lt;/value&gt; &lt;/property&gt; &lt;!-- é…ç½®æ•°æ®å­˜æ”¾åœ¨hdfsä¸Šçš„è·¯å¾„ --&gt; &lt;property&gt; &lt;name&gt;hive.metastore.warehouse.dir&lt;/name&gt; &lt;value&gt;/user/hive/warehouse&lt;/value&gt; &lt;/property&gt; &lt;!-- é…ç½®metastore service çš„èŠ‚ç‚¹ --&gt; &lt;property&gt; &lt;name&gt;hive.metastore.uris&lt;/name&gt; &lt;value&gt;thrift://node2:9083&lt;/value&gt; &lt;description&gt;IP address (or fully-qualified domain name) and port of the metastore host&lt;/description&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;hive.metastore.schema.verification&lt;/name&gt; &lt;value&gt;true&lt;/value&gt; &lt;/property&gt;&lt;/configuration&gt; å¯åŠ¨è¿‡ç¨‹ é¦–å…ˆå¯åŠ¨hdfsï¼šstart-dfs.sh åˆå§‹åŒ–metestoreï¼šschematool --dbType mysql --initSchema å¯åŠ¨metastore serviceï¼šhive --service metastore å¯åŠ¨hiveï¼šhive https://www.jianshu.com/p/6108e0aed204","categories":[{"name":"Hiveå­¦ä¹ ","slug":"Hiveå­¦ä¹ ","permalink":"https://shang.at/categories/Hiveå­¦ä¹ /"}],"tags":[{"name":"Hiveå®‰è£…","slug":"Hiveå®‰è£…","permalink":"https://shang.at/tags/Hiveå®‰è£…/"}]},{"title":"æ•°æ®åº“-mysql-ç¯å¢ƒé…ç½®","slug":"æ•°æ®åº“-mysql-ç¯å¢ƒé…ç½®","date":"2020-06-24T06:16:33.000Z","updated":"2020-12-07T02:14:25.434Z","comments":true,"path":"post/æ•°æ®åº“-mysql-ç¯å¢ƒé…ç½®/","link":"","permalink":"https://shang.at/post/æ•°æ®åº“-mysql-ç¯å¢ƒé…ç½®/","excerpt":"","text":"platformï¼šMAC å®‰è£…1234567891011121314brew istall mysqlWe've installed your MySQL database without a root password. To secure it run: mysql_secure_installationMySQL is configured to only allow connections from localhost by defaultTo connect run: mysql -urootTo have launchd start mysql now and restart at login: brew services start mysqlOr, if you don't want/need a background service you can just run: mysql.server start æ–°å®‰è£…çš„mysqlï¼Œéœ€è¦é‡ç½®å¯†ç ï¼š The initial root account may or may not have a password. Choose whichever of the following procedures applies: If the root account exists with an initial random password that has been expired, connect to the server as root using that password, then choose a new password. This is the case if the data directory was initialized using mysqld â€”initialize, either manually or using an installer that does not give you the option of specifying a password during the install operation. Because the password exists, you must use it to connect to the server. But because the password is expired, you cannot use the account for any purpose other than to choose a new password, until you do choose one. If you do not know the initial random password, look in the server error log. Connect to the server as root using the password: 12shell&gt; mysql -u root -p Enter password: (enter the random root password here) Choose a new password to replace the random password: mysql&gt; ALTER USER â€˜rootâ€™@â€™localhostâ€™ IDENTIFIED BY â€˜root-passwordâ€™; If the root account exists but has no password, connect to the server as root using no password, then assign a password. This is the case if you initialized the data directory using mysqld â€”initialize-insecure. Connect to the server as root using no password: 1shell&gt; mysql -u root --skip-password Assign a password: 1mysql&gt; ALTER USER 'root'@'localhost' IDENTIFIED BY 'root-password'; After assigning the root account a password, you must supply that password whenever you connect to the server using the account. For example, to connect to the server using the mysql client, use this command: 12shell&gt; mysql -u root -p Enter password: (enter root password here) To shut down the server with mysqladmin, use this command: 12shell&gt; mysqladmin -u root -p shutdown Enter password: (enter root password here) è®¾ç½®è¿œç¨‹è®¿é—®è®¾ç½®my.cnfä½¿ç”¨brew å®‰è£…çš„mysqlï¼Œmy.cnfæ–‡ä»¶åœ¨/usr/local/etc/my.cnfï¼Œä¿®æ”¹bind-addressä¸º0.0.0.0ï¼Œç„¶åé‡å¯brew services restart mysql åˆ›å»ºç”¨æˆ·ï¼Œèµ‹äºˆæƒé™1234567891011121314# ç™»å½•mysqlmysql -u root -p 123456# åˆ›å»ºæ–°ç”¨æˆ·create user 'hive' identified by 'hive1234';# æˆæƒgrant all privileges on *.* to 'hive'@'%' with grant option;# *.* å‰è¾¹çš„*å·æŒ‡çš„æ˜¯æ•°æ®åº“ï¼Œåé¢çš„*å·æŒ‡çš„æ˜¯è¡¨ï¼Œ*.*çš„æ„æ€å°±æ˜¯ä»»æ„æ•°æ®åº“ä¸‹çš„ä»»æ„è¡¨# 'root'@'%'ï¼Œ'root'ç”¨æˆ·åï¼Œ'%'ä»»æ„çš„ä¸»æœºåã€‚# è¿™æ¡é…ç½®ä¿¡æ¯å°±æ˜¯è¯´ï¼Œå…è®¸ä»»æ„èŠ‚ç‚¹ä»¥rootèº«ä»½ç™»å½•ï¼Œå¹¶ä¸”å¯ä»¥è®¿é—®mysqlé‡Œçš„ä»»æ„åº“ä¸‹çš„ä»»æ„è¡¨# åˆ·æ–°flush privileges; è‡³æ­¤ï¼Œä¾¿å¯ä»¥åœ¨å…¶ä»–hostä¸Šè®¿é—®mysqlæœåŠ¡äº†ã€‚ å…¶ä»–é—®é¢˜ jarè®°å¾—æ›´æ–° server æ—¶åŒº å¦‚æœä¸æ˜¯æ–°å®‰è£…çš„mysqlï¼Œé‚£ä¹ˆå¯ä»¥æŒ‰ç…§ä»¥ä¸‹çš„æ–¹å¼è¿›è¡Œä¿®æ”¹å¯†ç ï¼šcd /usr/local/mysql/bin sudo ./mysqld_safe â€”skip-grant-tables &amp; ç„¶åå¼€å¯å¦ä¸€ä¸ªç»ˆç«¯tabï¼Œæ‰§è¡Œmysql -uroot -pï¼Œè¦æ±‚è¾“å…¥å¯†ç çš„æ—¶å€™ç›´æ¥å›è½¦å³å¯ç™»å½•æˆåŠŸ use mysql;update user set authentication_string=â€™â€™ where user=â€™rootâ€™ flush privileges; æœ€åéœ€è¦é‡æ–°é€€å‡ºç™»å½•ï¼Œç„¶åæ­£å¸¸é‡å¯mysql server(â€”skip-grant-tablesæ¨¡å¼æ— æ³•ä¿®æ”¹å¯†ç )ï¼Œé‡æ–°ç™»å½• ä¿®æ”¹å¯†ç  use mysql; ALTER user â€˜rootâ€™@â€™localhostâ€™ IDENTIFIED BY â€˜!Qwer1234â€™; flush privileges;","categories":[{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"https://shang.at/categories/æ•°æ®åº“/"}],"tags":[{"name":"mysqlç¯å¢ƒé…ç½®","slug":"mysqlç¯å¢ƒé…ç½®","permalink":"https://shang.at/tags/mysqlç¯å¢ƒé…ç½®/"}]},{"title":"Hadoopå­¦ä¹ -Shellè„šæœ¬å­¦ä¹ ","slug":"Hadoopå­¦ä¹ -Shellè„šæœ¬å­¦ä¹ ","date":"2020-06-24T05:28:09.000Z","updated":"2020-06-24T05:28:38.353Z","comments":true,"path":"post/Hadoopå­¦ä¹ -Shellè„šæœ¬å­¦ä¹ /","link":"","permalink":"https://shang.at/post/Hadoopå­¦ä¹ -Shellè„šæœ¬å­¦ä¹ /","excerpt":"","text":"","categories":[{"name":"Hadoopå­¦ä¹ ","slug":"Hadoopå­¦ä¹ ","permalink":"https://shang.at/categories/Hadoopå­¦ä¹ /"}],"tags":[{"name":"Hadoop-Shell","slug":"Hadoop-Shell","permalink":"https://shang.at/tags/Hadoop-Shell/"}]},{"title":"å·¥å…·ä½¿ç”¨-iterm2","slug":"å·¥å…·ä½¿ç”¨-iterm2","date":"2020-06-23T10:30:55.000Z","updated":"2020-06-23T10:32:31.790Z","comments":true,"path":"post/å·¥å…·ä½¿ç”¨-iterm2/","link":"","permalink":"https://shang.at/post/å·¥å…·ä½¿ç”¨-iterm2/","excerpt":"","text":"æ ‡ç­¾12345æ–°å»ºæ ‡ç­¾ï¼šcommand + tå…³é—­æ ‡ç­¾ï¼šcommand + wåˆ‡æ¢æ ‡ç­¾ï¼šcommand + æ•°å­— command + å·¦å³æ–¹å‘é”®åˆ‡æ¢å…¨å±ï¼šcommand + enteræŸ¥æ‰¾ï¼šcommand + f åˆ†å±12345å‚ç›´åˆ†å±ï¼šcommand + dæ°´å¹³åˆ†å±ï¼šcommand + shift + dåˆ‡æ¢å±å¹•ï¼šcommand + option + æ–¹å‘é”® command + [ æˆ– command + ]æŸ¥çœ‹å†å²å‘½ä»¤ï¼šcommand + ;æŸ¥çœ‹å‰ªè´´æ¿å†å²ï¼šcommand + shift + h å…¶ä»–1234567891011121314151617181920212223æ¸…é™¤å½“å‰è¡Œï¼šctrl + uåˆ°è¡Œé¦–ï¼šctrl + aåˆ°è¡Œå°¾ï¼šctrl + eå‰è¿›åé€€ï¼šctrl + f/b (ç›¸å½“äºå·¦å³æ–¹å‘é”®)ä¸Šä¸€æ¡å‘½ä»¤ï¼šctrl + pæœç´¢å‘½ä»¤å†å²ï¼šctrl + råˆ é™¤å½“å‰å…‰æ ‡çš„å­—ç¬¦ï¼šctrl + dåˆ é™¤å…‰æ ‡ä¹‹å‰çš„å­—ç¬¦ï¼šctrl + håˆ é™¤å…‰æ ‡ä¹‹å‰çš„å•è¯ï¼šctrl + wåˆ é™¤åˆ°æ–‡æœ¬æœ«å°¾ï¼šctrl + käº¤æ¢å…‰æ ‡å¤„æ–‡æœ¬ï¼šctrl + tæ¸…å±1ï¼šcommand + ræ¸…å±2ï¼šctrl + lè‡ªå¸¦æœ‰å“ªäº›å¾ˆå®ç”¨çš„åŠŸèƒ½/å¿«æ·é”®âŒ˜ + æ•°å­—åœ¨å„ tab æ ‡ç­¾ç›´æ¥æ¥å›åˆ‡æ¢é€‰æ‹©å³å¤åˆ¶ + é¼ æ ‡ä¸­é”®ç²˜è´´ï¼Œè¿™ä¸ªå¾ˆå®ç”¨âŒ˜ + f æ‰€æŸ¥æ‰¾çš„å†…å®¹ä¼šè¢«è‡ªåŠ¨å¤åˆ¶âŒ˜ + d æ¨ªç€åˆ†å± / âŒ˜ + shift + d ç«–ç€åˆ†å±âŒ˜ + r = clearï¼Œè€Œä¸”åªæ˜¯æ¢åˆ°æ–°ä¸€å±ï¼Œä¸ä¼šæƒ³ clear ä¸€æ ·åˆ›å»ºä¸€ä¸ªç©ºå±ctrl + u æ¸…ç©ºå½“å‰è¡Œï¼Œæ— è®ºå…‰æ ‡åœ¨ä»€ä¹ˆä½ç½®è¾“å…¥å¼€å¤´å‘½ä»¤å æŒ‰ âŒ˜ + ; ä¼šè‡ªåŠ¨åˆ—å‡ºè¾“å…¥è¿‡çš„å‘½ä»¤âŒ˜ + shift + h ä¼šåˆ—å‡ºå‰ªåˆ‡æ¿å†å²å¯ä»¥åœ¨ Preferences &gt; keys è®¾ç½®å…¨å±€å¿«æ·é”®è°ƒå‡º itermï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥ç”¨è¿‡ Alfred å®ç° å¸¸ç”¨çš„ä¸€äº›å¿«æ·é”®1234567891011121314âŒ˜ + 1 / 2 å·¦å³ tab ä¹‹é—´æ¥å›åˆ‡æ¢ï¼Œè¿™ä¸ªåœ¨ å‰é¢ å·²ç»ä»‹ç»è¿‡äº†âŒ˜â† / âŒ˜â†’ åˆ°ä¸€è¡Œå‘½ä»¤æœ€å·¦è¾¹/æœ€å³è¾¹ ï¼Œè¿™ä¸ªåŠŸèƒ½åŒ C+a / C+eâŒ¥â† / âŒ¥â†’ æŒ‰å•è¯å‰ç§»/åç§»ï¼Œç›¸å½“ä¸ C+f / C+bï¼Œå…¶å®è¿™ä¸ªåŠŸèƒ½åœ¨Itermä¸­å·²ç»é¢„å®šä¹‰å¥½äº†ï¼ŒâŒ¥f / âŒ¥bï¼Œçœ‹ä¸ªäººä¹ æƒ¯äº†å¥½åƒå°±è¿™å‡ ä¸ªè®¾ç½®æ–¹æ³•å¦‚ä¸‹å½“ç„¶é™¤äº†è¿™äº›å¯ä»¥è‡ªå®šä¹‰çš„ä¹Ÿä¸èƒ½å¿˜äº† linux ä¸‹é‚£äº›å¥½ç”¨çš„ç»„åˆC+a / C+e è¿™ä¸ªå‡ ä¹åœ¨å“ªéƒ½å¯ä»¥ä½¿ç”¨C+p / !! ä¸Šä¸€æ¡å‘½ä»¤C+k ä»å…‰æ ‡å¤„åˆ è‡³å‘½ä»¤è¡Œå°¾ (æœ¬æ¥ C+u æ˜¯åˆ è‡³å‘½ä»¤è¡Œé¦–ï¼Œä½†itermä¸­æ˜¯åˆ æ‰æ•´è¡Œ)C+w A+d ä»å…‰æ ‡å¤„åˆ è‡³å­—é¦–/å°¾C+h C+d åˆ æ‰å…‰æ ‡å‰åçš„è‡ªè´ŸC+y ç²˜è´´è‡³å…‰æ ‡åC+r æœç´¢å‘½ä»¤å†å²ï¼Œè¿™ä¸ªè¾ƒå¸¸ç”¨ é€‰ä¸­å³å¤åˆ¶iterm2 æœ‰ 2 ç§å¥½ç”¨çš„é€‰ä¸­å³å¤åˆ¶æ¨¡å¼ã€‚ ä¸€ç§æ˜¯ç”¨é¼ æ ‡ï¼Œåœ¨ iterm2 ä¸­ï¼Œé€‰ä¸­æŸä¸ªè·¯å¾„æˆ–è€…æŸä¸ªè¯æ±‡ï¼Œé‚£ä¹ˆï¼Œiterm2 å°±è‡ªåŠ¨å¤åˆ¶äº†ã€‚ å¦ä¸€ç§æ˜¯æ— é¼ æ ‡æ¨¡å¼ï¼Œcommand+f,å¼¹å‡º iterm2 çš„æŸ¥æ‰¾æ¨¡å¼ï¼Œè¾“å…¥è¦æŸ¥æ‰¾å¹¶å¤åˆ¶çš„å†…å®¹çš„å‰å‡ ä¸ªå­—æ¯ï¼Œç¡®è®¤æ‰¾åˆ°çš„æ˜¯è‡ªå·±çš„å†…å®¹ä¹‹åï¼Œè¾“å…¥ tabï¼ŒæŸ¥æ‰¾çª—å£å°†è‡ªåŠ¨å˜åŒ–å†…å®¹ï¼Œå¹¶å°†å…¶å¤åˆ¶ã€‚å¦‚æœè¾“å…¥çš„æ˜¯ shift+tabï¼Œåˆ™è‡ªåŠ¨å°†æŸ¥æ‰¾å†…å®¹çš„å·¦è¾¹é€‰ä¸­å¹¶å¤åˆ¶ã€‚ è‡ªåŠ¨å®Œæˆè¾“å…¥æ‰“å¤´å‡ ä¸ªå­—æ¯ï¼Œç„¶åè¾“å…¥ command+; iterm2 å°†è‡ªåŠ¨åˆ—å‡ºä¹‹å‰è¾“å…¥è¿‡çš„ç±»ä¼¼å‘½ä»¤ã€‚ å‰ªåˆ‡å†å²è¾“å…¥ command+shift+hï¼Œiterm2 å°†è‡ªåŠ¨åˆ—å‡ºå‰ªåˆ‡æ¿çš„å†å²è®°å½•ã€‚å¦‚æœéœ€è¦å°†å‰ªåˆ‡æ¿çš„å†å²è®°å½•ä¿å­˜åˆ°ç£ç›˜ï¼Œåœ¨ Preferences &gt; General &gt; Save copy/paste history to disk ä¸­è®¾ç½®ã€‚","categories":[{"name":"å·¥å…·ä½¿ç”¨","slug":"å·¥å…·ä½¿ç”¨","permalink":"https://shang.at/categories/å·¥å…·ä½¿ç”¨/"}],"tags":[{"name":"iterm2","slug":"iterm2","permalink":"https://shang.at/tags/iterm2/"}]},{"title":"Hadoopå­¦ä¹ -æºç ç¼–è¯‘","slug":"Hadoopå­¦ä¹ -æºç ç¼–è¯‘","date":"2020-06-23T10:18:16.000Z","updated":"2020-06-23T10:19:33.849Z","comments":true,"path":"post/Hadoopå­¦ä¹ -æºç ç¼–è¯‘/","link":"","permalink":"https://shang.at/post/Hadoopå­¦ä¹ -æºç ç¼–è¯‘/","excerpt":"","text":"","categories":[{"name":"Hadoopå­¦ä¹ ","slug":"Hadoopå­¦ä¹ ","permalink":"https://shang.at/categories/Hadoopå­¦ä¹ /"}],"tags":[{"name":"Hadoopæºç ç¼–è¯‘","slug":"Hadoopæºç ç¼–è¯‘","permalink":"https://shang.at/tags/Hadoopæºç ç¼–è¯‘/"}]},{"title":"Hadoopå­¦ä¹ -é›†ç¾¤æ­å»º","slug":"Hadoopå­¦ä¹ -é›†ç¾¤æ­å»º","date":"2020-06-23T10:17:38.000Z","updated":"2020-06-26T03:45:57.288Z","comments":true,"path":"post/Hadoopå­¦ä¹ -é›†ç¾¤æ­å»º/","link":"","permalink":"https://shang.at/post/Hadoopå­¦ä¹ -é›†ç¾¤æ­å»º/","excerpt":"","text":"é…ç½®12345678# hadoop.sh -&gt; /etc/profile.d/export HADOOP_PREFIX=/root/hadoopexport HADOOP_YARN_HOME=$&#123;HADOOP_PREFIX&#125;export HADOOP_CONF_DIR=$&#123;HADOOP_PREFIX&#125;/etc/hadoopexport YARN_LOG_DIR=$&#123;HADOOP_YARN_HOME&#125;/logsexport YARN_IDENT_STRING=rootexport HADOOP_MAPRED_IDENT_STRING=rootexport PATH=$&#123;HADOOP_PREFIX&#125;/bin:$&#123;HADOOP_PREFIX&#125;/sbin:$&#123;PATH&#125; 12345678910111213&lt;!-- core-site.xml -&gt; path_to_hadoop/etc/hadoop/ --&gt;&lt;!-- https://hadoop.apache.org/docs/r2.7.3/hadoop-project-dist/hadoop-common/core-default.xml --&gt;&lt;configuration&gt; &lt;property&gt; &lt;name&gt;fs.defaultFS&lt;/name&gt; &lt;value&gt;hdfs://node4:9000&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;hadoop.tmp.dir&lt;/name&gt; &lt;value&gt;file:///root/data/hadoop/tmp&lt;/value&gt; &lt;description&gt;A base for other temporary directories.&lt;/description&gt; &lt;/property&gt;&lt;/configuration&gt; 12345678910111213141516171819202122232425262728293031323334353637383940&lt;!-- hdfs-site.xml -&gt; path_to_hadoop/etc/hadoop/ --&gt;&lt;!-- https://hadoop.apache.org/docs/r2.7.3/hadoop-project-dist/hadoop-hdfs/hdfs-default.xml --&gt;&lt;configuration&gt; &lt;property&gt; &lt;name&gt;dfs.namenode.name.dir&lt;/name&gt; &lt;value&gt;file:///root/data/hadoop/namenode&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;dfs.datanode.data.dir&lt;/name&gt; &lt;value&gt;file:///root/data/hadoop/datanode&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;dfs.replication&lt;/name&gt; &lt;value&gt;1&lt;/value&gt; &lt;/property&gt; &lt;!-- config secondary namenode --&gt; &lt;property&gt; &lt;name&gt;dfs.namenode.secondary.http-address&lt;/name&gt; &lt;value&gt;node3:50090&lt;/value&gt; &lt;/property&gt; &lt;!-- enable webhdfs --&gt; &lt;property&gt; &lt;name&gt;dfs.webhdfs.enabled&lt;/name&gt; &lt;value&gt;true&lt;/value&gt; &lt;/property&gt; &lt;!-- disable permissions; only for development, of course --&gt; &lt;property&gt; &lt;name&gt;dfs.permissions.enabled&lt;/name&gt; &lt;value&gt;false&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;dfs.namenode.handler.count&lt;/name&gt; &lt;value&gt;5&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;dfs.datanode.handler.count&lt;/name&gt; &lt;value&gt;5&lt;/value&gt; &lt;/property&gt;&lt;/configuration&gt; 12345678910111213141516171819202122&lt;!-- yarn-site.xml -&gt; path_to_hadoop/etc/hadoop/ --&gt;&lt;!-- https://hadoop.apache.org/docs/r2.7.3/hadoop-yarn/hadoop-yarn-common/yarn-default.xml --&gt;&lt;configuration&gt; &lt;property&gt; &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt; &lt;value&gt;mapreduce_shuffle&lt;/value&gt; &lt;/property&gt; &lt;!-- enable log aggregation, this is false by default --&gt; &lt;property&gt; &lt;name&gt;yarn.log-aggregation-enable&lt;/name&gt; &lt;value&gt;true&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;yarn.resourcemanager.hostname&lt;/name&gt; &lt;value&gt;node4&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;yarn.timeline-service.hostname&lt;/name&gt; &lt;value&gt;node4&lt;/value&gt; &lt;/property&gt;&lt;/configuration&gt; 123456789101112&lt;!-- mapred-site.xml -&gt; path_to_hadoop/etc/hadoop/ --&gt;&lt;!-- https://hadoop.apache.org/docs/r2.7.3/hadoop-mapreduce-client/hadoop-mapreduce-client-core/mapred-default.xml --&gt;&lt;configuration&gt; &lt;property&gt; &lt;name&gt;mapreduce.framework.name&lt;/name&gt; &lt;value&gt;yarn&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;mapreduce.jobhistory.webapp.address&lt;/name&gt; &lt;value&gt;node3:19888&lt;/value&gt; &lt;/property&gt;&lt;/configuration&gt; å¯åŠ¨æµç¨‹Step1. ç¬¬ä¸€æ¬¡å¯åŠ¨HDFSï¼Œéœ€è¦æ ¼å¼åŒ–ä¸€ä¸‹hdfs 1$HADOOP_PREFIX/bin/hdfs namenode -format &lt;cluster-name&gt; Step2. å¯åŠ¨ 1234start-dfs.shstart-yarn.shyarn-daemon.sh start proxyservermr-jobhistory-daemon.sh start historyserver åœæ­¢æµç¨‹1234stop-dfs.shstop-yarn.shyarn-daemon.sh stop proxyservermr-jobhistory-daemon.sh stop historyserver è®¿é—®Once the Hadoop cluster is up and running check the web-ui of the components as described below: Daemon Web Interface Notes NameNode http://nn_host:port/ Default HTTP port is 50070. SecondaryNameNode http://nn_host:port/ Default HTTP port is 50090. ResourceManager http://rm_host:port/ Default HTTP port is 8088. YarnWebProxy http://proxy_host:port/ no Default HTTP port. éœ€è¦è‡ªå®šä¹‰ MapReduce JobHistory Server http://jhs_host:port/ Default HTTP port is 19888.","categories":[{"name":"Hadoopå­¦ä¹ ","slug":"Hadoopå­¦ä¹ ","permalink":"https://shang.at/categories/Hadoopå­¦ä¹ /"}],"tags":[{"name":"Hadoopé›†ç¾¤æ­å»º","slug":"Hadoopé›†ç¾¤æ­å»º","permalink":"https://shang.at/tags/Hadoopé›†ç¾¤æ­å»º/"}]},{"title":"Hadoopå­¦ä¹ -é…ç½®è¯¦è§£","slug":"Hadoopå­¦ä¹ -é…ç½®è¯¦è§£","date":"2020-06-23T09:12:52.000Z","updated":"2020-06-26T02:48:44.351Z","comments":true,"path":"post/Hadoopå­¦ä¹ -é…ç½®è¯¦è§£/","link":"","permalink":"https://shang.at/post/Hadoopå­¦ä¹ -é…ç½®è¯¦è§£/","excerpt":"","text":"ç‰ˆæœ¬ï¼š2.7.3 core-default.xml parameter default value notes fs.defaultFS file:/// å®šä¹‰namenodeçš„URIï¼Œæ”¹æˆhdfs://host:port/ hadoop.tmp.dir /tmp/hadoop-${user.name} å®šä¹‰å…¶ä»–ä¸´æ—¶ç›®å½•çš„æ ¹ç›®å½• io.file.buffer.size 4096 è¯»å†™æ–‡ä»¶æ“ä½œæ—¶çš„ç¼“å­˜å­—èŠ‚æ•°ï¼Œå¿…é¡»æ˜¯ç¡¬ä»¶ä¸Šçš„å†…å­˜é¡µå¤§å°çš„æ•´æ•°å€ hdfs-default.xmlnamenode parameter default value note dfs.namenode.http(s)-address 0.0.0.0:50070(50470) é…ç½®dfsçš„web uiç•Œé¢ï¼Œä¸å»ºè®®ä¿®æ”¹ã€‚å¯ä»¥é€šè¿‡http://namenode_hostname:50070è®¿é—® dfs.namenode.name.dir file://${hadoop.tmp.dir}/dfs/name é…ç½®DFS namenodeçš„fsimageæ–‡ä»¶å­˜æ”¾åœ¨æœ¬æ¬¡æ–‡ä»¶ç³»ç»Ÿçš„è·¯å¾„ã€‚å¦‚æœé…ç½®äº†ä½¿ç”¨é€—å·åˆ†éš”çš„å¤šä¸ªè·¯å¾„ï¼Œé‚£ä¹ˆnamemodeä¼šåœ¨æ¯ä¸ªç›®å½•ä¸‹é¢éƒ½å†—ä½™çš„å­˜æ”¾ä¸€ä»½ã€‚ dfs.namenode.edits.dir dfs.namenode.name.dir é…ç½®DFS namenodeçš„editsæ–‡ä»¶å­˜æ”¾åœ¨æœ¬æ¬¡æ–‡ä»¶ç³»ç»Ÿçš„è·¯å¾„ã€‚å¦‚æœé…ç½®äº†ä½¿ç”¨é€—å·åˆ†éš”çš„å¤šä¸ªè·¯å¾„ï¼Œé‚£ä¹ˆnamemodeä¼šåœ¨æ¯ä¸ªç›®å½•ä¸‹é¢éƒ½å†—ä½™çš„å­˜æ”¾ä¸€ä»½ã€‚ dfs.namenode.fs-limits.min-block-size 1048576 1m æœ€å°å—å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ï¼Œç”±Namenodeåœ¨åˆ›å»ºæ—¶å¼ºåˆ¶æ‰§è¡Œã€‚è¿™æ ·å¯ä»¥é˜²æ­¢æ„å¤–åˆ›å»ºå…·æœ‰å¾ˆå°å—å¤§å°ï¼ˆå› æ­¤æœ‰å¾ˆå¤šå—ï¼‰çš„æ–‡ä»¶ï¼Œè¿™ä¼šé™ä½æ€§èƒ½ã€‚å‡å°‘æ•°æ®å—çš„æ•°é‡ï¼Œ dfs.namenode.handler.count 10 namenodeç«¯æœåŠ¡çš„çº¿ç¨‹æ•°ï¼Œæµ‹è¯•æ—¶å¯ä»¥é…ç½®çš„å°ä¸€äº›ï¼Œå‡å°‘å†…å­˜å ç”¨ datanode parameter default value notes dfs.datanode.data.dir file://${hadoop.tmp.dir}/dfs/data æ–‡ä»¶å—çš„åœ¨local filesystemä¸­çš„å­˜æ”¾è·¯å¾„ã€‚å¦‚æœæä¾›çš„æ˜¯é€—å·åˆ†éš”çš„ç›®å½•åˆ—è¡¨ï¼Œé‚£ä¹ˆæ•°æ®å°†ä¼šå­˜å‚¨åœ¨æ‰€æœ‰çš„ç›®å½•ä¸­ï¼Œ(é€šå¸¸ç›®å½•åˆ—è¡¨æ˜¯åœ¨ä¸åŒçš„è®¾å¤‡ä¸Š)ã€‚ç›®å½•åº”è¯¥è¢«ç›¸åº”çš„å­˜å‚¨ç±»å‹æ‰€æ ‡è®°(HDFSä¸Šæœ‰å››ç§å­˜å‚¨è®¾å¤‡ï¼šSSDã€DISKã€ARCHIVEã€RAM_DISK)ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œé»˜è®¤æ˜¯DISKã€‚å¦‚æœç›®å½•ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆä¼šè‡ªåŠ¨åˆ›å»º(éœ€è¦è·å–ç›®å½•æƒé™) dfs.datanode.handler.count 10 namenodeç«¯æœåŠ¡çš„çº¿ç¨‹æ•°ï¼Œæµ‹è¯•æ—¶å¯ä»¥é…ç½®çš„å°ä¸€äº›ï¼Œå‡å°‘å†…å­˜å ç”¨ secondary namenode parameter default value notes dfs.namenode.secondary.http(s)-address 0.0.0.0:50090(50091) é…ç½®secondary namenodeçš„http serverå’Œç«¯å£ dfs.namenode.checkpoint.dir file://${hadoop.tmp.dir}/dfs/namesecondary dfs.namenode.checkpoint.edits.dir ${dfs.namenode.checkpoint.dir} dfs.namenode.checkpoint.period 3600 dfs.namenode.checkpoint.txns 1000000 dfs.namenode.checkpoint.check.period 60 dfs.namenode.checkpoint.max-retries 3 dfs.namenode.num.checkpoints.retained 2 dfs parameter default value notes dfs.permissions.enabled true é…ç½®æ˜¯å¦å¯ç”¨æƒé™æ£€æŸ¥ï¼Œé»˜è®¤æ˜¯å¯ç”¨çš„ã€‚æµ‹è¯•æ—¶å¯ä»¥è®¾ç½®ä¸ºfalseã€‚å½“å¼€å¯çŠ¶æ€æ—¶ï¼Œdfsä¸ä¼šæ£€æµ‹æ–‡ä»¶çš„æƒé™æ£€æµ‹ã€‚HDFS PermissionHDFSé»˜è®¤å¯åŠ¨namenodeçš„userä¸ºsuperuserï¼Œè¿™ä¸ª dfs.blocksize 134217728 128m å•ä½å­—èŠ‚ï¼Œæ–°æ–‡ä»¶çš„block å¤§å° dfs.hosts / dfs.hosts.exclude List of permitted/excluded DataNodes.If necessary, use these files to control the list of allowable datanodes. dfs.replication 3 å—å‰¯æœ¬æ•° dfs.webhdfs.enabled true å¯åŠ¨namenodeå’Œdatanodeä¸Šçš„WebHHDFS(REST API) mapred-default.xmlMapReduce Applications Parameter Value Notes mapreduce.framework.name yarn Execution framework set to Hadoop YARN. mapreduce.map.memory.mb 1536 Larger resource limit for maps. mapreduce.map.java.opts -Xmx1024M Larger heap-size for child jvms of maps. mapreduce.reduce.memory.mb 3072 Larger resource limit for reduces. mapreduce.reduce.java.opts -Xmx2560M Larger heap-size for child jvms of reduces. mapreduce.task.io.sort.mb 100 Higher memory-limit while sorting data for efficiency. mapreduce.task.io.sort.factor 10 More streams merged at once while sorting files. mapreduce.reduce.shuffle.parallelcopies 5 Higher number of parallel copies run by reduces to fetch outputs from very large number of maps. MapReduce JobHistory Server Parameter Value Notes mapreduce.jobhistory.address 0.0.0.0:10020 MapReduce JobHistory Server IPC host:port mapreduce.jobhistory.webapp.address 0.0.0.0:19888 MapReduce JobHistory Server Web UI host:port yarn.app.mapreduce.am.staging-dir /tmp/hadoop-yarn/staging The staging dir used while submitting jobs. mapreduce.jobhistory.intermediate-done-dir ${yarn.app.mapreduce.am.staging-dir}/history/done_intermediate Directory where history files are written by MapReduce jobs. mapreduce.jobhistory.done-dir ${yarn.app.mapreduce.am.staging-dir}/history/done Directory where history files are managed by the MR JobHistory Server. yarn-default.xmlResourceManager and NodeManager Parameter default Value Notes yarn.acl.enable false æ˜¯å¦å¼€å¯ACLs yarn.admin.acl * ACL to set admins on the cluster. ACLs are of for comma-separated-usersspacecomma-separated-groups. Defaults to special value of * which means anyone. Special value of just space means no one has access. yarn.log-aggregation-enable false æ˜¯å¦å¯åŠ¨æ—¥å¿—èšåˆã€‚æ—¥å¿—èšåˆä¼šæ”¶é›†æ¯ä¸ªcontainerçš„æ—¥å¿—å¹¶ä¸”åœ¨åº”ç”¨å®Œæˆåå°†ä»–ä»¬ç§»åŠ¨åˆ°HDFSä¸­ã€‚å…·ä½“ç›®å½•ç”±ä¸‹é¢ä¸¤ä¸ªé€‰é¡¹é…ç½®yarn.nodemanager.remote-app-log-dirå’Œyarn.nodemanager.remote-app-log-dir-suffixã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡Application Timeline Serverè®¿é—®è¿™äº›æ—¥å¿—æ–‡ä»¶ ResourceManager Parameter default Value Notes yarn.resourcemanager.address ${yarn.resourcemanager.hostname}:8032 é…ç½®RMçš„URIfor clients to submit jobs. yarn.resourcemanager.scheduler.address ${yarn.resourcemanager.hostname}:8030 èµ„æºè°ƒåº¦å™¨URIfor ApplicationMasters to talk to Scheduler to obtain resources. yarn.resourcemanager.resource-tracker.address ${yarn.resourcemanager.hostname}:8031 for NodeManagers. yarn.resourcemanager.admin.address ${yarn.resourcemanager.hostname}:8033 for administrative commands. yarn.resourcemanager.webapp.address ${yarn.resourcemanager.hostname}:8088 RM web application yarn.resourcemanager.hostname 0.0.0.0 ResourceManager host.åº”è¯¥æ”¹æˆç‰¹å®šçš„hostname yarn.web-proxy.address é»˜è®¤æ²¡æœ‰é…ç½®ï¼Œä¼šä½œä¸ºRMçš„ä¸€éƒ¨åˆ†è¿è¡Œ The address for the web proxy as HOST:PORT, if this is not given then the proxy will run as part of the RM yarn.resourcemanager.scheduler.class org.apache.hadoop.yarn.server.resourcemanager.&lt;br /&gt;scheduler.capacity.CapacityScheduler æŒ‡å®šRMä½¿ç”¨çš„è°ƒåº¦å™¨ï¼šCapacityScheduler (recommended), FairScheduler (also recommended), or FifoScheduler yarn.scheduler.minimum-allocation-mb 1024 In MBsï¼ŒMinimum limit of memory to allocate to each container request at the ResourceManager. yarn.scheduler.maximum-allocation-mb 8192 In MBsï¼ŒMaximum limit of memory to allocate to each container request at the Resource Manager. yarn.resourcemanager.nodes.include-path / yarn.resourcemanager.nodes.exclude-path List of permitted/excluded NodeManagers.If necessary, use these files to control the list of allowable NodeManagers. NodeManager Parameter default Value Notes yarn.nodemanager.resource.memory-mb 8192 Resource i.e. available physical memory, in MB, for given NodeManager.Defines total available resources on the NodeManager to be made available to running containers yarn.nodemanager.vmem-pmem-ratio 2.1Maximum ratio by which virtual memory usage of tasks may exceed physical memory The virtual memory usage of each task may exceed its physical memory limit by this ratio. The total amount of virtual memory used by tasks on the NodeManager may exceed its physical memory usage by this ratio. yarn.nodemanager.local-dirs ${hadoop.tmp.dir}/nm-local-dirComma-separated list of paths on the local filesystem where intermediate data is written. Multiple paths help spread disk i/o. yarn.nodemanager.log-dirs ${yarn.log.dir}/userlogsComma-separated list of paths on the local filesystem where logs are written. Multiple paths help spread disk i/o. yarn.nodemanager.log.retain-seconds 10800 Default time (in seconds) to retain log files on the NodeManager. Only applicable if log-aggregation is disabled. yarn.nodemanager.remote-app-log-dir /tmp/logs HDFS directory where the application logs are moved on application completion. Need to set appropriate permissions. Only applicable if log-aggregation is enabled. yarn.nodemanager.remote-app-log-dir-suffix logs Suffix appended to the remote log dir. Logs will be aggregated to ${yarn.nodemanager.remote-app-log-dir}/${user}/${thisParam} Only applicable if log-aggregation is enabled. yarn.nodemanager.aux-services mapreduce_shuffle Shuffle service that needs to be set for Map Reduce applications. History Server (Needs to be moved elsewhere) Parameter default Value Notes yarn.log-aggregation.retain-seconds -1 How long to keep aggregation logs before deleting them. -1 disables. Be careful, set this too small and you will spam the name node. yarn.log-aggregation.retain-check-interval-seconds -1 Time between checks for aggregated log retention. If set to 0 or a negative value then the value is computed as one-tenth of the aggregated log retention time. Be careful, set this too small and you will spam the name node.","categories":[{"name":"Hadoopå­¦ä¹ ","slug":"Hadoopå­¦ä¹ ","permalink":"https://shang.at/categories/Hadoopå­¦ä¹ /"}],"tags":[{"name":"Hadoopé…ç½®è¯¦è§£","slug":"Hadoopé…ç½®è¯¦è§£","permalink":"https://shang.at/tags/Hadoopé…ç½®è¯¦è§£/"}]},{"title":"Shellç¼–ç¨‹-å¸¸ç”¨å‘½ä»¤","slug":"Shellç¼–ç¨‹-å¸¸ç”¨å‘½ä»¤","date":"2020-06-23T08:53:17.000Z","updated":"2021-02-10T02:38:20.804Z","comments":true,"path":"post/Shellç¼–ç¨‹-å¸¸ç”¨å‘½ä»¤/","link":"","permalink":"https://shang.at/post/Shellç¼–ç¨‹-å¸¸ç”¨å‘½ä»¤/","excerpt":"","text":"æ–‡æœ¬ç¼–è¾‘sedawkç£ç›˜ç³»ç»ŸdfæŸ¥çœ‹ç£ç›˜ä½¿ç”¨é‡ï¼šdf -hT duæŸ¥çœ‹å„æ–‡ä»¶å¤¹å¤§å°ï¼šdu -h --max-depth=1 /path Linuxä¸Šçš„å®šæ—¶å™¨cronå‘½ä»¤xargsexecfind grep ä»æ–‡ä»¶å†…å®¹æŸ¥æ‰¾åŒ¹é…æŒ‡å®šå­—ç¬¦ä¸²çš„è¡Œï¼š$ grep â€œè¢«æŸ¥æ‰¾çš„å­—ç¬¦ä¸²â€ æ–‡ä»¶åä¾‹å­ï¼šåœ¨å½“å‰ç›®å½•é‡Œç¬¬ä¸€çº§æ–‡ä»¶å¤¹ä¸­å¯»æ‰¾åŒ…å«æŒ‡å®šå­—ç¬¦ä¸²çš„.inæ–‡ä»¶grep â€œthermcontactâ€ /.in ä»æ–‡ä»¶å†…å®¹æŸ¥æ‰¾ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„è¡Œï¼š$ grep â€“e â€œæ­£åˆ™è¡¨è¾¾å¼â€ æ–‡ä»¶å æŸ¥æ‰¾æ—¶ä¸åŒºåˆ†å¤§å°å†™ï¼š$ grep â€“i â€œè¢«æŸ¥æ‰¾çš„å­—ç¬¦ä¸²â€ æ–‡ä»¶å æŸ¥æ‰¾åŒ¹é…çš„è¡Œæ•°ï¼š$ grep -c â€œè¢«æŸ¥æ‰¾çš„å­—ç¬¦ä¸²â€ æ–‡ä»¶å ä»æ–‡ä»¶å†…å®¹æŸ¥æ‰¾ä¸åŒ¹é…æŒ‡å®šå­—ç¬¦ä¸²çš„è¡Œï¼š$ grep â€“v â€œè¢«æŸ¥æ‰¾çš„å­—ç¬¦ä¸²â€ æ–‡ä»¶å ä»æ ¹ç›®å½•å¼€å§‹æŸ¥æ‰¾æ‰€æœ‰æ‰©å±•åä¸º.logçš„æ–‡æœ¬æ–‡ä»¶ï¼Œå¹¶æ‰¾å‡ºåŒ…å«â€ERRORâ€çš„è¡Œfind / -type f -name â€œ.logâ€ | xargs grep â€œERRORâ€ä¾‹å­ï¼šä»å½“å‰ç›®å½•å¼€å§‹æŸ¥æ‰¾æ‰€æœ‰æ‰©å±•åä¸º.inçš„æ–‡æœ¬æ–‡ä»¶ï¼Œå¹¶æ‰¾å‡ºåŒ…å«â€thermcontactâ€çš„è¡Œfind . -name â€œ.inâ€ | xargs grep â€œthermcontactâ€ ç³»ç»Ÿç®¡ç†tophttps://blog.csdn.net/hsd2012/article/details/51387332 strace strace å‘½ä»¤æ˜¯ä¸€ç§å¼ºå¤§çš„å·¥å…·, èƒ½å¤Ÿæ˜¾ç¤ºä»»ä½•ç”±ç”¨æˆ·ç©ºé—´ç¨‹å¼å‘å‡ºçš„ç³»ç»Ÿè°ƒç”¨. strace æ˜¾ç¤ºè¿™äº›è°ƒç”¨çš„å‚æ•°å¹¶è¿”å›ç¬¦å·å½¢å¼çš„å€¼. strace ä»å†…æ ¸æ¥æ”¶ä¿¡æ¯, è€Œä¸”æ— éœ€ä»¥ä»»ä½•ç‰¹åˆ«çš„æ–¹å¼æ¥æ„å»ºå†…æ ¸. strace çš„æ¯ä¸€è¡Œè¾“å‡ºåŒ…æ‹¬ç³»ç»Ÿè°ƒç”¨åç§°, ç„¶åæ˜¯å‚æ•°å’Œè¿”å›å€¼. è¿œç¨‹æ§åˆ¶sshscp12345# å¤åˆ¶æŸæ–‡ä»¶(å¤¹) åˆ°è¿œç¨‹åœ°å€scp [-r] xxxxx user@host:path# å¦‚æœè¦æ±‚æ˜¯åŒä¸€ä¸ªç›®å½•å¯ä»¥ç›´æ¥ç”¨å¦‚ä¸‹å†™æ³•scp [-r] xxxxx user@host:`pwd` rsyncè½¯ä»¶ç®¡ç†rpmRPM å…¨åæ˜¯ã€ RedHat Package Manager å®‰è£…12345678910111213141516171819rpm -i *.rpm # å®‰è£…rpmåŒ…rpm -ivh *.rmpé€‰é¡¹ä¸å‚æ•°ï¼š-i ï¼šinstall çš„æ„æ€-v ï¼šå¯Ÿçœ‹æ›´ç»†éƒ¨çš„å®‰è£…èµ„è®¯ç”»é¢-h ï¼šä»¥å®‰è£…èµ„è®¯åˆ—æ˜¾ç¤ºå®‰è£…è¿›åº¦èŒƒä¾‹ä¸€ï¼šå®‰è£… rp-pppoe-3.5-32.1.i386.rpmrpm -ivh rp-pppoe-3.5-32.1.i386.rpmPreparing... ####################################### [100%] 1:rp-pppoe ####################################### [100%] èŒƒä¾‹äºŒã€ä¸€å£æ°”å®‰è£…ä¸¤ä¸ªä»¥ä¸Šçš„è½¯ä»¶æ—¶ï¼šrpm -ivh a.i386.rpm b.i386.rpm *.rpm# åé¢ç›´æ¥æ¥ä¸Šè®¸å¤šçš„è½¯ä»¶æ–‡ä»¶ï¼èŒƒä¾‹ä¸‰ã€ç›´æ¥ç”±ç½‘ç»œä¸Šé¢çš„æŸä¸ªæ–‡ä»¶å®‰è£…ï¼Œä»¥ç½‘å€æ¥å®‰è£…ï¼šrpm -ivh http://website.name/path/pkgname.rpm rpm å®‰è£…æ—¶å¸¸ç”¨çš„é€‰é¡¹ä¸å‚æ•°è¯´æ˜ å¯ä¸‹è¾¾çš„é€‰é¡¹ ä»£è¡¨æ„ä¹‰ â€”nodeps ä½¿ç”¨æ—¶æœºï¼šå½“å‘ç”Ÿè½¯ä»¶å±æ€§ç›¸ä¾é—®é¢˜è€Œæ— æ³•å®‰è£…ï¼Œä½†ä½ æ‰§æ„å®‰è£…æ—¶ å±é™©æ€§ï¼š è½¯ä»¶ä¼šæœ‰ç›¸ä¾æ€§çš„åŸå› æ˜¯å› ä¸ºå½¼æ­¤ä¼šä½¿ç”¨åˆ°å¯¹æ–¹çš„æœºåˆ¶æˆ–åŠŸèƒ½ï¼Œå¦‚æœå¼ºåˆ¶å®‰è£…è€Œä¸è€ƒè™‘è½¯ä»¶çš„å±æ€§ç›¸ä¾ï¼Œ åˆ™å¯èƒ½ä¼šé€ æˆè¯¥è½¯ä»¶çš„æ— æ³•æ­£å¸¸ä½¿ç”¨ï¼ â€”replacefiles ä½¿ç”¨æ—¶æœºï¼š å¦‚æœåœ¨å®‰è£…çš„è¿‡ç¨‹å½“ä¸­å‡ºç°äº†ã€æŸä¸ªæ–‡ä»¶å·²ç»è¢«å®‰è£…åœ¨ä½ çš„ç³»ç»Ÿä¸Šé¢ã€çš„èµ„è®¯ï¼Œåˆæˆ–è®¸å‡ºç°ç‰ˆæœ¬ä¸åˆçš„ä¿¡æ¯ (confilcting files) æ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªå‚æ•°æ¥ç›´æ¥è¦†ç›–æ–‡ä»¶ã€‚ å±é™©æ€§ï¼š è¦†ç›–çš„åŠ¨ä½œæ˜¯æ— æ³•å¤åŸçš„ï¼æ‰€ä»¥ï¼Œä½ å¿…é¡»è¦å¾ˆæ¸…æ¥šçš„çŸ¥é“è¢«è¦†ç›–çš„æ–‡ä»¶æ˜¯çœŸçš„å¯ä»¥è¢«è¦†ç›–å–”ï¼å¦åˆ™ä¼šæ¬²å“­æ— æ³ªï¼ â€”replacepkgs ä½¿ç”¨æ—¶æœºï¼š é‡æ–°å®‰è£…æŸä¸ªå·²ç»å®‰è£…è¿‡çš„è½¯ä»¶ï¼å¦‚æœä½ è¦å®‰è£…ä¸€å † RPM è½¯ä»¶æ–‡ä»¶æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ rpm -ivh *.rpm ï¼Œä½†è‹¥æŸäº›è½¯ä»¶å·²ç»å®‰è£…è¿‡äº†ï¼Œ æ­¤æ—¶ç³»ç»Ÿä¼šå‡ºç°ã€æŸè½¯ä»¶å·²å®‰è£…ã€çš„èµ„è®¯ï¼Œå¯¼è‡´æ— æ³•ç»§ç»­å®‰è£…ã€‚æ­¤æ—¶å¯ä½¿ç”¨è¿™ä¸ªé€‰é¡¹æ¥é‡å¤å®‰è£…å–”ï¼ â€”force ä½¿ç”¨æ—¶æœºï¼šè¿™ä¸ªå‚æ•°å…¶å®å°±æ˜¯ â€”replacefiles ä¸ â€”replacepkgs çš„ç»¼åˆä½“ï¼ â€”test ä½¿ç”¨æ—¶æœºï¼š æƒ³è¦æµ‹è¯•ä¸€ä¸‹è¯¥è½¯ä»¶æ˜¯å¦å¯ä»¥è¢«å®‰è£…åˆ°ä½¿ç”¨è€…çš„ Linux ç¯å¢ƒå½“ä¸­ï¼Œå¯æ‰¾å‡ºæ˜¯å¦æœ‰å±æ€§ç›¸ä¾çš„é—®é¢˜ã€‚èŒƒä¾‹ä¸ºï¼š rpm -ivh pkgname.i386.rpm â€”test â€”justdb ä½¿ç”¨æ—¶æœºï¼š ç”±æ–¼ RPM æ•°æ®åº“ç ´æŸæˆ–è€…æ˜¯æŸäº›ç¼˜æ•…äº§ç”Ÿé”™è¯¯æ—¶ï¼Œå¯ä½¿ç”¨è¿™ä¸ªé€‰é¡¹æ¥å‡çº§è½¯ä»¶åœ¨æ•°æ®åº“å†…çš„ç›¸å…³èµ„è®¯ã€‚ â€”nosignature ä½¿ç”¨æ—¶æœºï¼š æƒ³è¦ç•¥è¿‡æ•°ç ç­¾ç« çš„æ£€æŸ¥æ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªé€‰é¡¹ã€‚ â€”prefix æ–°è·¯å¾„ ä½¿ç”¨æ—¶æœºï¼š è¦å°†è½¯ä»¶å®‰è£…åˆ°å…¶ä»–éæ­£è§„ç›®å½•æ—¶ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œä½ æƒ³è¦å°†æŸè½¯ä»¶å®‰è£…åˆ° /usr/local è€Œéæ­£è§„çš„ /bin, /etc ç­‰ç›®å½•ï¼Œ å°±å¯ä»¥ä½¿ç”¨ã€ â€”prefix /usr/local ã€æ¥å¤„ç†äº†ã€‚ â€”noscripts ä½¿ç”¨æ—¶æœºï¼šä¸æƒ³è®©è¯¥è½¯ä»¶åœ¨å®‰è£…è¿‡ç¨‹ä¸­è‡ªè¡Œè¿è¡ŒæŸäº›ç³»ç»Ÿå‘½ä»¤ã€‚ è¯´æ˜ï¼š RPM çš„ä¼˜ç‚¹é™¤äº†å¯ä»¥å°†æ–‡ä»¶æ”¾ç½®åˆ°å®šä½ä¹‹å¤–ï¼Œè¿˜å¯ä»¥è‡ªåŠ¨è¿è¡Œä¸€äº›å‰ç½®ä½œä¸šçš„å‘½ä»¤ï¼Œä¾‹å¦‚æ•°æ®åº“çš„åˆå§‹åŒ–ã€‚ å¦‚æœä½ ä¸æƒ³è¦è®© RPM å¸®ä½ è‡ªåŠ¨è¿è¡Œè¿™ä¸€ç±»å‹çš„å‘½ä»¤ï¼Œå°±åŠ ä¸Šä»–å§ï¼ å‡çº§12rpm -Uvh *.rpm rpm -Fvh *.rpm é€‰é¡¹ å«ä¹‰ -Uvh åé¢æ¥çš„è½¯ä»¶å³ä½¿æ²¡æœ‰å®‰è£…è¿‡ï¼Œåˆ™ç³»ç»Ÿå°†äºˆä»¥ç›´æ¥å®‰è£…ï¼› è‹¥åé¢æ¥çš„è½¯ä»¶æœ‰å®‰è£…è¿‡æ—§ç‰ˆï¼Œåˆ™ç³»ç»Ÿè‡ªåŠ¨å‡çº§è‡³æ–°ç‰ˆï¼› -Fvh å¦‚æœåé¢æ¥çš„è½¯ä»¶å¹¶æœªå®‰è£…åˆ°ä½ çš„ Linux ç³»ç»Ÿä¸Šï¼Œåˆ™è¯¥è½¯ä»¶ä¸ä¼šè¢«å®‰è£…ï¼›äº¦å³åªæœ‰å·²å®‰è£…è‡³ä½  Linux ç³»ç»Ÿå†…çš„è½¯ä»¶ä¼šè¢«ã€å‡çº§ã€ï¼ æŸ¥è¯¢123456789101112131415161718rpm -qa &lt;==å·²å®‰è£…è½¯ä»¶rpm -q[licdR] å·²å®‰è£…çš„è½¯ä»¶åç§° &lt;==å·²å®‰è£…è½¯ä»¶rpm -qf å­˜åœ¨æ–¼ç³»ç»Ÿä¸Šé¢çš„æŸä¸ªæ¡£å &lt;==å·²å®‰è£…è½¯ä»¶rpm -qp[licdR] æœªå®‰è£…çš„æŸä¸ªæ–‡ä»¶åç§° &lt;==æŸ¥é˜…RPMæ–‡ä»¶é€‰é¡¹ä¸å‚æ•°ï¼šæŸ¥è¯¢å·²å®‰è£…è½¯ä»¶çš„èµ„è®¯ï¼š-q ï¼šä»…æŸ¥è¯¢ï¼Œåé¢æ¥çš„è½¯ä»¶åç§°æ˜¯å¦æœ‰å®‰è£…ï¼›-qa ï¼šåˆ—å‡ºæ‰€æœ‰çš„ï¼Œå·²ç»å®‰è£…åœ¨æœ¬æœº Linux ç³»ç»Ÿä¸Šé¢çš„æ‰€æœ‰è½¯ä»¶åç§°ï¼›-qi ï¼šåˆ—å‡ºè¯¥è½¯ä»¶çš„è¯¦ç»†èµ„è®¯ (information)ï¼ŒåŒ…å«å¼€å‘å•†ã€ç‰ˆæœ¬ä¸è¯´æ˜ç­‰ï¼›-ql ï¼šåˆ—å‡ºè¯¥è½¯ä»¶æ‰€æœ‰çš„æ–‡ä»¶ä¸ç›®å½•æ‰€åœ¨å®Œæ•´æ¡£å (list)ï¼›-qc ï¼šåˆ—å‡ºè¯¥è½¯ä»¶çš„æ‰€æœ‰é…ç½®æ¡£ (æ‰¾å‡ºåœ¨ /etc/ åº•ä¸‹çš„æ¡£åè€Œå·²)-qd ï¼šåˆ—å‡ºè¯¥è½¯ä»¶çš„æ‰€æœ‰è¯´æ˜æ¡£ (æ‰¾å‡ºä¸ man æœ‰å…³çš„æ–‡ä»¶è€Œå·²)-qR ï¼šåˆ—å‡ºä¸è¯¥è½¯ä»¶æœ‰å…³çš„ç›¸ä¾è½¯ä»¶æ‰€å«çš„æ–‡ä»¶ (Required çš„æ„æ€)-qf ï¼šç”±åé¢æ¥çš„æ–‡ä»¶åç§°ï¼Œæ‰¾å‡ºè¯¥æ–‡ä»¶å±æ–¼å“ªä¸€ä¸ªå·²å®‰è£…çš„è½¯ä»¶ï¼›æŸ¥è¯¢æŸä¸ª RPM æ–‡ä»¶å†…å«æœ‰çš„èµ„è®¯ï¼š-qp[icdlR]ï¼šæ³¨æ„ -qp åé¢æ¥çš„æ‰€æœ‰å‚æ•°ä»¥ä¸Šé¢çš„è¯´æ˜ä¸€è‡´ã€‚ä½†ç”¨é€”ä»…åœ¨æ–¼æ‰¾å‡º æŸä¸ª RPM æ–‡ä»¶å†…çš„èµ„è®¯ï¼Œè€Œéå·²å®‰è£…çš„è½¯ä»¶èµ„è®¯ï¼æ³¨æ„ï¼ ç»ƒä¹  12345678910111213141516ä¾‹é¢˜ï¼šæˆ‘æƒ³è¦çŸ¥é“æˆ‘çš„ç³»ç»Ÿå½“ä¸­ï¼Œä»¥ c å¼€å¤´çš„è½¯ä»¶æœ‰å‡ ä¸ªï¼Œå¦‚ä½•å®åšï¼Ÿæˆ‘çš„ WWW æœåŠ¡å™¨ä¸º Apache ï¼Œæˆ‘çŸ¥é“ä»–ä½¿ç”¨çš„ RPM è½¯ä»¶æ¡£åä¸º httpd ã€‚ç°åœ¨ï¼Œæˆ‘æƒ³è¦çŸ¥é“è¿™ä¸ªè½¯ä»¶çš„æ‰€æœ‰é…ç½®æ¡£æ”¾ç½®åœ¨ä½•å¤„ï¼Œå¯ä»¥æ€ä¹ˆä½œï¼Ÿæ‰¿ä¸Šé¢˜ï¼Œå¦‚æœæŸ¥å‡ºæ¥çš„é…ç½®æ–‡ä»¶å·²ç»è¢«æˆ‘æ”¹è¿‡ï¼Œä½†æ˜¯æˆ‘å¿˜è®°äº†æ›¾ç»ä¿®æ”¹è¿‡å“ªäº›åœ°æ–¹ï¼Œæ‰€ä»¥æƒ³è¦ç›´æ¥é‡æ–°å®‰è£…ä¸€æ¬¡è¯¥è½¯ä»¶ï¼Œè¯¥å¦‚ä½•ä½œï¼Ÿå¦‚æœæˆ‘è¯¯ç äº†æŸä¸ªé‡è¦æ–‡ä»¶ï¼Œä¾‹å¦‚ /etc/crontabï¼Œååä¸æ™“å¾—ä»–å±æ–¼å“ªä¸€ä¸ªè½¯ä»¶ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿç­”ï¼šrpm -qa | grep ^c | wc -lrpm -qc httpdå‡è®¾è¯¥è½¯ä»¶åœ¨ç½‘ç»œä¸Šçš„ç½‘å€ä¸ºï¼šhttp://web.site.name/path/httpd-x.x.xx.i386.rpmåˆ™æˆ‘å¯ä»¥è¿™æ ·åšï¼šrpm -ivh http://web.site.name/path/httpd-x.x.xx.i386.rpm --replacepkgsè™½ç„¶å·²ç»æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶äº†ï¼Œä¸è¿‡æ²¡æœ‰å…³ç³»ï¼Œå› ä¸º RPM æœ‰è®°å½•åœ¨ /var/lib/rpm å½“ä¸­çš„æ•°æ®åº“å•Šï¼æ‰€ä»¥ç›´æ¥ä¸‹è¾¾ï¼šrpm -qf /etc/crontabå°±å¯ä»¥çŸ¥é“æ˜¯é‚£ä¸ªè½¯ä»¶ç½—ï¼é‡æ–°å®‰è£…ä¸€æ¬¡è¯¥è½¯ä»¶å³å¯ï¼ å¸è½½1234rpm -e *** # å¯èƒ½ä¼šå› ä¸ºä¾èµ–çš„å…³ç³»ï¼Œå¯¼è‡´å¸è½½å¤±è´¥rpm -e *** --nodeps # å¼ºåˆ¶å¸è½½rpm --rebuilddb # å½“rpmæ•°æ®åº“/var/lib/rpmå†…çš„æ–‡ä»¶ç ´æŸï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªå‘½ä»¤é‡å»ºæ•°æ®åº“(å¾ˆæ…¢) yum","categories":[{"name":"Shellç¼–ç¨‹","slug":"Shellç¼–ç¨‹","permalink":"https://shang.at/categories/Shellç¼–ç¨‹/"}],"tags":[{"name":"å¸¸è§å‘½ä»¤","slug":"å¸¸è§å‘½ä»¤","permalink":"https://shang.at/tags/å¸¸è§å‘½ä»¤/"}]},{"title":"æ“ä½œç³»ç»Ÿ-centos7ä¿®æ”¹hostname","slug":"æ“ä½œç³»ç»Ÿ-centos7ä¿®æ”¹hostname","date":"2020-06-23T04:31:11.000Z","updated":"2020-07-26T03:29:49.522Z","comments":true,"path":"post/æ“ä½œç³»ç»Ÿ-centos7ä¿®æ”¹hostname/","link":"","permalink":"https://shang.at/post/æ“ä½œç³»ç»Ÿ-centos7ä¿®æ”¹hostname/","excerpt":"","text":"åœ¨CentOS7ä¸­ï¼Œæœ‰ä¸‰ç§å®šä¹‰çš„ä¸»æœºå:é™æ€çš„ï¼ˆstaticï¼‰ã€ç¬æ€çš„ï¼ˆtransientï¼‰ã€çµæ´»çš„ï¼ˆprettyï¼‰ã€‚â€œé™æ€â€ä¸»æœºåä¹Ÿç§°ä¸ºå†…æ ¸ä¸»æœºåï¼Œæ˜¯ç³»ç»Ÿåœ¨å¯åŠ¨æ—¶ä»/etc/hostnameè‡ªåŠ¨åˆå§‹åŒ–çš„ä¸»æœºåã€‚â€œç¬æ€â€ä¸»æœºåæ˜¯åœ¨ç³»ç»Ÿè¿è¡Œæ—¶ä¸´æ—¶åˆ†é…çš„ä¸»æœºåï¼Œä¾‹å¦‚ï¼Œé€šè¿‡DHCPæˆ–mDNSæœåŠ¡å™¨åˆ†é…ã€‚é™æ€ä¸»æœºåå’Œç¬æ€ä¸»æœºåéƒ½éµä»ä½œä¸ºäº’è”ç½‘åŸŸååŒæ ·çš„å­—ç¬¦é™åˆ¶è§„åˆ™ã€‚è€Œå¦ä¸€æ–¹é¢ï¼Œâ€œçµæ´»â€ä¸»æœºååˆ™å…è®¸ä½¿ç”¨è‡ªç”±å½¢å¼ï¼ˆåŒ…æ‹¬ç‰¹æ®Š/ç©ºç™½å­—ç¬¦ï¼‰çš„ä¸»æœºåï¼Œä»¥å±•ç¤ºç»™ç»ˆç«¯ç”¨æˆ·ã€‚ æ–¹æ³•ä¸€1234567891011121314151617181920212223242526[root@Geeklp201 ~]# hostnamectl #æŸ¥çœ‹ä¸€ä¸‹å½“å‰ä¸»æœºåçš„æƒ…å†µ Static hostname: Geeklp201 Icon name: computer-vm Chassis: vm Machine ID: 77efa27de81d470883b5bb0ed04f468c Boot ID: fa62bd1c0f5e4e53a0691fb97971594f Virtualization: vmware Operating System: CentOS Linux 7 (Core) CPE OS Name: cpe:/o:centos:centos:7 Kernel: Linux 3.10.0-693.el7.x86_64 Architecture: x86-64[root@Geeklp201 ~]# hostnamectl set-hostname geeklp --static[root@Geeklp201 ~]# hostnamectl status Static hostname: geeklp Pretty hostname: Geeklp201 Icon name: computer-vm Chassis: vm Machine ID: 77efa27de81d470883b5bb0ed04f468c Boot ID: fa62bd1c0f5e4e53a0691fb97971594f Virtualization: vmware Operating System: CentOS Linux 7 (Core) CPE OS Name: cpe:/o:centos:centos:7 Kernel: Linux 3.10.0-693.el7.x86_64 Architecture: x86-64é‡å¯VM æ–¹æ³•äºŒé€šè¿‡ä¿®æ”¹æ–‡ä»¶/etc/hostnameæ¥å®ç°ä¸»æœºåçš„ä¿®æ”¹ã€‚æŠŠè¯¥æ–‡ä»¶å†…å®¹æ›¿æ¢æˆè‡ªå·±æƒ³è¦çš„ä¸»æœºåé‡å¯å³å¯ã€‚","categories":[{"name":"æ“ä½œç³»ç»Ÿ","slug":"æ“ä½œç³»ç»Ÿ","permalink":"https://shang.at/categories/æ“ä½œç³»ç»Ÿ/"}],"tags":[{"name":"centos7ä¿®æ”¹hostname","slug":"centos7ä¿®æ”¹hostname","permalink":"https://shang.at/tags/centos7ä¿®æ”¹hostname/"}]},{"title":"å·¥å…·ä½¿ç”¨-vim","slug":"å·¥å…·ä½¿ç”¨-vim","date":"2020-06-23T04:22:22.000Z","updated":"2020-08-11T01:07:38.733Z","comments":true,"path":"post/å·¥å…·ä½¿ç”¨-vim/","link":"","permalink":"https://shang.at/post/å·¥å…·ä½¿ç”¨-vim/","excerpt":"","text":"vimå¿«æ·é”® å‘½ä»¤æ¨¡å¼ï¼šesc ç¼–è¾‘æ¨¡å¼ï¼š åœ¨å½“å‰å­—ç¬¦å‰å¼€å§‹ç¼–è¾‘ï¼šå‘½ä»¤æ¨¡å¼ä¸‹æŒ‰i åœ¨è¡Œé¦–å¤„å¼€å§‹ç¼–è¾‘ï¼šI åœ¨å½“å‰å­—ç¬¦åå¼€å§‹ç¼–è¾‘ï¼šå‘½ä»¤æ¨¡å¼ä¸‹æŒ‰a åœ¨è¡Œå°¾å¤„å¼€å§‹ç¼–è¾‘ï¼šA å¦èµ·ä¸€è¡Œï¼šå‘½ä»¤æ¨¡å¼ä¸‹æŒ‰o åœ¨å½“å‰è¡Œçš„ä¹‹ä¸Šå¦èµ·ä¸€è¡Œï¼šå‘½ä»¤æ¨¡å¼ä¸‹æŒ‰O åˆ é™¤å½“å‰å­—ç¬¦åçš„å½“å‰è¡Œçš„æ‰€æœ‰å†…å®¹ï¼šD æ¢å¤ä¿®æ”¹ï¼šu è·³åˆ°æœ€åä¸€è¡Œï¼šG å¤åˆ¶ å•è¡Œå¤åˆ¶ åœ¨å‘½ä»¤æ¨¡å¼ä¸‹ï¼Œå°†å…‰æ ‡ç§»åŠ¨åˆ°å°†è¦å¤åˆ¶çš„è¡Œå¤„ï¼ŒæŒ‰â€œyyâ€è¿›è¡Œå¤åˆ¶ï¼Œå°†å…‰æ ‡ç§»åŠ¨åˆ°å°†è¦ç²˜è´´çš„è¡Œå¤„ï¼ŒæŒ‰â€œpâ€è¿›è¡Œç²˜è´´ï¼› å¤šè¡Œå¤åˆ¶ åœ¨å‘½ä»¤æ¨¡å¼ä¸‹ï¼Œå°†å…‰æ ‡ç§»åŠ¨åˆ°å°†è¦å¤åˆ¶çš„é¦–è¡Œå¤„ï¼ŒæŒ‰â€œnyyâ€å¤åˆ¶nè¡Œï¼›å…¶ä¸­nä¸º1ã€2ã€3â€¦â€¦ 2ã€ç²˜è´´ åœ¨å‘½ä»¤æ¨¡å¼ä¸‹ï¼Œå°†å…‰æ ‡ç§»åŠ¨åˆ°å°†è¦ç²˜è´´çš„è¡Œå¤„ï¼ŒæŒ‰â€œpâ€è¿›è¡Œç²˜è´´ æŸ¥è¯¢ è¾“å…¥ï¼š /abc æŸ¥è¯¢ abc å¼€å¤´çš„å•è¯ ä¹‹åï¼Œæ‰€ä»¥ä»¥abcå¼€å¤´çš„å•è¯éƒ½ä¼šæ ‡è®°é«˜äº®ï¼Œè¾“å…¥ n ä¼šæŸ¥æ‰¾ä¸‹ä¸€ä¸ªç»“æœ ?pattern å‘ä¸Šæœç´¢#ç»§ç»­æœç´¢ä¸Šä¸€ä¸ª æ‰§è¡Œå‘½ä»¤åœ¨å‘½ä»¤æ¨¡å¼ä¸‹ï¼Œè¾“å…¥:å’Œ!åé¢è·Ÿç€è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œæ¯”å¦‚ï¼š:! ls .ï¼Œè¡¨ç¤ºåˆ—å‡ºå½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶ æŸ¥çœ‹ æš‚æ—¶æ˜¾ç¤º/å–æ¶ˆè¡Œå·ï¼š ä½¿ç”¨Vimæ‰“å¼€æ–‡ä»¶åï¼Œåœ¨Normalæ¨¡å¼ä¸‹è¾“å…¥ :set numberï¼ˆæˆ– :set nuï¼‰æ˜¾ç¤ºè¡Œå· :set nonumber ï¼ˆæˆ– :set nonuï¼‰å–æ¶ˆè¡Œå· æ°¸ä¹…æ˜¾ç¤ºè¡Œå· æŸ¥æ‰¾Vimè®¾å®šæ–‡ä»¶ sudo find / -name vimrc ä¿®æ”¹Vimè®¾å®šæ–‡ä»¶ /etc/vimrc ,æœ«å°¾æ·»åŠ  set number ï¼ˆæˆ– set nuï¼‰ ä¿å­˜å³å¯ã€‚","categories":[{"name":"å·¥å…·ä½¿ç”¨","slug":"å·¥å…·ä½¿ç”¨","permalink":"https://shang.at/categories/å·¥å…·ä½¿ç”¨/"}],"tags":[{"name":"vim","slug":"vim","permalink":"https://shang.at/tags/vim/"}]},{"title":"å¤§æ•°æ®-å¸¸è§ç«¯å£","slug":"å¤§æ•°æ®-å¸¸è§ç«¯å£","date":"2020-06-21T01:17:50.000Z","updated":"2020-06-23T07:50:07.013Z","comments":true,"path":"post/å¤§æ•°æ®-å¸¸è§ç«¯å£/","link":"","permalink":"https://shang.at/post/å¤§æ•°æ®-å¸¸è§ç«¯å£/","excerpt":"","text":"mysqlï¼š3306 redisï¼š zookeeperï¼š2181 kafkaï¼š9092 eagleï¼š8048 hdfsï¼š50070 yarnï¼š8088 sparkï¼š4041 flinkï¼š8081","categories":[{"name":"å¤§æ•°æ®ç”Ÿæ€","slug":"å¤§æ•°æ®ç”Ÿæ€","permalink":"https://shang.at/categories/å¤§æ•°æ®ç”Ÿæ€/"}],"tags":[{"name":"å¤§æ•°æ®ç«¯å£","slug":"å¤§æ•°æ®ç«¯å£","permalink":"https://shang.at/tags/å¤§æ•°æ®ç«¯å£/"}]},{"title":"å¤§æ•°æ®-ç¯å¢ƒé…ç½®","slug":"å¤§æ•°æ®-ç¯å¢ƒé…ç½®","date":"2020-06-20T10:01:00.000Z","updated":"2020-12-11T08:02:30.653Z","comments":true,"path":"post/å¤§æ•°æ®-ç¯å¢ƒé…ç½®/","link":"","permalink":"https://shang.at/post/å¤§æ•°æ®-ç¯å¢ƒé…ç½®/","excerpt":"","text":"åŸºç¡€linuxçš„æ–‡ä»¶å’Œç›®å½•çš„æƒé™è§„åˆ™ä½¿ç”¨ls -lå‘½ä»¤å¯ä»¥æŸ¥çœ‹å½“å‰ç›®å½•çš„æ–‡ä»¶åˆ—è¡¨ä»¥åŠæƒé™ä¿¡æ¯ï¼Œæ˜¾ç¤ºå¦‚ä¸‹ drwxr-xr-x linuxå®‰è£…rpmåŒ…å…å¯†ç™»å½•123456789# ç”Ÿæˆå¯†é’¥ å…¬é’¥sudo ssh-keygen -t rsa -f ~/.ssh/id_rsa# å°†å…¬é’¥æ‹·è´åˆ°ç›®æ ‡æœºå™¨ssh-copy-id user@tartget_hostame# è¿™æ ·ä¹‹åå°±å¯ä»¥åœ¨èŠ‚ç‚¹ä¹‹é—´ å…å¯†ç™»å½•äº†ssh user@tartget_hostamessh tartget_hostame # å¦‚æœå½“å‰ç™»å½•çš„ç”¨æˆ·å’Œtargetçš„ç”¨æˆ·åä¸€è‡´ï¼Œåˆ™ä¸éœ€è¦åŠ user@ æ³¨æ„ï¼Œå¦‚æœæ‰§è¡Œssh-copy-id è¾“å…¥å¯†ç åä»æŠ¥é”™(Permission denied (publickey,gssapi-keyex,gssapi-with-mic))ï¼Œå¯ä»¥å°è¯•æŒ‰ç…§å¦‚ä¸‹æ–¹æ¡ˆè§£å†³ï¼š è¿›å…¥targetæœºå™¨ï¼Œè¿›å…¥cd /etc/ssh/sshd_configï¼Œç„¶åä¿®æ”¹ä¸ºPasswordAuthentication yesï¼Œæœ€åé‡å¯sshdæœåŠ¡service sshd restartå³å¯ åŒæ­¥æ—¶é’Ÿntpdate cn.pool.ntp.org æˆ– ntpdate ntp[1-7].aliyun.com clock -w å¼€æºå¤§æ•°æ®å¹³å°Cloudera Ambari+HDP CM+CDH æ­å»ºCM+CDHå¤§æ•°æ®å¹³å° èŠ‚ç‚¹ é…ç½® mysql cloudera-scm-server cloudera-scm-agent node100 2G 2cores âœ… master 16G 8cores âœ… âœ… node111 8G 6cores âœ… node112 8G 6cores âœ… node113 8G 6cores âœ… 1ã€å‡†å¤‡ä¸€ä¸ªæ•°æ®åº“èŠ‚ç‚¹ ä½¿ç”¨vagrantåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿæœºï¼Œvagranté…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š 1234567891011121314151617# -*- mode: ruby -*-# vi: set ft=ruby :Vagrant.configure(\"2\") do |config| config.vm.box = \"centos/7\" config.vm.hostname = \"node100\" config.vm.provider :virtualbox do |v| v.name = \"node100\" v.memory = 2024 v.cpus = 2 end config.vm.network :private_network, ip: \"10.211.55.109\" config.vm.provision :shell, path: \"mysql.sh\"end å¯¹åº”çš„mysql.shå¦‚ä¸‹ï¼š 12345678910#!/bin/bashsudo yum -y updatesudo yum -y upgradesudo yum install -y net-tools rsync mlocate wget vim ntpdate telnet gcc zlib-dev openssl-devel sqlite-devel bzip2-devel binutils qt make patch libgomp glibc-headers glibc-devel kernel-headers kernel-devel dkms straceif [ -z $(rpm -qa | grep 'mysql-community-server') ]; then wget https://dev.mysql.com/get/mysql57-community-release-el7-9.noarch.rpm rpm -ivh mysql57-community-release-el7-9.noarch.rpm yum install -y mysql-community-serverfi 2ã€è®¾ç½®mysqlå¯†ç å’Œé…ç½®mysqlå¯ä»¥è¿œç¨‹è¿æ¥ å¯åŠ¨mysqlï¼šservice mysqld start or systemctl start mysqld.service è®¾ç½®å¼€æœºè‡ªå¯åŠ¨ï¼šsystemctl enable mysqld.service æ£€æŸ¥çŠ¶æ€ï¼šservice mysqld status or systemctl stop mysqld.service æŸ¥çœ‹åˆå§‹å¯†ç ï¼šgrep &#39;temporary password&#39; /var/log/mysqld.log é‡ç½®rootå¯†ç ï¼š 12345678# ç™»å½•mysqlmysql -uroot -p# ä¿®æ”¹å¯†ç ALTER USER 'root'@'localhost' IDENTIFIED BY 'MyNewPass4!';# åˆ·æ–°flush privileges; è®¾ç½®è¿œç¨‹è¿æ¥ï¼š ä¿®æ”¹/etc/my.cnfä¸­çš„bind-address=0.0.0.0 update user set host = &#39;%&#39; where user = &#39;root&#39;; åˆ›å»ºä¸€ä¸ªç”¨æˆ· 1234567891011# åˆ›å»ºæ–°ç”¨æˆ·create user 'cdh' identified by '!Cdh1234';# æˆæƒgrant all privileges on *.* to 'cdh'@'%' with grant option;# *.* å‰è¾¹çš„*å·æŒ‡çš„æ˜¯æ•°æ®åº“ï¼Œåé¢çš„*å·æŒ‡çš„æ˜¯è¡¨ï¼Œ*.*çš„æ„æ€å°±æ˜¯ä»»æ„æ•°æ®åº“ä¸‹çš„ä»»æ„è¡¨# 'root'@'%'ï¼Œ'root'ç”¨æˆ·åï¼Œ'%'ä»»æ„çš„ä¸»æœºåã€‚# è¿™æ¡é…ç½®ä¿¡æ¯å°±æ˜¯è¯´ï¼Œå…è®¸ä»»æ„èŠ‚ç‚¹ä»¥rootèº«ä»½ç™»å½•ï¼Œå¹¶ä¸”å¯ä»¥è®¿é—®mysqlé‡Œçš„ä»»æ„åº“ä¸‹çš„ä»»æ„è¡¨# åˆ·æ–°flush privileges; 3ã€å®‰è£…cm+cdh ä½¿ç”¨Vagrantåˆ›å»ºå››ä¸ªè™šæ‹Ÿæœºï¼š 12345678910111213141516171819202122232425262728293031323334353637# -*- mode: ruby -*-# vi: set ft=ruby :Vagrant.configure(\"2\") do |config| config.vm.box = \"centos/7\" # master èŠ‚ç‚¹ config.vm.define :master do |master| master.vm.hostname = \"master\" master.vm.provider :virtualbox do |v| v.name = \"master\" v.memory = 16384 # 16G v.cpus = 8 end master.vm.network :public_network, :bridge=&gt;'em1', ip: \"192.168.0.110\" master.vm.provision 'bootstrap_master', type: :shell, path: \"bootstrap_master.sh\" end # node èŠ‚ç‚¹ (1..3).each do |i| config.vm.define \"node11#&#123;i&#125;\" do |node| node.vm.hostname = \"node11#&#123;i&#125;\" node.vm.provider :virtualbox do |v| v.name = \"node11#&#123;i&#125;\" v.memory = 8096 # 8G v.cpus = 6 end node.vm.network :public_network, :bridge=&gt;'em1', ip: \"192.168.0.11#&#123;i&#125;\" end end config.vm.provision 'java', type: :shell, path: \"java.sh\" config.vm.provision 'sshd', type: :shell, path: \"sshd.sh\" config.vm.provision 'bootstrap', type: :shell, path: \"bootstrap.sh\"end boostrap.sh 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253#!/bin/bashsudo yum -y updatesudo yum -y upgradesudo yum install -y net-tools rsync mlocate wget vim ntpdate telnet gcc zlib-dev openssl-devel \\ sqlite-devel bzip2-devel binutils make patch libgomp glibc-headers glibc-devel kernel-headers kernel-devel dkms strace \\ bind-utils psmisc cyrus-sasl-plain cyrus-sasl-gssapi redhat-lsb httpd mod_ssl python-psycopg2 MySQL-python postgresql-libs# sshkeyif [ ! -f \"~/.ssh/id_rsa\" ]; then sudo ssh-keygen -t rsa -f ~/.ssh/id_rsafi# set hostsecho '127.0.0.1' &gt; /etc/hostsecho '192.168.0.109 node100' &gt;&gt; /etc/hostsecho '192.168.0.110 master' &gt;&gt; /etc/hostsecho '192.168.0.111 node111' &gt;&gt; /etc/hostsecho '192.168.0.112 node112' &gt;&gt; /etc/hostsecho '192.168.0.113 node113' &gt;&gt; /etc/hosts# set system timezonetimedatectl set-timezone Asia/Shanghai# æ—¶é’ŸåŒæ­¥ntpdate ntp1.aliyun.comclock -w# set mysql drivermkdir -p /usr/share/java/cp /vagrant/components/mysql-connector-java-5.1.49.jar /usr/share/java/mysql-connector-java.jar# cdhif [ ! -f \"/opt/cloudera/parcel-repo/CDH-6.2.0-1.cdh6.2.0.p0.967373-el7.parcel\" ]; then mkdir -p /opt/cloudera/parcel-repo cp /vagrant/components/CDH-6.2.0-1.cdh6.2.0.p0.967373-el7.parcel /opt/cloudera/parcel-repo/CDH-6.2.0-1.cdh6.2.0.p0.967373-el7.parcel cp /vagrant/components/manifest.json /opt/cloudera/parcel-repo/manifest.json cd /opt/cloudera/parcel-repo &amp;&amp; sha1sum CDH-6.2.0-1.cdh6.2.0.p0.967373-el7.parcel | awk '&#123; print $1 &#125;' &gt; CDH-6.2.0-1.cdh6.2.0.p0.967373-el7.parcel.shafi# cm:daemonsif [ -z $(rpm -qa | grep 'cloudera-manager-daemons') ]; then rpm -i /vagrant/components/cloudera-manager-daemons-6.2.0-968826.el7.x86_64.rpmfi# cm:agentif [ -z $(rpm -qa | grep 'cloudera-manager-agent') ]; then rpm -i /vagrant/components/cloudera-manager-agent-6.2.0-968826.el7.x86_64.rpmfi# ä¿®æ”¹cm agentçš„é…ç½®æ–‡ä»¶ï¼Œserver_host=masterï¼Œå¦åˆ™ä¼šæ‰¾ä¸åˆ° serversed -i 's/server_host=localhost/server_host=master/g' /etc/cloudera-scm-agent/config.ini Bootstrap_master.sh 1234567891011121314151617181920212223242526272829303132333435363738#!/bin/bash# å®‰è£…mysql client# if [ -z $(rpm -qa | grep 'mysql-community-client') ]; then# wget https://repo.mysql.com//mysql80-community-release-el7-3.noarch.rpm# rpm -ivh mysql80-community-release-el7-3.noarch.rpm# yum install -y mysql-community-client# fiif [ -z $(rpm -qa | grep 'mysql-community-client') ]; then wget https://dev.mysql.com/get/mysql57-community-release-el7-9.noarch.rpm rpm -ivh mysql57-community-release-el7-9.noarch.rpm yum install -y mysql-community-client mysql-connector-javafi# cm:daemonsif [ -z $(rpm -qa | grep 'cloudera-manager-daemons') ]; then rpm -i /vagrant/components/cloudera-manager-daemons-6.2.0-968826.el7.x86_64.rpmfi# cm:agentif [ -z $(rpm -qa | grep 'cloudera-manager-agent') ]; then rpm -i /vagrant/components/cloudera-manager-agent-6.2.0-968826.el7.x86_64.rpmfi# cm:serverif [ -z $(rpm -qa | grep 'cloudera-manager-server') ]; then rpm -i /vagrant/components/cloudera-manager-server-6.2.0-968826.el7.x86_64.rpmfi# cdhif [ ! -f \"/opt/cloudera/parcel-repo/CDH-6.2.0-1.cdh6.2.0.p0.967373-el7.parcel\" ]; then cp /vagrant/components/CDH-6.2.0-1.cdh6.2.0.p0.967373-el7.parcel /opt/cloudera/parcel-repo/CDH-6.2.0-1.cdh6.2.0.p0.967373-el7.parcel cp /vagrant/components/manifest.json /opt/cloudera/parcel-repo/manifest.json cd /opt/cloudera/parcel-repo &amp;&amp; sha1sum CDH-6.2.0-1.cdh6.2.0.p0.967373-el7.parcel | awk '&#123; print $1 &#125;' &gt; CDH-6.2.0-1.cdh6.2.0.p0.967373-el7.parcel.shafimysql -hnode100 -uroot -p!Aa147258 &lt; /vagrant/cdh.sql Sshd.sh 1234567# è®¾ç½®ssh è¿æ¥# open PasswordAuthenticationsed -i 's/#PasswordAuthentication yes/PasswordAuthentication yes/g' /etc/ssh/sshd_configsed -i 's/PasswordAuthentication no/#PasswordAuthentication yes/g' /etc/ssh/sshd_config# restart sshdservice sshd restart Java.sh 123456if [ -z $(rpm -qa | grep 'jdk1.8-1.8.0') ]; then rpm -qa | grep jdk | xargs rpm -e rpm -i /vagrant/components/jdk-8u191-linux-x64.rpm cp /vagrant/conf/java.sh /etc/profile.d/fi Cdh.sql åˆå§‹åŒ–ç›¸å…³æ•°æ®åº“ 1234567891011121314151617181920212223242526272829303132333435CREATE DATABASE IF NOT EXISTS scm DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;create user IF NOT EXISTS 'scm' identified by '!Cdh1234';GRANT ALL privileges ON scm.* TO 'scm'@'%' with grant option;CREATE DATABASE IF NOT EXISTS amon DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;create user IF NOT EXISTS 'amon' identified by '!Cdh1234';GRANT ALL privileges ON amon.* TO 'amon'@'%' with grant option;CREATE DATABASE IF NOT EXISTS rman DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;create user IF NOT EXISTS 'rman' identified by '!Cdh1234';GRANT ALL privileges ON rman.* TO 'rman'@'%' with grant option;CREATE DATABASE IF NOT EXISTS hue DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;create user IF NOT EXISTS 'hue' identified by '!Cdh1234';GRANT ALL privileges ON hue.* TO 'hue'@'%' with grant option;CREATE DATABASE IF NOT EXISTS metastore DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;create user IF NOT EXISTS 'hive' identified by '!Cdh1234';GRANT ALL privileges ON metastore.* TO 'hive'@'%' with grant option;CREATE DATABASE IF NOT EXISTS sentry DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;create user IF NOT EXISTS 'sentry' identified by '!Cdh1234';GRANT ALL privileges ON sentry.* TO 'sentry'@'%' with grant option;CREATE DATABASE IF NOT EXISTS nav DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;create user IF NOT EXISTS 'nav' identified by '!Cdh1234';GRANT ALL privileges ON nav.* TO 'nav'@'%' with grant option;CREATE DATABASE IF NOT EXISTS navms DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;create user IF NOT EXISTS 'navms' identified by '!Cdh1234';GRANT ALL privileges ON navms.* TO 'navms'@'%' with grant option;CREATE DATABASE IF NOT EXISTS oozie DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;create user IF NOT EXISTS 'oozie' identified by '!Cdh1234';GRANT ALL privileges ON oozie.* TO 'oozie'@'%' with grant option; ä¸‹è½½cmï¼Œå»ºè®®ä½¿ç”¨è¿…é›·ä¸‹è½½ â€”â€” æˆ‘æ˜¯å°†ä¸‹è½½çš„æ–‡ä»¶æ”¾åˆ°äº†componentsæ–‡ä»¶å¤¹ä¸‹ï¼Œvagrantå¯åŠ¨çš„æ—¶å€™ç›´æ¥å®‰è£… 1234wget https://archive.cloudera.com/cm6/6.2.0/redhat7/yum/RPMS/x86_64/cloudera-manager-daemons-6.2.0-968826.el7.x86_64.rpmwget https://archive.cloudera.com/cm6/6.2.0/redhat7/yum/RPMS/x86_64/cloudera-manager-agent-6.2.0-968826.el7.x86_64.rpmwget https://archive.cloudera.com/cm6/6.2.0/redhat7/yum/RPMS/x86_64/cloudera-manager-server-6.2.0-968826.el7.x86_64.rpmwget https://archive.cloudera.com/cm6/6.2.0/redhat7/yum/RPMS/x86_64/cloudera-manager-server-db-2-6.2.0-968826.el7.x86_64.rpm è®¾ç½® Cloudera Manager æ•°æ®åº“ï¼š/opt/cloudera/cm/schema/scm_prepare_database.sh --host node100 mysql scm scm éœ€è¦ä½¿ç”¨--hostæŒ‡å®šmysqlä¸»æœºä½ç½®ï¼Œå¦åˆ™é»˜è®¤æ˜¯localhostï¼Œåœ¨scm_prepare_database.shä¸­æœ‰é…ç½® ä¸‹è½½cdhï¼Œå»ºè®®ä½¿ç”¨è¿…é›·ä¸‹è½½ â€”â€” æˆ‘æ˜¯å°†ä¸‹è½½çš„æ–‡ä»¶æ”¾åˆ°äº†componentsæ–‡ä»¶å¤¹ä¸‹ï¼Œvagrantå¯åŠ¨çš„æ—¶å€™å°†ä»–ä»¬å¤åˆ¶åˆ°/opt/cloudera/parcel-repoï¼ŒCMä¼šè‡ªåŠ¨åˆ°è¯¥ç›®å½•ä¸‹æ‰¾åˆ°å¯¹åº”çš„æ–‡ä»¶ 12345cd /opt/cloudera/parcel-repowget https://archive.cloudera.com/cdh6/6.2.0/parcels/CDH-6.2.0-1.cdh6.2.0.p0.967373-el7.parcelwget https://archive.cloudera.com/cdh6/6.2.0/parcels/manifest.jsonsha1sum CDH-6.2.0-1.cdh6.2.0.p0.967373-el7.parcel | awk '&#123; print $1 &#125;' &gt; CDH-6.2.0-1.cdh6.2.0.p0.967373-el7.parcel.sha å¯åŠ¨Cloudera Manager Serverï¼šsystemctl start cloudera-scm-server æŸ¥çœ‹å¯åŠ¨æ—¥å¿—ï¼štail -f /var/log/cloudera-scm-server/cloudera-scm-server.log 4ã€CMè®¾ç½®è¿‡ç¨‹ï¼š ç™»å½•ï¼šç”¨æˆ·åå¯†ç éƒ½æ˜¯admin æ¬¢è¿é¡µ ä¸‹ä¸€æ­¥ï¼Œå‹¾é€‰åè®® é€‰æ‹©å¥—é¤ å®‰è£… è®¾ç½®é›†ç¾¤åç§° é€‰æ‹©é›†ç¾¤èŠ‚ç‚¹ è®¾ç½®ä»“åº“ jdkè®¾ç½®ï¼Œä¸è¦å‹¾é€‰ è®¤è¯è®¾ç½® å®‰è£…Agent åœ¨è¿™ä¸€æ­¥ï¼Œå¡äº†å¾ˆä¹…ï¼Œagentæ€»æ˜¯å®‰è£…å¤±è´¥ï¼šé‡åˆ°äº†ä¸¤ä¸ªé—®é¢˜ï¼š â€‹ a. agentæ‰¾ä¸åˆ°serverï¼Œagentçš„é…ç½®é”™è¯¯ï¼Œéœ€è¦ä¿®æ”¹agentçš„é…ç½®æ–‡ä»¶ï¼šsed -i &#39;s/server_host=localhost/server_host=master/g&#39; /etc/cloudera-scm-agent/config.ini â€‹ b. æ”¹å®Œä¹‹åï¼Œå‘ç°è¿˜æ˜¯æ‰¾ä¸åˆ°ï¼Œæ€»æ˜¯å»localhostæ‰¾ï¼Œç»è¿‡æŸ¥è¯¢ï¼Œå‘ç°éœ€è¦æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼šmv /usr/bin/host /usr/bin/host.backï¼Œä¼°è®¡æ˜¯CMåšäº†ç¼“å­˜ï¼Œéœ€è¦æ¸…æ‰é”™è¯¯çš„ç¼“å­˜ å®‰è£…Parcelsï¼Œ åˆå§‹åŒ–å®Œæˆ é›†ç¾¤é…ç½®ï¼šæˆ‘é€‰æ‹©äº†è‡ªå®šä¹‰ åˆ†é…è§’è‰² è®¾ç½®æ•°æ®åº“ Review Changes é‡åˆ°çš„é—®é¢˜ï¼š 1. Command failed to run because service HDFS has an invalid configuration. Review and correct its configuration. First error: HDFS service not configured for High Availability must have a SecondaryNameNodeï¼Œè§£å†³æ–¹æ¡ˆï¼šè¿›å…¥ä¸‹é¢çš„ç•Œé¢ï¼Œç‚¹å‡»add role instancesï¼ŒæŠŠsnnåŠ ä¸Š 2. Namenode formatå¤±è´¥ï¼šç‚¹å‡»è¿™é‡Œæ‰‹åŠ¨format CDH ç³»ç»Ÿä¼˜åŒ–ä¹‹å…³é—­é€æ˜å¤§é¡µé¢åŠè®¾ç½®swappiness","categories":[{"name":"å¤§æ•°æ®ç”Ÿæ€","slug":"å¤§æ•°æ®ç”Ÿæ€","permalink":"https://shang.at/categories/å¤§æ•°æ®ç”Ÿæ€/"}],"tags":[{"name":"å¤§æ•°æ®ç¯å¢ƒ","slug":"å¤§æ•°æ®ç¯å¢ƒ","permalink":"https://shang.at/tags/å¤§æ•°æ®ç¯å¢ƒ/"}]},{"title":"è™šæ‹Ÿæœº-Vagrantä½¿ç”¨","slug":"è™šæ‹Ÿæœº-Vagrantä½¿ç”¨","date":"2020-06-20T03:48:16.000Z","updated":"2020-08-10T02:35:41.459Z","comments":true,"path":"post/è™šæ‹Ÿæœº-Vagrantä½¿ç”¨/","link":"","permalink":"https://shang.at/post/è™šæ‹Ÿæœº-Vagrantä½¿ç”¨/","excerpt":"","text":"ä»€ä¹ˆæ˜¯Vagrantvagrantæ˜¯ä¸€ä¸ªåŸºäºVirtualBox, VMware, AWSç­‰å¹³å°çš„ä¸€ä¸ªæ„é€ å’Œç®¡ç†VMçš„å·¥å…·ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªç®€å•çš„å·¥ä½œæµç¨‹ï¼Œè®©VMçš„åˆ›å»ºå’Œç®¡ç†å…¨éƒ½è‡ªåŠ¨åŒ–ã€‚vagrantçš„é…ç½®æ˜¯åŸºäºrubyçš„ Vagrantæ˜¯åŸºäºBoxçš„ï¼ŒBoxæ˜¯é’ˆå¯¹Vagrantè¿è¡Œç¯å¢ƒçš„å°è£… å¦‚ä½•ä½¿ç”¨VagrantStep 1ï¼šå®‰è£… å®˜ç½‘ï¼šhttps://www.vagrantup.com è™šæ‹Ÿæœºä½ç½®ï¼š/root/.vagrant.d/ Step 2ï¼šåˆå§‹åŒ–ç¯å¢ƒ 123mkdir vm-workspacecd vm-workspacevagrant init 123# boxä¸‹è½½å¾ˆæ…¢çš„æ—¶å€™ï¼Œå¯ä»¥å…ˆä¸‹è½½boxï¼Œç„¶åé€šè¿‡å‘½ä»¤å®‰è£…boxwget https://vagrantcloud.com/centos/boxes/7/versions/2004.01/providers/virtualbox.boxvagrant box add --name centos/7 virtualbox.box Step 3ï¼šé…ç½®Vagrantfile ç»è¿‡vagrant initä¹‹åï¼Œä¼šåœ¨vm-workspaceä¸‹ç”Ÿæˆä¸€ä¸ªVagrantfileï¼Œå†…å®¹å¦‚ä¸‹(åˆ é™¤äº†æ³¨é‡Š) 12345# -*- mode: ruby -*-# vi: set ft=ruby :Vagrant.configure(\"2\") do |config| config.vm.box = \"centos/7\"end é…ç½®æ–‡ä»¶ç®€ä»‹ï¼š 2 æ˜¯æŒ‡å½“å‰é…ç½®çš„Vagrant configçš„ç‰ˆæœ¬ï¼Œç›®å‰Vagrantåªæ”¯æŒä¸¤ä¸ªç‰ˆæœ¬ 1å’Œ2ï¼Œè¿™é‡Œæˆ‘ä¸ç”¨æ”¹ï¼Œç”¨2å°±å¯ä»¥ config å°±æ˜¯é…ç½®å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹ä»–è¿›è¡Œé…ç½® do â€¦ end æ˜¯rubyçš„è¯­æ³•ï¼Œå°±æ˜¯ä¸€ä¸ªä»£ç å— ä¸‹é¢æ˜¯åˆ›å»ºäº† 123456789101112131415161718192021222324252627282930313233343536373839404142# -*- mode: ruby -*-# vi: set ft=ruby :# 2 æŒ‡å®šäº†é…ç½®çš„ç‰ˆæœ¬Vagrant.configure(\"2\") do |config| # æŒ‡å®š boxä¸º centos/7 config.vm.box = \"centos/7\" # ä½¿ç”¨defineå®šä¹‰vmçš„é…ç½®èŠ‚ç‚¹ï¼šä¸€ä¸ªé…ç½®èŠ‚ç‚¹å°±æ˜¯ä¸€ä¸ªè™šæ‹Ÿæœºã€‚ # è¿™é‡Œè¡¨ç¤ºï¼šåœ¨configä¸­é…ç½®ä¸€ä¸ªmasterçš„vmï¼Œè¯¥vmçš„é…ç½®å¯¹è±¡å‘½åä¸ºmasterï¼Œä¸‹é¢å¯ä»¥å¯¹è¯¥é…ç½®è¿›è¡Œé…ç½® config.vm.define :master do |master| # é…ç½®masterçš„hostnameä¸ºmaster master.vm.hostname = \"master\" # å®šä¹‰ è™šæœºå®¹å™¨æä¾›è€…é…ç½®ï¼Œè¿™é‡Œä½¿ç”¨virtualboxã€‚æ‰“å¼€virtualboxåï¼Œå¯ä»¥åœ¨é‡Œé¢çœ‹åˆ°å¯¹åº”çš„vmå®ä¾‹ master.vm.provider :virtualbox do |v| v.name = \"master\" # vmçš„åç§° v.memory = 1024 # vmçš„å†…å­˜ v.cpus = 1 # vmå¯ä»¥ä½¿ç”¨çš„CPUä¸ªæ•° end # é…ç½®master vmä½¿ç”¨host-onlyç½‘ç»œæ¨¡å¼ï¼Œipä¸º10.211.55.100 master.vm.network :private_network, ip: \"10.211.55.100\" # é…ç½®vagrant å¯åŠ¨vmçš„æ—¶å€™ï¼Œéœ€è¦æ‰§è¡Œçš„å‘½ä»¤æˆ–è„šæœ¬ # master.vm.provision :shell, path: \"bootstrap_master.sh\" end # å†æ¬¡å¾ªç¯ç»™vmåˆ›å»º3ä¸ªé…ç½®èŠ‚ç‚¹ï¼Œå³å†åˆ›å»º3ä¸ªè™šæ‹Ÿæœº (1..3).each do |i| config.vm.define \"node#&#123;i&#125;\" do |node| node.vm.hostname = \"node#&#123;i&#125;\" node.vm.provider :virtualbox do |v| v.name = \"node#&#123;i&#125;\" v.memory = 1024 v.cpus = 1 end node.vm.network :private_network, ip: \"10.211.55.10#&#123;i&#125;\" # node.vm.provision :shell, path: \"bootstrap_master.sh\" end end # config.vm.synced_folder \"\" \"\" # vagranté»˜è®¤ä¼šæŠŠå½“å‰å·¥ä½œç›®å½•æŒ‚è½½åœ¨vmçš„/vagrantç›®å½•ä¸‹ config.vm.provision :shell, path: \"bootstrap.sh\" config.vm.provision :shell, path: \"sshd.sh\"end 123456789101112131415161718# bootstrap.sh:è™šæ‹Ÿæœºåˆå§‹åŒ–çš„è¿‡ç¨‹ï¼Œå¹¶ä¸”é…ç½®javaã€sshkeyã€hostssudo yum -y updatesudo yum -y upgradesudo yum groupinstall -y developmentsudo yum install -y java-1.8.0-openjdk net-tools rsync mlocate wget vim \\ gcc zlib-dev openssl-devel sqlite-devel bzip2-devel python-devel# set Javaecho 'export JAVA_HOME=/usr/lib/jvm/jre' &gt;&gt; /etc/profile.d/java.shecho 'export PATH=/usr/lib/jvm/jre/bin:$PATH' &gt;&gt; /etc/profile.d/java.sh# sshkeysudo ssh-keygen -t rsa -f ~/.ssh/id_rsa# set hostsecho '10.211.55.100 node0' &gt;&gt; /etc/hostsecho '10.211.55.101 node1' &gt;&gt; /etc/hostsecho '10.211.55.102 node2' &gt;&gt; /etc/hostsecho '10.211.55.102 node3' &gt;&gt; /etc/hosts 12345678# sshd.sh: centos/7ä¸‹çš„ssh é»˜è®¤æ²¡æœ‰å¼€å¯PasswordAuthenticationï¼Œæ‰€ä»¥å•ç‹¬ä½¿ç”¨è¿™ä¸ªè„šæœ¬å¼€å¯ä¸€ä¸‹# å…å»åé¢é…ç½®å…å¯†ç™»å½•çš„æ—¶å€™ï¼Œå†å»ä¿®æ”¹# open PasswordAuthenticationsed -i 's/#PasswordAuthentication yes/PasswordAuthentication yes/g' /etc/ssh/sshd_configsed -i 's/PasswordAuthentication no/#PasswordAuthentication yes/g' /etc/ssh/sshd_config# restart sshdservice sshd restart è§£é‡Šï¼š Vagrantçš„ç½‘ç»œè¿æ¥æ–¹å¼æœ‰ä¸‰ç§ï¼š NAT : ç¼ºçœåˆ›å»ºï¼Œç”¨äºè®©vmå¯ä»¥é€šè¿‡hostè½¬å‘è®¿é—®å±€åŸŸç½‘ç”šè‡³äº’è”ç½‘ã€‚ host-only : åªæœ‰ä¸»æœºå¯ä»¥è®¿é—®vmï¼Œå…¶ä»–æœºå™¨æ— æ³•è®¿é—®å®ƒã€‚ bridge : æ­¤æ¨¡å¼ä¸‹vmå°±åƒå±€åŸŸç½‘ä¸­çš„ä¸€å°ç‹¬ç«‹çš„æœºå™¨ï¼Œå¯ä»¥è¢«å…¶ä»–æœºå™¨è®¿é—®ã€‚ â€‹ è®¾ç½®bridgeæ¨¡å¼çš„æ—¶å€™ï¼Œéœ€è¦æ‰‹åŠ¨æŒ‡å®š bridgeï¼Œå¦‚ï¼šmaster.vm.network :public_network, :bridge=&gt;&#39;em1&#39;, ip: &quot;192.168.0.110&quot;ï¼Œä¹Ÿå¯è®¾ç½®é™æ€IP æ ¹æ®vagrantfileçš„å±‚æ¬¡ï¼Œåˆ†ä¸ºï¼š configureçº§ï¼šå®ƒå®šä¹‰åœ¨ Vagrant.configure(â€œ2â€) çš„ä¸‹ä¸€å±‚æ¬¡ï¼Œå½¢å¦‚ï¼š config.vm.provision â€¦ vmçº§ï¼šå®ƒå®šä¹‰åœ¨ config.vm.define :master do |master| çš„ä¸‹ä¸€å±‚æ¬¡ï¼Œmaster.vm.provision â€¦ æ‰§è¡Œçš„é¡ºåºæ˜¯å…ˆæ‰§è¡Œconfigureçº§ä»»åŠ¡ï¼Œå†æ‰§è¡Œvmçº§ä»»åŠ¡ï¼Œå³ä¾¿configureçº§ä»»åŠ¡åœ¨vmå®šä¹‰çš„ä¸‹é¢æ‰å®šä¹‰ Step 4ï¼šå¯åŠ¨Vagrant 1vagrant up Step 5ï¼šè¿æ¥vm 1vagrant ssh node0 Step 6ï¼šåˆ‡æ¢åˆ°rootç”¨æˆ· 12supasswordé»˜è®¤æ˜¯vagrant è‡³æ­¤ï¼Œå°±å¯ä»¥ä½¿ç”¨vmäº†ã€‚ æœ‰ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å‘½ä»¤ï¼švagrant rsync-autoã€‚å› ä¸ºæˆ‘ä»¬å¯èƒ½ä¼šç»å¸¸æ€§çš„ä¿®æ”¹å…±äº«æ–‡ä»¶å¤¹ï¼Œè¿™ä¸ªå‘½ä»¤å¯ä»¥è§¦å‘å…±äº«æ–‡ä»¶å¤¹çš„åŒæ­¥ï¼Œè€Œä¸éœ€è¦æ‰§è¡Œvagrant reloadæ¥åŒæ­¥å…±äº«æ–‡ä»¶å¤¹ï¼Œè¯¥å‘½ä»¤ä¼šé‡å¯VM Vagrantå¸¸ç”¨å‘½ä»¤vagrant help vagrant help 1vagrant help vagrant [command] -h 1vagrant box -h vagrant box æ·»åŠ box 1vagrant box add --name centos-7.4-base centos-7.4-base.box æŸ¥çœ‹box 1vagrant box list ç§»é™¤box 1vagrant box remove centos-7.4-base privisioné‡æ–°æ‰§è¡Œprovision 1vagrant provision [vm-name] [--provision-with x,y,z] æ‰§è¡ŒæŒ‡å®šçš„provisionï¼Œä½¿ç”¨â€”provision-with å‚æ•°ï¼ŒåŒæ—¶åœ¨é…ç½®Vagrantçš„æ—¶å€™ï¼Œéœ€è¦å¦‚ä¸‹é…ç½®ï¼š 12# typeå…³é”®å­— å¿…é¡»æ˜¾å¼å†™å‡ºmaster.vm.provision 'bootstrap_master', type: :shell, path: \"bootstrap_master.sh\" é‚£ä¹ˆåªæ‰§è¡Œ bootstrap_masterçš„å‘½ä»¤ä¸ºï¼švagrant provision master --provision-with bootstrap_master vagrant vm åˆå§‹åŒ– å¦‚æœè‡ªå·±ç¼–å†™Vagrantfileï¼Œä¸éœ€è¦è¿™ä¸€æ­¥ è¿™ä¸€æ­¥ä¼šæŠŠconfig.vm.boxå†™å…¥ 1vagrant init centos-7.4-base å¯åŠ¨è™šæ‹Ÿæœº 1vagrant up æŸ¥çœ‹çŠ¶æ€ 1vagrant status ssh 1vagrant ssh æš‚åœè™šæ‹Ÿæœº 1vagrant suspend æ¢å¤è™šæ‹Ÿæœº 1vagrant resume å…³é—­è™šæ‹Ÿæœº 1vagrant halt é”€æ¯è™šæ‹Ÿæœº 1vagrant destroy æ›´æ–°Vagrantfileï¼Œåˆ·æ–°å®¹å™¨ 1vagrant reload vagrant snapshotä½¿ç”¨è™šæ‹Ÿæœºå¿«ç…§å‘½ä»¤éœ€è¦å…ˆå¯åŠ¨è™šæ‹Ÿæœº ä¿å­˜è™šæ‹Ÿæœºå¿«ç…§ 1vagrant snapshot save snap1 listè™šæ‹Ÿæœºå¿«ç…§ 1vagrant snapshot list æ¢å¤è™šæ‹Ÿæœºå¿«ç…§ 1vagrant snapshot restore snap1 åˆ é™¤è™šæ‹Ÿæœºå¿«ç…§ 1vagrant snapshot delete snap1","categories":[{"name":"è™šæ‹Ÿæœº","slug":"è™šæ‹Ÿæœº","permalink":"https://shang.at/categories/è™šæ‹Ÿæœº/"}],"tags":[{"name":"Vagrant","slug":"Vagrant","permalink":"https://shang.at/tags/Vagrant/"}]},{"title":"å¤§æ•°æ®-æ¶ˆæ¯é˜Ÿåˆ—-æ•°æ®é‡‡é›†-Kafka","slug":"å¤§æ•°æ®-æ¶ˆæ¯é˜Ÿåˆ—-æ•°æ®é‡‡é›†-Kafka","date":"2020-06-20T03:14:01.000Z","updated":"2020-12-11T08:03:37.624Z","comments":true,"path":"post/å¤§æ•°æ®-æ¶ˆæ¯é˜Ÿåˆ—-æ•°æ®é‡‡é›†-Kafka/","link":"","permalink":"https://shang.at/post/å¤§æ•°æ®-æ¶ˆæ¯é˜Ÿåˆ—-æ•°æ®é‡‡é›†-Kafka/","excerpt":"","text":"Kafkaçš„åŸºæœ¬æ¦‚å¿µå’Œæ¶æ„Apache Kafkaæ˜¯Apacheè½¯ä»¶åŸºé‡‘ä¼šçš„å¼€æºçš„æµå¤„ç†å¹³å°ï¼Œè¯¥å¹³å°æä¾›äº†æ¶ˆæ¯çš„è®¢é˜…ä¸å‘å¸ƒçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¸€èˆ¬ç”¨ä½œç³»ç»Ÿé—´è§£è€¦ã€å¼‚æ­¥é€šä¿¡ã€å‰Šå³°å¡«è°·ç­‰ä½œç”¨ ç³»ç»Ÿé—´è§£è€¦ å°†åˆ†æ”¯ä¸šåŠ¡ä¸ä¸»ä¸šåŠ¡çš„è€¦åˆæ€§è§£é™¤ï¼šç”¨æˆ·æ³¨å†Œæ—¶åªéœ€è¦ç­‰å¾…è°ƒç”¨æ³¨å†ŒæœåŠ¡çš„æ—¶é—´ï¼Œåç»­æˆ‘ä»¬é€šçŸ¥ç”¨æˆ·æ³¨å†ŒæˆåŠŸçš„æ—¶é—´æ˜¯å’Œä¸»ä¸šåŠ¡æµç¨‹è§£è€¦çš„ï¼Œå‘é€çŸ­ä¿¡çš„æ—¶é—´ä¸åœ¨ç”¨æˆ·ç­‰å¾…çš„èŒƒå›´å†…ï¼›åŒæ—¶çŸ­ä¿¡æœåŠ¡å‘ç”Ÿäº†å¼‚å¸¸ä¹Ÿä¸ä¼šå½±å“åˆ°ç”¨æˆ·çš„æ³¨å†ŒæœåŠ¡ å¼‚æ­¥é€šä¿¡ ä¸Šé¢çš„ä¾‹å­åŒæ ·ä¹Ÿè§£é‡Šäº†å¼‚æ­¥é€šä¿¡ å‰Šå³°å¡«è°· åœ¨ä¸€äº›æ•°æ®äº§ç”Ÿæ¯”è¾ƒå¤§çš„åœºæ™¯ï¼ŒMQå¯ä»¥åœ¨æµè®¡ç®—å‰å’Œå…¥åº“å‰èµ·åˆ°ä¸€ä¸ªç¼“å†²çš„ä½œç”¨ Message Queueæ¶ˆæ¯é˜Ÿåˆ—æ˜¯ä¸€ç§åœ¨åˆ†å¸ƒå¼å’Œå¤§æ•°æ®å¼€å‘ä¸­ä¸å¯æˆ–ç¼ºçš„ä¸­é—´ä»¶ã€‚åœ¨åˆ†å¸ƒå¼å¼€å‘æˆ–è€…å¤§æ•°æ®å¼€å‘ä¸­é€šå¸¸ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—è¿›è¡Œç¼“å†²ã€ç³»ç»Ÿè§£è€¦å’Œå‰Šå³°å¡«è°·ç­‰ä¸šåŠ¡åœºæ™¯ï¼Œå¸¸è§çš„æ¶ˆæ¯é˜Ÿåˆ—å·¥ä½œæ¨¡å¼å¤§è‡´ä¼šåˆ†ä¸ºä¸¤å¤§ç±»ï¼š è‡³å¤šä¸€æ¬¡ï¼šæ¶ˆæ¯ç”Ÿäº§è€…å°†æ•°æ®å†™å…¥æ¶ˆæ¯ç³»ç»Ÿï¼Œç„¶åç”±æ¶ˆè´¹è€…è´Ÿè´£å»æ‹‰å–æ¶ˆæ¯æœåŠ¡å™¨ä¸­çš„æ¶ˆæ¯ï¼Œä¸€æ—¦æ¶ˆæ¯è¢«ç¡®è®¤æ¶ˆè´¹åï¼Œç”±æ¶ˆæ¯æœåŠ¡å™¨ä¸»åŠ¨åˆ é™¤é˜Ÿåˆ—ä¸­çš„æ•°æ®ï¼Œè¿™ç§æ¶ˆè´¹æ–¹å¼ä¸€èˆ¬åªå…è®¸è¢«ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ï¼Œå¹¶ä¸”é˜Ÿåˆ—ä¸­çš„æ•°æ®ä¸å…è®¸è¢«é‡å¤æ¶ˆè´¹ æ²¡æœ‰é™åˆ¶[Kafka]ï¼šåŒä¸Šè¯‰ä¸åŒï¼Œç”Ÿäº§è€…å‘å¸ƒå®Œæ•°æ®ä¹‹åï¼Œè¯¥æ¶ˆæ¯å¯ä»¥è¢«å¤šä¸ªæ¶ˆè´¹è€…åŒæ—¶æ¶ˆè´¹ï¼Œå¹¶ä¸”åŒä¸€ä¸ªæ¶ˆè´¹è€…å¯ä»¥å¤šæ¬¡æ¶ˆè´¹æ¶ˆæ¯æœåŠ¡å™¨ä¸­çš„åŒä¸€ä¸ªè®°å½•ï¼Œä¸»è¦æ˜¯å› ä¸ºæ¶ˆæ¯æœåŠ¡å™¨ä¸€èˆ¬å¯ä»¥é•¿æ—¶é—´å­˜å‚¨æµ·é‡æ¶ˆæ¯ Kafkakafkaé›†ç¾¤ä»¥Topicçš„å½¢å¼è´Ÿè´£åˆ†ç±»é›†ç¾¤ä¸­çš„Recordï¼Œæ¯ä¸€ä¸ªRecordå±äºä¸€ä¸ªTopicã€‚æ¯ä¸ªTopicåº•å±‚éƒ½ä¼šå¯¹åº”ä¸€ç»„åˆ†åŒºçš„æ—¥å¿—ç”¨äºæŒä¹…åŒ–Topicä¸­çš„Recordã€‚åŒæ—¶åœ¨kafkaé›†ç¾¤ä¸­ï¼ŒTopicçš„æ¯ä¸€ä¸ªæ—¥å¿—åˆ†åŒºéƒ½ä¸€å®šä¼šæœ‰1ä¸ªBrokeræ‹…å½“è¯¥åˆ†åŒºçš„Leaderï¼Œå…¶ä»–Brokeræ‹…å½“è¯¥åˆ†åŒºçš„followerï¼ŒLeaderè´Ÿè´£åˆ†åŒºæ•°æ®çš„è¯»å†™æ“ä½œã€‚followerè´Ÿè´£åŒæ­¥è¯¥åˆ†åŒºçš„æ•°æ®ã€‚è¿™æ ·å¦‚æœåˆ†åŒºçš„Leaderå®•æœºï¼Œè¯¥åˆ†åŒºçš„å…¶ä»–followerä¼šé€‰å–å‡ºæ–°çš„leaderç»§ç»­è´Ÿè´£è¯¥åˆ†åŒºæ•°æ®çš„è¯»å†™ã€‚å…¶ä¸­é›†ç¾¤ä¸­çš„Leaderçš„ç›‘æ§å’ŒTopicçš„éƒ¨åˆ†å…ƒæ•°æ®æ˜¯å­˜å‚¨åœ¨Zookeeperä¸­ kafkaé€»è¾‘ä¸Šæ¦‚å¿µkafkaä¸­æ‰€æœ‰çš„æ¶ˆæ¯æ—¶é€šè¿‡Topicä¸ºå•ä½è¿›è¡Œç®¡ç†ï¼Œæ¯ä¸ªkafkaä¸­çš„topicé€šå¸¸ä¼šæœ‰å¤šä¸ªè®¢é˜…è€…ï¼Œè´Ÿè´£è®¢é˜…å‘é€åˆ°è¯¥Topicä¸­çš„æ•°æ®ã€‚kafkaè´Ÿè´£ç®¡ç†é›†ç¾¤ä¸­æ¯ä¸ªTopicçš„ä¸€ç»„æ—¥å¿—åˆ†åŒºæ•°æ®ã€‚ ç”Ÿäº§è€…å°†æ•°æ®å‘å¸ƒåˆ°ç›¸åº”çš„Topicã€‚è´Ÿè´£é€‰æ‹©å°†å“ªä¸ªè®°å½•å‘é€åˆ°Topicçš„å“ªä¸ªpartitionã€‚ä¾‹å¦‚ï¼Œå¯ä»¥round-robinæ–¹å¼å®Œæˆæ­¤æ“ä½œï¼Œç„¶è€Œè¿™ç§é€‰æ‹©ä»…ä»…æ˜¯ä¸ºäº†æ•°æ®è´Ÿè½½ã€‚ä¹Ÿå¯ä»¥æ ¹æ®æŸäº›è¯­ä¹‰åˆ†åŒºåŠŸèƒ½(ä¾‹å¦‚åŸºäºè®°å½•ä¸­çš„key)è¿›è¡Œæ­¤æ“ä½œ æ¯ç»„æ—¥å¿—åˆ†åŒºæ˜¯ä¸€ä¸ªæœ‰åºçš„ä¸å¯å˜çš„æ—¥å¿—åºåˆ—(åˆ†åŒºæœ‰åºï¼Œå…¨å±€æ— åºï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ç»„ç»‡keyæ¥ä¿è¯æ¶ˆè´¹çš„æ•°æ®æ˜¯æœ‰åºçš„)ï¼Œåˆ†åŒºä¸­çš„æ¯ä¸€ä¸ªRecordéƒ½è¢«åˆ†é…äº†å”¯ä¸€çš„åºåˆ—ç¼–å·ï¼Œç§°ä¸ºoffsetï¼Œkafkaé›†ç¾¤ä¼šæŒä¹…åŒ–æ‰€æœ‰å‘å¸ƒåˆ°Topicä¸­çš„Recordä¿¡æ¯ï¼Œè¯¥Topicçš„æŒä¹…åŒ–æ—¶é—´æ˜¯é€šè¿‡é…ç½®æ–‡ä»¶æ‰§è¡Œçš„ï¼Œé»˜è®¤æ˜¯168å°æ—¶ log.retention.hours=168 7*24 ä¸€å‘¨çš„ç¼“å­˜æ—¶é—´ kafkaåº•å±‚ä¼šå®šæœŸçš„æ£€æŸ¥æ—¥å¿—æ–‡ä»¶ï¼Œç„¶åå°†è¿‡æœŸçš„æ•°æ®ä»logä¸­ç§»é™¤ï¼Œç”±äºkafkaä½¿ç”¨ç¡¬ç›˜å­˜å‚¨(é›¶æ‹·è´)æ—¥å¿—æ–‡ä»¶ï¼Œå› æ­¤ä½¿ç”¨kafkaé•¿æ—¶é—´ç¼“å­˜ä¸€äº›æ—¥å¿—æ–‡ä»¶æ˜¯ä¸å­˜åœ¨é—®é¢˜çš„ åœ¨æ¶ˆè´¹è€…æ¶ˆè´¹Topicä¸­æ•°æ®çš„æ˜¯æ—¶å€™ï¼Œæ¯ä¸ªæ¶ˆè´¹è€…ä¼šç»´æŠ¤æœ¬æ¬¡æ¶ˆè´¹å¯¹åº”åˆ†åŒºçš„åç§»é‡ï¼Œæ¶ˆè´¹è€…ä¼šåœ¨æ¶ˆè´¹å®Œä¸€ä¸ªæ‰¹æ¬¡çš„æ•°æ®ä¹‹åï¼Œä¼šå°†æœ¬æ¬¡æ¶ˆè´¹çš„åç§»é‡æäº¤ç»™kafkaé›†ç¾¤ï¼Œå› æ­¤å¯¹äºæ¯ä¸ªæ¶ˆè´¹è€…è€Œè¨€ï¼Œå¯ä»¥éšæ„çš„æ§åˆ¶æ¶ˆè´¹è€…çš„åç§»é‡ã€‚å› æ­¤åœ¨kafkaä¸­æ¶ˆè´¹è€…å¯ä»¥ä»ä¸€ä¸ªTopicåˆ†åŒºä¸­çš„ä»»æ„ä½ç½®è¯»å–é˜Ÿåˆ—æ•°æ®ï¼Œç”±äºæ¯ä¸ªæ¶ˆè´¹è€…ç‹¬ç«‹æ§åˆ¶äº†è‡ªå·±çš„æ¶ˆè´¹åç§»é‡ï¼Œå› æ­¤å¤šä¸ªæ¶ˆè´¹è€…ä¹‹é—´å½¼æ­¤ç›¸äº’ç‹¬ç«‹ã€‚ kafkaä¸­å¯¹Topicå®ç°æ—¥å¿—åˆ†åŒºæœ‰ä»¥ä¸‹çš„ç›®çš„ï¼š é¦–å…ˆï¼Œå®ƒä»¬å…è®¸æ—¥å¿—æ‰©å±•åˆ°è¶…å‡ºå•ä¸ªæœåŠ¡å™¨æ‰€èƒ½å®¹çº³çš„å¤§å°ã€‚æ¯ä¸ªå•ç‹¬çš„åˆ†åŒºéƒ½å¿…é¡»é€‚åˆæ‰˜ç®¡å®ƒçš„æœåŠ¡å™¨ï¼Œä½†æ˜¯ä¸€ä¸ªTopicå¯èƒ½å­˜åœ¨å¾ˆå¤šåˆ†åŒºï¼Œå› æ­¤å®ƒå¯ä»¥å¤„ç†ä»»æ„æ•°é‡çš„æ•°æ® â€”- å¦‚æœæ•°æ®åæœŸå‘ç”Ÿå¢é•¿ï¼Œç›´æ¥å¢åŠ åˆ†åŒºæ•°å°±å¯ä»¥å—? å…¶æ¬¡ï¼Œæ¯ä¸ªæœåŠ¡å™¨å……å½“å…¶ä»–æŸäº›åˆ†åŒºçš„Leaderï¼Œä¹Ÿå¯èƒ½å……å½“å…¶ä»–åˆ†åŒºçš„Followerï¼Œå› æ­¤é›†ç¾¤ä¸­è´Ÿè½½å¾—åˆ°äº†å¾ˆå¥½çš„å¹³è¡¡ é€»è¾‘æ¦‚å¿µ Producerï¼šç”Ÿäº§æ¶ˆæ¯çš„å®¢æˆ·ç«¯ Consumerï¼šæ¶ˆè´¹æ¶ˆæ¯çš„å®¢æˆ·ç«¯ Consumer Groupï¼šåŒä¸€ä¸ªConsumerGroupä¸­çš„Consumerå¾€å¾€æ˜¯ä¸€ä¸ªæœåŠ¡çš„å¤šä¸ªå®ä¾‹ï¼Œç”¨æ¥æé«˜æ¶ˆè´¹çš„æ•ˆç‡ï¼Œä¹Ÿå°±æ˜¯è¯´åŒä¸€ä¸ªCGä¸­çš„å¤šä¸ªCä¸èƒ½é‡å¤æ¶ˆè´¹æ¶ˆæ¯ï¼›ä¸åŒCGå¾€å¾€ä»£è¡¨äº†å¤šç§ä¸åŒçš„æœåŠ¡ï¼Œä»–ä»¬å¤„ç†ä¸åŒçš„ä¸šåŠ¡ï¼Œæ‰€ä»¥ï¼Œä¸åŒçš„CGä¸­çš„Cå¯¹äºæ¶ˆæ¯çš„å¤„ç†æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œå¦‚CG2ä¸­çš„C2å¯ä»¥é‡å¤çš„æ¶ˆè´¹åœ¨CG1ä¸­çš„C1å·²ç»æ¶ˆè´¹è¿‡çš„æ¶ˆæ¯ æ¶ˆè´¹è€…ä½¿ç”¨Consumer Groupåç§°æ ‡è®°è‡ªå·±ï¼Œå¹¶ä¸”å‘å¸ƒåˆ°Topicçš„æ¯æ¡è®°å½•éƒ½ä¼šä¼ é€’åˆ°æ¯ä¸ªè®¢é˜…Consumer Groupä¸­çš„ä¸€ä¸ªæ¶ˆè´¹è€…å®ä¾‹ã€‚ å¦‚æœæ‰€æœ‰Consumerå®ä¾‹éƒ½å…·æœ‰ç›¸åŒçš„Consumer Groupï¼Œé‚£ä¹ˆTopicä¸­çš„è®°å½•ä¼šåœ¨è¯¥ConsumerGroupä¸­çš„Consumerå®ä¾‹è¿›è¡Œå‡åˆ†æ¶ˆè´¹ï¼› å¦‚æœæ‰€æœ‰Consumerå®ä¾‹å…·æœ‰ä¸åŒçš„ConsumerGroupï¼Œåˆ™æ¯æ¡è®°å½•å°†å¹¿æ’­åˆ°æ‰€æœ‰Consumer Groupè¿›ç¨‹ã€‚ æ›´å¸¸è§çš„æ˜¯ï¼Œæˆ‘ä»¬å‘ç°Topicå…·æœ‰å°‘é‡çš„Consumer Groupï¼Œæ¯ä¸ªConsumer Groupå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªâ€œé€»è¾‘çš„è®¢é˜…è€…â€ã€‚æ¯ä¸ªConsumer Groupå‡ç”±è®¸å¤šConsumerå®ä¾‹ç»„æˆï¼Œä»¥å®ç°å¯ä¼¸ç¼©æ€§å’Œå®¹é”™èƒ½åŠ›ã€‚è¿™æ— éå°±æ˜¯å‘å¸ƒ-è®¢é˜…æ¨¡å‹ï¼Œå…¶ä¸­è®¢é˜…è€…æ˜¯æ¶ˆè´¹è€…çš„é›†ç¾¤è€Œä¸æ˜¯å•ä¸ªè¿›ç¨‹ã€‚è¿™ç§æ¶ˆè´¹æ–¹å¼Kafkaä¼šå°†TopicæŒ‰ç…§åˆ†åŒºçš„æ–¹å¼å‡åˆ†ç»™ä¸€ä¸ªConsumer Groupä¸‹çš„å®ä¾‹ï¼Œå¦‚æœConsumerGroupä¸‹æœ‰æ–°çš„æˆå‘˜ä»‹å…¥ï¼Œåˆ™æ–°ä»‹å…¥çš„Consumerå®ä¾‹ä¼šå»æ¥ç®¡ConsumerGroupå†…å…¶ä»–æ¶ˆè´¹è€…è´Ÿè´£çš„æŸäº›åˆ†åŒºï¼ŒåŒæ ·å¦‚æœä¸€ä¸‹ConsumerGroupä¸‹çš„æœ‰å…¶ä»–Consumerå®ä¾‹å®•æœºï¼Œåˆ™ç”±è¯¥ConsumerGroupä¸­å…¶ä»–Consumerå®ä¾‹æ¥ç®¡ã€‚ æ¶ˆè´¹è€…ç»„å†…çš„æ¶ˆè´¹è€…æ•°é‡ä¸€èˆ¬ä¸èƒ½å¤§äºTopicä¸­çš„åˆ†åŒºæ•°ï¼Œå¦‚æœå¤§äºäº†ï¼Œé‚£ä¹ˆå¤šå‡ºæ¥çš„æ¶ˆè´¹è€…ä¼šåˆ†ä¸åˆ°åˆ†åŒºè€Œæ¶ˆè´¹ä¸åˆ°æ¶ˆæ¯ Tocpicï¼šä¸€ç»„Recordå¯ä»¥ä½œä¸ºä¸€ä¸ªTopicåœ¨é›†ç¾¤ä¸­è¢«ç®¡ç† Recordï¼šProducerç”Ÿäº§çš„æ¯ä¸€æ¡æ¶ˆæ¯å°±æ˜¯ä¸€ä¸ªRecordï¼Œæ¯ä¸€ä¸ªRecordåªèƒ½å±äºä¸€ä¸ªTopic ç”±äºKafkaçš„Topicçš„åˆ†åŒºç­–ç•¥ï¼Œå› æ­¤Kafkaä»…æä¾›åˆ†åŒºä¸­è®°å½•çš„æœ‰åºæ€§ï¼Œä¹Ÿå°±æ„å‘³ç€ç›¸åŒTopicçš„ä¸åŒåˆ†åŒºè®°å½•ä¹‹é—´æ— é¡ºåºã€‚å› ä¸ºé’ˆå¯¹äºç»å¤§å¤šæ•°çš„å¤§æ•°æ®åº”ç”¨å’Œä½¿ç”¨åœºæ™¯ï¼Œ ä½¿ç”¨åˆ†åŒºå†…éƒ¨æœ‰åºæˆ–è€…ä½¿ç”¨keyè¿›è¡Œåˆ†åŒºç­–ç•¥å·²ç»è¶³å¤Ÿæ»¡è¶³ç»å¤§å¤šæ•°åº”ç”¨åœºæ™¯ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‚¨éœ€è¦è®°å½•å…¨å±€æœ‰åºï¼Œåˆ™å¯ä»¥é€šè¿‡åªæœ‰ä¸€ä¸ªåˆ†åŒºTopicæ¥å®ç°ï¼Œå°½ç®¡è¿™å°†æ„å‘³ç€æ¯ä¸ªConsumerGroupåªæœ‰ä¸€ä¸ªConsumerè¿›ç¨‹ Partitionï¼šæ¯ä¸ªTopicä¼šæœ‰num.partitions(é»˜è®¤)ä¸ªåˆ†åŒºï¼Œæ¯ä¸ªTopicåœ¨åˆ›å»ºçš„æ—¶å€™ï¼Œä¹Ÿå¯ä»¥è¢«æŒ‡å®šåˆ†åŒºçš„ä¸ªæ•°ã€‚ Kafkaä¸­å¯¹Topicå®ç°æ—¥å¿—åˆ†åŒºçš„æœ‰ä»¥ä¸‹ç›®çš„ï¼š æ”¯æŒé›†ç¾¤å­˜å‚¨çš„æ¨ªå‘æ‰©å®¹ã€‚å¦‚æœå•ä¸€æœåŠ¡å™¨çš„èµ„æºä¸å¤Ÿç”¨ï¼Œé‚£ä¹ˆå¢åŠ é›†ç¾¤èŠ‚ç‚¹å³å¯ æ¯ä¸ªæœåŠ¡å™¨å……å½“å…¶æŸäº›åˆ†åŒºçš„Leaderï¼Œä¹Ÿå¯èƒ½å……å½“å…¶ä»–åˆ†åŒºçš„Follwerï¼Œå› æ­¤ç¾¤é›†ä¸­çš„è´Ÿè½½å¾—åˆ°äº†å¾ˆå¥½çš„å¹³è¡¡ã€‚ åŒä¸€ä¸ªTopic å¤šä¸ªåˆ†åŒºå¯ä»¥æé«˜Consumeræ¶ˆè´¹çš„å¹¶è¡Œåº¦ åœ¨kafkaä¸­åŒä¸€ä¸ªpartitionçš„recordæ˜¯ä¸¥æ ¼æœ‰åºçš„ï¼Œä½†æ˜¯ä¸åŒpartitionçš„recordå¹¶ä¸æ˜¯ä¸¥æ ¼æœ‰åºçš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œkafkaåªèƒ½ä¿è¯partitionå†…éƒ¨recordçš„æœ‰åºæ¶ˆè´¹ Duplicate(å‰¯æœ¬)ï¼šæ¯ä¸ªåˆ†åŒºä¼šæœ‰--replication-factorä¸ªå‰¯æœ¬ï¼Œæ˜¯åœ¨Topicè¢«åˆ›å»ºçš„æ—¶å€™æŒ‡å®šçš„ offset (éå¸¸é‡è¦çš„ä¸€ä¸ªæ¦‚å¿µ) â€” å¾…è¡¥å…… åœ¨kafkaä¸­å¯¹äºæ¶ˆæ¯çš„ç”Ÿäº§å’Œæ¶ˆè´¹éƒ½æ˜¯é€šè¿‡offsetæ§åˆ¶çš„ã€‚åŒä¸€ä¸ªpartitionçš„æ¶ˆæ¯recordçš„offsetæ˜¯é€’å¢çš„ï¼Œæ¶ˆè´¹è€…æ¶ˆè´¹çš„æ—¶å€™ï¼Œä¹Ÿæ˜¯æ¶ˆè´¹çš„æŒ‡å®šçš„offsetä¹‹åçš„æ¶ˆæ¯ã€‚ æ¶ˆè´¹è€…ä¼šå®šæœŸçš„ä¸Šä¼ è‡ªå·±æ¶ˆè´¹çš„offsetç»™kafka server Segments â€” å¾…è¡¥å…… æ¶æ„ä¸Šçš„æ¦‚å¿µ Brokerï¼šKafkaé›†ç¾¤å†…çš„ä¸»æœºèŠ‚ç‚¹è¢«ç§°ä¸ºbrokerï¼Œbrokerå¯èƒ½æ˜¯æŸä¸ªpartitionçš„Leaderï¼Œä¹Ÿå¯èƒ½æ˜¯å¦å¤–ä¸€ä¸ªpartitionçš„follower Leaderï¼škafkaé‡‡ç”¨ä¸»ä»çš„æ¶æ„ï¼Œæ¯ä¸ªpartitionéƒ½æœ‰è‡ªå·±çš„leaderã€‚æ¯ä¸ªpartitionçš„leaderè´Ÿè´£æ¶ˆæ¯çš„è¯»å†™ Followerï¼špartitionçš„ä»èŠ‚ç‚¹ï¼Œä¸»è¦ç”¨æ¥åŒæ­¥è¯¥åˆ†åŒºçš„æ•°æ®ï¼Œå½“leaderå®•æœºä¹‹åï¼Œå¯ä»¥ç”¨æ¥ç«é€‰leader ISRï¼š kafkaé«˜æ€§èƒ½ä¹‹é“-é¡ºåºå†™&amp;MMAPkafkaçš„ç‰¹æ€§ä¹‹ä¸€å°±æ˜¯é«˜ååé‡ï¼Œä½†æ˜¯kafkaçš„æ¶ˆæ¯æ˜¯ä¿å­˜æˆ–ç¼“å­˜åœ¨ç£ç›˜ä¸Šçš„ï¼Œä¸€èˆ¬è®¤ä¸ºåœ¨ç£ç›˜ä¸Šè¯»å†™æ•°æ®æ˜¯ä¼šé™ä½æ€§èƒ½çš„ï¼Œä½†æ˜¯kafkaå³ä½¿æ˜¯æ™®é€šçš„æœåŠ¡å™¨ï¼Œä¹Ÿå¯ä»¥è½»æ¾æ”¯æŒç™¾ä¸‡/sçº§çš„å†™å…¥è¯·æ±‚ï¼Œè¶…å‡ºäº†å¤§éƒ¨åˆ†çš„æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œè¿™ç§ç‰¹æ€§ä¹Ÿä½¿å¾—kafkaåœ¨ç¥ºæ™ºå¤„ç†ç­‰æµ·é‡æ•°æ®åœºæ™¯å¹¿æ³›åº”ç”¨ï¼Œkafkaä¼šæŠŠæ”¶åˆ°çš„æ¶ˆæ¯éƒ½é¡ºåºå†™å…¥ç£ç›˜ä¸­ï¼Œé˜²æ­¢ä¸¢å¤±æ•°æ®ã€‚ä¸ºäº†ä¼˜åŒ–å†™å…¥é€Ÿåº¦kafkaé‡‡ç”¨äº†ä¸¤ä¸ªæŠ€æœ¯ï¼šé¡ºåºå†™å…¥å’ŒMMFile å› ä¸ºç¡¬ç›˜æ˜¯æœºæ¢°æœºæ„ï¼Œæ¯æ¬¡è¯»å†™éƒ½ä¼šå¯»å€-&gt;å†™å…¥ï¼Œå…¶ä¸­å¯»å€æ˜¯ä¸€ä¸ªæœºæ¢°æ“ä½œï¼Œå®ƒæ˜¯æœ€è€—æ—¶çš„ï¼Œæ‰€ä»¥ç¡¬ç›˜æœ€è®¨åŒéšæœºIOï¼Œæœ€å–œæ¬¢é¡ºåºIOã€‚ä¸ºäº†æé«˜è¯»å†™ç¡¬ç›˜çš„é€Ÿåº¦ï¼Œkafkaå°±æ˜¯ä½¿ç”¨çš„é¡ºåºIOï¼Œè¿™æ ·çœå»äº†å¤§é‡çš„å†…å­˜å¼€é”€ä»¥åŠèŠ‚çœäº†IOå¯»å€çš„æ—¶é—´ã€‚ä½†æ˜¯å•çº¯çš„ä½¿ç”¨é¡ºåºå†™å…¥ï¼Œkafkaçš„å†™å…¥æ€§èƒ½ä¹Ÿä¸å¯èƒ½å’Œå†…å­˜è¿›è¡Œå¯¹æ¯”ï¼Œå› æ­¤kafkaçš„æ•°æ®å¹¶ä¸æ˜¯å®æ—¶çš„å†™å…¥ç¡¬ç›˜çš„ kafkaå……åˆ†åˆ©ç”¨äº†ç°ä»£æ“ä½œç³»ç»Ÿåˆ†é¡µå­˜å‚¨çš„ç‰¹æ€§æ¥åˆ©ç”¨å†…å­˜æé«˜IOæ•ˆç‡ã€‚Memory Mapped Filesä¹Ÿç§°ä¸ºå†…å­˜æ˜ å°„æ–‡ä»¶ï¼Œåœ¨64ä½çš„æ“ä½œç³»ç»Ÿä¸­ä¸€èˆ¬å¯ä»¥è¡¨ç¤º20Gçš„æ•°æ®æ–‡ä»¶ï¼Œå®ƒçš„å·¥ä½œåŸç†æ˜¯ç›´æ¥åˆ©ç”¨æ“ä½œç³»ç»Ÿçš„Pageå®ç°æ–‡ä»¶åˆ°ç‰©ç†å†…å­˜çš„ç›´æ¥æ˜ å°„ã€‚å®ŒæˆMMPæ˜ å°„åï¼Œç”¨æˆ·å †å†…å­˜çš„æ‰€æœ‰æ“ä½œä¼šè¢«æ“ä½œç³»ç»Ÿè‡ªåŠ¨åˆ·æ–°åˆ°ç£ç›˜ä¸Šï¼Œæå¤§åœ°é™ä½äº†IOä½¿ç”¨ç‡ kafkaé«˜æ€§èƒ½ä¹‹é“-æ¶ˆè´¹æ¶ˆæ¯-é›¶æ‹·è´kafkaæœåŠ¡å™¨åœ¨å“åº”å®¢æˆ·ç«¯è¯»å–çš„æ—¶å€™ï¼Œåº•å±‚ä½¿ç”¨ZeroCopyæŠ€æœ¯ï¼Œç›´æ¥å°†ç£ç›˜æ— åºæ‹·è´åˆ°ç”¨æˆ·æ§ä»¶ï¼Œè€Œæ˜¯ç›´æ¥å°†æ•°æ®é€šè¿‡å†…æ ¸ç©ºé—´ä¼ é€’è¾“å‡ºï¼Œæ•°æ®å¹¶æ²¡æœ‰æŠµè¾¾ç”¨æˆ·ç©ºé—´ ä¼ ç»ŸIOæ“ä½œæ­¥éª¤ ç”¨æˆ·è¿›ç¨‹è°ƒç”¨readç­‰ç³»ç»Ÿè°ƒç”¨å‘æ“ä½œç³»ç»Ÿå‘é€IOè¯·æ±‚ï¼Œè¯·æ±‚è¯»å–æ•°æ®åˆ°è‡ªå·±çš„å†…å­˜ç¼“å†²åŒºä¸­ï¼Œè‡ªå·±è¿›å…¥é˜»å¡çŠ¶æ€ æ“ä½œç³»ç»Ÿæ”¶åˆ°è¯·æ±‚åï¼Œè¿›ä¸€æ­¥å°†IOè¯·æ±‚å‘é€ç£ç›˜ ç£ç›˜é©±åŠ¨å™¨æ”¶åˆ°å†…æ ¸IOè¯·æ±‚ï¼ŒæŠŠæ•°æ®ä»ç£ç›˜è¯»å–åˆ°é©±åŠ¨å™¨çš„ç¼“å†²åŒºï¼Œæ­¤æ—¶ä¸å ç”¨CPUã€‚å½“é©±åŠ¨å™¨ç¼“å†²åŒºè¢«è¯»æ»¡åï¼Œå‘å†…æ ¸å‘èµ·ä¸­æ–­ä¿¡å·å‘ŠçŸ¥è‡ªå·±ç¼“å†²åŒºå·²æ»¡ å†…æ ¸æ”¶åˆ°ä¸­æ–­ï¼Œä½¿ç”¨CPUæ—¶é—´å°†ç£ç›˜é©±åŠ¨å™¨ç¼“å­˜ä¸­çš„æ•°æ®æ‹·è´åˆ°å†…æ ¸ç¼“å†²åŒºã€‚ å¦‚æœå†…æ ¸ç¼“å†²åŒºçš„æ•°æ®å°‘äºç”¨æˆ·ç”³è¯·çš„è¯»å–çš„æ•°æ®ï¼Œé‡å¤æ­¥éª¤3å’Œ4ï¼Œç›´åˆ°å†…æ ¸ç¼“å†²åŒºçš„æ•°æ®è¶³å¤Ÿå¤šä¸ºæ­¢ å°†æ•°æ®ä»å†…æ ¸ç¼“å†²åŒºæ‹·è´åˆ°ç”¨æˆ·ç¼“å†²åŒºï¼ŒåŒæ—¶ä»ç³»ç»Ÿè°ƒç”¨ä¸­è¿”å›ï¼ŒIOä»»åŠ¡ç»“æŸ DMAè¯»å– - Direct Memory Access ç›´æ¥å­˜å‚¨å™¨è®¿é—® ç”¨æˆ·è¿›ç¨‹è°ƒç”¨readç­‰ç³»ç»Ÿè°ƒç”¨å‘æ“ä½œç³»ç»Ÿå‘é€IOè¯·æ±‚ï¼Œè¯·æ±‚è¯»å–æ•°æ®åˆ°è‡ªå·±çš„å†…å­˜ç¼“å†²åŒºä¸­ï¼Œè‡ªå·±è¿›å…¥é˜»å¡çŠ¶æ€ æ“ä½œç³»ç»Ÿæ”¶åˆ°è¯·æ±‚åï¼Œè¿›ä¸€æ­¥å°†IOè¯·æ±‚å‘é€ç»™DMAï¼Œç„¶åè®©CPUå¹²åˆ«çš„æ´» DMAè¿›ä¸€æ­¥å°†IOè¯·æ±‚å‘é€ç»™ç£ç›˜ ç£ç›˜é©±åŠ¨å™¨æ”¶åˆ°DMAçš„IOè¯·æ±‚ï¼ŒæŠŠæ•°æ®ä»ç£ç›˜è¯»å–åˆ°é©±åŠ¨å™¨çš„ç¼“å­˜ä¸­ï¼Œå½“é©±åŠ¨å™¨çš„ç¼“å†²åŒºè¢«è¯»æ»¡åï¼Œæƒ³DMAå‘èµ·ä¸­æ–­ä¿¡å·å‘ŠçŸ¥è‡ªå·±çš„ç¼“å†²åŒºå·²æ»¡ DMAæ”¶åˆ°ç£ç›˜é©±åŠ¨å™¨çš„æ–°å·ï¼Œå°†ç£ç›˜é©±åŠ¨å™¨çš„ç¼“å­˜ä¸­çš„æ•°æ®æ‹·è´åˆ°å†…æ ¸ç¼“å†²åŒºã€‚æ­¤æ—¶ä¸å ç”¨CPUï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœå†…æ ¸ç¼“å†²åŒºçš„æ•°æ®å°‘äºç”¨æˆ·ç”³è¯·çš„è¯»å–çš„æ•°æ®ï¼Œå†…æ ¸å°±ä¼šä¸€ç›´é‡å¤æ­¥éª¤3å’Œ4ï¼ŒçŸ¥é“å†…æ ¸ç¼“å†²åŒºçš„æ•°æ®è¶³å¤Ÿå¤šä½ç½® å½“DMAè¯»å–äº†è¶³å¤Ÿå¤šçš„æ•°æ®ï¼Œå°±ä¼šå‘é€ä¸­æ–­ä¿¡å·ç»™CPU CPUæ”¶åˆ°DMAçš„ä¸­æ–­ä¿¡å·ï¼ŒçŸ¥é“æ•°æ®å·²ç»å‡†å¤‡å¥½ï¼Œäºæ˜¯å°†æ•°æ®ä»å†…æ ¸ç©ºé—´æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´ï¼Œç³»ç»Ÿè°ƒç”¨è¿”å› DMAä¸ä¼ ç»ŸIOä¸­æ–­æ¨¡å¼ç›¸æ¯”ï¼šDMAæ¨¡å¼ä¸‹ï¼ŒDMAå°±æ˜¯CPUçš„ä¸€ä¸ªä»£ç†ï¼Œä»–è´Ÿè´£äº†ä¸€éƒ¨åˆ†çš„æ‹·è´å·¥ä½œï¼Œä»è€Œå‡è½»äº†CPUçš„è´Ÿæ‹…ï¼ŒDMAçš„ä¼˜ç‚¹å°±æ˜¯ï¼šä¸­æ–­å°‘ï¼ŒCPUè´Ÿæ‹…ä½ ç½‘ç»œIOçš„ä¸¤ç§æ–¹æ¡ˆå¯¹æ¯”ï¼š ä¸€èˆ¬æ–¹æ¡ˆ æ–‡ä»¶åœ¨ç£ç›˜ä¸­è¢«æ‹·è´åˆ°å†…æ ¸ç¼“å†²åŒº æ•°æ®å†ä»å†…æ ¸ç¼“å†²åŒºæ‹·è´åˆ°ç”¨æˆ·ç©ºé—´ æ•°æ®å†ä»ç”¨æˆ·ç©ºé—´æ‹·è´åˆ°socketçš„ç›¸å…³ç¼“å†²åŒº æ•°æ®ä»socketç›¸å…³ç¼“å†²åŒºæ‹·è´åˆ°ç›¸å…³åè®®å¼•æ“å‘é€å‡ºå» Zeroæ‹·è´ æ–‡ä»¶åœ¨ç£ç›˜ä¸­æ•°æ®è¢«æ‹·è´åˆ°å†…æ ¸ç¼“å†²åŒº æ•°æ®ä»å†…æ ¸ç¼“å†²åŒºç›´æ¥æ‹·è´åˆ°socketç›¸å…³ç¼“å†²åŒº æ•°æ®ä»socketç¼“å†²åŒºæ‹·è´åˆ°ç›¸å…³åè®®å¼•æ“å‘é€å‡ºå» kafkaçš„åŸºæœ¬ä½¿ç”¨å‘½ä»¤ å¯åŠ¨kafka 1./bin/kafka-server-start.sh -daemon config/server.properties å…³é—­kafka 1./bin/kafka-server-stop.sh åˆ›å»ºtopic 123456kafka-topics.sh \\--bootstrap-server node1:9092,node2:9092,node3:9092 \\--create \\--topic topic01 \\--partitions 3 \\--replication-factor 3 æŸ¥çœ‹topicåˆ—è¡¨ 123kafka-topics.sh \\--bootstrap-server node1:9092,node2:9092,node3:9092 \\--list æŸ¥çœ‹topicè¯¦æƒ… 1234kafka-topics.sh \\--bootstrap-server node1:9092,node2:9092,node3:9092 \\--describe \\--topic topic01 ä¿®æ”¹topic 123456789101112kafka-topics.sh \\--bootstrap-server node1:9092,node2:9092,node3:9092 \\--create \\--topic topic03 \\--partitions 1 \\--replication-factor 1kafka-topics.sh \\--bootstrap-server node1:9092,node2:9092,node3:9092 \\--alter \\--topic topic03 \\--partitions 2 åˆ é™¤topic 1234kafka-topics.sh \\--bootstrap-server node1:9092,node2:9092,node3:9092 \\--delete \\--topic topic03 æ¶ˆè´¹è€…è®¢é˜…topic 1234567kafka-console-consumer.sh \\--bootstrap-server node1:9092,node2:9092,node3:9092 \\--topic topic01 \\--group g1 \\--property print.key=true \\--property print.value=true \\--property key.separator=, æ¶ˆè´¹è€…ç»„ 12345678kafka-consumer-groups.sh \\--bootstrap-server node1:9092,node2:9092,node3:9092 \\--listkafka-consumer-groups.sh \\--bootstrap-server node1:9092,node2:9092,node3:9092 \\--describe \\--group g1 ç”Ÿäº§è€…ç”Ÿäº§æ¶ˆæ¯ 123kafka-console-producer.sh \\--broker-list node1:9092,node2:9092,node3:9092 \\--topic topic01 APIåŸºæœ¬APIé«˜çº§APIæ¶æ„è¿›é˜¶é«˜æ€§èƒ½åˆ†æä¹‹é›¶æ‹·è´&amp;æºç åˆ†ææ•°æ®åŒæ­¥æœºåˆ¶kafkaä¸å…¶ä»–è½¯ä»¶çš„é›†æˆä¸Flumeçš„é›†æˆä¸SpringBootçš„é›†æˆåœ¨å¤§æ•°æ®æµè®¡ç®—ä¸­çš„åº”ç”¨ZookeeperKafkaä¸­çš„leaderç›‘æ§å’Œtopicçš„å…ƒæ•°æ®ï¼Œéƒ½æ˜¯å­˜åœ¨zkä¸­","categories":[{"name":"å¤§æ•°æ®ç”Ÿæ€","slug":"å¤§æ•°æ®ç”Ÿæ€","permalink":"https://shang.at/categories/å¤§æ•°æ®ç”Ÿæ€/"}],"tags":[{"name":"Kafka","slug":"Kafka","permalink":"https://shang.at/tags/Kafka/"}]},{"title":"å¤§æ•°æ®-çŸ¥è¯†ç‚¹","slug":"å¤§æ•°æ®-çŸ¥è¯†ç‚¹","date":"2020-06-20T02:46:39.000Z","updated":"2020-06-22T10:30:39.392Z","comments":true,"path":"post/å¤§æ•°æ®-çŸ¥è¯†ç‚¹/","link":"","permalink":"https://shang.at/post/å¤§æ•°æ®-çŸ¥è¯†ç‚¹/","excerpt":"","text":"ç”Ÿæ€ç®¡ç†å‘˜-Zookeeper èŠ‚ç‚¹é€šä¿¡-RPC Hadoop æ•°æ®å­˜å‚¨-HDFS èµ„æºç®¡ç†-YARN ä»»åŠ¡è°ƒåº¦-AppMasterï¼šæ‰€æœ‰ç¬¬ä¸‰æ–¹çš„åº”ç”¨å¯ä»¥å®ç°AppMasterï¼Œå³å¯å°†ä»»åŠ¡è·‘åœ¨YARNä¸Š æ•°æ®é‡‡é›†-Flume æ¶ˆæ¯é˜Ÿåˆ—-æ•°æ®é‡‡é›†-Kafka æ•°ä»“-Hive æ•°æ®å­˜å‚¨-HBase æµæ‰¹ä¸€ä½“-Spark æµæ‰¹ä¸€ä½“-Flink æœºå™¨å­¦ä¹ -Spark mlib æœºå™¨å­¦ä¹ -FlinkML","categories":[{"name":"å¤§æ•°æ®ç”Ÿæ€","slug":"å¤§æ•°æ®ç”Ÿæ€","permalink":"https://shang.at/categories/å¤§æ•°æ®ç”Ÿæ€/"}],"tags":[{"name":"å¤§æ•°æ®ç”Ÿæ€","slug":"å¤§æ•°æ®ç”Ÿæ€","permalink":"https://shang.at/tags/å¤§æ•°æ®ç”Ÿæ€/"}]},{"title":"javaå­¦ä¹ -åº•å±‚çŸ¥è¯†æ€»ç»“","slug":"javaå­¦ä¹ -åº•å±‚çŸ¥è¯†æ€»ç»“","date":"2020-06-13T00:20:45.000Z","updated":"2020-06-13T02:18:33.907Z","comments":true,"path":"post/javaå­¦ä¹ -åº•å±‚çŸ¥è¯†æ€»ç»“/","link":"","permalink":"https://shang.at/post/javaå­¦ä¹ -åº•å±‚çŸ¥è¯†æ€»ç»“/","excerpt":"","text":"JVMJVMï¼šJava Virtual Machine JMMï¼šJava Memory Model 1ï¼šJVMåŸºç¡€çŸ¥è¯† ä»€ä¹ˆæ˜¯JVM å¸¸è§çš„JVM 2ï¼šClassFileFormat3ï¼šç±»ç¼–è¯‘-åŠ è½½-åˆå§‹åŒ–hashcodeé”çš„ä¿¡æ¯ï¼ˆ2ä½ å››ç§ç»„åˆï¼‰GCä¿¡æ¯ï¼ˆå¹´é¾„ï¼‰å¦‚æœæ˜¯æ•°ç»„ï¼Œæ•°ç»„çš„é•¿åº¦ 4ï¼šJMMnew Cat()pointer -&gt; Cat.classå¯»æ‰¾æ–¹æ³•çš„ä¿¡æ¯ 5ï¼šå¯¹è±¡1ï¼šå¥æŸ„æ±  ï¼ˆæŒ‡é’ˆæ± ï¼‰é—´æ¥æŒ‡é’ˆï¼ŒèŠ‚çœå†…å­˜2ï¼šç›´æ¥æŒ‡é’ˆï¼Œè®¿é—®é€Ÿåº¦å¿« 6ï¼šGCåŸºç¡€çŸ¥è¯†æ ˆä¸Šåˆ†é…TLABï¼ˆThread Local Allocation Bufferï¼‰OldEdenè€ä¸æ­» - &gt; Old 7ï¼šGCå¸¸ç”¨åƒåœ¾å›æ”¶å™¨new Object()markword 8ä¸ªå­—èŠ‚ç±»å‹æŒ‡é’ˆ 8ä¸ªå­—èŠ‚å®ä¾‹å˜é‡ 0è¡¥é½ 016å­—èŠ‚ï¼ˆå‹ç¼© éå‹ç¼©ï¼‰Object o8ä¸ªå­—èŠ‚JVMå‚æ•°æŒ‡å®šå‹ç¼©æˆ–éå‹ç¼©","categories":[{"name":"JAVAå­¦ä¹ ","slug":"JAVAå­¦ä¹ ","permalink":"https://shang.at/categories/JAVAå­¦ä¹ /"}],"tags":[{"name":"javaåº•å±‚","slug":"javaåº•å±‚","permalink":"https://shang.at/tags/javaåº•å±‚/"}]},{"title":"javaå­¦ä¹ -åŸºç¡€1-classæ–‡ä»¶æ ¼å¼","slug":"javaå­¦ä¹ -åŸºç¡€1-classæ–‡ä»¶æ ¼å¼","date":"2020-06-13T00:12:38.000Z","updated":"2020-12-11T08:20:27.279Z","comments":true,"path":"post/javaå­¦ä¹ -åŸºç¡€1-classæ–‡ä»¶æ ¼å¼/","link":"","permalink":"https://shang.at/post/javaå­¦ä¹ -åŸºç¡€1-classæ–‡ä»¶æ ¼å¼/","excerpt":"","text":"ä»€ä¹ˆæ˜¯JVMï¼Ÿ jvmä¸javaæ²¡æœ‰å…³ç³»ï¼Œä»»ä½•èƒ½ç¿»è¯‘æˆclassæ–‡ä»¶çš„è¯­è¨€ï¼Œéƒ½èƒ½è¿è¡Œåœ¨jvmä¸Š JDK JRE JVM Class File Formatæ ·ä¾‹ä»£ç ï¼šéå¸¸ç®€å•ï¼Œåªæœ‰ä¸€ä¸ªç±»å‹çš„å£°æ˜ 1234package com.mashibing.jvm.c1_bytecode;public class T0100_ByteCode01 &#123;&#125; ç¼–è¯‘å®Œä¹‹åï¼Œåœ¨ç”¨IDEAæ‰“å¼€ï¼šä¼šå‘ç°ï¼Œè¢«è‡ªåŠ¨åŠ äº†ä¸€ä¸ªæ— å‚çš„æ„é€ æ–¹æ³• 1234567891011//// Source code recreated from a .class file by IntelliJ IDEA// (powered by Fernflower decompiler)//package com.mashibing.jvm.c1_bytecode;public class T0100_ByteCode01 &#123; public T0100_ByteCode01() &#123; &#125;&#125; ç„¶åæˆ‘ä»¬ä½¿ç”¨ä¸€ç§èƒ½æŸ¥çœ‹äºŒè¿›åˆ¶æ–‡ä»¶çš„è½¯ä»¶æ‰“å¼€è¯¥classæ–‡ä»¶ï¼Œ(æˆ‘è¿™é‡Œç”¨çš„æ˜¯sublime)ã€‚ä¼šå¾—åˆ°å¦‚ä¸‹çš„16è¿›åˆ¶æ˜¾ç¤ºï¼š 123456789101112131415161718192021cafe babe 0000 0034 0010 0a00 0300 0d07000e 0700 0f01 0006 3c69 6e69 743e 01000328 2956 0100 0443 6f64 6501 000f 4c696e65 4e75 6d62 6572 5461 626c 6501 00124c6f 6361 6c56 6172 6961 626c 6554 61626c65 0100 0474 6869 7301 0030 4c63 6f6d2f6d 6173 6869 6269 6e67 2f6a 766d 2f63315f 6279 7465 636f 6465 2f54 3031 30305f42 7974 6543 6f64 6530 313b 0100 0a536f75 7263 6546 696c 6501 0015 5430 3130305f 4279 7465 436f 6465 3031 2e6a 6176610c 0004 0005 0100 2e63 6f6d 2f6d 61736869 6269 6e67 2f6a 766d 2f63 315f 62797465 636f 6465 2f54 3031 3030 5f42 79746543 6f64 6530 3101 0010 6a61 7661 2f6c616e 672f 4f62 6a65 6374 0021 0002 00030000 0000 0001 0001 0004 0005 0001 00060000 002f 0001 0001 0000 0005 2ab7 0001b100 0000 0200 0700 0000 0600 0100 00000300 0800 0000 0c00 0100 0000 0500 09000a00 0000 0100 0b00 0000 0200 0c ç»“æ„å¦‚ä¸‹ï¼šclassæ–‡ä»¶å°±æ˜¯æŒ‰ç…§å¦‚ä¸‹çš„é¡ºåºç´§å‡‘çš„æ‹¼åœ¨ä¸€èµ·çš„ Magic Number 4å­—èŠ‚ é­”æ•° å¯ä»¥è®¤ä¸ºæ˜¯æ–‡ä»¶ç±»å‹ï¼šä»¥cafe babeå¼€å¤´çš„æ–‡ä»¶åˆ™ä¸ºclassç±»å‹çš„æ–‡ä»¶ classæ–‡ä»¶çš„å‰4ä¸ªå­—èŠ‚ï¼šcafe babe Minor Version 2å­—èŠ‚ å°ç‰ˆæœ¬ï¼š0000 å°æ•°ç‚¹åçš„æ•°å€¼ Major Version 2å­—èŠ‚ å¤§ç‰ˆæœ¬ï¼š0034 å°æ•°ç‚¹å‰çš„æ•°å€¼ classæ–‡ä»¶çš„ç‰ˆæœ¬å·ï¼š JDK1.7é»˜è®¤ä¸º51.0ã€JDK1.8é»˜è®¤ä¸º52.0 constant_pool_count 2å­—èŠ‚ å¸¸é‡æ± å¤§å° constant_poolï¼šé•¿åº¦ä¸ºconstan_pool_count-1çš„è¡¨ æ ¹æ®å¸¸é‡æ± å¤§å° ä¸æ˜¯å›ºå®šçš„ å¸¸é‡æ± è¡¨ å¸¸é‡æ± åºå·ä»#1å¼€å§‹ å¸¸é‡æ± çš„æ¯ç§å…ƒç´ å ç”¨çš„å­—èŠ‚æ•°å¯èƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œä½†æ˜¯æ¯ä¸ªå…ƒç´ çš„ç¬¬ä¸€ä¸ªå­—èŠ‚è¡¨ç¤ºçš„æ˜¯å½“å‰å…ƒç´ çš„ç±»å‹(tag)ï¼Œç„¶åå†æ ¹æ®å½“å‰å…ƒç´ çš„ç±»å‹å¯ä»¥å¾—åˆ°è¯¥å…ƒç´ å ç”¨çš„å­—èŠ‚æ•° ä¸€ä¸ªå…ƒç´ è¯»å®Œä¹‹åç«‹å³è·Ÿç€ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œä¸­é—´æ²¡æœ‰ç©ºé—² å¸¸é‡æ± ä¸­æ¯ç§å…ƒç´ å¯¹åº”çš„å«ä¹‰ 1 CONSTANT_Utf8_info tag: 1 Lengthï¼šutf8å­—ç¬¦ä¸²å ç”¨çš„å­—èŠ‚æ•° bytesï¼šé•¿åº¦ä¸ºlengthçš„å­—ç¬¦ä¸² 3 7 CONSTANT_Class_info tag: 7 Indexï¼š2å­—èŠ‚ ç±»çš„å…¨é™å®šåçš„ å¸¸é‡æ± ç´¢å¼• å…¨é™å®šåä¾‹å­å¦‚ä¸‹ï¼šcom/mashibing/jvm/c1_bytecode/T0100_ByteCode01 8 CONSTANT_String_info tagï¼š8 indexï¼š2å­—èŠ‚ æŒ‡å‘å­—ç¬¦ä¸²å­—é¢é‡çš„ å¸¸é‡æ± ç´¢å¼• 10 CONSTANT_Methodref_info Tagï¼š10 indexï¼š2å­—èŠ‚ æŒ‡å‘å£°æ˜æ–¹æ³•çš„ç±»æˆ–è€…æ¥å£æè¿°ç¬¦CONSTANT_Class_infoçš„å¸¸é‡æ± ç´¢å¼• indexï¼š2å­—èŠ‚ æŒ‡å‘å­—æ®µæè¿°ç¬¦CONSTANT_NameAndTypeçš„å¸¸é‡æ± ç´¢å¼• 12 CONSTANT_NameAndType_info tagï¼š12 Indexï¼š2å­—èŠ‚ æŒ‡å‘è¯¥å­—æ®µæˆ–æ–¹æ³•åç§°çš„ å¸¸é‡æ± ç´¢å¼• indexï¼š2å­—èŠ‚ æŒ‡å‘è¯¥å­—æ®µæˆ–æ–¹æ³•æè¿°ç¬¦çš„ å¸¸é‡æ± ç´¢å¼• access_flagsï¼šè®¿é—®æ ‡è®° 2å­—èŠ‚ ACC_PUBLIC 0x0001 æ˜¯å¦ä¸ºpublicç±»å‹ ACC_FINAL 0x0010 æ˜¯å¦ä¸ºfinal ACC_SUPER 0x0020 è¯¥æ ‡å¿—å¿…é¡»ä¸ºçœŸï¼ŒJDK1.0.2ä¹‹åç¼–è¯‘å‡ºæ¥çš„å†…å®¹å¿…é¡»ä¸ºçœŸï¼ŒæŒ‡æ˜invokespecialæŒ‡ä»¤ä½¿ç”¨æ–°è¯­ä¹‰ ACC_INTERFACE 0x0200 æ˜¯å¦ä¸ºæ¥å£ ACC_ABSTRACT 0x0400 æ˜¯å¦ä¸ºæŠ½è±¡ç±» ACC_SYNTHETIC 0x1000ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆï¼Œéç”¨æˆ·ä»£ç  ACC_ANNOTATION 0x2000 æ˜¯å¦ä¸ºæ³¨è§£ ACC_ENUM 0x4000 æ˜¯å¦ä¸ºæšä¸¾ç±»å‹ this_classï¼šå½“å‰ç±»çš„åç§° 2å­—èŠ‚ indexï¼š2å­—èŠ‚ æŒ‡å‘ç±»å‹æè¿°ç¬¦CONSTANT_Class_infoçš„å¸¸é‡æ± ç´¢å¼• super_classï¼šçˆ¶ç±»çš„åç§° 2å­—èŠ‚ indexï¼š2å­—èŠ‚ æŒ‡å‘ç±»å‹æè¿°ç¬¦CONSTANT_Class_infoçš„å¸¸é‡æ± ç´¢å¼• interfaces_countï¼šå®ç°çš„æ¥å£æ•°é‡ 2å­—èŠ‚ interfaces å®ç°çš„å…·ä½“æ¥å£åˆ—è¡¨ fields_countï¼šå­—æ®µæ•°é‡ 2å­—èŠ‚ fieldsï¼šå­—æ®µåˆ—è¡¨ access_flags 2å­—èŠ‚ ACC_PUBLIC 0x0001 ACC_PRIVATE 0x0002 ACC_PROTECTED 0x0004 ACC_STATIC 0x0008 ACC_FINAL 0x0010 ACC_VOLATILE 0x0040 ACC_TRANSIENT 0x0080 ACC_SYNTHETIC 0x1000 ACC_ENUM 0x4000 name_index 2å­—èŠ‚ decriptor_index 2å­—èŠ‚ B byte C char D double F float I int J long S short Z boolean V void L Object ï¼š Lcom/mashibing/jvm/Test [ æ•°ç»„ ä¸€ç»´ [B [Ljava/lang/String äºŒç»´ [[C [[Ljava/lang/String attribubtes_count 2å­—èŠ‚ attributes methods_countï¼šæ–¹æ³•æ•°é‡ 2å­—èŠ‚ methodsï¼šæ–¹æ³•åˆ—è¡¨ access_flag 2å­—èŠ‚ name_index 2å­—èŠ‚ descriptor_index 2å­—èŠ‚ attribute_count 2å­—èŠ‚ attributes attributes_count - u2 é™„åŠ å±æ€§æ•°é‡ attributesï¼šé™„åŠ å±æ€§åˆ—è¡¨ æ—¢æœ‰é¢„å®šä¹‰çš„å±æ€§ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰ï¼Œjavaè™šæ‹Ÿæœºè‡ªåŠ¨å¿½ç•¥ä¸è®¤è¯†çš„å±æ€§ code - æ–¹æ³•è¡¨ - è¯¥æ–¹æ³•ç¼–è¯‘çš„å­—èŠ‚ç æŒ‡ä»¤ ConstantValue - å­—æ®µè¡¨ - finalå…³é”®å­—å®šä¹‰çš„å¸¸é‡å€¼ Deprecated - ç±»ã€æ–¹æ³•è¡¨ã€å­—æ®µè¡¨ Exceptions - æ–¹æ³•è¡¨ EnclosingMethod - ç±»æ–‡ä»¶ - å±€éƒ¨ç±»æˆ–åŒ¿åç±»çš„å¤–éƒ¨å°è£…æ–¹æ³• InnerClass - ç±»æ–‡ä»¶ - å†…éƒ¨ç±»åˆ—è¡¨ LineNumberTable - Codeå±æ€§ - javaæºç çš„è¡Œå·ä¸å­—èŠ‚ç æŒ‡ä»¤çš„å¯¹åº”å…³ç³» LocalVariableTable - Codeå±æ€§ - æ–¹æ³•å±€éƒ¨å˜é‡è¡¨ SourceFile - ç±»æ–‡ä»¶ - æºæ–‡ä»¶å","categories":[{"name":"JAVAå­¦ä¹ ","slug":"JAVAå­¦ä¹ ","permalink":"https://shang.at/categories/JAVAå­¦ä¹ /"}],"tags":[{"name":"classæ–‡ä»¶æ ¼å¼","slug":"classæ–‡ä»¶æ ¼å¼","permalink":"https://shang.at/tags/classæ–‡ä»¶æ ¼å¼/"}]},{"title":"Pythonå­¦ä¹ -metaclasså®ç°å•ä¾‹","slug":"Pythonå­¦ä¹ -metaclasså®ç°å•ä¾‹","date":"2020-06-12T01:35:16.000Z","updated":"2020-11-26T02:27:38.986Z","comments":true,"path":"post/Pythonå­¦ä¹ -metaclasså®ç°å•ä¾‹/","link":"","permalink":"https://shang.at/post/Pythonå­¦ä¹ -metaclasså®ç°å•ä¾‹/","excerpt":"","text":"å•ä¾‹æ¨¡å¼å•ä¾‹æ¨¡å¼ï¼ˆSingleton Patternï¼‰æ˜¯ä¸€ç§å¸¸ç”¨çš„è½¯ä»¶è®¾è®¡æ¨¡å¼ï¼Œè¯¥æ¨¡å¼çš„ä¸»è¦ç›®çš„æ˜¯ç¡®ä¿æŸä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹å­˜åœ¨ã€‚å½“ä½ å¸Œæœ›åœ¨æ•´ä¸ªç³»ç»Ÿä¸­ï¼ŒæŸä¸ªç±»åªèƒ½å‡ºç°ä¸€ä¸ªå®ä¾‹æ—¶ï¼Œå•ä¾‹å¯¹è±¡å°±èƒ½æ´¾ä¸Šç”¨åœºã€‚ æ¯”å¦‚ï¼ŒæŸä¸ªæœåŠ¡å™¨ç¨‹åºçš„é…ç½®ä¿¡æ¯å­˜æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå®¢æˆ·ç«¯é€šè¿‡ä¸€ä¸ª AppConfig çš„ç±»æ¥è¯»å–é…ç½®æ–‡ä»¶çš„ä¿¡æ¯ã€‚å¦‚æœåœ¨ç¨‹åºè¿è¡ŒæœŸé—´ï¼Œæœ‰å¾ˆå¤šåœ°æ–¹éƒ½éœ€è¦ä½¿ç”¨é…ç½®æ–‡ä»¶çš„å†…å®¹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¾ˆå¤šåœ°æ–¹éƒ½éœ€è¦åˆ›å»º AppConfig å¯¹è±¡çš„å®ä¾‹ï¼Œè¿™å°±å¯¼è‡´ç³»ç»Ÿä¸­å­˜åœ¨å¤šä¸ª AppConfig çš„å®ä¾‹å¯¹è±¡ï¼Œè€Œè¿™æ ·ä¼šä¸¥é‡æµªè´¹å†…å­˜èµ„æºï¼Œå°¤å…¶æ˜¯åœ¨é…ç½®æ–‡ä»¶å†…å®¹å¾ˆå¤šçš„æƒ…å†µä¸‹ã€‚äº‹å®ä¸Šï¼Œç±»ä¼¼ AppConfig è¿™æ ·çš„ç±»ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨ç¨‹åºè¿è¡ŒæœŸé—´åªå­˜åœ¨ä¸€ä¸ªå®ä¾‹å¯¹è±¡ã€‚ åœ¨ Python ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å¤šç§æ–¹æ³•æ¥å®ç°å•ä¾‹æ¨¡å¼ å®ç°å•ä¾‹æ¨¡å¼çš„å‡ ç§æ–¹å¼1.ä½¿ç”¨æ¨¡å—å…¶å®ï¼ŒPython çš„æ¨¡å—å°±æ˜¯å¤©ç„¶çš„å•ä¾‹æ¨¡å¼ï¼Œå› ä¸ºæ¨¡å—åœ¨ç¬¬ä¸€æ¬¡å¯¼å…¥æ—¶ï¼Œä¼šç”Ÿæˆ .pyc æ–‡ä»¶ï¼Œå½“ç¬¬äºŒæ¬¡å¯¼å…¥æ—¶ï¼Œå°±ä¼šç›´æ¥åŠ è½½ .pyc æ–‡ä»¶ï¼Œè€Œä¸ä¼šå†æ¬¡æ‰§è¡Œæ¨¡å—ä»£ç ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åªéœ€æŠŠç›¸å…³çš„å‡½æ•°å’Œæ•°æ®å®šä¹‰åœ¨ä¸€ä¸ªæ¨¡å—ä¸­ï¼Œå°±å¯ä»¥è·å¾—ä¸€ä¸ªå•ä¾‹å¯¹è±¡äº†ã€‚å¦‚æœæˆ‘ä»¬çœŸçš„æƒ³è¦ä¸€ä¸ªå•ä¾‹ç±»ï¼Œå¯ä»¥è€ƒè™‘è¿™æ ·åšï¼š mysingleton.py 1234class Singleton(object): def foo(self): passsingleton = Singleton() å°†ä¸Šé¢çš„ä»£ç ä¿å­˜åœ¨æ–‡ä»¶ mysingleton.py ä¸­ï¼Œè¦ä½¿ç”¨æ—¶ï¼Œç›´æ¥åœ¨å…¶ä»–æ–‡ä»¶ä¸­å¯¼å…¥æ­¤æ–‡ä»¶ä¸­çš„å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å³æ˜¯å•ä¾‹æ¨¡å¼çš„å¯¹è±¡ 1from a import singleton 2.ä½¿ç”¨è£…é¥°å™¨123456789101112131415161718192021def Singleton(cls): _instance = &#123;&#125; def _singleton(*args, **kargs): if cls not in _instance: _instance[cls] = cls(*args, **kargs) return _instance[cls] return _singleton@Singletonclass A(object): a = 1 def __init__(self, x=0): self.x = xa1 = A(2)a2 = A(3) 3.ä½¿ç”¨ç±»12345678910class Singleton(object): def __init__(self): pass @classmethod def instance(cls, *args, **kwargs): if not hasattr(Singleton, \"_instance\"): Singleton._instance = Singleton(*args, **kwargs) return Singleton._instance ä¸€èˆ¬æƒ…å†µï¼Œå¤§å®¶ä»¥ä¸ºè¿™æ ·å°±å®Œæˆäº†å•ä¾‹æ¨¡å¼ï¼Œä½†æ˜¯è¿™æ ·å½“ä½¿ç”¨å¤šçº¿ç¨‹æ—¶ä¼šå­˜åœ¨é—®é¢˜ 1234567891011121314151617181920class Singleton(object): def __init__(self): pass @classmethod def instance(cls, *args, **kwargs): if not hasattr(Singleton, \"_instance\"): Singleton._instance = Singleton(*args, **kwargs) return Singleton._instanceimport threadingdef task(arg): obj = Singleton.instance() print(obj)for i in range(10): t = threading.Thread(target=task,args=[i,]) t.start() ç¨‹åºæ‰§è¡Œåï¼Œæ‰“å°ç»“æœå¦‚ä¸‹ï¼š 12345678910&lt;__main__.Singleton object at 0x02C933D0&gt;&lt;__main__.Singleton object at 0x02C933D0&gt;&lt;__main__.Singleton object at 0x02C933D0&gt;&lt;__main__.Singleton object at 0x02C933D0&gt;&lt;__main__.Singleton object at 0x02C933D0&gt;&lt;__main__.Singleton object at 0x02C933D0&gt;&lt;__main__.Singleton object at 0x02C933D0&gt;&lt;__main__.Singleton object at 0x02C933D0&gt;&lt;__main__.Singleton object at 0x02C933D0&gt;&lt;__main__.Singleton object at 0x02C933D0&gt; çœ‹èµ·æ¥ä¹Ÿæ²¡æœ‰é—®é¢˜ï¼Œé‚£æ˜¯å› ä¸ºæ‰§è¡Œé€Ÿåº¦è¿‡å¿«ï¼Œå¦‚æœåœ¨initæ–¹æ³•ä¸­æœ‰ä¸€äº›IOæ“ä½œï¼Œå°±ä¼šå‘ç°é—®é¢˜äº†ï¼Œä¸‹é¢æˆ‘ä»¬é€šè¿‡time.sleepæ¨¡æ‹Ÿ æˆ‘ä»¬åœ¨ä¸Šé¢initæ–¹æ³•ä¸­åŠ å…¥ä»¥ä¸‹ä»£ç ï¼š 123def __init__(self): import time time.sleep(1) é‡æ–°æ‰§è¡Œç¨‹åºåï¼Œç»“æœå¦‚ä¸‹ 12345678910&lt;__main__.Singleton object at 0x034A3410&gt;&lt;__main__.Singleton object at 0x034BB990&gt;&lt;__main__.Singleton object at 0x034BB910&gt;&lt;__main__.Singleton object at 0x034ADED0&gt;&lt;__main__.Singleton object at 0x034E6BD0&gt;&lt;__main__.Singleton object at 0x034E6C10&gt;&lt;__main__.Singleton object at 0x034E6B90&gt;&lt;__main__.Singleton object at 0x034BBA30&gt;&lt;__main__.Singleton object at 0x034F6B90&gt;&lt;__main__.Singleton object at 0x034E6A90&gt; é—®é¢˜å‡ºç°äº†ï¼æŒ‰ç…§ä»¥ä¸Šæ–¹å¼åˆ›å»ºçš„å•ä¾‹ï¼Œæ— æ³•æ”¯æŒå¤šçº¿ç¨‹ è§£å†³åŠæ³•ï¼šåŠ é”ï¼æœªåŠ é”éƒ¨åˆ†å¹¶å‘æ‰§è¡Œ,åŠ é”éƒ¨åˆ†ä¸²è¡Œæ‰§è¡Œ,é€Ÿåº¦é™ä½,ä½†æ˜¯ä¿è¯äº†æ•°æ®å®‰å…¨ 12345678910111213141516171819202122232425import timeimport threadingclass Singleton(object): _instance_lock = threading.Lock() def __init__(self): time.sleep(1) @classmethod def instance(cls, *args, **kwargs): with Singleton._instance_lock: if not hasattr(Singleton, \"_instance\"): Singleton._instance = Singleton(*args, **kwargs) return Singleton._instancedef task(arg): obj = Singleton.instance() print(obj)for i in range(10): t = threading.Thread(target=task,args=[i,]) t.start()time.sleep(20)obj = Singleton.instance()print(obj) æ‰“å°ç»“æœå¦‚ä¸‹ï¼š 12345678910&lt;__main__.Singleton object at 0x02D6B110&gt;&lt;__main__.Singleton object at 0x02D6B110&gt;&lt;__main__.Singleton object at 0x02D6B110&gt;&lt;__main__.Singleton object at 0x02D6B110&gt;&lt;__main__.Singleton object at 0x02D6B110&gt;&lt;__main__.Singleton object at 0x02D6B110&gt;&lt;__main__.Singleton object at 0x02D6B110&gt;&lt;__main__.Singleton object at 0x02D6B110&gt;&lt;__main__.Singleton object at 0x02D6B110&gt;&lt;__main__.Singleton object at 0x02D6B110&gt; è¿™æ ·å°±å·®ä¸å¤šäº†ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸€ç‚¹å°é—®é¢˜ï¼Œå°±æ˜¯å½“ç¨‹åºæ‰§è¡Œæ—¶ï¼Œæ‰§è¡Œäº†time.sleep(20)åï¼Œä¸‹é¢å®ä¾‹åŒ–å¯¹è±¡æ—¶ï¼Œæ­¤æ—¶å·²ç»æ˜¯å•ä¾‹æ¨¡å¼äº†ï¼Œä½†æˆ‘ä»¬è¿˜æ˜¯åŠ äº†é”ï¼Œè¿™æ ·ä¸å¤ªå¥½ï¼Œå†è¿›è¡Œä¸€äº›ä¼˜åŒ–ï¼ŒæŠŠintanceæ–¹æ³•ï¼Œæ”¹æˆä¸‹é¢çš„è¿™æ ·å°±è¡Œï¼š 1234567@classmethoddef instance(cls, *args, **kwargs): if not hasattr(Singleton, \"_instance\"): with Singleton._instance_lock: if not hasattr(Singleton, \"_instance\"): Singleton._instance = Singleton(*args, **kwargs) return Singleton._instance è¿™æ ·ï¼Œä¸€ä¸ªå¯ä»¥æ”¯æŒå¤šçº¿ç¨‹çš„å•ä¾‹æ¨¡å¼å°±å®Œæˆäº†ã€‚ è¿™ä¹Ÿå°±æ˜¯å¤§åé¼é¼çš„DCL 1234567891011121314151617181920212223242526import timeimport threadingclass Singleton(object): _instance_lock = threading.Lock() def __init__(self): time.sleep(1) @classmethod def instance(cls, *args, **kwargs): if not hasattr(Singleton, \"_instance\"): with Singleton._instance_lock: if not hasattr(Singleton, \"_instance\"): Singleton._instance = Singleton(*args, **kwargs) return Singleton._instancedef task(arg): obj = Singleton.instance() print(obj)for i in range(10): t = threading.Thread(target=task,args=[i,]) t.start()time.sleep(20)obj = Singleton.instance()print(obj) è¿™ç§æ–¹å¼å®ç°çš„å•ä¾‹æ¨¡å¼ï¼Œä½¿ç”¨æ—¶ä¼šæœ‰é™åˆ¶ï¼Œä»¥åå®ä¾‹åŒ–å¿…é¡»é€šè¿‡ obj = Singleton.instance() å¦‚æœç”¨ obj=Singleton() ,è¿™ç§æ–¹å¼å¾—åˆ°çš„ä¸æ˜¯å•ä¾‹ 4.åŸºäºnewæ–¹æ³•å®ç°ï¼ˆæ¨èä½¿ç”¨ï¼Œæ–¹ä¾¿ï¼‰é€šè¿‡ä¸Šé¢ä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå½“æˆ‘ä»¬å®ç°å•ä¾‹æ—¶ï¼Œä¸ºäº†ä¿è¯çº¿ç¨‹å®‰å…¨éœ€è¦åœ¨å†…éƒ¨åŠ å…¥é” æˆ‘ä»¬çŸ¥é“ï¼Œå½“æˆ‘ä»¬å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œæ˜¯å…ˆæ‰§è¡Œäº†ç±»çš„newæ–¹æ³•ï¼ˆæˆ‘ä»¬æ²¡å†™æ—¶ï¼Œé»˜è®¤è°ƒç”¨object.newï¼‰ï¼Œå®ä¾‹åŒ–å¯¹è±¡ï¼›ç„¶åå†æ‰§è¡Œç±»çš„initæ–¹æ³•ï¼Œå¯¹è¿™ä¸ªå¯¹è±¡è¿›è¡Œåˆå§‹åŒ–ï¼Œæ‰€æœ‰æˆ‘ä»¬å¯ä»¥åŸºäºè¿™ä¸ªï¼Œå®ç°å•ä¾‹æ¨¡å¼ 1234567891011121314151617181920212223242526import threadingclass Singleton(object): _instance_lock = threading.Lock() def __init__(self): pass def __new__(cls, *args, **kwargs): if not hasattr(Singleton, \"_instance\"): with Singleton._instance_lock: if not hasattr(Singleton, \"_instance\"): Singleton._instance = object.__new__(cls) return Singleton._instanceobj1 = Singleton()obj2 = Singleton()print(obj1,obj2)def task(arg): obj = Singleton() print(obj)for i in range(10): t = threading.Thread(target=task,args=[i,]) t.start() æ‰“å°ç»“æœå¦‚ä¸‹ï¼š 1234567891011&lt;__main__.Singleton object at 0x038B33D0&gt; &lt;__main__.Singleton object at 0x038B33D0&gt;&lt;__main__.Singleton object at 0x038B33D0&gt;&lt;__main__.Singleton object at 0x038B33D0&gt;&lt;__main__.Singleton object at 0x038B33D0&gt;&lt;__main__.Singleton object at 0x038B33D0&gt;&lt;__main__.Singleton object at 0x038B33D0&gt;&lt;__main__.Singleton object at 0x038B33D0&gt;&lt;__main__.Singleton object at 0x038B33D0&gt;&lt;__main__.Singleton object at 0x038B33D0&gt;&lt;__main__.Singleton object at 0x038B33D0&gt;&lt;__main__.Singleton object at 0x038B33D0&gt; é‡‡ç”¨è¿™ç§æ–¹å¼çš„å•ä¾‹æ¨¡å¼ï¼Œä»¥åå®ä¾‹åŒ–å¯¹è±¡æ—¶ï¼Œå’Œå¹³æ—¶å®ä¾‹åŒ–å¯¹è±¡çš„æ–¹æ³•ä¸€æ · obj = Singleton() 5.åŸºäºmetaclassæ–¹å¼å®ç°ç›¸å…³çŸ¥è¯† 1234\"\"\"1.ç±»ç”±typeåˆ›å»ºï¼Œåˆ›å»ºç±»æ—¶ï¼Œtypeçš„__init__æ–¹æ³•è‡ªåŠ¨æ‰§è¡Œï¼Œç±»() æ‰§è¡Œtypeçš„ __call__æ–¹æ³•(ç±»çš„__new__æ–¹æ³•,ç±»çš„__init__æ–¹æ³•)2.å¯¹è±¡ç”±ç±»åˆ›å»ºï¼Œåˆ›å»ºå¯¹è±¡æ—¶ï¼Œç±»çš„__init__æ–¹æ³•è‡ªåŠ¨æ‰§è¡Œï¼Œå¯¹è±¡()æ‰§è¡Œç±»çš„ __call__ æ–¹æ³•\"\"\" ä¾‹å­ï¼š 1234567891011class Foo: def __init__(self): pass def __call__(self, *args, **kwargs): passobj = Foo()# æ‰§è¡Œtypeçš„ __call__ æ–¹æ³•ï¼Œè°ƒç”¨ Fooç±»ï¼ˆæ˜¯typeçš„å¯¹è±¡ï¼‰çš„ __new__æ–¹æ³•ï¼Œç”¨äºåˆ›å»ºå¯¹è±¡ï¼Œç„¶åè°ƒç”¨ Fooç±»ï¼ˆæ˜¯typeçš„å¯¹è±¡ï¼‰çš„ __init__æ–¹æ³•ï¼Œç”¨äºå¯¹å¯¹è±¡åˆå§‹åŒ–ã€‚obj() # æ‰§è¡ŒFooçš„ __call__ æ–¹æ³• å…ƒç±»çš„ä½¿ç”¨1234567891011121314151617class SingletonType(type): def __init__(self,*args,**kwargs): super(SingletonType,self).__init__(*args,**kwargs) def __call__(cls, *args, **kwargs): # è¿™é‡Œçš„clsï¼Œå³Fooç±» print('cls',cls) obj = cls.__new__(cls,*args, **kwargs) cls.__init__(obj,*args, **kwargs) # Foo.__init__(obj) return objclass Foo(metaclass=SingletonType): # æŒ‡å®šåˆ›å»ºFooçš„typeä¸ºSingletonType def __init__(selfï¼Œname): self.name = name def __new__(cls, *args, **kwargs): return object.__new__(cls)obj = Foo('xx') å®ç°å•ä¾‹æ¨¡å¼12345678910111213141516171819import threadingclass SingletonType(type): _instance_lock = threading.Lock() def __call__(cls, *args, **kwargs): if not hasattr(cls, \"_instance\"): with SingletonType._instance_lock: if not hasattr(cls, \"_instance\"): cls._instance = super(SingletonType,cls).__call__(*args, **kwargs) return cls._instanceclass Foo(metaclass=SingletonType): def __init__(self,name): self.name = nameobj1 = Foo('name')obj2 = Foo('name')print(obj1,obj2) å¯¹äºLockå¯¹è±¡è€Œè¨€ï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹è¿ç»­ä¸¤æ¬¡releaseï¼Œä½¿å¾—çº¿ç¨‹æ­»é”ã€‚æ‰€ä»¥Lockä¸å¸¸ç”¨ï¼Œä¸€èˆ¬é‡‡ç”¨Rlockè¿›è¡Œçº¿ç¨‹é”çš„è®¾å®šã€‚ å»–é›ªå³°-mateclass","categories":[],"tags":[]},{"title":"javaå­¦ä¹ -è¿è¡Œæ—¶çº¿ç¨‹","slug":"javaå­¦ä¹ -è¿è¡Œæ—¶çº¿ç¨‹","date":"2020-06-11T03:40:56.000Z","updated":"2020-06-11T03:52:13.279Z","comments":true,"path":"post/javaå­¦ä¹ -è¿è¡Œæ—¶çº¿ç¨‹/","link":"","permalink":"https://shang.at/post/javaå­¦ä¹ -è¿è¡Œæ—¶çº¿ç¨‹/","excerpt":"","text":"ä¸€ä¸ªJavaè¿›ç¨‹å¯åŠ¨ä¹‹åï¼Œè‡³å°‘ä¼šåˆ›å»ºä»¥ä¸‹å‡ ä¸ªçº¿ç¨‹ï¼š main Finalizer Reference Handler Signal Dispatcher Others: ç”¨æˆ·è‡ªå·±åˆ›å»ºçš„çº¿ç¨‹","categories":[{"name":"JAVAå­¦ä¹ ","slug":"JAVAå­¦ä¹ ","permalink":"https://shang.at/categories/JAVAå­¦ä¹ /"}],"tags":[{"name":"è¿è¡Œæ—¶çº¿ç¨‹","slug":"è¿è¡Œæ—¶çº¿ç¨‹","permalink":"https://shang.at/tags/è¿è¡Œæ—¶çº¿ç¨‹/"}]},{"title":"æ•°æ®ç»“æ„ä¸ç®—æ³•å­¦ä¹ ç¬”è®°-JOINçš„ç®—æ³•å®ç°","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•å­¦ä¹ ç¬”è®°-JOINçš„ç®—æ³•å®ç°","date":"2020-06-10T06:40:09.000Z","updated":"2020-07-13T13:33:48.925Z","comments":true,"path":"post/æ•°æ®ç»“æ„ä¸ç®—æ³•å­¦ä¹ ç¬”è®°-JOINçš„ç®—æ³•å®ç°/","link":"","permalink":"https://shang.at/post/æ•°æ®ç»“æ„ä¸ç®—æ³•å­¦ä¹ ç¬”è®°-JOINçš„ç®—æ³•å®ç°/","excerpt":"https://www.infoq.cn/article/6XGx92FyQ45cMXpj2mgZ","text":"https://www.infoq.cn/article/6XGx92FyQ45cMXpj2mgZ JOIN(INNER JOIN) å†…è¿æ¥ï¼šå·¦å³ä¸¤ä¸ªé›†åˆçš„äº¤é›†ï¼Œåªä¿ç•™å·¦å³ä¸¤ä¸ªé›†åˆéƒ½æœ‰çš„å…ƒç´  å†…è¿æ¥çš„æ—¶å€™ä¼šå…ˆæ’åº(O($NlogN$))ï¼Œç„¶åå…³è”ä¸¤ä¸ªæœ‰åºé›†åˆ(O($N$)) 12 LEFT JOIN å·¦å¤–è¿æ¥ï¼šä»¥å·¦é›†åˆä¸ºä¸»ï¼Œå³é›†åˆä¸å­˜åœ¨çš„å…ƒç´ è¡¥null RIGHT JOIN å³å¤–è¿æ¥ï¼šä»¥å³é›†åˆä¸ºä¸»ï¼Œå·¦é›†åˆä¸å­˜åœ¨çš„å…ƒç´ è¡¥null FULL JOIN å…¨è¿æ¥ï¼šå·¦å³ä¸¤ä¸ªé›†åˆçš„å…¨é›†ï¼Œå…¶ä¸­ å·¦é›†åˆæœ‰ä½†æ˜¯å³é›†åˆä¸å­˜åœ¨çš„å…ƒç´ ï¼Œå³é›†åˆå¯¹åº”çš„å­—æ®µè¡¥nullï¼Œåä¹‹äº¦ç„¶ left_semi è¿‡æ»¤å‡ºå·¦é›†åˆä¸­å’Œå³é›†åˆå…±æœ‰çš„éƒ¨åˆ†ï¼Œåªè¿”å›å·¦é›†åˆä¸­çš„rows left_anti è¿‡æ»¤å‡ºå·¦é›†åˆä¸­ å³é›†åˆæ²¡æœ‰çš„éƒ¨åˆ†ï¼Œåªè¿”å›å·¦é›†åˆä¸­çš„rows","categories":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://shang.at/categories/æ•°æ®ç»“æ„ä¸ç®—æ³•/"}],"tags":[{"name":"JOINçš„ç®—æ³•å®ç°","slug":"JOINçš„ç®—æ³•å®ç°","permalink":"https://shang.at/tags/JOINçš„ç®—æ³•å®ç°/"}]},{"title":"javaå­¦ä¹ -JDKç¯å¢ƒåˆ‡æ¢","slug":"javaå­¦ä¹ -JDKç¯å¢ƒåˆ‡æ¢","date":"2020-06-10T05:40:50.000Z","updated":"2020-06-10T05:47:55.073Z","comments":true,"path":"post/javaå­¦ä¹ -JDKç¯å¢ƒåˆ‡æ¢/","link":"","permalink":"https://shang.at/post/javaå­¦ä¹ -JDKç¯å¢ƒåˆ‡æ¢/","excerpt":"","text":"è¿‘æœŸï¼ŒJDKç‰ˆæœ¬æ›´æ–°ååˆ†é¢‘ç¹ï¼Œå¦‚æœè¦æƒ³å¿«é€Ÿåˆ‡æ¢JDKç‰ˆæœ¬ï¼Œå¯ä»¥é€šè¿‡linuxçš„aliaså‘½ä»¤æ¥ç®€å•å®ç°ï¼š 12345678910111213141516# macç¯å¢ƒ# ~/.bash_profileexport JAVA_8_HOME=$(/usr/libexec/java_home -v 1.8)export JAVA_9_HOME=$(/usr/libexec/java_home -v 9)export JAVA_10_HOME=$(/usr/libexec/java_home -v 10)export JAVA_11_HOME=$(/usr/libexec/java_home -v 11)export JAVA_HOME=$JAVA_8_HOMEexport PATH=$JAVA_HOME/bin:$PATH# ~/.zshrc æ³¨æ„è¦æ”¾åˆ°~/.zshrcæ–‡ä»¶çš„æœ€ä¸‹é¢# multi jdk configalias jdk8=\"export PATH=$JAVA_8_HOME/bin:$PATH\"alias jdk9=\"export PATH=$JAVA_9_HOME/bin:$PATH\"alias jdk10=\"export PATH=$JAVA_10_HOME/bin:$PATH\"alias jdk11=\"export PATH=$JAVA_11_HOME/bin:$PATH\" é»˜è®¤ç¯å¢ƒä¸º 1234âœ ~ java -versionjava version \"1.8.0_144\"Java(TM) SE Runtime Environment (build 1.8.0_144-b01)Java HotSpot(TM) 64-Bit Server VM (build 25.144-b01, mixed mode) åˆ‡æ¢jdk9ä¹‹å 12345âœ ~ jdk9âœ ~ java -versionjava version \"9.0.4\"Java(TM) SE Runtime Environment (build 9.0.4+11)Java HotSpot(TM) 64-Bit Server VM (build 9.0.4+11, mixed mode) è¿™æ ·å°±å¯ä»¥åœ¨å½“å‰çš„terminal sessionä¸­ä½¿ç”¨jdk9çš„æ–°ç‰¹æ€§äº†ï¼Œæ¯”å¦‚jshell","categories":[{"name":"JAVAå­¦ä¹ ","slug":"JAVAå­¦ä¹ ","permalink":"https://shang.at/categories/JAVAå­¦ä¹ /"}],"tags":[{"name":"JDKç¯å¢ƒåˆ‡æ¢","slug":"JDKç¯å¢ƒåˆ‡æ¢","permalink":"https://shang.at/tags/JDKç¯å¢ƒåˆ‡æ¢/"}]},{"title":"javaå­¦ä¹ -JVMè™šæ‹Ÿæœºæ ˆ","slug":"javaå­¦ä¹ -JVMè™šæ‹Ÿæœºæ ˆ","date":"2020-06-09T07:39:37.000Z","updated":"2020-06-09T07:40:05.128Z","comments":true,"path":"post/javaå­¦ä¹ -JVMè™šæ‹Ÿæœºæ ˆ/","link":"","permalink":"https://shang.at/post/javaå­¦ä¹ -JVMè™šæ‹Ÿæœºæ ˆ/","excerpt":"","text":"","categories":[{"name":"JAVAå­¦ä¹ ","slug":"JAVAå­¦ä¹ ","permalink":"https://shang.at/categories/JAVAå­¦ä¹ /"}],"tags":[{"name":"JVMè™šæ‹Ÿæœºæ ˆ","slug":"JVMè™šæ‹Ÿæœºæ ˆ","permalink":"https://shang.at/tags/JVMè™šæ‹Ÿæœºæ ˆ/"}]},{"title":"javaå­¦ä¹ -JVMç–‘é—®","slug":"javaå­¦ä¹ -JVMç–‘é—®","date":"2020-06-05T09:01:58.000Z","updated":"2020-06-09T07:36:50.916Z","comments":true,"path":"post/javaå­¦ä¹ -JVMç–‘é—®/","link":"","permalink":"https://shang.at/post/javaå­¦ä¹ -JVMç–‘é—®/","excerpt":"","text":"åœ¨å­¦ä¹ JVMçš„å†…å­˜æ¨¡å‹çš„æ—¶å€™ï¼Œæˆ‘æœ‰è¿™æ ·ä¸€äº›ç–‘æƒ‘ï¼š 1ã€æˆ‘ä»¬é€šå¸¸åªæ˜¯å®šä¹‰äº†å †å¤§å°(-Xmsåˆå§‹ï¼Œ-Xmxæœ€å¤§)ï¼Œè™šæ‹Ÿæœºæ ˆå¤§å°(-Xss)ã€‚ä½†æ˜¯æˆ‘å‘ç°è¿™å¹¶ä¸èƒ½è®¡ç®—å‡ºä¸€ä¸ªjavaè¿›ç¨‹å ç”¨çš„å…¨éƒ¨å†…å­˜å¤§å°ã€‚ä»¥ä¸‹æ˜¯æˆ‘è‡ªå·±ç†è§£çš„(JDK1.8)ï¼šjavaè¿›ç¨‹å ç”¨çš„å†…å­˜â€‹ =JVMç®¡ç†çš„å†…å­˜+éJVMç®¡ç†çš„å†…å­˜â€‹ =çº¿ç¨‹ç‹¬ç«‹çš„å†…å­˜+çº¿ç¨‹å…±äº«çš„å†…å­˜â€‹ =n*(è™šæ‹Ÿæœºæ ˆå†…å­˜+ç¨‹åºè®¡æ•°å™¨å†…å­˜+æœ¬åœ°æ–¹æ³•æ ˆå†…å­˜)+å †å†…å­˜(heap)+éå †å†…å­˜(non-heap)+å…ƒç©ºé—´(metaspace)+å †å¤–å†…å­˜(off-heap:direct memory)å…¶ä¸­ï¼šâ€‹ JVMç®¡ç†çš„å†…å­˜ï¼šn*(è™šæ‹Ÿæœºæ ˆå†…å­˜+ç¨‹åºè®¡æ•°å™¨å†…å­˜+æœ¬åœ°æ–¹æ³•æ ˆå†…å­˜)+å †å†…å­˜(heap)+éå †å†…å­˜(non-heap)â€‹ éJVMç®¡ç†çš„å†…å­˜ï¼šå…ƒç©ºé—´(metaspace)+å †å¤–å†…å­˜(off-heap:direct memory)â€‹ çº¿ç¨‹ç‹¬ç«‹çš„å†…å­˜ï¼šn*(è™šæ‹Ÿæœºæ ˆå†…å­˜+ç¨‹åºè®¡æ•°å™¨å†…å­˜+æœ¬åœ°æ–¹æ³•æ ˆå†…å­˜)ï¼Œnæ˜¯çº¿ç¨‹æ•°â€‹ çº¿ç¨‹å…±äº«çš„å†…å­˜ï¼šå †å†…å­˜(heap)+éå †å†…å­˜(non-heap)+å…ƒç©ºé—´(metaspace)+å¯¹å¤–å†…å­˜(off-heap:direct memory) 2ã€åœ¨JDK1.7åŠä»¥å‰ï¼Œæœ‰ä¸ªæ°¸ä¹…ä»£(PermGen)ï¼Œä¹Ÿå°±æ˜¯æ–‡ä¸­è¯´çš„æ–¹æ³•åŒºã€‚è¿™å—åŒºåŸŸä¹Ÿè¢«ç§°ä¸ºéå †å†…å­˜â€‹ é‚£ä¹ˆåœ¨JDK1.8åŠä»¥åï¼Œæ°¸ä¹…ä»£å˜æˆäº†å…ƒç©ºé—´ï¼Œåˆ°äº†JVMç®¡ç†ä¹‹å¤–äº†ï¼Œé‚£ä¹ˆJDK1.8åŠä»¥åçš„ç‰ˆæœ¬ä¸­è¿˜æœ‰éå †å†…å­˜(non-heap)çš„è¯´æ³•å—ï¼Ÿå¦‚æœæœ‰çš„è¯ï¼Œæ˜¯æŒ‡ä»€ä¹ˆå‘¢ï¼Ÿ 3ã€å…³äºçº¿ç¨‹ç‹¬ç«‹çš„è¿™å—å†…å­˜\\{n*(è™šæ‹Ÿæœºæ ˆå†…å­˜+ç¨‹åºè®¡æ•°å™¨å†…å­˜+æœ¬åœ°æ–¹æ³•æ ˆå†…å­˜)ï¼Œnæ˜¯çº¿ç¨‹æ•°}ï¼Œå®ƒæ˜¯å®Œå…¨ç‹¬ç«‹äºå…¶ä»–çš„å†…å­˜çš„å—ï¼Ÿâ€‹ è¿˜æ˜¯ä¼šåˆ†äº«å †å†…å­˜ï¼Œå—åˆ°å †å†…å­˜å¤§å°çš„é™åˆ¶â€‹ è¿˜æ˜¯è¯´Threadå¯¹è±¡æ˜¯å»ºç«‹åœ¨å †å†…å­˜ï¼Œç„¶åæ¯ä¸ªThreadå¯¹åº”çš„è™šæ‹Ÿæœºæ ˆéƒ½æ˜¯ç‹¬ç«‹çš„å—ï¼Ÿ æ¢å¥è¯è¯´ï¼Œéšç€Threadçš„å¢åŠ (å †å†…å­˜å……è¶³ï¼šè¿˜èƒ½ç»™æ–°çš„å¯¹è±¡åˆ†é…å†…å­˜)ï¼Œjavaè¿›ç¨‹å ç”¨çš„å†…å­˜ä¼šè¶Šæ¥è¶Šå¤§â€”â€”-æˆ‘è§‰å¾—è¿™è‚¯å®šä¸å¯¹ï¼Œä½†æ˜¯æˆ‘å´æ— æ³•è§£é‡Š 4ã€æˆ‘åšäº†ä¸€äº›æµ‹è¯•(JDK1.8)ï¼šâ€‹ 4.1ã€æŒ‡å®šå¾ˆå°çš„å †å†…å­˜ï¼Œæ”¹å˜è™šæ‹Ÿæœºæ ˆå¤§å°â€‹ 4.1.1ã€-Xms2m -Xmx2m -Xss16m å¯åŠ¨javaè¿›ç¨‹ï¼Œç›´åˆ°é€’å½’è°ƒç”¨1,016,085æ·±åº¦ï¼Œä¼šæŠ¥StackOverflowErrorâ€‹ 4.1.2ã€-Xms2m -Xmx2m -Xss8m å¯åŠ¨javaè¿›ç¨‹ï¼Œç›´åˆ°é€’å½’è°ƒç”¨318,031æ·±åº¦ï¼Œä¼šæŠ¥StackOverflowErrorâ€‹ 4.2ã€æŒ‡å®šå¾ˆå°çš„å †å†…å­˜ï¼Œå¦‚-Xms2m -Xmx2mï¼Œæœ€ç»ˆä¼šæŠ¥OutOfMemoryError æˆ‘è°ˆä¸€ä¸‹æˆ‘çš„ç†è§£ï¼Œé¦–å…ˆï¼Œæ–°åˆ›å»ºçš„çº¿ç¨‹å¯¹è±¡è‚¯å®šæ˜¯æ”¾åœ¨å †ä¸­çš„ï¼›æ¯ä¸ªçº¿ç¨‹ç‹¬ç«‹çš„è™šæ‹Ÿæœºæ ˆï¼Œå­˜æ”¾äº†å¾ˆå¤šçš„æ ˆå¸§ï¼Œæ¯ä¸ªæ ˆå¸§å®é™…ä¸Šå­˜æ”¾äº†å±€éƒ¨å˜é‡è¡¨(å’Œå…¶ä»–ä¸‰éƒ¨åˆ†)ï¼Œæ¯ä¸ªæ ˆå¸§å¯¹åº”äº†ä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼Œåœ¨è¿™ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œçš„æ¯ä¸ªå‡½æ•°ä¸­çš„å˜é‡å¯èƒ½ä¼šå­˜æ”¾åœ¨å †é‡Œé¢ï¼Œä¹Ÿæœ‰å¯èƒ½ä¼šç›´æ¥åœ¨æ ˆä¸Šåˆ†é…å†…å­˜ï¼Œå› ä¸ºè¿™é‡Œæœ‰ä¸€ä¸ªé€ƒé€¸çš„æ¦‚å¿µ(ä»…å‡½æ•°å†…éƒ¨ä½¿ç”¨çš„å±€éƒ¨å˜é‡ç›´æ¥åœ¨æ ˆä¸Šåˆ†é…å†…å­˜ï¼Œä¸ä¼šå ç”¨å †å†…å­˜)ã€‚ æ‰€ä»¥åœ¨æˆ‘çš„ç†è§£é‡Œé¢ï¼Œå¦‚æœè™šæ‹Ÿæœºæ ˆæ˜¯ä¸€ä¸ªå®Œå…¨ç‹¬ç«‹äºå †çš„å†…å­˜ï¼Œé‚£ä¹ˆè™šæ‹Ÿæœºæ ˆå°±ä¸ä¼šå—åˆ°å †å†…å­˜å¤§å°çš„é™åˆ¶(æ¯”å¦‚æˆ‘ä¸Šé¢åšçš„å®éªŒï¼šå½“å †å†…å­˜è¿œå°äºè™šæ‹Ÿæœºæ ˆå¤§å°ï¼Œæœ€ç»ˆæŠ¥çš„å¼‚å¸¸ä»ç„¶æ˜¯StackOverflowErrorï¼Œè€Œä¸æ˜¯OutOfMemoryError) æ‰€ä»¥æˆ‘æ‰ä¼šæƒ³åˆ°ï¼Œå¦‚æœè™šæ‹Ÿæœºæ ˆæ˜¯ä¸€ä¸ªå®Œå…¨ç‹¬ç«‹äºå †çš„å†…å­˜ï¼Œæ— é™çš„åˆ›å»ºçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹çš„è™šæ‹Ÿæœºæ ˆå¦‚æœéƒ½æ— é™æ¥è¿‘äº-Xssåˆ†é…çš„æœ€å¤§é™åº¦ï¼Œé‚£ä¹ˆæœ€ç»ˆä¼šè€—å°½ç³»ç»Ÿçš„æ‰€æœ‰ å†…å­˜å§ æˆ‘åˆåšäº†ä¸€ä¸ªå®éªŒï¼Œå°±æ˜¯æ— é™çš„åˆ›å»ºçº¿ç¨‹ï¼Œç„¶ååœ¨è°ƒç”¨start()çš„æ—¶å€™ï¼ŒæŠ¥äº†OutOfMemoryError:unable to create new native threadçš„å¼‚å¸¸ï¼Œçœ‹æ¥æ“ä½œç³»ç»Ÿåœ¨è¿™é‡Œæ˜¯å¯¹çº¿ç¨‹æ•°æ˜¯æœ‰é™åˆ¶çš„ã€‚","categories":[{"name":"JAVAå­¦ä¹ ","slug":"JAVAå­¦ä¹ ","permalink":"https://shang.at/categories/JAVAå­¦ä¹ /"}],"tags":[{"name":"JVMç–‘é—®","slug":"JVMç–‘é—®","permalink":"https://shang.at/tags/JVMç–‘é—®/"}]},{"title":"javaå­¦ä¹ -åŸºæœ¬ç±»å‹å’ŒåŒ…è£…ç±»å‹","slug":"javaå­¦ä¹ -åŸºæœ¬ç±»å‹å’ŒåŒ…è£…ç±»å‹","date":"2020-06-04T03:37:10.000Z","updated":"2020-12-11T08:19:27.726Z","comments":true,"path":"post/javaå­¦ä¹ -åŸºæœ¬ç±»å‹å’ŒåŒ…è£…ç±»å‹/","link":"","permalink":"https://shang.at/post/javaå­¦ä¹ -åŸºæœ¬ç±»å‹å’ŒåŒ…è£…ç±»å‹/","excerpt":"","text":"Java çš„æ¯ä¸ªåŸºæœ¬ç±»å‹éƒ½å¯¹åº”äº†ä¸€ä¸ªåŒ…è£…ç±»å‹ï¼Œæ¯”å¦‚è¯´ int çš„åŒ…è£…ç±»å‹ä¸º Integerï¼Œdouble çš„åŒ…è£…ç±»å‹ä¸º Doubleã€‚åŸºæœ¬ç±»å‹å’ŒåŒ…è£…ç±»å‹çš„åŒºåˆ«ä¸»è¦æœ‰ä»¥ä¸‹ 4 ç‚¹ã€‚ 01ã€åŒ…è£…ç±»å‹å¯ä»¥ä¸º nullï¼Œè€ŒåŸºæœ¬ç±»å‹ä¸å¯ä»¥åˆ«å°çœ‹è¿™ä¸€ç‚¹åŒºåˆ«ï¼Œå®ƒä½¿å¾—åŒ…è£…ç±»å‹å¯ä»¥åº”ç”¨äº POJO ä¸­ï¼Œè€ŒåŸºæœ¬ç±»å‹åˆ™ä¸è¡Œã€‚ POJO æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè¿™é‡Œç¨å¾®è¯´æ˜ä¸€ä¸‹ã€‚ POJO çš„è‹±æ–‡å…¨ç§°æ˜¯ Plain Ordinary Java Objectï¼Œç¿»è¯‘ä¸€ä¸‹å°±æ˜¯ï¼Œç®€å•æ— è§„åˆ™çš„ Java å¯¹è±¡ï¼Œåªæœ‰å±æ€§å­—æ®µä»¥åŠ setter å’Œ getter æ–¹æ³•ï¼Œç¤ºä¾‹å¦‚ä¸‹ã€‚ 1234567891011121314151617181920class Writer &#123;private Integer age;private String name;public Integer getAge() &#123;return age;&#125;public void setAge(Integer age) &#123;this.age = age;&#125;public String getName() &#123;return name;&#125;public void setName(String name) &#123;this.name = name;&#125;&#125; å’Œ POJO ç±»ä¼¼çš„ï¼Œè¿˜æœ‰æ•°æ®ä¼ è¾“å¯¹è±¡ DTOï¼ˆData Transfer Objectï¼Œæ³›æŒ‡ç”¨äºå±•ç¤ºå±‚ä¸æœåŠ¡å±‚ä¹‹é—´çš„æ•°æ®ä¼ è¾“å¯¹è±¡ï¼‰ã€è§†å›¾å¯¹è±¡ VOï¼ˆView Objectï¼ŒæŠŠæŸä¸ªé¡µé¢çš„æ•°æ®å°è£…èµ·æ¥ï¼‰ã€æŒä¹…åŒ–å¯¹è±¡ POï¼ˆPersistant Objectï¼Œå¯ä»¥çœ‹æˆæ˜¯ä¸æ•°æ®åº“ä¸­çš„è¡¨æ˜ å°„çš„ Java å¯¹è±¡ï¼‰ã€‚ é‚£ä¸ºä»€ä¹ˆ POJO çš„å±æ€§å¿…é¡»è¦ç”¨åŒ…è£…ç±»å‹å‘¢ï¼Ÿ ã€Šé˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œã€‹ä¸Šæœ‰è¯¦ç»†çš„è¯´æ˜ï¼Œæˆ‘ä»¬æ¥å¤§å£°æœ—è¯»ä¸€ä¸‹ï¼ˆé¢„å¤‡ï¼Œèµ·ï¼‰ã€‚ æ•°æ®åº“çš„æŸ¥è¯¢ç»“æœå¯èƒ½æ˜¯ nullï¼Œå¦‚æœä½¿ç”¨åŸºæœ¬ç±»å‹çš„è¯ï¼Œå› ä¸ºè¦è‡ªåŠ¨æ‹†ç®±ï¼ˆå°†åŒ…è£…ç±»å‹è½¬ä¸ºåŸºæœ¬ç±»å‹ï¼Œæ¯”å¦‚è¯´æŠŠ Integer å¯¹è±¡è½¬æ¢æˆ int å€¼ï¼‰ï¼Œå°±ä¼šæŠ›å‡º NullPointerException çš„å¼‚å¸¸ã€‚ 02ã€åŒ…è£…ç±»å‹å¯ç”¨äºæ³›å‹ï¼Œè€ŒåŸºæœ¬ç±»å‹ä¸å¯ä»¥æ³›å‹ä¸èƒ½ä½¿ç”¨åŸºæœ¬ç±»å‹ï¼Œå› ä¸ºä½¿ç”¨åŸºæœ¬ç±»å‹æ—¶ä¼šç¼–è¯‘å‡ºé”™ã€‚ 12List&lt;int&gt; list = new ArrayList&lt;&gt;(); // æç¤º Syntax error, insert &quot;Dimensions&quot; to complete ReferenceTypeList&lt;Integer&gt; list = new ArrayList&lt;&gt;(); ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºæ³›å‹åœ¨ç¼–è¯‘æ—¶ä¼šè¿›è¡Œç±»å‹æ“¦é™¤ï¼Œæœ€ååªä¿ç•™åŸå§‹ç±»å‹ï¼Œè€ŒåŸå§‹ç±»å‹åªèƒ½æ˜¯ Object ç±»åŠå…¶å­ç±»â€”â€”åŸºæœ¬ç±»å‹æ˜¯ä¸ªç‰¹ä¾‹ã€‚ 03ã€åŸºæœ¬ç±»å‹æ¯”åŒ…è£…ç±»å‹æ›´é«˜æ•ˆåŸºæœ¬ç±»å‹åœ¨æ ˆä¸­ç›´æ¥å­˜å‚¨çš„å…·ä½“æ•°å€¼ï¼Œè€ŒåŒ…è£…ç±»å‹åˆ™å­˜å‚¨çš„æ˜¯å †ä¸­çš„å¼•ç”¨ã€‚ å¾ˆæ˜¾ç„¶ï¼Œç›¸æ¯”è¾ƒäºåŸºæœ¬ç±»å‹è€Œè¨€ï¼ŒåŒ…è£…ç±»å‹éœ€è¦å ç”¨æ›´å¤šçš„å†…å­˜ç©ºé—´ã€‚å‡å¦‚æ²¡æœ‰åŸºæœ¬ç±»å‹çš„è¯ï¼Œå¯¹äºæ•°å€¼è¿™ç±»ç»å¸¸ä½¿ç”¨åˆ°çš„æ•°æ®æ¥è¯´ï¼Œæ¯æ¬¡éƒ½è¦é€šè¿‡ new ä¸€ä¸ªåŒ…è£…ç±»å‹å°±æ˜¾å¾—éå¸¸ç¬¨é‡ã€‚ 03ã€ä¸¤ä¸ªåŒ…è£…ç±»å‹çš„å€¼å¯ä»¥ç›¸åŒï¼Œä½†å´ä¸ç›¸ç­‰ä¸¤ä¸ªåŒ…è£…ç±»å‹çš„å€¼å¯ä»¥ç›¸åŒï¼Œä½†å´ä¸ç›¸ç­‰â€”â€”è¿™å¥è¯æ€ä¹ˆç†è§£å‘¢ï¼Ÿæ¥çœ‹ä¸€æ®µä»£ç å°±æ˜æ˜ç™½ç™½äº†ã€‚ 12345Integer chenmo = new Integer(10);Integer wanger = new Integer(10);System.out.println(chenmo == wanger); // falseSystem.out.println(chenmo.equals(wanger )); // true ä¸¤ä¸ªåŒ…è£…ç±»å‹åœ¨ä½¿ç”¨â€œ==â€è¿›è¡Œåˆ¤æ–­çš„æ—¶å€™ï¼Œåˆ¤æ–­çš„æ˜¯å…¶æŒ‡å‘çš„åœ°å€æ˜¯å¦ç›¸ç­‰ã€‚chenmo å’Œ wanger ä¸¤ä¸ªå˜é‡ä½¿ç”¨äº† new å…³é”®å­—ï¼Œå¯¼è‡´å®ƒä»¬åœ¨â€œ==â€çš„æ—¶å€™è¾“å‡ºäº† falseã€‚ è€Œ chenmo.equals(wanger) çš„è¾“å‡ºç»“æœä¸º trueï¼Œæ˜¯å› ä¸º equals æ–¹æ³•å†…éƒ¨æ¯”è¾ƒçš„æ˜¯ä¸¤ä¸ª int å€¼æ˜¯å¦ç›¸ç­‰ã€‚æºç å¦‚ä¸‹ã€‚ 1234567891011private final int value;public int intValue() &#123;return value;&#125;public boolean equals(Object obj) &#123;if (obj instanceof Integer) &#123;return value == ((Integer)obj).intValue();&#125;return false;&#125; ç§ï¼Œè™½ç„¶ chenmo å’Œ wanger çš„å€¼éƒ½æ˜¯ 10ï¼Œä½†ä»–ä»¬å¹¶ä¸ç›¸ç­‰ã€‚æ¢å¥è¯è¯´å°±æ˜¯ï¼šå°†â€œ==â€æ“ä½œç¬¦åº”ç”¨äºåŒ…è£…ç±»å‹æ¯”è¾ƒçš„æ—¶å€™ï¼Œå…¶ç»“æœå¾ˆå¯èƒ½ä¼šå’Œé¢„æœŸçš„ä¸ç¬¦ã€‚ 04ã€è‡ªåŠ¨è£…ç®±å’Œè‡ªåŠ¨æ‹†ç®±æ—¢ç„¶æœ‰äº†åŸºæœ¬ç±»å‹å’ŒåŒ…è£…ç±»å‹ï¼Œè‚¯å®šæœ‰äº›æ—¶å€™è¦åœ¨å®ƒä»¬ä¹‹é—´è¿›è¡Œè½¬æ¢ã€‚æŠŠåŸºæœ¬ç±»å‹è½¬æ¢æˆåŒ…è£…ç±»å‹çš„è¿‡ç¨‹å«åšè£…ç®±ï¼ˆboxingï¼‰ã€‚åä¹‹ï¼ŒæŠŠåŒ…è£…ç±»å‹è½¬æ¢æˆåŸºæœ¬ç±»å‹çš„è¿‡ç¨‹å«åšæ‹†ç®±ï¼ˆunboxingï¼‰ã€‚ åœ¨ Java SE5 ä¹‹å‰ï¼Œå¼€å‘äººå‘˜è¦æ‰‹åŠ¨è¿›è¡Œè£…æ‹†ç®±ï¼Œæ¯”å¦‚è¯´ï¼š 12Integer chenmo = new Integer(10); // æ‰‹åŠ¨è£…ç®±int wanger = chenmo.intValue(); // æ‰‹åŠ¨æ‹†ç®± Java SE5 ä¸ºäº†å‡å°‘å¼€å‘äººå‘˜çš„å·¥ä½œï¼Œæä¾›äº†è‡ªåŠ¨è£…ç®±ä¸è‡ªåŠ¨æ‹†ç®±çš„åŠŸèƒ½ã€‚ 12Integer chenmo = 10; // è‡ªåŠ¨è£…ç®±int wanger = chenmo; // è‡ªåŠ¨æ‹†ç®± ä¸Šé¢è¿™æ®µä»£ç ä½¿ç”¨ JAD åç¼–è¯‘åçš„ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š 12Integer chenmo = Integer.valueOf(10);int wanger = chenmo.intValue(); ä¹Ÿå°±æ˜¯è¯´ï¼Œè‡ªåŠ¨è£…ç®±æ˜¯é€šè¿‡ Integer.valueOf() å®Œæˆçš„ï¼›è‡ªåŠ¨æ‹†ç®±æ˜¯é€šè¿‡ Integer.intValue() å®Œæˆçš„ã€‚ç†è§£äº†åŸç†ä¹‹åï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸€é“è€é©¬å½“å¹´ç»™æˆ‘å‡ºçš„é¢è¯•é¢˜ã€‚ 1234567891011121314// 1ï¼‰åŸºæœ¬ç±»å‹å’ŒåŒ…è£…ç±»å‹int a = 100;Integer b = 100;System.out.println(a == b);// 2ï¼‰ä¸¤ä¸ªåŒ…è£…ç±»å‹Integer c = 100;Integer d = 100;System.out.println(c == d);// 3ï¼‰c = 200;d = 200;System.out.println(c == d); ç­”æ¡ˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæœ‰ä¸¾æ‰‹è¦å›ç­”çš„å—ï¼Ÿç­”å¯¹çš„å¥–åŠ±ä¸€æœµå°çº¢èŠ±å“¦ã€‚ ç¬¬ä¸€æ®µä»£ç ï¼ŒåŸºæœ¬ç±»å‹å’ŒåŒ…è£…ç±»å‹è¿›è¡Œ == æ¯”è¾ƒï¼Œè¿™æ—¶å€™ b ä¼šè‡ªåŠ¨æ‹†ç®±ï¼Œç›´æ¥å’Œ a æ¯”è¾ƒå€¼ï¼Œæ‰€ä»¥ç»“æœä¸º trueã€‚ ç¬¬äºŒæ®µä»£ç ï¼Œä¸¤ä¸ªåŒ…è£…ç±»å‹éƒ½è¢«èµ‹å€¼ä¸ºäº† 100ï¼Œè¿™æ—¶å€™ä¼šè¿›è¡Œè‡ªåŠ¨è£…ç®±ï¼Œé‚£ == çš„ç»“æœä¼šæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ æˆ‘ä»¬ä¹‹å‰çš„ç»“è®ºæ˜¯ï¼šå°†â€œ==â€æ“ä½œç¬¦åº”ç”¨äºåŒ…è£…ç±»å‹æ¯”è¾ƒçš„æ—¶å€™ï¼Œå…¶ç»“æœå¾ˆå¯èƒ½ä¼šå’Œé¢„æœŸçš„ä¸ç¬¦ã€‚é‚£ç»“æœæ˜¯ falseï¼Ÿä½†è¿™æ¬¡çš„ç»“æœå´æ˜¯ trueï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰å¾ˆæ„å¤–ï¼Ÿ ç¬¬ä¸‰æ®µä»£ç ï¼Œä¸¤ä¸ªåŒ…è£…ç±»å‹é‡æ–°è¢«èµ‹å€¼ä¸ºäº† 200ï¼Œè¿™æ—¶å€™ä»ç„¶ä¼šè¿›è¡Œè‡ªåŠ¨è£…ç®±ï¼Œé‚£ == çš„ç»“æœä¼šæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ åƒäº†ç¬¬äºŒæ®µä»£ç çš„äºåï¼Œæ˜¯ä¸æ˜¯æœ‰ç‚¹æ€€ç–‘äººç”Ÿäº†ï¼Œè¿™æ¬¡ç»“æœæ˜¯ true è¿˜æ˜¯ false å‘¢ï¼Ÿæ‰”ä¸ªç¡¬å¸å§ï¼Œå“ˆå“ˆã€‚æˆ‘å…ˆå‘Šè¯‰ä½ ç»“æœå§ï¼Œfalseã€‚ ä¸ºä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆå‘¢ï¼Ÿ äº‹æƒ…åˆ°äº†è¿™ä¸€æ­¥ï¼Œå¿…é¡»ä½¿å‡ºæ€æ‰‹é”äº†â€”â€”åˆ†ææºç å§ã€‚ ä¹‹å‰æˆ‘ä»¬å·²ç»çŸ¥é“äº†ï¼Œè‡ªåŠ¨è£…ç®±æ˜¯é€šè¿‡ Integer.valueOf() å®Œæˆçš„ï¼Œé‚£æˆ‘ä»¬å°±æ¥çœ‹çœ‹è¿™ä¸ªæ–¹æ³•çš„æºç å§ã€‚ 12345public static Integer valueOf(int i) &#123;if (i &gt;= IntegerCache.low &amp;&amp; i &lt;= IntegerCache.high)return IntegerCache.cache[i + (-IntegerCache.low)];return new Integer(i);&#125; éš¾ä¸æˆæ˜¯ IntegerCache åœ¨ä½œæ€ªï¼Ÿä½ çŒœå¯¹äº†ï¼ 12345678910111213141516171819202122private static class IntegerCache &#123;static final int low = -128;static final int high;static final Integer cache[];static &#123;// high value may be configured by propertyint h = 127;int i = parseInt(integerCacheHighPropValue);i = Math.max(i, 127);h = Math.min(i, Integer.MAX_VALUE - (-low) -1);high = h;cache = new Integer[(high - low) + 1];int j = low;for(int k = 0; k &lt; cache.length; k++)cache[k] = new Integer(j++);// range [-128, 127] must be interned (JLS7 5.1.7)assert IntegerCache.high &gt;= 127;&#125;&#125; å¤§è‡´çŸä¸€ä¸‹è¿™æ®µä»£ç ä½ å°±å…¨æ˜ç™½äº†ã€‚-128 åˆ° 127 ä¹‹é—´çš„æ•°ä¼šä» IntegerCache ä¸­å–ï¼Œç„¶åæ¯”è¾ƒï¼Œæ‰€ä»¥ç¬¬äºŒæ®µä»£ç ï¼ˆ100 åœ¨è¿™ä¸ªèŒƒå›´ä¹‹å†…ï¼‰çš„ç»“æœæ˜¯ trueï¼Œè€Œç¬¬ä¸‰æ®µä»£ç ï¼ˆ200 ä¸åœ¨è¿™ä¸ªèŒƒå›´ä¹‹å†…ï¼Œæ‰€ä»¥ new å‡ºæ¥äº†ä¸¤ä¸ª Integer å¯¹è±¡ï¼‰çš„ç»“æœæ˜¯ falseã€‚ çœ‹å®Œä¸Šé¢çš„åˆ†æä¹‹åï¼Œæˆ‘å¸Œæœ›å¤§å®¶è®°ä½ä¸€ç‚¹ï¼šå½“éœ€è¦è¿›è¡Œè‡ªåŠ¨è£…ç®±æ—¶ï¼Œå¦‚æœæ•°å­—åœ¨ -128 è‡³ 127 ä¹‹é—´æ—¶ï¼Œä¼šç›´æ¥ä½¿ç”¨ç¼“å­˜ä¸­çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯é‡æ–°åˆ›å»ºä¸€ä¸ªå¯¹è±¡ã€‚ è‡ªåŠ¨è£…æ‹†ç®±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„åŠŸèƒ½ï¼Œå¤§å¤§èŠ‚çœäº†æˆ‘ä»¬å¼€å‘äººå‘˜çš„ç²¾åŠ›ï¼Œä½†ä¹Ÿä¼šå¼•å‘ä¸€äº›éº»çƒ¦ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ®µä»£ç ï¼Œæ€§èƒ½å°±å¾ˆå·®ã€‚ 1234567long t1 = System.currentTimeMillis();Long sum = 0L;for (int i = 0; i &lt; Integer.MAX_VALUE;i++) &#123; sum += i;&#125;long t2 = System.currentTimeMillis();System.out.println(t2-t1); sum ç”±äºè¢«å£°æ˜æˆäº†åŒ…è£…ç±»å‹ Long è€Œä¸æ˜¯åŸºæœ¬ç±»å‹ longï¼Œæ‰€ä»¥ sum += i è¿›è¡Œäº†å¤§é‡çš„æ‹†è£…ç®±æ“ä½œï¼ˆsum å…ˆæ‹†ç®±å’Œ i ç›¸åŠ ï¼Œç„¶åå†è£…ç®±èµ‹å€¼ç»™ sumï¼‰ï¼Œå¯¼è‡´è¿™æ®µä»£ç è¿è¡Œå®ŒèŠ±è´¹çš„æ—¶é—´è¶³è¶³æœ‰ 2986 æ¯«ç§’ï¼›å¦‚æœæŠŠ sum æ¢æˆåŸºæœ¬ç±»å‹ longï¼Œæ—¶é—´å°±ä»…æœ‰ 554 æ¯«ç§’ï¼Œå®Œå…¨ä¸ä¸€ä¸ªç­‰é‡çº§å•Šã€‚","categories":[{"name":"JAVAå­¦ä¹ ","slug":"JAVAå­¦ä¹ ","permalink":"https://shang.at/categories/JAVAå­¦ä¹ /"}],"tags":[{"name":"åŸºæœ¬ç±»å‹å’ŒåŒ…è£…ç±»å‹","slug":"åŸºæœ¬ç±»å‹å’ŒåŒ…è£…ç±»å‹","permalink":"https://shang.at/tags/åŸºæœ¬ç±»å‹å’ŒåŒ…è£…ç±»å‹/"}]},{"title":"javaå­¦ä¹ -JVM-heap-non-heap-off-heap","slug":"javaå­¦ä¹ -JVM-heap-non-heap-off-heap","date":"2020-06-03T22:50:26.000Z","updated":"2020-06-03T22:50:26.253Z","comments":true,"path":"post/javaå­¦ä¹ -JVM-heap-non-heap-off-heap/","link":"","permalink":"https://shang.at/post/javaå­¦ä¹ -JVM-heap-non-heap-off-heap/","excerpt":"","text":"","categories":[],"tags":[]},{"title":"javaç½‘ç»œç¼–ç¨‹-é›¶æ‹·è´","slug":"javaç½‘ç»œç¼–ç¨‹-é›¶æ‹·è´","date":"2020-06-03T16:32:39.000Z","updated":"2020-12-11T08:18:16.713Z","comments":true,"path":"post/javaç½‘ç»œç¼–ç¨‹-é›¶æ‹·è´/","link":"","permalink":"https://shang.at/post/javaç½‘ç»œç¼–ç¨‹-é›¶æ‹·è´/","excerpt":"","text":"ä»€ä¹ˆæ˜¯é›¶æ‹·è´åˆšæ‰è®²é˜»å¡ IO çš„æ—¶å€™æˆ‘è®²åˆ°ï¼Œç³»ç»Ÿå†…æ ¸å¤„ç† IO æ“ä½œåˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µâ€”â€”ç­‰å¾…æ•°æ®å’Œæ‹·è´æ•°æ®ã€‚ç­‰å¾…æ•°æ®ï¼Œå°±æ˜¯ç³»ç»Ÿå†…æ ¸åœ¨ç­‰å¾…ç½‘å¡æ¥æ”¶åˆ°æ•°æ®åï¼ŒæŠŠæ•°æ®å†™åˆ°å†…æ ¸ä¸­ï¼›è€Œæ‹·è´æ•°æ®ï¼Œå°±æ˜¯ç³»ç»Ÿå†…æ ¸åœ¨è·å–åˆ°æ•°æ®åï¼Œå°†æ•°æ®æ‹·è´åˆ°ç”¨æˆ·è¿›ç¨‹çš„ç©ºé—´ä¸­ã€‚ä»¥ä¸‹æ˜¯å…·ä½“æµç¨‹ï¼š åº”ç”¨è¿›ç¨‹çš„æ¯ä¸€æ¬¡å†™æ“ä½œï¼Œéƒ½ä¼šæŠŠæ•°æ®å†™åˆ°ç”¨æˆ·ç©ºé—´çš„ç¼“å†²åŒºä¸­ï¼Œå†ç”± CPU å°†æ•°æ®æ‹·è´åˆ°ç³»ç»Ÿå†…æ ¸çš„ç¼“å†²åŒºä¸­ï¼Œä¹‹åå†ç”± DMA å°†è¿™ä»½æ•°æ®æ‹·è´åˆ°ç½‘å¡ä¸­ï¼Œæœ€åç”±ç½‘å¡å‘é€å‡ºå»ã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä¸€æ¬¡å†™æ“ä½œæ•°æ®è¦æ‹·è´ä¸¤æ¬¡æ‰èƒ½é€šè¿‡ç½‘å¡å‘é€å‡ºå»ï¼Œè€Œç”¨æˆ·è¿›ç¨‹çš„è¯»æ“ä½œåˆ™æ˜¯å°†æ•´ä¸ªæµç¨‹åè¿‡æ¥ï¼Œæ•°æ®åŒæ ·ä¼šæ‹·è´ä¸¤æ¬¡æ‰èƒ½è®©åº”ç”¨ç¨‹åºè¯»å–åˆ°æ•°æ®ã€‚ åº”ç”¨è¿›ç¨‹çš„ä¸€æ¬¡å®Œæ•´çš„è¯»å†™æ“ä½œï¼Œéƒ½éœ€è¦åœ¨ç”¨æˆ·ç©ºé—´ä¸å†…æ ¸ç©ºé—´ä¸­æ¥å›æ‹·è´ï¼Œå¹¶ä¸”æ¯ä¸€æ¬¡æ‹·è´ï¼Œéƒ½éœ€è¦ CPU è¿›è¡Œä¸€æ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ˆç”±ç”¨æˆ·è¿›ç¨‹åˆ‡æ¢åˆ°ç³»ç»Ÿå†…æ ¸ï¼Œæˆ–ç”±ç³»ç»Ÿå†…æ ¸åˆ‡æ¢åˆ°ç”¨æˆ·è¿›ç¨‹ï¼‰ï¼Œè¿™æ ·æ˜¯ä¸æ˜¯å¾ˆæµªè´¹ CPU å’Œæ€§èƒ½å‘¢ï¼Ÿé‚£æœ‰æ²¡æœ‰ä»€ä¹ˆæ–¹å¼ï¼Œå¯ä»¥å‡å°‘è¿›ç¨‹é—´çš„æ•°æ®æ‹·è´ï¼Œæé«˜æ•°æ®ä¼ è¾“çš„æ•ˆç‡å‘¢ï¼Ÿ è¿™æ—¶æˆ‘ä»¬å°±éœ€è¦é›¶æ‹·è´ï¼ˆZero-copyï¼‰æŠ€æœ¯ã€‚ æ‰€è°“çš„é›¶æ‹·è´ï¼Œå°±æ˜¯å–æ¶ˆç”¨æˆ·ç©ºé—´ä¸å†…æ ¸ç©ºé—´ä¹‹é—´çš„æ•°æ®æ‹·è´æ“ä½œï¼Œåº”ç”¨è¿›ç¨‹æ¯ä¸€æ¬¡çš„è¯»å†™æ“ä½œï¼Œéƒ½å¯ä»¥é€šè¿‡ä¸€ç§æ–¹å¼ï¼Œè®©åº”ç”¨è¿›ç¨‹å‘ç”¨æˆ·ç©ºé—´å†™å…¥æˆ–è€…è¯»å–æ•°æ®ï¼Œå°±å¦‚åŒç›´æ¥å‘å†…æ ¸ç©ºé—´å†™å…¥æˆ–è€…è¯»å–æ•°æ®ä¸€æ ·ï¼Œå†é€šè¿‡ DMA å°†å†…æ ¸ä¸­çš„æ•°æ®æ‹·è´åˆ°ç½‘å¡ï¼Œæˆ–å°†ç½‘å¡ä¸­çš„æ•°æ® copy åˆ°å†…æ ¸ã€‚ é‚£æ€ä¹ˆåšåˆ°é›¶æ‹·è´ï¼Ÿä½ æƒ³ä¸€ä¸‹æ˜¯ä¸æ˜¯ç”¨æˆ·ç©ºé—´ä¸å†…æ ¸ç©ºé—´éƒ½å°†æ•°æ®å†™åˆ°ä¸€ä¸ªåœ°æ–¹ï¼Œå°±ä¸éœ€è¦æ‹·è´äº†ï¼Ÿæ­¤æ—¶ä½ æœ‰æ²¡æœ‰æƒ³åˆ°è™šæ‹Ÿå†…å­˜ï¼Ÿ é›¶æ‹·è´æœ‰ä¸¤ç§è§£å†³æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯ mmap+write æ–¹å¼å’Œ sendfile æ–¹å¼ï¼Œmmap+write æ–¹å¼çš„æ ¸å¿ƒåŸç†å°±æ˜¯é€šè¿‡è™šæ‹Ÿå†…å­˜æ¥è§£å†³çš„ã€‚ javaä¸­çš„é›¶æ‹·è´Nettyä¸­çš„é›¶æ‹·è´ å…·ä½“å»è¯»Nettyçš„æºç å†è¯¦ç»†è¡¥å……è¿™é‡Œ äº†è§£å®Œé›¶æ‹·è´ï¼Œæˆ‘ä»¬å†çœ‹çœ‹ Netty ä¸­çš„é›¶æ‹·è´ã€‚ æˆ‘åˆšæ‰è®²åˆ°ï¼ŒRPC æ¡†æ¶åœ¨ç½‘ç»œé€šä¿¡æ¡†æ¶çš„é€‰å‹ä¸Šï¼Œæˆ‘ä»¬æœ€ä¼˜çš„é€‰æ‹©æ˜¯åŸºäº Reactor æ¨¡å¼å®ç°çš„æ¡†æ¶ï¼Œå¦‚ Java è¯­è¨€ï¼Œé¦–é€‰çš„ä¾¿æ˜¯ Netty æ¡†æ¶ã€‚é‚£ä¹ˆ Netty æ¡†æ¶æ˜¯å¦ä¹Ÿæœ‰é›¶æ‹·è´æœºåˆ¶å‘¢ï¼ŸNetty æ¡†æ¶ä¸­çš„é›¶æ‹·è´å’Œæˆ‘ä¹‹å‰è®²çš„é›¶æ‹·è´åˆæœ‰ä»€ä¹ˆä¸åŒå‘¢ï¼Ÿ åˆšæ‰æˆ‘è®²çš„é›¶æ‹·è´æ˜¯æ“ä½œç³»ç»Ÿå±‚é¢ä¸Šçš„é›¶æ‹·è´ï¼Œä¸»è¦ç›®æ ‡æ˜¯é¿å…ç”¨æˆ·ç©ºé—´ä¸å†…æ ¸ç©ºé—´ä¹‹é—´çš„æ•°æ®æ‹·è´æ“ä½œï¼Œå¯ä»¥æå‡ CPU çš„åˆ©ç”¨ç‡ã€‚ è€Œ Netty çš„é›¶æ‹·è´åˆ™ä¸å¤§ä¸€æ ·ï¼Œä»–å®Œå…¨ç«™åœ¨äº†ç”¨æˆ·ç©ºé—´ä¸Šï¼Œä¹Ÿå°±æ˜¯ JVM ä¸Šï¼Œå®ƒçš„é›¶æ‹·è´ä¸»è¦æ˜¯åå‘äºæ•°æ®æ“ä½œçš„ä¼˜åŒ–ä¸Šã€‚ é‚£ä¹ˆ Netty è¿™ä¹ˆåšçš„æ„ä¹‰æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ å›æƒ³ä¸‹[ç¬¬ 02 è®²]ï¼Œåœ¨è¿™ä¸€è®²ä¸­æˆ‘è®²è§£äº† RPC æ¡†æ¶å¦‚ä½•å»è®¾è®¡åè®®ï¼Œå…¶ä¸­æˆ‘è®²åˆ°ï¼šåœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ï¼ŒRPC å¹¶ä¸ä¼šæŠŠè¯·æ±‚å‚æ•°çš„æ‰€æœ‰äºŒè¿›åˆ¶æ•°æ®æ•´ä½“ä¸€ä¸‹å­å‘é€åˆ°å¯¹ç«¯æœºå™¨ä¸Šï¼Œä¸­é—´å¯èƒ½ä¼šæ‹†åˆ†æˆå¥½å‡ ä¸ªæ•°æ®åŒ…ï¼Œä¹Ÿå¯èƒ½ä¼šåˆå¹¶å…¶ä»–è¯·æ±‚çš„æ•°æ®åŒ…ï¼Œæ‰€ä»¥æ¶ˆæ¯éƒ½éœ€è¦æœ‰è¾¹ç•Œã€‚é‚£ä¹ˆä¸€ç«¯çš„æœºå™¨æ”¶åˆ°æ¶ˆæ¯ä¹‹åï¼Œå°±éœ€è¦å¯¹æ•°æ®åŒ…è¿›è¡Œå¤„ç†ï¼Œæ ¹æ®è¾¹ç•Œå¯¹æ•°æ®åŒ…è¿›è¡Œåˆ†å‰²å’Œåˆå¹¶ï¼Œæœ€ç»ˆè·å¾—ä¸€æ¡å®Œæ•´çš„æ¶ˆæ¯ã€‚ é‚£æ”¶åˆ°æ¶ˆæ¯åï¼Œå¯¹æ•°æ®åŒ…çš„åˆ†å‰²å’Œåˆå¹¶ï¼Œæ˜¯åœ¨ç”¨æˆ·ç©ºé—´å®Œæˆï¼Œè¿˜æ˜¯åœ¨å†…æ ¸ç©ºé—´å®Œæˆçš„å‘¢ï¼Ÿ å½“ç„¶æ˜¯åœ¨ç”¨æˆ·ç©ºé—´ï¼Œå› ä¸ºå¯¹æ•°æ®åŒ…çš„å¤„ç†å·¥ä½œéƒ½æ˜¯ç”±åº”ç”¨ç¨‹åºæ¥å¤„ç†çš„ï¼Œé‚£ä¹ˆè¿™é‡Œæœ‰æ²¡æœ‰å¯èƒ½å­˜åœ¨æ•°æ®çš„æ‹·è´æ“ä½œï¼Ÿå¯èƒ½ä¼šå­˜åœ¨ï¼Œå½“ç„¶ä¸æ˜¯åœ¨ç”¨æˆ·ç©ºé—´ä¸å†…æ ¸ç©ºé—´ä¹‹é—´çš„æ‹·è´ï¼Œæ˜¯ç”¨æˆ·ç©ºé—´å†…éƒ¨å†…å­˜ä¸­çš„æ‹·è´å¤„ç†æ“ä½œã€‚Netty çš„é›¶æ‹·è´å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåœ¨ç”¨æˆ·ç©ºé—´å¯¹æ•°æ®æ“ä½œè¿›è¡Œä¼˜åŒ–ã€‚ é‚£ä¹ˆ Netty æ˜¯æ€ä¹ˆå¯¹æ•°æ®æ“ä½œè¿›è¡Œä¼˜åŒ–çš„å‘¢ï¼Ÿ Netty æä¾›äº† CompositeByteBuf ç±»ï¼Œå®ƒå¯ä»¥å°†å¤šä¸ª ByteBuf åˆå¹¶ä¸ºä¸€ä¸ªé€»è¾‘ä¸Šçš„ ByteBufï¼Œé¿å…äº†å„ä¸ª ByteBuf ä¹‹é—´çš„æ‹·è´ã€‚ ByteBuf æ”¯æŒ slice æ“ä½œï¼Œå› æ­¤å¯ä»¥å°† ByteBuf åˆ†è§£ä¸ºå¤šä¸ªå…±äº«åŒä¸€ä¸ªå­˜å‚¨åŒºåŸŸçš„ ByteBufï¼Œé¿å…äº†å†…å­˜çš„æ‹·è´ã€‚ é€šè¿‡ wrap æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥å°† byte[] æ•°ç»„ã€ByteBufã€ByteBuffer ç­‰åŒ…è£…æˆä¸€ä¸ª Netty ByteBuf å¯¹è±¡, è¿›è€Œé¿å…æ‹·è´æ“ä½œã€‚ Netty æ¡†æ¶ä¸­å¾ˆå¤šå†…éƒ¨çš„ ChannelHandler å®ç°ç±»ï¼Œéƒ½æ˜¯é€šè¿‡ CompositeByteBufã€sliceã€wrap æ“ä½œæ¥å¤„ç† TCP ä¼ è¾“ä¸­çš„æ‹†åŒ…ä¸ç²˜åŒ…é—®é¢˜çš„ã€‚ é‚£ä¹ˆ Netty æœ‰æ²¡æœ‰è§£å†³ç”¨æˆ·ç©ºé—´ä¸å†…æ ¸ç©ºé—´ä¹‹é—´çš„æ•°æ®æ‹·è´é—®é¢˜çš„æ–¹æ³•å‘¢ï¼Ÿ Netty çš„ ByteBuffer å¯ä»¥é‡‡ç”¨ Direct Buffersï¼Œä½¿ç”¨å †å¤–ç›´æ¥å†…å­˜è¿›è¡Œ Socket çš„è¯»å†™æ“ä½œï¼Œæœ€ç»ˆçš„æ•ˆæœä¸æˆ‘åˆšæ‰è®²è§£çš„è™šæ‹Ÿå†…å­˜æ‰€å®ç°çš„æ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚(mmapæ–¹å¼) Netty è¿˜æä¾› FileRegion ä¸­åŒ…è£… NIO çš„ FileChannel.transferTo() æ–¹æ³•å®ç°äº†é›¶æ‹·è´ï¼Œè¿™ä¸ Linux ä¸­çš„ sendfile æ–¹å¼åœ¨åŸç†ä¸Šä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚ æ€»ç»“é›¶æ‹·è´å¸¦æ¥çš„å¥½å¤„å°±æ˜¯é¿å…æ²¡å¿…è¦çš„ CPU æ‹·è´ï¼Œè®© CPU è§£è„±å‡ºæ¥å»åšå…¶ä»–çš„äº‹ï¼ŒåŒæ—¶ä¹Ÿå‡å°‘äº† CPU åœ¨ç”¨æˆ·ç©ºé—´ä¸å†…æ ¸ç©ºé—´ä¹‹é—´çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œä»è€Œæå‡äº†ç½‘ç»œé€šä¿¡æ•ˆç‡ä¸åº”ç”¨ç¨‹åºçš„æ•´ä½“æ€§èƒ½ã€‚ è€Œ Netty çš„é›¶æ‹·è´ä¸æ“ä½œç³»ç»Ÿçš„é›¶æ‹·è´æ˜¯æœ‰äº›åŒºåˆ«çš„ï¼ŒNetty çš„é›¶æ‹·è´åå‘äºç”¨æˆ·ç©ºé—´ä¸­å¯¹æ•°æ®æ“ä½œçš„ä¼˜åŒ–ï¼Œè¿™å¯¹å¤„ç† TCP ä¼ è¾“ä¸­çš„æ‹†åŒ…ç²˜åŒ…é—®é¢˜æœ‰ç€é‡è¦çš„æ„ä¹‰ï¼Œå¯¹åº”ç”¨ç¨‹åºå¤„ç†è¯·æ±‚æ•°æ®ä¸è¿”å›æ•°æ®ä¹Ÿæœ‰é‡è¦çš„æ„ä¹‰ã€‚ åœ¨ RPC æ¡†æ¶çš„å¼€å‘ä¸ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬è¦æ·±å…¥äº†è§£ç½‘ç»œé€šä¿¡ç›¸å…³çš„åŸç†çŸ¥è¯†ï¼Œå°½é‡åšåˆ°é›¶æ‹·è´ï¼Œå¦‚ä½¿ç”¨ Netty æ¡†æ¶ï¼›æˆ‘ä»¬è¦åˆç†ä½¿ç”¨ ByteBuf å­ç±»ï¼Œåšåˆ°å®Œå…¨é›¶æ‹·è´ï¼Œæå‡ RPC æ¡†æ¶çš„æ•´ä½“æ€§èƒ½ã€‚ å…¶ä»–å…³äºé›¶æ‹·è´æŠ€æœ¯çš„æ–‡ç« ï¼š Javaä¸­çš„é›¶æ‹·è´","categories":[{"name":"JAVAå­¦ä¹ ","slug":"JAVAå­¦ä¹ ","permalink":"https://shang.at/categories/JAVAå­¦ä¹ /"}],"tags":[{"name":"ç½‘ç»œç¼–ç¨‹-é›¶æ‹·è´","slug":"ç½‘ç»œç¼–ç¨‹-é›¶æ‹·è´","permalink":"https://shang.at/tags/ç½‘ç»œç¼–ç¨‹-é›¶æ‹·è´/"}]},{"title":"javaå­¦ä¹ -JVMå‚æ•°","slug":"javaå­¦ä¹ -JVMå‚æ•°","date":"2020-06-03T10:36:02.000Z","updated":"2020-06-04T03:30:03.517Z","comments":true,"path":"post/javaå­¦ä¹ -JVMå‚æ•°/","link":"","permalink":"https://shang.at/post/javaå­¦ä¹ -JVMå‚æ•°/","excerpt":"","text":"æŸ¥çœ‹JVMå‚æ•°å¯åŠ¨åº”ç”¨çš„æ—¶å€™åˆ†åˆ«åŠ ä»¥ä¸‹çš„å‚æ•°å¯ä»¥æ‰“å°ç›¸å…³çš„å‚æ•°ï¼š java -XX:+PrintFlagsInitial æ‰“å°æ‰€æœ‰çš„JVMåˆå§‹å‚æ•°ï¼Œä½†æ˜¯ä¼šç«‹åˆ»ç»ˆæ­¢åº”ç”¨ java -XX:+PrintFlagsFinal æ‰“å°æ‰€æœ‰çš„è®¾ç½®åçš„JVMå‚æ•°ï¼Œä¸ä¼šç»ˆæ­¢åº”ç”¨ jinfo [options] pid â€‹ jinfo -flags pid æŸ¥çœ‹æŒ‡å®špidçš„jvmçš„æ‰€æœ‰è®¾ç½®å‚æ•° -XX:+PrintVMOptions ç¨‹åºè¿è¡Œæ—¶ï¼Œæ‰“å°è™šæ‹Ÿæœºæ¥å—åˆ°çš„å‘½ä»¤è¡Œæ˜¾å¼å‚æ•°ã€‚ä¸ä¼šç»ˆæ­¢åº”ç”¨ -XX:+PrintCommandLineFlags æ‰“å°ä¼ é€’ç»™è™šæ‹Ÿæœºçš„æ˜¾å¼å’Œéšå¼å‚æ•°ã€‚ä¸ä¼šç»ˆæ­¢åº”ç”¨ å¸¸è§çš„JVMå‚æ•° InitialHeapSize(å•ä½æ˜¯å­—èŠ‚)ï¼šåˆå§‹å †å¤§å°ï¼Œé»˜è®¤æ˜¯ç‰©ç†å†…å­˜çš„1/64ï¼Œæœ€å°ä¸º2m(è®¾ç½®äº†1mï¼Œå‘ç°PrintFlagsFinalæ‰“å°å‡ºæ¥çš„æ˜¯2m)ï¼Œå¯ä»¥ä½¿ç”¨-XmsæŒ‡å®šï¼Œå¦‚-Xms64mï¼Œåªèƒ½æŒ‡å®šmã€gè¿™æ ·çš„å•ä½ MaxHeapSizeï¼šæœ€å¤§å †å¤§å°ï¼Œé»˜è®¤æ˜¯ç‰©ç†å†…å­˜çš„1/4ï¼Œæœ€å°ä¸º2mï¼Œå¯ä»¥ä½¿ç”¨-XmxæŒ‡å®šï¼Œå¦‚-Xmx64m MaxNewSizeï¼š NewSizeï¼š OldSizeï¼š MetaspaceSizeï¼š MaxMetaspaceSizeï¼š ThreadStackSize(å•ä½æ˜¯kb)ï¼šè™šæ‹Ÿæœºæ ˆå¤§å°ï¼Œé»˜è®¤æ˜¯1024kï¼Œå¯ä»¥ä½¿ç”¨-XssæŒ‡å®šï¼Œå¦‚-Xss256k MaxTenuringThresholdï¼šå¯¹è±¡æ™‹å‡åˆ°è€å¹´ä»£çš„å¹´é¾„é˜ˆå€¼ï¼Œé»˜è®¤æ˜¯15ï¼Œå¯ä»¥ä½¿ç”¨-XX:MaxTenuringThresholdæŒ‡å®šï¼Œå¦‚-XX:MaxTenuringThreshold=20 å‚æ•°è°ƒä¼˜ é»˜è®¤ç©ºä½™å †å†…å­˜å°äº40%æ—¶ï¼ŒJVMå°±ä¼šå¢å¤§å †ç›´åˆ°-Xmxçš„æœ€å¤§é™åˆ¶ï¼›ç©ºä½™å †å†…å­˜å¤§äº70%æ—¶ï¼ŒJVMä¼šå‡å°‘å †ç›´åˆ° -Xmsçš„æœ€å°é™åˆ¶ã€‚å› æ­¤æœåŠ¡å™¨ä¸€èˆ¬è®¾ç½®-Xmsã€-Xmxç›¸ç­‰ä»¥é¿å…åœ¨æ¯æ¬¡GC åè°ƒæ•´å †çš„å¤§å°ã€‚","categories":[{"name":"JAVAå­¦ä¹ ","slug":"JAVAå­¦ä¹ ","permalink":"https://shang.at/categories/JAVAå­¦ä¹ /"}],"tags":[{"name":"JVMå‚æ•°","slug":"JVMå‚æ•°","permalink":"https://shang.at/tags/JVMå‚æ•°/"}]},{"title":"Javaå­¦ä¹ -å¸¸è§å¼‚å¸¸","slug":"Javaå­¦ä¹ -å¸¸è§å¼‚å¸¸","date":"2020-06-03T09:31:00.000Z","updated":"2020-06-12T02:06:08.511Z","comments":true,"path":"post/Javaå­¦ä¹ -å¸¸è§å¼‚å¸¸/","link":"","permalink":"https://shang.at/post/Javaå­¦ä¹ -å¸¸è§å¼‚å¸¸/","excerpt":"","text":"StackOverflowErrorå’ŒOutOfMemoryErrorçš„åŒºåˆ«(JDK1.8)StackOverflowErrorï¼šThrown when a stack overflow occurs because an application recurses too deeply. OutOfMemoryErrorï¼šThrown when the Java Virtual Machine cannot allocate an object because it is out of memory, and no more memory could be made available by the garbage collector. ä»å¯¹è¿™ä¸¤ä¸ªErrorçš„æ³¨é‡Šæ¥çœ‹ï¼Œ ç”±äºåº”ç”¨ç¨‹åºé€’å½’è¿‡æ·±è€Œåœ¨å †æ ˆæº¢å‡ºæ—¶ä¼šæŠ›å‡ºStackOverflowErrorï¼›åŒä¸€ä¸ªå‡½æ•°é€’å½’è°ƒç”¨æ—¶ï¼Œå†…å­˜ä¸è¶³ å½“Javaè™šæ‹Ÿæœºç”±äºå†…å­˜ä¸è¶³è€Œæ— æ³•åˆ†é…å¯¹è±¡ï¼Œå¹¶ä¸”åƒåœ¾å›æ”¶å™¨æ— æ³•å†æä¾›æ›´å¤šå†…å­˜æ—¶ï¼ŒæŠ›å‡ºOutOfMemoryErrorã€‚åˆ›å»ºæ–°çš„å¯¹è±¡(åŒ…æ‹¬è™šæ‹Ÿæœºæ ˆï¼šå‡½æ•°è°ƒç”¨(ä¹ŸåŒ…æ‹¬é€’å½’è°ƒç”¨)æ—¶åˆ›å»ºè™šæ‹Ÿæœºæ ˆ)æ—¶ï¼Œå†…å­˜ä¸è¶³ åœ¨javaåº”ç”¨å¯åŠ¨çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡-Xssæ¥è®¾ç½®è™šæ‹Ÿæœºæ ˆå¤§å°ï¼Œè™šæ‹Ÿæœºæ ˆé»˜è®¤å¤§å°ä¸º1024k åœ¨javaé‡Œï¼Œå‡½æ•°çš„é€’å½’è°ƒç”¨å—åˆ°ä»¥ä¸‹å‡ æ–¹é¢çš„å½±å“ï¼š è™šæ‹Ÿæœºæ ˆå¤§å°ï¼šè®¾ç½®çš„è™šæ‹Ÿæœºæ ˆ å±€éƒ¨å˜é‡è¡¨å¤§å° https://blog.csdn.net/chengyun19830206/article/details/78452321 https://dzone.com/articles/outofmemoryerror-unable-create https://blog.csdn.net/kylinsoong/article/details/16879653 https://www.jianshu.com/p/c09727dc8f92","categories":[{"name":"JAVAå­¦ä¹ ","slug":"JAVAå­¦ä¹ ","permalink":"https://shang.at/categories/JAVAå­¦ä¹ /"}],"tags":[{"name":"å¸¸è§å¼‚å¸¸","slug":"å¸¸è§å¼‚å¸¸","permalink":"https://shang.at/tags/å¸¸è§å¼‚å¸¸/"}]},{"title":"JAVAå¹¶å‘ç¼–ç¨‹-12-å¹¶å‘æ¡†æ¶(Disruptor)","slug":"JAVAå¹¶å‘ç¼–ç¨‹-12-å¹¶å‘æ¡†æ¶-Disruptor","date":"2020-06-03T02:54:59.000Z","updated":"2020-06-03T03:00:26.307Z","comments":true,"path":"post/JAVAå¹¶å‘ç¼–ç¨‹-12-å¹¶å‘æ¡†æ¶-Disruptor/","link":"","permalink":"https://shang.at/post/JAVAå¹¶å‘ç¼–ç¨‹-12-å¹¶å‘æ¡†æ¶-Disruptor/","excerpt":"","text":"","categories":[{"name":"JAVAå¹¶å‘ç¼–ç¨‹","slug":"JAVAå¹¶å‘ç¼–ç¨‹","permalink":"https://shang.at/categories/JAVAå¹¶å‘ç¼–ç¨‹/"}],"tags":[{"name":"Disruptor","slug":"Disruptor","permalink":"https://shang.at/tags/Disruptor/"}]},{"title":"JAVAå¹¶å‘ç¼–ç¨‹-11-å“åº”å¼ç¼–ç¨‹(RxJava)","slug":"JAVAå¹¶å‘ç¼–ç¨‹-11-å“åº”å¼ç¼–ç¨‹-RxJava","date":"2020-06-03T02:53:44.000Z","updated":"2020-06-03T08:24:11.250Z","comments":true,"path":"post/JAVAå¹¶å‘ç¼–ç¨‹-11-å“åº”å¼ç¼–ç¨‹-RxJava/","link":"","permalink":"https://shang.at/post/JAVAå¹¶å‘ç¼–ç¨‹-11-å“åº”å¼ç¼–ç¨‹-RxJava/","excerpt":"","text":"https://juejin.im/post/5ed62cabf265da7709526718","categories":[{"name":"JAVAå¹¶å‘ç¼–ç¨‹","slug":"JAVAå¹¶å‘ç¼–ç¨‹","permalink":"https://shang.at/categories/JAVAå¹¶å‘ç¼–ç¨‹/"}],"tags":[{"name":"RxJava","slug":"RxJava","permalink":"https://shang.at/tags/RxJava/"}]},{"title":"JAVAå¹¶å‘ç¼–ç¨‹-10-åç¨‹","slug":"JAVAå¹¶å‘ç¼–ç¨‹-10-åç¨‹","date":"2020-06-03T02:53:19.000Z","updated":"2020-06-03T08:24:17.642Z","comments":true,"path":"post/JAVAå¹¶å‘ç¼–ç¨‹-10-åç¨‹/","link":"","permalink":"https://shang.at/post/JAVAå¹¶å‘ç¼–ç¨‹-10-åç¨‹/","excerpt":"","text":"https://juejin.im/post/5ed62cabf265da7709526718","categories":[{"name":"JAVAå¹¶å‘ç¼–ç¨‹","slug":"JAVAå¹¶å‘ç¼–ç¨‹","permalink":"https://shang.at/categories/JAVAå¹¶å‘ç¼–ç¨‹/"}],"tags":[{"name":"åç¨‹","slug":"åç¨‹","permalink":"https://shang.at/tags/åç¨‹/"}]},{"title":"JAVAå¹¶å‘ç¼–ç¨‹-9-çº¿ç¨‹æ± ","slug":"JAVAå¹¶å‘ç¼–ç¨‹-9-çº¿ç¨‹æ± ","date":"2020-06-03T02:52:35.000Z","updated":"2020-06-03T02:59:46.242Z","comments":true,"path":"post/JAVAå¹¶å‘ç¼–ç¨‹-9-çº¿ç¨‹æ± /","link":"","permalink":"https://shang.at/post/JAVAå¹¶å‘ç¼–ç¨‹-9-çº¿ç¨‹æ± /","excerpt":"","text":"","categories":[{"name":"JAVAå¹¶å‘ç¼–ç¨‹","slug":"JAVAå¹¶å‘ç¼–ç¨‹","permalink":"https://shang.at/categories/JAVAå¹¶å‘ç¼–ç¨‹/"}],"tags":[{"name":"çº¿ç¨‹æ± ","slug":"çº¿ç¨‹æ± ","permalink":"https://shang.at/tags/çº¿ç¨‹æ± /"}]},{"title":"JAVAå¹¶å‘ç¼–ç¨‹-8-é˜»å¡é˜Ÿåˆ—","slug":"JAVAå¹¶å‘ç¼–ç¨‹-8-é˜»å¡é˜Ÿåˆ—","date":"2020-06-03T02:52:16.000Z","updated":"2020-06-03T02:59:37.175Z","comments":true,"path":"post/JAVAå¹¶å‘ç¼–ç¨‹-8-é˜»å¡é˜Ÿåˆ—/","link":"","permalink":"https://shang.at/post/JAVAå¹¶å‘ç¼–ç¨‹-8-é˜»å¡é˜Ÿåˆ—/","excerpt":"","text":"","categories":[{"name":"JAVAå¹¶å‘ç¼–ç¨‹","slug":"JAVAå¹¶å‘ç¼–ç¨‹","permalink":"https://shang.at/categories/JAVAå¹¶å‘ç¼–ç¨‹/"}],"tags":[{"name":"é˜»å¡é˜Ÿåˆ—","slug":"é˜»å¡é˜Ÿåˆ—","permalink":"https://shang.at/tags/é˜»å¡é˜Ÿåˆ—/"}]},{"title":"JAVAå¹¶å‘ç¼–ç¨‹-7-Atomic","slug":"JAVAå¹¶å‘ç¼–ç¨‹-7-Atomic","date":"2020-06-03T02:51:56.000Z","updated":"2020-06-03T02:59:29.958Z","comments":true,"path":"post/JAVAå¹¶å‘ç¼–ç¨‹-7-Atomic/","link":"","permalink":"https://shang.at/post/JAVAå¹¶å‘ç¼–ç¨‹-7-Atomic/","excerpt":"","text":"","categories":[{"name":"JAVAå¹¶å‘ç¼–ç¨‹","slug":"JAVAå¹¶å‘ç¼–ç¨‹","permalink":"https://shang.at/categories/JAVAå¹¶å‘ç¼–ç¨‹/"}],"tags":[{"name":"Atomic","slug":"Atomic","permalink":"https://shang.at/tags/Atomic/"}]},{"title":"JAVAå¹¶å‘ç¼–ç¨‹-6-å¹¶å‘é›†åˆ","slug":"JAVAå¹¶å‘ç¼–ç¨‹-6-å¹¶å‘é›†åˆ","date":"2020-06-03T02:51:41.000Z","updated":"2020-06-03T02:59:22.524Z","comments":true,"path":"post/JAVAå¹¶å‘ç¼–ç¨‹-6-å¹¶å‘é›†åˆ/","link":"","permalink":"https://shang.at/post/JAVAå¹¶å‘ç¼–ç¨‹-6-å¹¶å‘é›†åˆ/","excerpt":"","text":"","categories":[{"name":"JAVAå¹¶å‘ç¼–ç¨‹","slug":"JAVAå¹¶å‘ç¼–ç¨‹","permalink":"https://shang.at/categories/JAVAå¹¶å‘ç¼–ç¨‹/"}],"tags":[{"name":"å¹¶å‘é›†åˆ","slug":"å¹¶å‘é›†åˆ","permalink":"https://shang.at/tags/å¹¶å‘é›†åˆ/"}]},{"title":"JAVAå¹¶å‘ç¼–ç¨‹-5-å…¶ä»–","slug":"JAVAå¹¶å‘ç¼–ç¨‹-5-å…¶ä»–","date":"2020-06-03T02:51:25.000Z","updated":"2020-06-03T02:59:14.785Z","comments":true,"path":"post/JAVAå¹¶å‘ç¼–ç¨‹-5-å…¶ä»–/","link":"","permalink":"https://shang.at/post/JAVAå¹¶å‘ç¼–ç¨‹-5-å…¶ä»–/","excerpt":"","text":"","categories":[{"name":"JAVAå¹¶å‘ç¼–ç¨‹","slug":"JAVAå¹¶å‘ç¼–ç¨‹","permalink":"https://shang.at/categories/JAVAå¹¶å‘ç¼–ç¨‹/"}],"tags":[{"name":"ThreadLocal-Fork&Join","slug":"ThreadLocal-Fork-Join","permalink":"https://shang.at/tags/ThreadLocal-Fork-Join/"}]},{"title":"JAVAå¹¶å‘ç¼–ç¨‹-4-å¹¶å‘å·¥å…·ç±»","slug":"JAVAå¹¶å‘ç¼–ç¨‹-4-å¹¶å‘å·¥å…·ç±»","date":"2020-06-03T02:51:14.000Z","updated":"2020-06-03T02:58:42.622Z","comments":true,"path":"post/JAVAå¹¶å‘ç¼–ç¨‹-4-å¹¶å‘å·¥å…·ç±»/","link":"","permalink":"https://shang.at/post/JAVAå¹¶å‘ç¼–ç¨‹-4-å¹¶å‘å·¥å…·ç±»/","excerpt":"","text":"","categories":[{"name":"JAVAå¹¶å‘ç¼–ç¨‹","slug":"JAVAå¹¶å‘ç¼–ç¨‹","permalink":"https://shang.at/categories/JAVAå¹¶å‘ç¼–ç¨‹/"}],"tags":[{"name":"å¹¶å‘å·¥å…·ç±»","slug":"å¹¶å‘å·¥å…·ç±»","permalink":"https://shang.at/tags/å¹¶å‘å·¥å…·ç±»/"}]},{"title":"JAVAå¹¶å‘ç¼–ç¨‹-3-é”","slug":"JAVAå¹¶å‘ç¼–ç¨‹-3-é”","date":"2020-06-03T02:51:06.000Z","updated":"2020-06-03T02:58:32.008Z","comments":true,"path":"post/JAVAå¹¶å‘ç¼–ç¨‹-3-é”/","link":"","permalink":"https://shang.at/post/JAVAå¹¶å‘ç¼–ç¨‹-3-é”/","excerpt":"","text":"","categories":[{"name":"JAVAå¹¶å‘ç¼–ç¨‹","slug":"JAVAå¹¶å‘ç¼–ç¨‹","permalink":"https://shang.at/categories/JAVAå¹¶å‘ç¼–ç¨‹/"}],"tags":[{"name":"é”","slug":"é”","permalink":"https://shang.at/tags/é”/"}]},{"title":"JAVAå¹¶å‘ç¼–ç¨‹-2-å¹¶å‘åŸºç¡€","slug":"JAVAå¹¶å‘ç¼–ç¨‹-2-å¹¶å‘åŸºç¡€","date":"2020-06-03T02:50:55.000Z","updated":"2020-06-03T02:58:23.366Z","comments":true,"path":"post/JAVAå¹¶å‘ç¼–ç¨‹-2-å¹¶å‘åŸºç¡€/","link":"","permalink":"https://shang.at/post/JAVAå¹¶å‘ç¼–ç¨‹-2-å¹¶å‘åŸºç¡€/","excerpt":"","text":"","categories":[{"name":"JAVAå¹¶å‘ç¼–ç¨‹","slug":"JAVAå¹¶å‘ç¼–ç¨‹","permalink":"https://shang.at/categories/JAVAå¹¶å‘ç¼–ç¨‹/"}],"tags":[{"name":"å¹¶å‘åŸºç¡€","slug":"å¹¶å‘åŸºç¡€","permalink":"https://shang.at/tags/å¹¶å‘åŸºç¡€/"}]},{"title":"JAVAå¹¶å‘ç¼–ç¨‹-1-å†…å­˜æ¨¡å‹JMM","slug":"JAVAå¹¶å‘ç¼–ç¨‹-1-å†…å­˜æ¨¡å‹JMM","date":"2020-06-03T02:50:11.000Z","updated":"2020-12-11T08:17:49.358Z","comments":true,"path":"post/JAVAå¹¶å‘ç¼–ç¨‹-1-å†…å­˜æ¨¡å‹JMM/","link":"","permalink":"https://shang.at/post/JAVAå¹¶å‘ç¼–ç¨‹-1-å†…å­˜æ¨¡å‹JMM/","excerpt":"","text":"ç¡¬ä»¶å±‚çš„å¹¶å‘ä¼˜åŒ–åŸºç¡€ ä¸ºäº†è§£å†³CPUé€Ÿåº¦å’Œå†…å­˜ã€ç£ç›˜çš„é€Ÿåº¦çš„å·®å¼‚(ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œå·®å¼‚æ˜¯å¾ˆå¤§çš„)å¸¦æ¥çš„èµ„æºåº”ç”¨ä¸å‡è¡¡çš„é—®é¢˜ï¼Œåœ¨ç¡¬ä»¶å±‚æ˜¯åšäº†å¾ˆå¤šä¼˜åŒ–çš„ï¼Œå…¶ä¸­ä¸€ä¸ªå°±æ˜¯å¢åŠ å¤šçº§ç¼“å­˜æœºåˆ¶ï¼Œè¯¥æœºåˆ¶ä¼šåˆ©ç”¨å±€éƒ¨æ€§åŸç†(è®¿é—®æŸä¸ªæ•°æ®ï¼Œé‚£ä¹ˆå®ƒé™„è¿‘çš„æ•°æ®å°†å¾ˆæœ‰å¯èƒ½è¢«è®¿é—®)ï¼Œå°†æœ€è¿‘è¢«è®¿é—®çš„æ•°æ®åšä¸€å±‚ç¼“å­˜ï¼Œé‚£ä¹ˆä¸‹æ¬¡å†æ¬¡è®¿é—®è¯¥æ•°æ®çš„æ—¶å€™ï¼Œé€Ÿåº¦ä¼šå¿«å¾ˆå¤šã€‚ å…¶ä¸­L1å’ŒL2çº§ç¼“å­˜æ˜¯ä¸CPUæ ¸ç»‘å®šçš„ï¼Œé‚£ä¹ˆè¿™å°±æœ‰å¯èƒ½å¯¼è‡´ä¸€ä¸ªé—®é¢˜ï¼šåœ¨å¹¶å‘ç¯å¢ƒä¸‹ä¸åŒçš„æ ¸åœ¨åšL1å’ŒL2ç¼“å­˜çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¸¤è€…ç¼“å­˜çš„æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ï¼Œå³Core1å’ŒCore2åŒæ—¶ç¼“å­˜äº†ä¸€ä¸ªå˜é‡xï¼Œä½†æ˜¯åœ¨Core1æŠŠå®ƒä¿®æ”¹äº†ï¼Œè¿™ä¸ªæ—¶å€™Core2çš„ç¼“å­˜å®é™…æ¡‘ä¸Šå°±ä¸å¯¹äº†ã€‚é‚£ä¹ˆå¦‚ä½•è¿›è¡ŒåŒæ­¥å‘¢ï¼Ÿ ç¡¬ä»¶å±‚ç¼“å­˜ä¸€è‡´æ€§ æ€»çº¿é”ï¼šè€çš„CPU æ•°æ®ä¸€è‡´æ€§åè®® MESI Cacheä¸€è‡´æ€§åè®® æ˜¯ä¸€ç§ç¼“å­˜é” åè®®å¾ˆå¤š intel ç”¨MESIï¼Œç»™æ¯ä¸ªç¼“å­˜çš„å†…å®¹ä½œäº†ä¸€ä¸ªæ ‡è®° M: è¢«ä¿®æ”¹ï¼ˆModified) è¯¥ç¼“å­˜è¡Œåªè¢«ç¼“å­˜åœ¨è¯¥CPUçš„ç¼“å­˜ä¸­ï¼Œå¹¶ä¸”æ˜¯è¢«ä¿®æ”¹è¿‡çš„ï¼ˆdirty),å³ä¸ä¸»å­˜ä¸­çš„æ•°æ®ä¸ä¸€è‡´ï¼Œè¯¥ç¼“å­˜è¡Œä¸­çš„å†…å­˜éœ€è¦åœ¨æœªæ¥çš„æŸä¸ªæ—¶é—´ç‚¹ï¼ˆå…è®¸å…¶å®ƒCPUè¯»å–è¯·ä¸»å­˜ä¸­ç›¸åº”å†…å­˜ä¹‹å‰ï¼‰å†™å›ï¼ˆwrite backï¼‰ä¸»å­˜ã€‚ å½“è¢«å†™å›ä¸»å­˜ä¹‹åï¼Œè¯¥ç¼“å­˜è¡Œçš„çŠ¶æ€ä¼šå˜æˆç‹¬äº«ï¼ˆexclusive)çŠ¶æ€ã€‚ E: ç‹¬äº«çš„ï¼ˆExclusive) è¯¥ç¼“å­˜è¡Œåªè¢«ç¼“å­˜åœ¨è¯¥CPUçš„ç¼“å­˜ä¸­ï¼Œå®ƒæ˜¯æœªè¢«ä¿®æ”¹è¿‡çš„ï¼ˆclean)ï¼Œä¸ä¸»å­˜ä¸­æ•°æ®ä¸€è‡´ã€‚è¯¥çŠ¶æ€å¯ä»¥åœ¨ä»»ä½•æ—¶åˆ»å½“æœ‰å…¶å®ƒCPUè¯»å–è¯¥å†…å­˜æ—¶å˜æˆå…±äº«çŠ¶æ€ï¼ˆshared)ã€‚ åŒæ ·åœ°ï¼Œå½“CPUä¿®æ”¹è¯¥ç¼“å­˜è¡Œä¸­å†…å®¹æ—¶ï¼Œè¯¥çŠ¶æ€å¯ä»¥å˜æˆModifiedçŠ¶æ€ã€‚ S: å…±äº«çš„ï¼ˆShared) è¯¥çŠ¶æ€æ„å‘³ç€è¯¥ç¼“å­˜è¡Œå¯èƒ½è¢«å¤šä¸ªCPUç¼“å­˜ï¼Œå¹¶ä¸”å„ä¸ªç¼“å­˜ä¸­çš„æ•°æ®ä¸ä¸»å­˜æ•°æ®ä¸€è‡´ï¼ˆclean)ï¼Œå½“æœ‰ä¸€ä¸ªCPUä¿®æ”¹è¯¥ç¼“å­˜è¡Œä¸­ï¼Œå…¶å®ƒCPUä¸­è¯¥ç¼“å­˜è¡Œå¯ä»¥è¢«ä½œåºŸï¼ˆå˜æˆæ— æ•ˆçŠ¶æ€ï¼ˆInvalidï¼‰ï¼‰ã€‚ I: æ— æ•ˆçš„ï¼ˆInvalidï¼‰ è¯¥ç¼“å­˜æ˜¯æ— æ•ˆçš„ï¼ˆå¯èƒ½æœ‰å…¶å®ƒCPUä¿®æ”¹äº†è¯¥ç¼“å­˜è¡Œï¼‰ã€‚ https://www.cnblogs.com/z00377750/p/9180644.html ç°ä»£CPUçš„æ•°æ®ä¸€è‡´æ€§å®ç° = ç¼“å­˜é”(MESI â€¦) + æ€»çº¿é” ç¼“å­˜è¡Œè¯»å–ç¼“å­˜ä»¥cache lineä¸ºåŸºæœ¬å•ä½ï¼Œç›®å‰64bytes ä½äºåŒä¸€ç¼“å­˜è¡Œçš„ä¸¤ä¸ªä¸åŒæ•°æ®ï¼Œè¢«ä¸¤ä¸ªä¸åŒCPUé”å®šï¼Œäº§ç”Ÿäº’ç›¸å½±å“çš„ä¼ªå…±äº«é—®é¢˜ ä¼ªå…±äº«é—®é¢˜ï¼šJUC/c_028_FalseSharing ä½¿ç”¨ç¼“å­˜è¡Œçš„å¯¹é½èƒ½å¤Ÿæé«˜æ•ˆç‡ ä¹±åºæ‰§è¡ŒCPUä¸ºäº†æé«˜æŒ‡ä»¤æ‰§è¡Œæ•ˆç‡ï¼Œä¼šåœ¨ä¸€æ¡æŒ‡ä»¤æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼ˆæ¯”å¦‚å»å†…å­˜è¯»å–æ•°æ®ï¼ˆæ…¢100å€ï¼‰ï¼‰ï¼Œä»–ä¼šå»åŒæ—¶æ‰§è¡Œå¦ä¸€æ¡æŒ‡ä»¤ï¼Œå‰ææ˜¯ï¼Œä¸¤æ¡æŒ‡ä»¤æ²¡æœ‰ä¾èµ–å…³ç³» https://www.cnblogs.com/liushaodong/p/4777308.html å†™æ“ä½œä¹Ÿå¯ä»¥åˆå¹¶ï¼š åˆå¹¶å†™ï¼šWC Bufferï¼ŒWrite Combiner Bufferã€‚ä¸€èˆ¬åªæœ‰4Bytesï¼Œä½äºæ¯”L1ç¼“å­˜è¿˜é«˜çš„çº§åˆ« 12345JUC/029_WriteCombiningä¹±åºæ‰§è¡Œçš„è¯æ˜ï¼šJVM/jmm/Disorder.javaåŸå§‹å‚è€ƒï¼šhttps://preshing.com/20120515/memory-reordering-caught-in-the-act/ å¦‚ä½•ä¿è¯ç‰¹å®šæƒ…å†µä¸‹ ä¸ä¹±åºç¡¬ä»¶çº§åˆ«çš„å†…å­˜å±éšœï¼šIntelçš„CPUçš„æ±‡ç¼–æŒ‡ä»¤ sfenceï¼š save fence lfenceï¼š load fence mfenceï¼š modify fence åŸå­æŒ‡ä»¤ï¼šå¦‚x86ä¸Šçš„lock ...æŒ‡ä»¤æ˜¯ä¸€ä¸ªFullBarrierï¼Œæ‰§è¡Œæ—¶ä¼šé”ä½å†…å­˜å­ç³»ç»Ÿæ¥ç¡®ä¿æ‰§è¡Œé¡ºåºï¼Œç”šè‡³è·¨å¤šä¸ªCPUã€‚Sofeware Locksé€šå¸¸æ˜¯ä½¿ç”¨äº†å†…å­˜å±éšœæˆ–åŸå­æŒ‡ä»¤æ¥å®ç°å˜é‡çš„å¯è§æ€§å’Œä¿æŒç¨‹åºçš„é¡ºåº JVMçº§åˆ«çš„å†…å­˜å±éšœ volatileçš„å®ç°ç»†èŠ‚ å­—èŠ‚ç å±‚é¢ â€‹ åœ¨ç¼–è¯‘æˆå­—èŠ‚ç çš„æ—¶å€™ï¼Œè¢«æ ‡è®°å­—æ®µçš„accessflagsä¸º0x0040ï¼Œå³åŠ äº†ä¸€ä¸ªvolatileçš„æ ‡è®° JVMå±‚é¢ åœ¨volatileå˜é‡çš„è¯»å†™æ“ä½œå‰åä¼šåŠ å…¥ä¸åŒçš„å†…å­˜å±éšœï¼Œä¿è¯volatileå˜é‡è¯»å†™æ“ä½œä¸ä¼šå‘ç”Ÿä¹±åº OSå’Œç¡¬ä»¶å±‚é¢ https://blog.csdn.net/qq_26222859/article/details/52235930 hsdis - HotSpot Dis Assembler windows lock æŒ‡ä»¤å®ç° | MESIå®ç° synchronizedå®ç°ç»†èŠ‚ å­—èŠ‚ç å±‚é¢ACC_SYNCHRONIZEDmonitorenter monitorexit JVMå±‚é¢C C++ è°ƒç”¨äº†æ“ä½œç³»ç»Ÿæä¾›çš„åŒæ­¥æœºåˆ¶ OSå’Œç¡¬ä»¶å±‚é¢X86 : lock cmpxchg / xxxhttps://blog.csdn.net/21aspnet/article/details/88571740 javaå¹¶å‘å†…å­˜æ¨¡å‹ Happened-BeforeåŸåˆ™ as-is-serial","categories":[{"name":"JAVAå¹¶å‘ç¼–ç¨‹","slug":"JAVAå¹¶å‘ç¼–ç¨‹","permalink":"https://shang.at/categories/JAVAå¹¶å‘ç¼–ç¨‹/"}],"tags":[{"name":"å†…å­˜æ¨¡å‹JMM","slug":"å†…å­˜æ¨¡å‹JMM","permalink":"https://shang.at/tags/å†…å­˜æ¨¡å‹JMM/"}]},{"title":"Sparkåº”ç”¨-Scheduler","slug":"Sparkåº”ç”¨-Scheduler","date":"2020-06-01T06:22:50.000Z","updated":"2021-05-07T01:51:09.179Z","comments":true,"path":"post/Sparkåº”ç”¨-Scheduler/","link":"","permalink":"https://shang.at/post/Sparkåº”ç”¨-Scheduler/","excerpt":"","text":"Sparkä»»åŠ¡æœ‰å››ç§æäº¤æ–¹å¼ï¼š local standalone yarn(è¿™é‡Œç€é‡è®²) mesos è¿™é‡Œæ¶‰åŠåˆ°ä¸¤å±‚çš„ä»»åŠ¡è°ƒåº¦ï¼š ç¬¬ä¸€å±‚ï¼šschedule across applicationsï¼Œåº”ç”¨é—´çš„ä»»åŠ¡è°ƒåº¦Sparkçš„applicationæäº¤åˆ°yarnå¹³å°ï¼Œyarnå¹³å°è´Ÿè´£Spark applicationçš„è°ƒåº¦ï¼Œè¿™é‡Œä¹Ÿåˆ†ä¸ºä¸¤å±‚ï¼š ç¬¬ä¸€å±‚ï¼šYarnçš„é˜Ÿåˆ—ï¼ŒSpark applicationå’Œå…¶ä»–è¿è¡Œåœ¨Yarnå¹³å°ä¸Šçš„åº”ç”¨å¹¶æ— äºŒè‡´ï¼Œéƒ½è¦ç»Ÿä¸€æœä»yarnå¹³å°çš„å®‰æ’yarnæœ‰ä¸‰ç§ä»»åŠ¡è°ƒåº¦æ¨¡å‹ï¼š FIFO schedulerï¼šå…ˆå…¥å…ˆå‡ºè°ƒåº¦å™¨ï¼Œæ•´ä¸ªYarné›†ç¾¤åªæœ‰ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—ï¼Œæ‰€æœ‰æäº¤çš„ä»»åŠ¡éƒ½è¦ç­‰å¾…ä¸Šä¸€ä¸ªä»»åŠ¡å®Œå…¨æ‰§è¡Œå®Œæ‰èƒ½æ‰§è¡Œï¼Œé™¤éé›†ç¾¤ä¸­æœ‰ç©ºé—²çš„èµ„æº Capacity schedulerï¼šå®¹é‡è°ƒåº¦å™¨ï¼Œä»¥Capacityä¸ºä¸­å¿ƒï¼ŒæŠŠèµ„æºåˆ’åˆ†åˆ°è‹¥å¹²ä¸ªé˜Ÿåˆ—ä¸­ï¼Œå„ä¸ªé˜Ÿåˆ—å†…æ ¹æ®è‡ªå·±çš„é€»è¾‘åˆ†é…èµ„æºã€‚ä¾‹å¦‚ä¸‹å›¾ä¸­é˜Ÿåˆ—Aå¯ä»¥è°ƒåº¦çš„èµ„æºå¯ä»¥å 80%ï¼Œé˜Ÿåˆ—Bå æœ‰å‰©ä¸‹çš„20%ï¼Œå„é˜Ÿåˆ—æ¥å—ç›¸åº”çš„ä½œä¸šè¯·æ±‚ï¼Œåœ¨è‡ªå·±çš„èµ„æºä¸­åˆ†é… Fair schedulerï¼šç§‰æ‰¿å…¬å¹³æ€§åŸåˆ™ï¼Œå°½å¯èƒ½è®©å„ä¸ªä½œä¸šå¾—åˆ°çš„èµ„æºå¹³å‡ã€‚å…ˆæäº¤çš„job1é©¬ä¸Šå æ»¡äº†é›†ç¾¤èµ„æºï¼Œé‚£ä¹ˆä½œä¸š2æäº¤ä¹‹åï¼ŒåŸæœ¬Job1å æœ‰çš„èµ„æºæ‹¨å‡ºä¸€äº›ç»™ä½œä¸š2ï¼Œä»è€Œè¾¾åˆ°â€œå…¬å¹³â€(ä½†æ˜¯è¦ç­‰åˆ°job1çš„æŸäº›taskæ‰§è¡Œå®Œæ¯•ä¹‹åæ‰èƒ½æŠŠèµ„æºè®©å‡ºæ¥) ç¬¬äºŒå±‚ï¼šYarné˜Ÿåˆ—å†…çš„è°ƒåº¦å½“ä½¿ç”¨FIFO schedulerï¼Œè‡ªä¸å¿…è¯´ï¼Œå®ƒåªæœ‰ä¸€ä¸ªå…ˆè¿›å…ˆå‡ºçš„é˜Ÿåˆ—ï¼Œä¹Ÿå°±æ˜¯é˜Ÿåˆ—å†…éƒ¨çš„ä»»åŠ¡è°ƒåº¦ï¼›Capacity schedulerä¼šæŠŠ é›†ç¾¤åˆ†æˆè‹¥å¹²ä¸ªé˜Ÿåˆ—ï¼Œæ¯ä¸ªé˜Ÿåˆ—å†…éƒ¨é‡‡ç”¨FIFOçš„ç­–ç•¥ï¼›Fair schedulerå¯ä»¥é€šè¿‡è®¾ç½®ï¼Œæ¯ä¸ªFair Queueå†…éƒ¨ä½¿ç”¨ä¸åŒçš„schedulingPolicyï¼Œä½†æ˜¯ä¼šæœ‰ä¸€ä¸ªæ–‡æ¡£çº§åˆ«çš„é»˜è®¤ç­–ç•¥çš„é…ç½®defaultQueueSchedulingPolicyï¼Œå¦‚æœæ¯ä¸ªQueueæ²¡æœ‰è‡ªå·±çš„è®¾ç½®ï¼Œé‚£ä¹ˆå°±ç”¨defaultQueueSchedulingPolicy ç¬¬äºŒå±‚ï¼šschedule within applicationï¼ŒåŒä¸€ä¸ªSparkContextå†…çš„jobè°ƒåº¦è°ˆSparkä¸‹å¹¶è¡Œæ‰§è¡Œå¤šä¸ªJobçš„é—®é¢˜ ä¸€æ¬¡ Spark SQL æ€§èƒ½æå‡10å€çš„ç»å† Sparkè°ƒåº¦ï¼ˆä¸€ï¼‰ï¼šTaskè°ƒåº¦ç®—æ³•ï¼ŒFIFOè¿˜æ˜¯FAIR ç†è§£YARN Scheduler","categories":[],"tags":[{"name":"Scheduler","slug":"Scheduler","permalink":"https://shang.at/tags/Scheduler/"}]},{"title":"åˆ†å¸ƒå¼å¸¸è§æ€æƒ³-Bloomfilter","slug":"åˆ†å¸ƒå¼å¸¸è§æ€æƒ³-Bloomfilter","date":"2020-06-01T01:58:27.000Z","updated":"2020-06-01T01:58:58.674Z","comments":true,"path":"post/åˆ†å¸ƒå¼å¸¸è§æ€æƒ³-Bloomfilter/","link":"","permalink":"https://shang.at/post/åˆ†å¸ƒå¼å¸¸è§æ€æƒ³-Bloomfilter/","excerpt":"","text":"","categories":[{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","permalink":"https://shang.at/categories/åˆ†å¸ƒå¼/"}],"tags":[{"name":"BloomFilter","slug":"BloomFilter","permalink":"https://shang.at/tags/BloomFilter/"}]},{"title":"æ•°æ®ç»“æ„ä¸ç®—æ³•å­¦ä¹ ç¬”è®°-å†…å­˜ä¸è¶³","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•å­¦ä¹ ç¬”è®°-å†…å­˜ä¸è¶³","date":"2020-05-31T23:35:34.000Z","updated":"2020-07-02T11:07:58.668Z","comments":true,"path":"post/æ•°æ®ç»“æ„ä¸ç®—æ³•å­¦ä¹ ç¬”è®°-å†…å­˜ä¸è¶³/","link":"","permalink":"https://shang.at/post/æ•°æ®ç»“æ„ä¸ç®—æ³•å­¦ä¹ ç¬”è®°-å†…å­˜ä¸è¶³/","excerpt":"","text":"ä¸­ä½æ•°å®šä¹‰ï¼šæ•°å­—æ’åºä¹‹åï¼Œä½äºä¸­é—´çš„é‚£ä¸ªæ•°ã€‚æ¯”å¦‚å°†100äº¿ä¸ªæ•°å­—è¿›è¡Œæ’åºï¼Œæ’åºä¹‹åï¼Œä½äºç¬¬50äº¿ä¸ªä½ç½®çš„é‚£ä¸ªæ•° å°±æ˜¯ä¸­ä½æ•°ã€‚ â‘ å†…å­˜å¤Ÿï¼šå†…å­˜å¤Ÿè¿˜æ…Œä»€ä¹ˆå•Šï¼Œç›´æ¥æŠŠ100äº¿ä¸ªå…¨éƒ¨æ’åºäº†ï¼Œä½ ç”¨å†’æ³¡éƒ½å¯ä»¥â€¦ç„¶åæ‰¾åˆ°ä¸­é—´é‚£ä¸ªå°±å¯ä»¥äº†ã€‚ä½†æ˜¯ä½ ä»¥ä¸ºé¢è¯•å®˜ä¼šç»™ä½ å†…å­˜ï¼Ÿï¼Ÿ â‘¡å†…å­˜ä¸å¤Ÿï¼šé¢˜ç›®è¯´æ˜¯æ•´æ•°ï¼Œæˆ‘ä»¬è®¤ä¸ºæ˜¯å¸¦ç¬¦å·çš„int,æ‰€ä»¥4å­—èŠ‚ï¼Œå 32ä½ã€‚ å‡è®¾100äº¿ä¸ªæ•°å­—ä¿å­˜åœ¨ä¸€ä¸ªå¤§æ–‡ä»¶ä¸­ï¼Œä¾æ¬¡è¯»ä¸€éƒ¨åˆ†æ–‡ä»¶åˆ°å†…å­˜(ä¸è¶…è¿‡å†…å­˜çš„é™åˆ¶)ï¼Œå°†æ¯ä¸ªæ•°å­—ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºï¼Œæ¯”è¾ƒäºŒè¿›åˆ¶çš„æœ€é«˜ä½(ç¬¬32ä½ï¼Œç¬¦å·ä½ï¼Œ0æ˜¯æ­£ï¼Œ1æ˜¯è´Ÿ)ï¼Œå¦‚æœæ•°å­—çš„æœ€é«˜ä½ä¸º0ï¼Œåˆ™å°†è¿™ä¸ªæ•°å­—å†™å…¥ file_0æ–‡ä»¶ä¸­ï¼›å¦‚æœæœ€é«˜ä½ä¸º 1ï¼Œåˆ™å°†è¯¥æ•°å­—å†™å…¥file_1æ–‡ä»¶ä¸­ã€‚ ä»è€Œå°†100äº¿ä¸ªæ•°å­—åˆ†æˆäº†ä¸¤ä¸ªæ–‡ä»¶ï¼Œå‡è®¾ file_0æ–‡ä»¶ä¸­æœ‰ 60äº¿ ä¸ªæ•°å­—ï¼Œfile_1æ–‡ä»¶ä¸­æœ‰ 40äº¿ ä¸ªæ•°å­—ã€‚é‚£ä¹ˆä¸­ä½æ•°å°±åœ¨ file_0 æ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”æ˜¯ file_0 æ–‡ä»¶ä¸­æ‰€æœ‰æ•°å­—æ’åºä¹‹åçš„ç¬¬ 10äº¿ ä¸ªæ•°å­—ã€‚ï¼ˆfile_1ä¸­çš„æ•°éƒ½æ˜¯è´Ÿæ•°ï¼Œfile_0ä¸­çš„æ•°éƒ½æ˜¯æ­£æ•°ï¼Œä¹Ÿå³è¿™é‡Œä¸€å…±åªæœ‰40äº¿ä¸ªè´Ÿæ•°ï¼Œé‚£ä¹ˆæ’åºä¹‹åçš„ç¬¬50äº¿ä¸ªæ•°ä¸€å®šä½äºfile_0ä¸­ï¼‰ ç°åœ¨ï¼Œæˆ‘ä»¬åªéœ€è¦å¤„ç† file_0 æ–‡ä»¶äº†ï¼ˆä¸éœ€è¦å†è€ƒè™‘file_1æ–‡ä»¶ï¼‰ã€‚å¯¹äº file_0 æ–‡ä»¶ï¼ŒåŒæ ·é‡‡å–ä¸Šé¢çš„æªæ–½å¤„ç†ï¼šå°†file_0æ–‡ä»¶ä¾æ¬¡è¯»ä¸€éƒ¨åˆ†åˆ°å†…å­˜(ä¸è¶…å†…å­˜é™åˆ¶)ï¼Œå°†æ¯ä¸ªæ•°å­—ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºï¼Œæ¯”è¾ƒäºŒè¿›åˆ¶çš„ æ¬¡é«˜ä½ï¼ˆç¬¬31ä½ï¼‰ï¼Œå¦‚æœæ•°å­—çš„æ¬¡é«˜ä½ä¸º0ï¼Œå†™å…¥file_0_0æ–‡ä»¶ä¸­ï¼›å¦‚æœæ¬¡é«˜ä½ä¸º1ï¼Œå†™å…¥file_0_1æ–‡ä»¶ ä¸­ã€‚ ç°å‡è®¾ file_0_0æ–‡ä»¶ä¸­æœ‰30äº¿ä¸ªæ•°å­—ï¼Œfile_0_1ä¸­ä¹Ÿæœ‰30äº¿ä¸ªæ•°å­—ï¼Œåˆ™ä¸­ä½æ•°å°±æ˜¯ï¼šfile_0_0æ–‡ä»¶ä¸­çš„æ•°å­—ä»å°åˆ°å¤§æ’åºä¹‹åçš„ç¬¬10äº¿ä¸ªæ•°å­—ã€‚ æŠ›å¼ƒfile_0_1æ–‡ä»¶ï¼Œç»§ç»­å¯¹ file_0_0æ–‡ä»¶ æ ¹æ® æ¬¡æ¬¡é«˜ä½(ç¬¬30ä½) åˆ’åˆ†ï¼Œå‡è®¾æ­¤æ¬¡åˆ’åˆ†çš„ä¸¤ä¸ªæ–‡ä»¶ä¸ºï¼šfile_0_0_0ä¸­æœ‰5äº¿ä¸ªæ•°å­—ï¼Œfile_0_0_1ä¸­æœ‰25äº¿ä¸ªæ•°å­—ï¼Œé‚£ä¹ˆä¸­ä½æ•°å°±æ˜¯ file_0_0_1æ–‡ä»¶ä¸­çš„æ‰€æœ‰æ•°å­—æ’åºä¹‹åçš„ ç¬¬ 5äº¿ ä¸ªæ•°ã€‚ æŒ‰ç…§ä¸Šè¿°æ€è·¯ï¼Œç›´åˆ°åˆ’åˆ†çš„æ–‡ä»¶å¯ç›´æ¥åŠ è½½è¿›å†…å­˜æ—¶ï¼Œå°±å¯ä»¥ç›´æ¥å¯¹æ•°å­—è¿›è¡Œå¿«é€Ÿæ’åºï¼Œæ‰¾å‡ºä¸­ä½æ•°äº†ã€‚","categories":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://shang.at/categories/æ•°æ®ç»“æ„ä¸ç®—æ³•/"}],"tags":[{"name":"å¤–æ’-åˆ†ç»„å½’å¹¶-æ¡¶æ’åº","slug":"å¤–æ’-åˆ†ç»„å½’å¹¶-æ¡¶æ’åº","permalink":"https://shang.at/tags/å¤–æ’-åˆ†ç»„å½’å¹¶-æ¡¶æ’åº/"}]},{"title":"Javaå­¦ä¹ -Future","slug":"Javaå­¦ä¹ -Future","date":"2020-05-31T22:44:35.000Z","updated":"2020-06-03T09:32:37.246Z","comments":true,"path":"post/Javaå­¦ä¹ -Future/","link":"","permalink":"https://shang.at/post/Javaå­¦ä¹ -Future/","excerpt":"","text":"","categories":[{"name":"JAVAå­¦ä¹ ","slug":"JAVAå­¦ä¹ ","permalink":"https://shang.at/categories/JAVAå­¦ä¹ /"}],"tags":[{"name":"å¹¶å‘ç¼–ç¨‹-Future","slug":"å¹¶å‘ç¼–ç¨‹-Future","permalink":"https://shang.at/tags/å¹¶å‘ç¼–ç¨‹-Future/"}]},{"title":"Pythonå­¦ä¹ -ä¸€äº›å¸¸è§çš„æ“ä½œ","slug":"Pythonå­¦ä¹ -ä¸€äº›å¸¸è§çš„æ“ä½œ","date":"2020-05-29T09:15:13.000Z","updated":"2021-05-19T02:25:10.732Z","comments":true,"path":"post/Pythonå­¦ä¹ -ä¸€äº›å¸¸è§çš„æ“ä½œ/","link":"","permalink":"https://shang.at/post/Pythonå­¦ä¹ -ä¸€äº›å¸¸è§çš„æ“ä½œ/","excerpt":"","text":"å…¨å±€å˜é‡æŠŠglobalè¯­å¥æ”¾åˆ°å‡½æ•°çš„å¼€å¤´ æ•°ç»„ å¦‚ä½•åˆå§‹åŒ–ä¸€ä¸ªä¸€ç»´æ•°ç»„ 123n=10l = [0]*nl1 = [0 for _ in range(n)] å¦‚ä½•åˆå§‹åŒ–ä¸€ä¸ªäºŒç»´æ•°ç»„ 123m, n = 10, 7l = [[0]*m]*n # ä¼šæœ‰èµ‹å€¼é—®é¢˜ï¼šnä¸ª[0]*m å®é™…ä¸Šéƒ½æ˜¯åŒä¸€ä¸ªå¯¹è±¡l1 = [[0 for _ in range(m)] for _ in range(n)] # æ²¡æœ‰èµ‹å€¼é—®é¢˜ å¦‚ä½•åˆå§‹åŒ–ä¸€ä¸ªäºŒç»´æ•°ç»„å¹¶ä¸”è®¾ç½®å³è¾¹ç•Œå’Œä¸‹è¾¹ç•Œä¸º1(æ ¹æ®å®é™…æƒ…å†µå¤„ç†) 12m, n = 10, 7dp = [[1 if i == m - 1 or j == n - 1 else 0 for i in range(m)] for j in range(n)] æ­£åºéå† 123n=10for i in range(n): print(i) å€’åºéå† 123n=10for i in range(n-1, -1, -1): print(i) æ•°ç»„çš„å…ƒç´ æ‹¼æ¥ 1[str(x)+y+str(z) for x in (1,2,3) for y in ('a','b','c') for z in ('0','9')] äºŒç»´æ•°ç»„ä¸€ç»´åŒ– 1234567891011121314151617181920212223242526272829303132333435363738394041from itertools import chainb=[[1,2,3], [5,8], [7,8,9]]c=list(chain(*b))print(c)[1, 2, 3, 5, 8, 7, 8, 9]### --------------------------------------------------------------------------------ab = [[1,2,3], [5,8], [7,8,9]]print([i for item in ab for i in item])[1, 2, 3, 5, 8, 7, 8, 9]### --------------------------------------------------------------------------------import operatorfrom functools import reducea = [[1,2,3], [4,6], [7,8,9,8]]print(reduce(operator.add, a))[1, 2, 3, 4, 6, 7, 8, 9, 8]### --------------------------------------------------------------------------------a = [[1,2,3], [5, 8], [7,8,9]]l=[]for m in range(0,3): for i in a[m]: l.append(i)print(l)[1, 2, 3, 5, 8, 7, 8, 9]### --------------------------------------------------------------------------------a=[[1,2,3], [5,8], [7,8,9]]a= eval('['+str(a).replace(' ','').replace('[','').replace(']','')+']')print(a)[1, 2, 3, 5, 8, 7, 8, 9]### --------------------------------------------------------------------------------def flatten(a): if not isinstance(a, (list, )): return [a] else: b = [] for item in a: b += flatten(item)if __name__ == '__main__': a = [[[1,2],3],[4,[5,6]],[7,8,9]] print(flatten(a))[1, 2, 3, 4, 5, 6, 7, 8, 9]### -------------------------------------------------------------------------------- å¦‚ä½•æ‹·è´ä¸€ä¸ªä¸€ç»´æ•°ç»„ 12x = [1,2,3,4]y = x[:] å¦‚ä½•æ‹·è´ä¸€ä¸ªäºŒç»´æ•°ç»„ 1234567891011121314151617181920212223### --------------------------------------------------------------------------------x=[[1,2,3], [4,6]]y = [row[:] for row in x]### --------------------------------------------------------------------------------x=[[1,2,3], [4,6]]from copy import copy, deepcopyy = deepcopy(x)### --------------------------------------------------------------------------------old_array = [[2, 3], [4, 5]]# python2.*new_array = map(list, old_array)# python3.*new_array = list(map(list, old_array))### --------------------------------------------------------------------------------arr = [[1,2],[3,4]]deepcopy1d2d = lambda lVals: [x if not isinstance(x, list) else x[:] for x in lVals]dst = deepcopy1d2d(arr)dst[1][1]=150print dstprint arr setçš„æ“ä½œ1234567a = t | s # t å’Œ sçš„å¹¶é›† b = t &amp; s # t å’Œ sçš„äº¤é›† c = t â€“ s # æ±‚å·®é›†ï¼ˆé¡¹åœ¨tä¸­ï¼Œä½†ä¸åœ¨sä¸­ï¼‰ d = t ^ s # å¯¹ç§°å·®é›†ï¼ˆé¡¹åœ¨tæˆ–sä¸­ï¼Œä½†ä¸ä¼šåŒæ—¶å‡ºç°åœ¨äºŒè€…ä¸­ï¼‰ asciiç çš„è½¬æ¢12345# è·å–ä¸€ä¸ªå­—ç¬¦çš„asciiç ord('a')# å°†asciiç è½¬æ¢æˆå­—ç¬¦chr(97) å†…å­˜12345678910# å†…å­˜åœ°å€a = 9id(a)# æŸ¥çœ‹ä¸€ä¸ªå¯¹è±¡å†…å­˜å ç”¨å¤§å°(å˜é‡æ‰€å å­—èŠ‚çš„å¤§å°)import syssys.getsizeof(a)# æŸ¥çœ‹å˜é‡ç±»å‹type(a) è¿›åˆ¶123456789101112131415161718192021222324252627282930# äºŒè¿›åˆ¶Ob1010# è·å–ä¸€ä¸ªæ•°å­—çš„äºŒè¿›åˆ¶&gt;&gt;&gt; bin(3)'0b11'&gt;&gt;&gt; bin(-10)'-0b1010'# å…«è¿›åˆ¶0o176# è·å–ä¸€ä¸ªæ•°å­—çš„äºŒè¿›åˆ¶&gt;&gt;&gt; oct(3)'0o3'&gt;&gt;&gt; bin(-3)'-0o3'# åè¿›åˆ¶43# åå…­è¿›åˆ¶0x12abhex(3)&gt;&gt;&gt; '0x3'# 2 8 16 è¿›åˆ¶è½¬æ¢æˆ åè¿›åˆ¶int('101010', 2) # int('0b101010', 0)int('37621', 8) # int('0o37621', 0)int('23abcf', 16) # int('0x23abcf', 0) ä½æ“ä½œ123456&gt;&gt; # å³ç§»ï¼šå‘å³ç§»1ä½å¯ä»¥çœ‹æˆé™¤ä»¥2&lt;&lt; # å·¦ç§»ï¼šå‘å·¦ç§»ä¸€ä½å¯ä»¥çœ‹æˆä¹˜ä»¥2&amp; # ä¸| # æˆ–~ # å–åï¼šæ•ˆæœæ˜¯å¯¹nçš„å†…éƒ¨è¡¨ç¤ºçš„æ¯ä¸€ä½æ±‚è¡¥^ # å¼‚æˆ– äº¤æ¢å…ƒç´ 12345678910111213# é€šå¸¸å†™æ³•a=1b=2a,b = b,a# æ•°ç»„å…ƒç´ äº¤æ¢l = [1,2,3,4,5]l[3], l[1] = l[1], l[3]# ä½†æ˜¯è¦åŒæ—¶äº¤æ¢æ•°ç»„å’Œindexå°±ä¸è¡Œäº†i=0i, l[i] = l[i], 7 # å¤±è´¥ï¼šè¿™é‡Œä¸èƒ½ç”¨è¿™ç§å†™æ³•ï¼Œå› ä¸ºä¿®æ”¹äº†içš„å€¼ä¹‹åï¼Œç­‰å·å‰é¢çš„self.p[i]å°±ä¼šç«‹åˆ»æŒ‡å‘ä¿®æ”¹åçš„içš„ä½ç½®ã€‚è¿™é‡Œå’Œæ™®é€šçš„a bäº¤æ¢æœ‰åŒºåˆ«l[i], i = 7, l[i] # ç­‰å·åé¢çš„l[i]å®é™…ä¸Šæ˜¯å€¼ä¼ é€’ æ•´æ•°çš„æœ€å¤§å€¼å’Œæœ€å°å€¼1234567import sysmax_value = sys.maxsizemin_value = -sys.maxsize - 1max_value = float('inf')min_value = float('-inf') string123456789101112131415161718192021222324252627282930313233import string # å¯¼å…¥stringè¿™ä¸ªæ¨¡å—print(string.digits) # è¾“å‡ºåŒ…å«æ•°å­—0~9çš„å­—ç¬¦ä¸²print(string.ascii_letters) # åŒ…å«æ‰€æœ‰å­—æ¯(å¤§å†™æˆ–å°å†™)çš„å­—ç¬¦ä¸²print(string.ascii_lowercase) # åŒ…å«æ‰€æœ‰å°å†™å­—æ¯çš„å­—ç¬¦ä¸²print(string.ascii_uppercase) # åŒ…å«æ‰€æœ‰å¤§å†™å­—æ¯çš„å­—ç¬¦ä¸²##############0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZprint([chr(i) for i in range(65, 91)]) # æ‰€æœ‰å¤§å†™å­—æ¯print([chr(i) for i in range(97, 123)]) # æ‰€æœ‰å°å†™å­—æ¯print([chr(i) for i in range(48, 58)]) # æ‰€æœ‰æ•°å­—####################['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z']['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z']['0', '1', '2', '3', '4', '5', '6', '7', '8', '9']# å»æ‰ç©ºæ ¼çš„ä¸‰ä¸ªå‡½æ•°&gt;&gt;&gt;a=\" gho stwwl \"&gt;&gt;&gt;a.lstrip()'gho stwwl '&gt;&gt;&gt;a.rstrip()' gho stwwl'&gt;&gt;&gt;a.strip()'gho stwwl' f-stringhttps://blog.csdn.net/sunxb10/article/details/81036693 åˆå¹¶å­—å…¸ï¼šhttps://blog.csdn.net/shanliangliuxing/article/details/7757089","categories":[{"name":"Python","slug":"Python","permalink":"https://shang.at/categories/Python/"}],"tags":[{"name":"å¸¸è§æ“ä½œæŠ€å·§","slug":"å¸¸è§æ“ä½œæŠ€å·§","permalink":"https://shang.at/tags/å¸¸è§æ“ä½œæŠ€å·§/"}]},{"title":"Pythonå­¦ä¹ -lru_cache","slug":"Pythonå­¦ä¹ -lru-cache","date":"2020-05-28T01:48:49.000Z","updated":"2020-05-28T01:49:40.668Z","comments":true,"path":"post/Pythonå­¦ä¹ -lru-cache/","link":"","permalink":"https://shang.at/post/Pythonå­¦ä¹ -lru-cache/","excerpt":"","text":"","categories":[{"name":"Python","slug":"Python","permalink":"https://shang.at/categories/Python/"}],"tags":[{"name":"lru_cache","slug":"lru-cache","permalink":"https://shang.at/tags/lru-cache/"}]},{"title":"Javaå­¦ä¹ -Thread","slug":"Javaå­¦ä¹ -Thread","date":"2020-05-24T11:17:33.000Z","updated":"2020-06-12T01:57:34.925Z","comments":true,"path":"post/Javaå­¦ä¹ -Thread/","link":"","permalink":"https://shang.at/post/Javaå­¦ä¹ -Thread/","excerpt":"","text":"çº¿ç¨‹çš„åŸºæœ¬æ¦‚å¿µè¿›ç¨‹ï¼šæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ç‹¬ç«‹çš„ä»£ç å’Œæ•°æ®ç©ºé—´ï¼ˆè¿›ç¨‹ä¸Šä¸‹æ–‡ï¼‰ï¼Œè¿›ç¨‹é—´çš„åˆ‡æ¢ä¼šæœ‰è¾ƒå¤§çš„å¼€é”€ï¼Œä¸€ä¸ªè¿›ç¨‹åŒ…å«1â€“nä¸ªçº¿ç¨‹ã€‚ï¼ˆè¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„æœ€å°å•ä½ï¼‰çº¿ç¨‹ï¼šåŒä¸€ç±»çº¿ç¨‹å…±äº«ä»£ç å’Œæ•°æ®ç©ºé—´ï¼Œæ¯ä¸ªçº¿ç¨‹æœ‰ç‹¬ç«‹çš„è¿è¡Œæ ˆå’Œç¨‹åºè®¡æ•°å™¨(PC)ï¼Œçº¿ç¨‹åˆ‡æ¢å¼€é”€å°ã€‚ï¼ˆçº¿ç¨‹æ˜¯cpuè°ƒåº¦çš„æœ€å°å•ä½ï¼‰ çº¿ç¨‹çš„çŠ¶æ€åˆ›å»ºã€å°±ç»ªã€è¿è¡Œã€é˜»å¡ã€ç»ˆæ­¢ åˆ›å»ºï¼šæ–°åˆ›å»ºçš„ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡ å°±ç»ªï¼šçº¿ç¨‹å¯¹è±¡åˆ›å»ºæˆåŠŸåï¼Œå…¶ä»–çš„çº¿ç¨‹è°ƒç”¨è¯¥å¯¹è±¡çš„startæ–¹æ³•ã€‚è¯¥çŠ¶æ€çš„çº¿ç¨‹ä½äºå¯è¿è¡Œçº¿ç¨‹æ± å†…ï¼Œå˜çš„å¯è¿è¡Œï¼Œç­‰å¾…è·å–CPUçš„ä½¿ç”¨æƒå‘¢ è¿è¡Œï¼šå°±ç»ªçŠ¶æ€çš„çº¿ç¨‹è·å–äº†CPUä½¿ç”¨æƒï¼Œæ‰§è¡Œç¨‹åºä»£ç  é˜»å¡ï¼šé˜»å¡çŠ¶æ€æ˜¯çº¿ç¨‹å› ä¸ºæŸç§åŸå› æ”¾å¼ƒäº†CPUä½¿ç”¨æƒï¼Œæš‚åœè¿è¡Œã€‚ç›´åˆ°çº¿ç¨‹å†æ¬¡è¿›å…¥å°±ç»ªçŠ¶æ€ï¼Œæ‰æœ‰æœºä¼šè½¬åˆ°è¿è¡ŒçŠ¶æ€ã€‚é˜»å¡çš„æƒ…å†µåˆ†ä¸ºä»¥ä¸‹ä¸‰ç§ï¼š ç­‰å¾…é˜»å¡ï¼šè¿è¡Œçš„çº¿ç¨‹æ‰§è¡Œwaitæ–¹æ³•ï¼ŒJVMä¼šæŠŠè¯¥çº¿ç¨‹æ”¾å…¥ç­‰å¾…æ± ä¸­(waitä¼šé‡Šæ”¾æŒæœ‰çš„é”) åŒæ­¥é˜»å¡ï¼šè¿è¡Œçš„çº¿ç¨‹åœ¨è·å–å¯¹è±¡åŒæ­¥é”çš„æ—¶ï¼Œå¦‚æœè¯¥åŒæ­¥é”è¢«åˆ«çš„çº¿ç¨‹å ç”¨ï¼Œåˆ™JVMä¼šæŠŠæ”¹çº¿ç¨‹æ”¾å…¥é”æ± ä¸­ å…¶ä»–é˜»å¡ï¼šè¿è¡Œçš„çº¿ç¨‹æ‰§è¡Œsleepæˆ–joinæ–¹æ³•ï¼Œæˆ–è€…å‘å‡ºäº†I/O(æ–‡ä»¶è¯»å†™ã€ç½‘ç»œè¯·æ±‚)è¯·æ±‚ï¼ŒJVMä¼šæŠŠè¯¥çº¿ç¨‹ç½®ä¸ºé˜»å¡çŠ¶æ€ã€‚å½“sleepçŠ¶æ€è¶…æ—¶ã€joinç­‰å¾…çº¿ç¨‹ç»ˆæ­¢æˆ–è€…è¶…æ—¶ã€æˆ–è€…I/Oå¤„ç†å®Œæ¯•æ—¶ï¼Œçº¿ç¨‹é‡æ–°è½¬å…¥å°±ç»ªçŠ¶æ€(sleepä¸ä¼šé‡Šæ”¾æŒæœ‰çš„é”) ç»ˆæ­¢ï¼šçº¿ç¨‹æ‰§è¡Œå®Œäº†æˆ–è€…å› å¼‚å¸¸æ¨å‡ºäº†runæ–¹æ³•ï¼Œè¯¥çº¿ç¨‹ç»“æŸç”Ÿå‘½å‘¨æœŸ çº¿ç¨‹åˆ›å»ºå’Œåˆ‡æ¢çš„ä»£ä»·ï¼šhttps://www.jianshu.com/p/ece1bb5fa88b","categories":[{"name":"JAVAå­¦ä¹ ","slug":"JAVAå­¦ä¹ ","permalink":"https://shang.at/categories/JAVAå­¦ä¹ /"}],"tags":[{"name":"å¹¶å‘ç¼–ç¨‹-Thread","slug":"å¹¶å‘ç¼–ç¨‹-Thread","permalink":"https://shang.at/tags/å¹¶å‘ç¼–ç¨‹-Thread/"}]},{"title":"Javaå­¦ä¹ -å¹¶å‘ç¼–ç¨‹","slug":"Javaå­¦ä¹ -å¹¶å‘ç¼–ç¨‹","date":"2020-05-24T10:46:42.000Z","updated":"2021-04-12T09:35:48.272Z","comments":true,"path":"post/Javaå­¦ä¹ -å¹¶å‘ç¼–ç¨‹/","link":"","permalink":"https://shang.at/post/Javaå­¦ä¹ -å¹¶å‘ç¼–ç¨‹/","excerpt":"","text":"æ•´ä½“è„‘å›¾ å¹¶å‘ç¼–ç¨‹é¢†åŸŸå¯ä»¥æŠ½è±¡æˆä¸‰ä¸ªæ ¸å¿ƒé—®é¢˜ï¼šåˆ†å·¥ã€åŒæ­¥å’Œäº’æ–¥ åˆ†å·¥ä¸åŒçš„çº¿ç¨‹è´Ÿè´£ä¸åŒçš„ä»»åŠ¡ï¼Œå¯ä»¥å¹¶å‘çš„æ‰§è¡Œ åŒæ­¥äº’æ–¥ JAVAå¹¶å‘ç¼–ç¨‹-1-å†…å­˜æ¨¡å‹ JAVAå¹¶å‘ç¼–ç¨‹-2-å¹¶å‘åŸºç¡€ JAVAå¹¶å‘ç¼–ç¨‹-3-é” JAVAå¹¶å‘ç¼–ç¨‹-4-å¹¶å‘å·¥å…·ç±» JAVAå¹¶å‘ç¼–ç¨‹-5-ThreadLocal&amp;Fork&amp;Join JAVAå¹¶å‘ç¼–ç¨‹-6-å¹¶å‘é›†åˆ JAVAå¹¶å‘ç¼–ç¨‹-7-Atomic JAVAå¹¶å‘ç¼–ç¨‹-8-é˜»å¡é˜Ÿåˆ— JAVAå¹¶å‘ç¼–ç¨‹-9-çº¿ç¨‹æ±  JAVAå¹¶å‘ç¼–ç¨‹-10-å“åº”å¼ç¼–ç¨‹-RxJava JAVAå¹¶å‘ç¼–ç¨‹-12-å¹¶å‘æ¡†æ¶-Disruptor ç–‘é—®ç§’æ‡‚ç³»åˆ—","categories":[{"name":"JAVAå¹¶å‘ç¼–ç¨‹","slug":"JAVAå¹¶å‘ç¼–ç¨‹","permalink":"https://shang.at/categories/JAVAå¹¶å‘ç¼–ç¨‹/"}],"tags":[{"name":"å¹¶å‘ç¼–ç¨‹","slug":"å¹¶å‘ç¼–ç¨‹","permalink":"https://shang.at/tags/å¹¶å‘ç¼–ç¨‹/"}]},{"title":"Javaå­¦ä¹ -JVM","slug":"Javaå­¦ä¹ -JVM","date":"2020-05-24T10:42:22.000Z","updated":"2020-12-11T08:23:18.090Z","comments":true,"path":"post/Javaå­¦ä¹ -JVM/","link":"","permalink":"https://shang.at/post/Javaå­¦ä¹ -JVM/","excerpt":"","text":"è½¬è½½åœ°å€ : JavaGuide ç‚¹å‡»å…³æ³¨å…¬ä¼—å·åŠæ—¶è·å–ç¬”ä¸»æœ€æ–°æ›´æ–°æ–‡ç« ï¼Œå¹¶å¯å…è´¹é¢†å–æœ¬æ–‡æ¡£é…å¥—çš„ã€ŠJavaé¢è¯•çªå‡»ã€‹ä»¥åŠJavaå·¥ç¨‹å¸ˆå¿…å¤‡å­¦ä¹ èµ„æºã€‚ Java å†…å­˜åŒºåŸŸè¯¦è§£å¦‚æœæ²¡æœ‰ç‰¹æ®Šè¯´æ˜ï¼Œéƒ½æ˜¯é’ˆå¯¹çš„æ˜¯ HotSpot è™šæ‹Ÿæœºã€‚ å†™åœ¨å‰é¢ (å¸¸è§é¢è¯•é¢˜)åŸºæœ¬é—®é¢˜ ä»‹ç»ä¸‹ Java å†…å­˜åŒºåŸŸï¼ˆè¿è¡Œæ—¶æ•°æ®åŒºï¼‰ Java å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹ï¼ˆäº”æ­¥ï¼Œå»ºè®®èƒ½é»˜å†™å‡ºæ¥å¹¶ä¸”è¦çŸ¥é“æ¯ä¸€æ­¥è™šæ‹Ÿæœºåšäº†ä»€ä¹ˆï¼‰ å¯¹è±¡çš„è®¿é—®å®šä½çš„ä¸¤ç§æ–¹å¼ï¼ˆå¥æŸ„å’Œç›´æ¥æŒ‡é’ˆä¸¤ç§æ–¹å¼ï¼‰ æ‹“å±•é—®é¢˜ String ç±»å’Œå¸¸é‡æ±  8 ç§åŸºæœ¬ç±»å‹çš„åŒ…è£…ç±»å’Œå¸¸é‡æ±  ä¸€ æ¦‚è¿°å¯¹äº Java ç¨‹åºå‘˜æ¥è¯´ï¼Œåœ¨è™šæ‹Ÿæœºè‡ªåŠ¨å†…å­˜ç®¡ç†æœºåˆ¶ä¸‹ï¼Œä¸å†éœ€è¦åƒ C/C++ç¨‹åºå¼€å‘ç¨‹åºå‘˜è¿™æ ·ä¸ºæ¯ä¸€ä¸ª new æ“ä½œå»å†™å¯¹åº”çš„ delete/free æ“ä½œï¼Œä¸å®¹æ˜“å‡ºç°å†…å­˜æ³„æ¼å’Œå†…å­˜æº¢å‡ºé—®é¢˜ã€‚æ­£æ˜¯å› ä¸º Java ç¨‹åºå‘˜æŠŠå†…å­˜æ§åˆ¶æƒåˆ©äº¤ç»™ Java è™šæ‹Ÿæœºï¼Œä¸€æ—¦å‡ºç°å†…å­˜æ³„æ¼å’Œæº¢å‡ºæ–¹é¢çš„é—®é¢˜ï¼Œå¦‚æœä¸äº†è§£è™šæ‹Ÿæœºæ˜¯æ€æ ·ä½¿ç”¨å†…å­˜çš„ï¼Œé‚£ä¹ˆæ’æŸ¥é”™è¯¯å°†ä¼šæ˜¯ä¸€ä¸ªéå¸¸è‰°å·¨çš„ä»»åŠ¡ã€‚ äºŒ è¿è¡Œæ—¶æ•°æ®åŒºåŸŸJava è™šæ‹Ÿæœºåœ¨æ‰§è¡Œ Java ç¨‹åºçš„è¿‡ç¨‹ä¸­ä¼šæŠŠå®ƒç®¡ç†çš„å†…å­˜åˆ’åˆ†æˆè‹¥å¹²ä¸ªä¸åŒçš„æ•°æ®åŒºåŸŸã€‚JDK. 1.8 å’Œä¹‹å‰çš„ç‰ˆæœ¬ç•¥æœ‰ä¸åŒï¼Œä¸‹é¢ä¼šä»‹ç»åˆ°ã€‚ JDK 1.8 ä¹‹å‰ï¼š JDK 1.8 ï¼š çº¿ç¨‹ç§æœ‰çš„ï¼šä¸ä¼šå¸¦æ¥å¹¶å‘é—®é¢˜ ç¨‹åºè®¡æ•°å™¨ è™šæ‹Ÿæœºæ ˆ æœ¬åœ°æ–¹æ³•æ ˆ çº¿ç¨‹å…±äº«çš„ï¼šåœ¨å¹¶å‘é—®é¢˜ä¸­ä¸»è¦è§£å†³çš„å°±æ˜¯å†…å­˜å…±äº«é—®é¢˜ï¼Œå…¶ä¸­æœ€ä¸»è¦çš„æ˜¯å †å†…å­˜çš„ç®¡ç† å † æ–¹æ³•åŒº ç›´æ¥å†…å­˜ (éè¿è¡Œæ—¶æ•°æ®åŒºçš„ä¸€éƒ¨åˆ†) ç–‘é—®ï¼šçº¿ç¨‹ç§æœ‰çš„å†…å­˜å ç”¨æ˜¯JVMç®¡ç†çš„å†…å­˜çš„å“ªä¸€éƒ¨åˆ†ï¼Ÿ Xsså‚æ•°æ˜¯è®¾å®šè™šæ‹Ÿæœºä¸­æ¯ä¸ªçº¿ç¨‹å ç”¨çš„æ ˆå†…å­˜å¤§å°ï¼Œè€Œè™šæ‹Ÿæœºæ ˆå¯åˆ†é…çš„å†…å­˜åˆè·Ÿç‰©ç†æœºçš„å†…å­˜å¤§å°ã€Javaå †å†…å­˜ã€æ–¹æ³•åŒº(JDK1.7åŠä»¥å‰)ç­‰å†…å­˜å¤§å°ç›¸å…³ï¼Œå…¶å®ƒçš„åŒºåˆ†å¾—çš„å†…å­˜è¶Šå¤§ï¼Œè™šæ‹Ÿæœºæ ˆèƒ½å¤Ÿåˆ†å¾—çš„å†…å­˜å°±è¶Šå°ï¼Œå¹¶å‘çš„çº¿ç¨‹æ•°é‡ä¹Ÿå°±è¶Šå°â€”â€”â€”â€”è¿™å¥è¯æ˜¯å¯¹çš„å—ï¼Ÿ æµ‹è¯•ï¼šå•çº¿ç¨‹ å¯åŠ¨å‚æ•° -Xss16m -Xms2m -Xmx2mï¼Œstack depth:415910 æŠ¥äº†StackOverflowError 2.1 ç¨‹åºè®¡æ•°å™¨ç¨‹åºè®¡æ•°å™¨æ˜¯ä¸€å—è¾ƒå°çš„å†…å­˜ç©ºé—´ï¼Œå¯ä»¥çœ‹ä½œæ˜¯å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨ã€‚å­—èŠ‚ç è§£é‡Šå™¨å·¥ä½œæ—¶é€šè¿‡æ”¹å˜è¿™ä¸ªè®¡æ•°å™¨çš„å€¼æ¥é€‰å–ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ï¼Œåˆ†æ”¯ã€å¾ªç¯ã€è·³è½¬ã€å¼‚å¸¸å¤„ç†ã€çº¿ç¨‹æ¢å¤ç­‰åŠŸèƒ½éƒ½éœ€è¦ä¾èµ–è¿™ä¸ªè®¡æ•°å™¨æ¥å®Œæˆã€‚ å¦å¤–ï¼Œä¸ºäº†çº¿ç¨‹åˆ‡æ¢åèƒ½æ¢å¤åˆ°æ­£ç¡®çš„æ‰§è¡Œä½ç½®ï¼Œæ¯æ¡çº¿ç¨‹éƒ½éœ€è¦æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ç¨‹åºè®¡æ•°å™¨ï¼Œå„çº¿ç¨‹ä¹‹é—´è®¡æ•°å™¨äº’ä¸å½±å“ï¼Œç‹¬ç«‹å­˜å‚¨ï¼Œæˆ‘ä»¬ç§°è¿™ç±»å†…å­˜åŒºåŸŸä¸ºâ€œçº¿ç¨‹ç§æœ‰â€çš„å†…å­˜ã€‚ ä»ä¸Šé¢çš„ä»‹ç»ä¸­æˆ‘ä»¬çŸ¥é“ç¨‹åºè®¡æ•°å™¨ä¸»è¦æœ‰ä¸¤ä¸ªä½œç”¨ï¼š å­—èŠ‚ç è§£é‡Šå™¨é€šè¿‡æ”¹å˜ç¨‹åºè®¡æ•°å™¨æ¥ä¾æ¬¡è¯»å–æŒ‡ä»¤ï¼Œä»è€Œå®ç°ä»£ç çš„æµç¨‹æ§åˆ¶ï¼Œå¦‚ï¼šé¡ºåºæ‰§è¡Œã€é€‰æ‹©ã€å¾ªç¯ã€å¼‚å¸¸å¤„ç†ã€‚ åœ¨å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œç¨‹åºè®¡æ•°å™¨ç”¨äºè®°å½•å½“å‰çº¿ç¨‹æ‰§è¡Œçš„ä½ç½®ï¼Œä»è€Œå½“çº¿ç¨‹è¢«åˆ‡æ¢å›æ¥çš„æ—¶å€™èƒ½å¤ŸçŸ¥é“è¯¥çº¿ç¨‹ä¸Šæ¬¡è¿è¡Œåˆ°å“ªå„¿äº†ã€‚ æ³¨æ„ï¼šç¨‹åºè®¡æ•°å™¨æ˜¯å”¯ä¸€ä¸€ä¸ªä¸ä¼šå‡ºç° OutOfMemoryError çš„å†…å­˜åŒºåŸŸï¼Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸéšç€çº¿ç¨‹çš„åˆ›å»ºè€Œåˆ›å»ºï¼Œéšç€çº¿ç¨‹çš„ç»“æŸè€Œæ­»äº¡ã€‚ 2.2 Java è™šæ‹Ÿæœºæ ˆä¸ç¨‹åºè®¡æ•°å™¨ä¸€æ ·ï¼ŒJava è™šæ‹Ÿæœºæ ˆä¹Ÿæ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸå’Œçº¿ç¨‹ç›¸åŒï¼Œæè¿°çš„æ˜¯ Java æ–¹æ³•æ‰§è¡Œçš„å†…å­˜æ¨¡å‹ï¼Œæ¯æ¬¡æ–¹æ³•è°ƒç”¨çš„æ•°æ®éƒ½æ˜¯é€šè¿‡æ ˆä¼ é€’çš„ã€‚ Java å†…å­˜å¯ä»¥ç²—ç³™çš„åŒºåˆ†ä¸ºå †å†…å­˜ï¼ˆHeapï¼‰å’Œæ ˆå†…å­˜ (Stack),å…¶ä¸­æ ˆå°±æ˜¯ç°åœ¨è¯´çš„è™šæ‹Ÿæœºæ ˆï¼Œæˆ–è€…è¯´æ˜¯è™šæ‹Ÿæœºæ ˆä¸­å±€éƒ¨å˜é‡è¡¨éƒ¨åˆ†ã€‚ ï¼ˆå®é™…ä¸Šï¼ŒJava è™šæ‹Ÿæœºæ ˆæ˜¯ç”±ä¸€ä¸ªä¸ªæ ˆå¸§ç»„æˆï¼Œè€Œæ¯ä¸ªæ ˆå¸§ä¸­éƒ½æ‹¥æœ‰ï¼šå±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•å‡ºå£ä¿¡æ¯ã€‚ï¼‰ å±€éƒ¨å˜é‡è¡¨ä¸»è¦å­˜æ”¾äº†ç¼–è¯‘æœŸå¯çŸ¥çš„å„ç§æ•°æ®ç±»å‹ï¼ˆbooleanã€byteã€charã€shortã€intã€floatã€longã€doubleï¼‰ã€å¯¹è±¡å¼•ç”¨ï¼ˆreference ç±»å‹ï¼Œå®ƒä¸åŒäºå¯¹è±¡æœ¬èº«ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªæŒ‡å‘å¯¹è±¡èµ·å§‹åœ°å€çš„å¼•ç”¨æŒ‡é’ˆï¼Œä¹Ÿå¯èƒ½æ˜¯æŒ‡å‘ä¸€ä¸ªä»£è¡¨å¯¹è±¡çš„å¥æŸ„æˆ–å…¶ä»–ä¸æ­¤å¯¹è±¡ç›¸å…³çš„ä½ç½®ï¼‰ã€‚ Java è™šæ‹Ÿæœºæ ˆä¼šå‡ºç°ä¸¤ç§é”™è¯¯ï¼šStackOverFlowError å’Œ OutOfMemoryErrorã€‚äºŒè€…å·®å¼‚ StackOverFlowErrorï¼š è‹¥ Java è™šæ‹Ÿæœºæ ˆçš„å†…å­˜å¤§å°ä¸å…è®¸åŠ¨æ€æ‰©å±•ï¼Œé‚£ä¹ˆå½“çº¿ç¨‹è¯·æ±‚æ ˆçš„æ·±åº¦è¶…è¿‡å½“å‰ Java è™šæ‹Ÿæœºæ ˆçš„æœ€å¤§æ·±åº¦çš„æ—¶å€™ï¼Œå°±æŠ›å‡º StackOverFlowError é”™è¯¯ã€‚ OutOfMemoryErrorï¼š è‹¥ Java è™šæ‹Ÿæœºæ ˆçš„å†…å­˜å¤§å°å…è®¸åŠ¨æ€æ‰©å±•ï¼Œä¸”å½“çº¿ç¨‹è¯·æ±‚æ ˆæ—¶å†…å­˜ç”¨å®Œäº†ï¼Œæ— æ³•å†åŠ¨æ€æ‰©å±•äº†ï¼Œæ­¤æ—¶æŠ›å‡º OutOfMemoryError é”™è¯¯ã€‚ Java è™šæ‹Ÿæœºæ ˆä¹Ÿæ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰å„è‡ªçš„ Java è™šæ‹Ÿæœºæ ˆï¼Œè€Œä¸”éšç€çº¿ç¨‹çš„åˆ›å»ºè€Œåˆ›å»ºï¼Œéšç€çº¿ç¨‹çš„æ­»äº¡è€Œæ­»äº¡ã€‚ æ‰©å±•ï¼šé‚£ä¹ˆæ–¹æ³•/å‡½æ•°å¦‚ä½•è°ƒç”¨ï¼Ÿ Java æ ˆå¯ç”¨ç±»æ¯”æ•°æ®ç»“æ„ä¸­æ ˆï¼ŒJava æ ˆä¸­ä¿å­˜çš„ä¸»è¦å†…å®¹æ˜¯æ ˆå¸§ï¼Œæ¯ä¸€æ¬¡å‡½æ•°è°ƒç”¨éƒ½ä¼šæœ‰ä¸€ä¸ªå¯¹åº”çš„æ ˆå¸§è¢«å‹å…¥ Java æ ˆï¼Œæ¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨ç»“æŸåï¼Œéƒ½ä¼šæœ‰ä¸€ä¸ªæ ˆå¸§è¢«å¼¹å‡ºã€‚ Java æ–¹æ³•æœ‰ä¸¤ç§è¿”å›æ–¹å¼ï¼š return è¯­å¥ã€‚ æŠ›å‡ºå¼‚å¸¸ã€‚ ä¸ç®¡å“ªç§è¿”å›æ–¹å¼éƒ½ä¼šå¯¼è‡´æ ˆå¸§è¢«å¼¹å‡ºã€‚ ç–‘é—®ï¼šè™šæ‹Ÿæœºæ ˆåˆ°åº•æ˜¯å ç”¨çš„å“ªå—å†…å­˜å‘¢ï¼ŸJVMç›´æ¥å¼€è¾Ÿçš„ç³»ç»Ÿå†…å­˜ç©ºé—´ï¼Œè¿˜æ˜¯ä¼šå…±äº«heapç©ºé—´ï¼Ÿç”±äºæ¯æ¬¡åˆ›å»ºçº¿ç¨‹ï¼Œéƒ½ä¼šåˆ›å»ºå…¶å¯¹åº”çš„è™šæ‹Ÿæœºæ ˆï¼Œé‚£ä¹ˆçº¿ç¨‹åˆ›å»ºå¤ªå¤šä¼šå¸¦æ¥æå¤§çš„å†…å­˜æ¶ˆè€—ä»£ä»·(ä»¥åŠçº¿ç¨‹åˆ‡æ¢ä»£ä»·) åšäº†ä¸€ä¸ªå®éªŒï¼š â€‹ -Xss4m -Xms8m -Xmx8mï¼šstack depth:215835 æŠ¥äº†java.lang.StackOverflowError â€‹ -Xss16m -Xms8m -Xmx8mï¼šstack depth:416734 æŠ¥äº†java.lang.StackOverflowError â€‹ -Xss32m -Xms8m -Xmx8mï¼šstack depth:835116 æŠ¥äº†java.lang.StackOverflowError ä»å®éªŒç»“æœæ¥çœ‹ï¼Œé™åˆ¶äº†å†…å­˜å¤§å°ä¹‹åï¼Œæ”¹å˜è™šæ‹Ÿæœºæ ˆå¤§å°ï¼Œæ— è®ºæŠŠè™šæ‹Ÿæœºæ ˆè®¾ç½®å¤šå¤§ï¼Œæœ€ç»ˆéƒ½æ˜¯æŠ¥çš„java.lang.StackOverflowErrorï¼Œæ˜¯ä¸æ˜¯å¯ä»¥å¾—å‡ºè¿™æ ·çš„ç»“è®ºï¼Œhotspotçš„è®¾è®¡ä¸­è™šæ‹Ÿæœºæ ˆä½¿ç”¨çš„æ˜¯ç‹¬ç«‹äºjavaå †å†…å­˜çš„ç³»ç»Ÿç©ºé—´å‘¢ï¼Ÿ 2.3 æœ¬åœ°æ–¹æ³•æ ˆå’Œè™šæ‹Ÿæœºæ ˆæ‰€å‘æŒ¥çš„ä½œç”¨éå¸¸ç›¸ä¼¼ï¼ŒåŒºåˆ«æ˜¯ï¼š è™šæ‹Ÿæœºæ ˆä¸ºè™šæ‹Ÿæœºæ‰§è¡Œ Java æ–¹æ³• ï¼ˆä¹Ÿå°±æ˜¯å­—èŠ‚ç ï¼‰æœåŠ¡ï¼Œè€Œæœ¬åœ°æ–¹æ³•æ ˆåˆ™ä¸ºè™šæ‹Ÿæœºä½¿ç”¨åˆ°çš„ Native æ–¹æ³•æœåŠ¡ã€‚ åœ¨ HotSpot è™šæ‹Ÿæœºä¸­å’Œ Java è™šæ‹Ÿæœºæ ˆåˆäºŒä¸ºä¸€ã€‚ æœ¬åœ°æ–¹æ³•è¢«æ‰§è¡Œçš„æ—¶å€™ï¼Œåœ¨æœ¬åœ°æ–¹æ³•æ ˆä¹Ÿä¼šåˆ›å»ºä¸€ä¸ªæ ˆå¸§ï¼Œç”¨äºå­˜æ”¾è¯¥æœ¬åœ°æ–¹æ³•çš„å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€å‡ºå£ä¿¡æ¯ã€‚ æ–¹æ³•æ‰§è¡Œå®Œæ¯•åç›¸åº”çš„æ ˆå¸§ä¹Ÿä¼šå‡ºæ ˆå¹¶é‡Šæ”¾å†…å­˜ç©ºé—´ï¼Œä¹Ÿä¼šå‡ºç° StackOverFlowError å’Œ OutOfMemoryError ä¸¤ç§é”™è¯¯ã€‚ 2.4 å †Java è™šæ‹Ÿæœºæ‰€ç®¡ç†çš„å†…å­˜ä¸­æœ€å¤§çš„ä¸€å—ï¼ŒJava å †æ˜¯æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ä¸€å—å†…å­˜åŒºåŸŸï¼Œåœ¨è™šæ‹Ÿæœºå¯åŠ¨æ—¶åˆ›å»ºã€‚æ­¤å†…å­˜åŒºåŸŸçš„å”¯ä¸€ç›®çš„å°±æ˜¯å­˜æ”¾å¯¹è±¡å®ä¾‹ï¼Œå‡ ä¹æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹ä»¥åŠæ•°ç»„éƒ½åœ¨è¿™é‡Œåˆ†é…å†…å­˜ã€‚ Javaä¸–ç•Œä¸­â€œå‡ ä¹â€æ‰€æœ‰çš„å¯¹è±¡éƒ½åœ¨å †ä¸­åˆ†é…ï¼Œä½†æ˜¯ï¼Œéšç€JITç¼–è¯‘æœŸçš„å‘å±•ä¸é€ƒé€¸åˆ†ææŠ€æœ¯é€æ¸æˆç†Ÿï¼Œæ ˆä¸Šåˆ†é…ã€æ ‡é‡æ›¿æ¢ä¼˜åŒ–æŠ€æœ¯å°†ä¼šå¯¼è‡´ä¸€äº›å¾®å¦™çš„å˜åŒ–ï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½åˆ†é…åˆ°å †ä¸Šä¹Ÿæ¸æ¸å˜å¾—ä¸é‚£ä¹ˆâ€œç»å¯¹â€äº†ã€‚ä»jdk 1.7å¼€å§‹å·²ç»é»˜è®¤å¼€å¯é€ƒé€¸åˆ†æï¼Œå¦‚æœæŸäº›æ–¹æ³•ä¸­çš„å¯¹è±¡å¼•ç”¨æ²¡æœ‰è¢«è¿”å›æˆ–è€…æœªè¢«å¤–é¢ä½¿ç”¨ï¼ˆä¹Ÿå°±æ˜¯æœªé€ƒé€¸å‡ºå»ï¼‰ï¼Œé‚£ä¹ˆå¯¹è±¡å¯ä»¥ç›´æ¥åœ¨æ ˆä¸Šåˆ†é…å†…å­˜ã€‚ Java å †æ˜¯åƒåœ¾æ”¶é›†å™¨ç®¡ç†çš„ä¸»è¦åŒºåŸŸï¼Œå› æ­¤ä¹Ÿè¢«ç§°ä½œGC å †ï¼ˆGarbage Collected Heapï¼‰.ä»åƒåœ¾å›æ”¶çš„è§’åº¦ï¼Œç”±äºç°åœ¨æ”¶é›†å™¨åŸºæœ¬éƒ½é‡‡ç”¨åˆ†ä»£åƒåœ¾æ”¶é›†ç®—æ³•ï¼Œæ‰€ä»¥ Java å †è¿˜å¯ä»¥ç»†åˆ†ä¸ºï¼šæ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼šå†ç»†è‡´ä¸€ç‚¹æœ‰ï¼šEden ç©ºé—´ã€From Survivorã€To Survivor ç©ºé—´ç­‰ã€‚è¿›ä¸€æ­¥åˆ’åˆ†çš„ç›®çš„æ˜¯æ›´å¥½åœ°å›æ”¶å†…å­˜ï¼Œæˆ–è€…æ›´å¿«åœ°åˆ†é…å†…å­˜ã€‚ åœ¨ JDK 7 ç‰ˆæœ¬åŠJDK 7 ç‰ˆæœ¬ä¹‹å‰ï¼Œå †å†…å­˜è¢«é€šå¸¸è¢«åˆ†ä¸ºä¸‹é¢ä¸‰éƒ¨åˆ†ï¼š æ–°ç”Ÿä»£å†…å­˜(Young Generation) è€ç”Ÿä»£(Old Generation) æ°¸ç”Ÿä»£(Permanent Generation) JDK 8 ç‰ˆæœ¬ä¹‹åæ–¹æ³•åŒºï¼ˆHotSpot çš„æ°¸ä¹…ä»£ï¼‰è¢«å½»åº•ç§»é™¤äº†ï¼ˆJDK1.7 å°±å·²ç»å¼€å§‹äº†ï¼‰ï¼Œå–è€Œä»£ä¹‹æ˜¯å…ƒç©ºé—´ï¼Œå…ƒç©ºé—´ä½¿ç”¨çš„æ˜¯ç›´æ¥å†…å­˜ã€‚ ä¸Šå›¾æ‰€ç¤ºçš„ Eden åŒºã€ä¸¤ä¸ª Survivor åŒºéƒ½å±äºæ–°ç”Ÿä»£ï¼ˆä¸ºäº†åŒºåˆ†ï¼Œè¿™ä¸¤ä¸ª Survivor åŒºåŸŸæŒ‰ç…§é¡ºåºè¢«å‘½åä¸º from å’Œ toï¼‰ï¼Œä¸­é—´ä¸€å±‚å±äºè€å¹´ä»£ã€‚ å¤§éƒ¨åˆ†æƒ…å†µï¼Œå¯¹è±¡éƒ½ä¼šé¦–å…ˆåœ¨ Eden åŒºåŸŸåˆ†é…ï¼Œåœ¨ä¸€æ¬¡æ–°ç”Ÿä»£åƒåœ¾å›æ”¶åï¼Œå¦‚æœå¯¹è±¡è¿˜å­˜æ´»ï¼Œåˆ™ä¼šè¿›å…¥ s0 æˆ–è€… s1ï¼Œå¹¶ä¸”å¯¹è±¡çš„å¹´é¾„è¿˜ä¼šåŠ  1(Eden åŒº-&gt;Survivor åŒºåå¯¹è±¡çš„åˆå§‹å¹´é¾„å˜ä¸º 1)ï¼Œå½“å®ƒçš„å¹´é¾„å¢åŠ åˆ°ä¸€å®šç¨‹åº¦ï¼ˆé»˜è®¤ä¸º 15 å²ï¼‰ï¼Œå°±ä¼šè¢«æ™‹å‡åˆ°è€å¹´ä»£ä¸­ã€‚å¯¹è±¡æ™‹å‡åˆ°è€å¹´ä»£çš„å¹´é¾„é˜ˆå€¼ï¼Œå¯ä»¥é€šè¿‡å‚æ•° -XX:MaxTenuringThreshold æ¥è®¾ç½®ã€‚ ä¿®æ­£ï¼ˆissue552ï¼‰ï¼šâ€œHotspotéå†æ‰€æœ‰å¯¹è±¡æ—¶ï¼ŒæŒ‰ç…§å¹´é¾„ä»å°åˆ°å¤§å¯¹å…¶æ‰€å ç”¨çš„å¤§å°è¿›è¡Œç´¯ç§¯ï¼Œå½“ç´¯ç§¯çš„æŸä¸ªå¹´é¾„å¤§å°è¶…è¿‡äº†survivoråŒºçš„ä¸€åŠæ—¶ï¼Œå–è¿™ä¸ªå¹´é¾„å’ŒMaxTenuringThresholdä¸­æ›´å°çš„ä¸€ä¸ªå€¼ï¼Œä½œä¸ºæ–°çš„æ™‹å‡å¹´é¾„é˜ˆå€¼â€ã€‚ åŠ¨æ€å¹´é¾„è®¡ç®—çš„ä»£ç å¦‚ä¸‹ 123456789101112131415&gt; uint ageTable::compute_tenuring_threshold(size_t survivor_capacity) &#123;&gt; //survivor_capacityæ˜¯survivorç©ºé—´çš„å¤§å°&gt; size_t desired_survivor_size = (size_t)((((double) survivor_capacity)*TargetSurvivorRatio)/100);&gt; size_t total = 0;&gt; uint age = 1;&gt; while (age &lt; table_size) &#123;&gt; total += sizes[age];//sizesæ•°ç»„æ˜¯æ¯ä¸ªå¹´é¾„æ®µå¯¹è±¡å¤§å°&gt; if (total &gt; desired_survivor_size) break;&gt; age++;&gt; &#125;&gt; uint result = age &lt; MaxTenuringThreshold ? age : MaxTenuringThreshold;&gt; ...&gt; &#125;&gt; &gt; &gt;&gt; å †è¿™é‡Œæœ€å®¹æ˜“å‡ºç°çš„å°±æ˜¯ OutOfMemoryError é”™è¯¯ï¼Œå¹¶ä¸”å‡ºç°è¿™ç§é”™è¯¯ä¹‹åçš„è¡¨ç°å½¢å¼è¿˜ä¼šæœ‰å‡ ç§ï¼Œæ¯”å¦‚ï¼š OutOfMemoryError: GC Overhead Limit Exceeded ï¼š å½“JVMèŠ±å¤ªå¤šæ—¶é—´æ‰§è¡Œåƒåœ¾å›æ”¶å¹¶ä¸”åªèƒ½å›æ”¶å¾ˆå°‘çš„å †ç©ºé—´æ—¶ï¼Œå°±ä¼šå‘ç”Ÿæ­¤é”™è¯¯ã€‚ java.lang.OutOfMemoryError: Java heap space :å‡å¦‚åœ¨åˆ›å»ºæ–°çš„å¯¹è±¡æ—¶, å †å†…å­˜ä¸­çš„ç©ºé—´ä¸è¶³ä»¥å­˜æ”¾æ–°åˆ›å»ºçš„å¯¹è±¡, å°±ä¼šå¼•å‘java.lang.OutOfMemoryError: Java heap space é”™è¯¯ã€‚(å’Œæœ¬æœºç‰©ç†å†…å­˜æ— å…³ï¼Œå’Œä½ é…ç½®çš„å†…å­˜å¤§å°æœ‰å…³ï¼) â€¦â€¦ 2.5 æ–¹æ³•åŒºæ–¹æ³•åŒºä¸ Java å †ä¸€æ ·ï¼Œæ˜¯å„ä¸ªçº¿ç¨‹å…±äº«çš„å†…å­˜åŒºåŸŸï¼Œå®ƒç”¨äºå­˜å‚¨å·²è¢«è™šæ‹ŸæœºåŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ã€å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç­‰æ•°æ®ã€‚è™½ç„¶ Java è™šæ‹Ÿæœºè§„èŒƒæŠŠæ–¹æ³•åŒºæè¿°ä¸ºå †çš„ä¸€ä¸ªé€»è¾‘éƒ¨åˆ†ï¼Œä½†æ˜¯å®ƒå´æœ‰ä¸€ä¸ªåˆ«åå«åš Non-Heapï¼ˆéå †ï¼‰ï¼Œç›®çš„åº”è¯¥æ˜¯ä¸ Java å †åŒºåˆ†å¼€æ¥ã€‚ æ–¹æ³•åŒºä¹Ÿè¢«ç§°ä¸ºæ°¸ä¹…ä»£ã€‚å¾ˆå¤šäººéƒ½ä¼šåˆ†ä¸æ¸…æ–¹æ³•åŒºå’Œæ°¸ä¹…ä»£çš„å…³ç³»ï¼Œä¸ºæ­¤æˆ‘ä¹ŸæŸ¥é˜…äº†æ–‡çŒ®ã€‚ 2.5.1 æ–¹æ³•åŒºå’Œæ°¸ä¹…ä»£çš„å…³ç³» ã€ŠJava è™šæ‹Ÿæœºè§„èŒƒã€‹åªæ˜¯è§„å®šäº†æœ‰æ–¹æ³•åŒºè¿™ä¹ˆä¸ªæ¦‚å¿µå’Œå®ƒçš„ä½œç”¨ï¼Œå¹¶æ²¡æœ‰è§„å®šå¦‚ä½•å»å®ç°å®ƒã€‚é‚£ä¹ˆï¼Œåœ¨ä¸åŒçš„ JVM ä¸Šæ–¹æ³•åŒºçš„å®ç°è‚¯å®šæ˜¯ä¸åŒçš„äº†ã€‚ æ–¹æ³•åŒºå’Œæ°¸ä¹…ä»£çš„å…³ç³»å¾ˆåƒ Java ä¸­æ¥å£å’Œç±»çš„å…³ç³»ï¼Œç±»å®ç°äº†æ¥å£ï¼Œè€Œæ°¸ä¹…ä»£å°±æ˜¯ HotSpot è™šæ‹Ÿæœºå¯¹è™šæ‹Ÿæœºè§„èŒƒä¸­æ–¹æ³•åŒºçš„ä¸€ç§å®ç°æ–¹å¼ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œæ°¸ä¹…ä»£æ˜¯ HotSpot çš„æ¦‚å¿µï¼Œæ–¹æ³•åŒºæ˜¯ Java è™šæ‹Ÿæœºè§„èŒƒä¸­çš„å®šä¹‰ï¼Œæ˜¯ä¸€ç§è§„èŒƒï¼Œè€Œæ°¸ä¹…ä»£æ˜¯ä¸€ç§å®ç°ï¼Œä¸€ä¸ªæ˜¯æ ‡å‡†ä¸€ä¸ªæ˜¯å®ç°ï¼Œå…¶ä»–çš„è™šæ‹Ÿæœºå®ç°å¹¶æ²¡æœ‰æ°¸ä¹…ä»£è¿™ä¸€è¯´æ³•ã€‚ 2.5.2 å¸¸ç”¨å‚æ•°JDK 1.8 ä¹‹å‰æ°¸ä¹…ä»£è¿˜æ²¡è¢«å½»åº•ç§»é™¤çš„æ—¶å€™é€šå¸¸é€šè¿‡ä¸‹é¢è¿™äº›å‚æ•°æ¥è°ƒèŠ‚æ–¹æ³•åŒºå¤§å° 12-XX:PermSize=N //æ–¹æ³•åŒº (æ°¸ä¹…ä»£) åˆå§‹å¤§å°-XX:MaxPermSize=N //æ–¹æ³•åŒº (æ°¸ä¹…ä»£) æœ€å¤§å¤§å°,è¶…è¿‡è¿™ä¸ªå€¼å°†ä¼šæŠ›å‡º OutOfMemoryError å¼‚å¸¸:java.lang.OutOfMemoryError: PermGen ç›¸å¯¹è€Œè¨€ï¼Œåƒåœ¾æ”¶é›†è¡Œä¸ºåœ¨è¿™ä¸ªåŒºåŸŸæ˜¯æ¯”è¾ƒå°‘å‡ºç°çš„ï¼Œä½†å¹¶éæ•°æ®è¿›å…¥æ–¹æ³•åŒºåå°±â€œæ°¸ä¹…å­˜åœ¨â€äº†ã€‚ JDK 1.8 çš„æ—¶å€™ï¼Œæ–¹æ³•åŒºï¼ˆHotSpot çš„æ°¸ä¹…ä»£ï¼‰è¢«å½»åº•ç§»é™¤äº†ï¼ˆJDK1.7 å°±å·²ç»å¼€å§‹äº†ï¼‰ï¼Œå–è€Œä»£ä¹‹æ˜¯å…ƒç©ºé—´ï¼Œå…ƒç©ºé—´ä½¿ç”¨çš„æ˜¯ç›´æ¥å†…å­˜ã€‚ ä¸‹é¢æ˜¯ä¸€äº›å¸¸ç”¨å‚æ•°ï¼š 12-XX:MetaspaceSize=N //è®¾ç½® Metaspace çš„åˆå§‹ï¼ˆå’Œæœ€å°å¤§å°ï¼‰-XX:MaxMetaspaceSize=N //è®¾ç½® Metaspace çš„æœ€å¤§å¤§å° ä¸æ°¸ä¹…ä»£å¾ˆå¤§çš„ä¸åŒå°±æ˜¯ï¼Œå¦‚æœä¸æŒ‡å®šå¤§å°çš„è¯ï¼Œéšç€æ›´å¤šç±»çš„åˆ›å»ºï¼Œè™šæ‹Ÿæœºä¼šè€—å°½æ‰€æœ‰å¯ç”¨çš„ç³»ç»Ÿå†…å­˜ã€‚ 2.5.3 ä¸ºä»€ä¹ˆè¦å°†æ°¸ä¹…ä»£ (PermGen) æ›¿æ¢ä¸ºå…ƒç©ºé—´ (MetaSpace) å‘¢? æ•´ä¸ªæ°¸ä¹…ä»£æœ‰ä¸€ä¸ª JVM æœ¬èº«è®¾ç½®å›ºå®šå¤§å°ä¸Šé™ï¼Œæ— æ³•è¿›è¡Œè°ƒæ•´ï¼Œè€Œå…ƒç©ºé—´ä½¿ç”¨çš„æ˜¯ç›´æ¥å†…å­˜ï¼Œå—æœ¬æœºå¯ç”¨å†…å­˜çš„é™åˆ¶ï¼Œè™½ç„¶å…ƒç©ºé—´ä»æ—§å¯èƒ½æº¢å‡ºï¼Œä½†æ˜¯æ¯”åŸæ¥å‡ºç°çš„å‡ ç‡ä¼šæ›´å°ã€‚ å½“ä½ å…ƒç©ºé—´æº¢å‡ºæ—¶ä¼šå¾—åˆ°å¦‚ä¸‹é”™è¯¯ï¼š java.lang.OutOfMemoryError: MetaSpace ä½ å¯ä»¥ä½¿ç”¨ -XXï¼šMaxMetaspaceSize æ ‡å¿—è®¾ç½®æœ€å¤§å…ƒç©ºé—´å¤§å°ï¼Œé»˜è®¤å€¼ä¸º unlimitedï¼Œè¿™æ„å‘³ç€å®ƒåªå—ç³»ç»Ÿå†…å­˜çš„é™åˆ¶ã€‚-XXï¼šMetaspaceSize è°ƒæ•´æ ‡å¿—å®šä¹‰å…ƒç©ºé—´çš„åˆå§‹å¤§å°å¦‚æœæœªæŒ‡å®šæ­¤æ ‡å¿—ï¼Œåˆ™ Metaspace å°†æ ¹æ®è¿è¡Œæ—¶çš„åº”ç”¨ç¨‹åºéœ€æ±‚åŠ¨æ€åœ°é‡æ–°è°ƒæ•´å¤§å°ã€‚ å…ƒç©ºé—´é‡Œé¢å­˜æ”¾çš„æ˜¯ç±»çš„å…ƒæ•°æ®ï¼Œè¿™æ ·åŠ è½½å¤šå°‘ç±»çš„å…ƒæ•°æ®å°±ä¸ç”± MaxPermSize æ§åˆ¶äº†, è€Œç”±ç³»ç»Ÿçš„å®é™…å¯ç”¨ç©ºé—´æ¥æ§åˆ¶ï¼Œè¿™æ ·èƒ½åŠ è½½çš„ç±»å°±æ›´å¤šäº†ã€‚ åœ¨ JDK8ï¼Œåˆå¹¶ HotSpot å’Œ JRockit çš„ä»£ç æ—¶, JRockit ä»æ¥æ²¡æœ‰ä¸€ä¸ªå«æ°¸ä¹…ä»£çš„ä¸œè¥¿, åˆå¹¶ä¹‹åå°±æ²¡æœ‰å¿…è¦é¢å¤–çš„è®¾ç½®è¿™ä¹ˆä¸€ä¸ªæ°¸ä¹…ä»£çš„åœ°æ–¹äº†ã€‚ 2.6 è¿è¡Œæ—¶å¸¸é‡æ± è¿è¡Œæ—¶å¸¸é‡æ± æ˜¯æ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†ã€‚Class æ–‡ä»¶ä¸­é™¤äº†æœ‰ç±»çš„ç‰ˆæœ¬ã€å­—æ®µã€æ–¹æ³•ã€æ¥å£ç­‰æè¿°ä¿¡æ¯å¤–ï¼Œè¿˜æœ‰å¸¸é‡æ± è¡¨ï¼ˆç”¨äºå­˜æ”¾ç¼–è¯‘æœŸç”Ÿæˆçš„å„ç§å­—é¢é‡å’Œç¬¦å·å¼•ç”¨ï¼‰ æ—¢ç„¶è¿è¡Œæ—¶å¸¸é‡æ± æ˜¯æ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†ï¼Œè‡ªç„¶å—åˆ°æ–¹æ³•åŒºå†…å­˜çš„é™åˆ¶ï¼Œå½“å¸¸é‡æ± æ— æ³•å†ç”³è¯·åˆ°å†…å­˜æ—¶ä¼šæŠ›å‡º OutOfMemoryError é”™è¯¯ã€‚ JDK1.7 åŠä¹‹åç‰ˆæœ¬çš„ JVM å·²ç»å°†è¿è¡Œæ—¶å¸¸é‡æ± ä»æ–¹æ³•åŒºä¸­ç§»äº†å‡ºæ¥ï¼Œåœ¨ Java å †ï¼ˆHeapï¼‰ä¸­å¼€è¾Ÿäº†ä¸€å—åŒºåŸŸå­˜æ”¾è¿è¡Œæ—¶å¸¸é‡æ± ã€‚ ä¿®æ­£(issue747ï¼Œreference)ï¼š JDK1.7ä¹‹å‰è¿è¡Œæ—¶å¸¸é‡æ± é€»è¾‘åŒ…å«å­—ç¬¦ä¸²å¸¸é‡æ± å­˜æ”¾åœ¨æ–¹æ³•åŒº, æ­¤æ—¶hotspotè™šæ‹Ÿæœºå¯¹æ–¹æ³•åŒºçš„å®ç°ä¸ºæ°¸ä¹…ä»£ JDK1.7 å­—ç¬¦ä¸²å¸¸é‡æ± è¢«ä»æ–¹æ³•åŒºæ‹¿åˆ°äº†å †ä¸­, è¿™é‡Œæ²¡æœ‰æåˆ°è¿è¡Œæ—¶å¸¸é‡æ± ,ä¹Ÿå°±æ˜¯è¯´å­—ç¬¦ä¸²å¸¸é‡æ± è¢«å•ç‹¬æ‹¿åˆ°å †,è¿è¡Œæ—¶å¸¸é‡æ± å‰©ä¸‹çš„ä¸œè¥¿è¿˜åœ¨æ–¹æ³•åŒº, ä¹Ÿå°±æ˜¯hotspotä¸­çš„æ°¸ä¹…ä»£ ã€‚ JDK1.8 hotspotç§»é™¤äº†æ°¸ä¹…ä»£ç”¨å…ƒç©ºé—´(Metaspace)å–è€Œä»£ä¹‹, è¿™æ—¶å€™å­—ç¬¦ä¸²å¸¸é‡æ± è¿˜åœ¨å †, è¿è¡Œæ—¶å¸¸é‡æ± è¿˜åœ¨æ–¹æ³•åŒº, åªä¸è¿‡æ–¹æ³•åŒºçš„å®ç°ä»æ°¸ä¹…ä»£å˜æˆäº†å…ƒç©ºé—´(Metaspace) å®éªŒï¼šä»¥ä¸‹ä¸‰ç»„å‚æ•°åˆ†åˆ«è¿è¡ŒåŒä¸€æ®µä»£ç  123456789&gt; public static void main(String[] args) throws Throwable &#123;&gt; List&lt;String&gt; list = new ArrayList&lt;String&gt;();&gt; int i=0;&gt; while(true)&#123;&gt; list.add(String.valueOf(i++).intern());&gt; &#125;&gt; &gt; &#125;&gt; &gt; JDK1.6 -XX:PermSize=20M -XX:MaxPermSize=20Mè®¾ç½®æ°¸ä¹…åŒºå¤§å°ï¼ŒæŠ¥OutOfMemoryErrorï¼š PermGen spaceï¼Œè¯´æ˜å­—ç¬¦ä¸²å¸¸é‡ä½äºPermGen JDK1.7 -XX:PermSize=20M -XX:MaxPermSize=20Mè®¾ç½®æ°¸ä¹…åŒºå¤§å°ï¼ŒOutOfMemoryErrorï¼š Java heap spaceï¼Œè¯´æ˜å­—ç¬¦ä¸²å¸¸é‡ä½äºäº†heapå†… JDK1.8 -XX:MetaspaceSize=20M -XX:MaxMetaspaceSize=20Mè®¾ç½®æ°¸ä¹…åŒºå¤§å°ï¼ŒOutOfMemoryErrorï¼š Java heap spaceï¼Œè¯´æ˜å­—ç¬¦ä¸²å¸¸é‡è¿˜åœ¨heapå†… ç›¸å…³é—®é¢˜ï¼šJVM å¸¸é‡æ± ä¸­å­˜å‚¨çš„æ˜¯å¯¹è±¡è¿˜æ˜¯å¼•ç”¨å‘¢ï¼Ÿï¼š https://www.zhihu.com/question/57109429/answer/151717241 by RednaxelaFX 2.7 ç›´æ¥å†…å­˜ç›´æ¥å†…å­˜å¹¶ä¸æ˜¯è™šæ‹Ÿæœºè¿è¡Œæ—¶æ•°æ®åŒºçš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿä¸æ˜¯è™šæ‹Ÿæœºè§„èŒƒä¸­å®šä¹‰çš„å†…å­˜åŒºåŸŸï¼Œä½†æ˜¯è¿™éƒ¨åˆ†å†…å­˜ä¹Ÿè¢«é¢‘ç¹åœ°ä½¿ç”¨ã€‚è€Œä¸”ä¹Ÿå¯èƒ½å¯¼è‡´ OutOfMemoryError é”™è¯¯å‡ºç°ã€‚ JDK1.4 ä¸­æ–°åŠ å…¥çš„ NIO(New Input/Output) ç±»ï¼Œå¼•å…¥äº†ä¸€ç§åŸºäºé€šé“ï¼ˆChannelï¼‰ ä¸ç¼“å­˜åŒºï¼ˆBufferï¼‰ çš„ I/O æ–¹å¼ï¼Œå®ƒå¯ä»¥ç›´æ¥ä½¿ç”¨ Native å‡½æ•°åº“ç›´æ¥åˆ†é…å †å¤–å†…å­˜ï¼Œç„¶åé€šè¿‡ä¸€ä¸ªå­˜å‚¨åœ¨ Java å †ä¸­çš„ DirectByteBuffer å¯¹è±¡ä½œä¸ºè¿™å—å†…å­˜çš„å¼•ç”¨è¿›è¡Œæ“ä½œã€‚è¿™æ ·å°±èƒ½åœ¨ä¸€äº›åœºæ™¯ä¸­æ˜¾è‘—æé«˜æ€§èƒ½ï¼Œå› ä¸ºé¿å…äº†åœ¨ Java å †å’Œ Native å †ä¹‹é—´æ¥å›å¤åˆ¶æ•°æ®ã€‚è¿™å°±æ˜¯ç½‘ç»œç¼–ç¨‹ä¸­å¸¸è¯´çš„Zero-copy(é›¶æ‹·è´) æœ¬æœºç›´æ¥å†…å­˜çš„åˆ†é…ä¸ä¼šå—åˆ° Java å †çš„é™åˆ¶ï¼Œä½†æ˜¯ï¼Œæ—¢ç„¶æ˜¯å†…å­˜å°±ä¼šå—åˆ°æœ¬æœºæ€»å†…å­˜å¤§å°ä»¥åŠå¤„ç†å™¨å¯»å€ç©ºé—´çš„é™åˆ¶ã€‚ ä¸‰ HotSpot è™šæ‹Ÿæœºå¯¹è±¡æ¢ç§˜é€šè¿‡ä¸Šé¢çš„ä»‹ç»æˆ‘ä»¬å¤§æ¦‚çŸ¥é“äº†è™šæ‹Ÿæœºçš„å†…å­˜æƒ…å†µï¼Œä¸‹é¢æˆ‘ä»¬æ¥è¯¦ç»†çš„äº†è§£ä¸€ä¸‹ HotSpot è™šæ‹Ÿæœºåœ¨ Java å †ä¸­å¯¹è±¡åˆ†é…ã€å¸ƒå±€å’Œè®¿é—®çš„å…¨è¿‡ç¨‹ã€‚ 3.1 å¯¹è±¡çš„åˆ›å»ºä¸‹å›¾ä¾¿æ˜¯ Java å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹ï¼Œæˆ‘å»ºè®®æœ€å¥½æ˜¯èƒ½é»˜å†™å‡ºæ¥ï¼Œå¹¶ä¸”è¦æŒæ¡æ¯ä¸€æ­¥åœ¨åšä»€ä¹ˆã€‚ Step1:ç±»åŠ è½½æ£€æŸ¥ è™šæ‹Ÿæœºé‡åˆ°ä¸€æ¡ new æŒ‡ä»¤æ—¶ï¼Œé¦–å…ˆå°†å»æ£€æŸ¥è¿™ä¸ªæŒ‡ä»¤çš„å‚æ•°æ˜¯å¦èƒ½åœ¨å¸¸é‡æ± ä¸­å®šä½åˆ°è¿™ä¸ªç±»çš„ç¬¦å·å¼•ç”¨ï¼Œå¹¶ä¸”æ£€æŸ¥è¿™ä¸ªç¬¦å·å¼•ç”¨ä»£è¡¨çš„ç±»æ˜¯å¦å·²è¢«åŠ è½½è¿‡ã€è§£æå’Œåˆå§‹åŒ–è¿‡ã€‚å¦‚æœæ²¡æœ‰ï¼Œé‚£å¿…é¡»å…ˆæ‰§è¡Œç›¸åº”çš„ç±»åŠ è½½è¿‡ç¨‹ã€‚ Step2:åˆ†é…å†…å­˜åœ¨ç±»åŠ è½½æ£€æŸ¥é€šè¿‡åï¼Œæ¥ä¸‹æ¥è™šæ‹Ÿæœºå°†ä¸ºæ–°ç”Ÿå¯¹è±¡åˆ†é…å†…å­˜ã€‚å¯¹è±¡æ‰€éœ€çš„å†…å­˜å¤§å°åœ¨ç±»åŠ è½½å®Œæˆåä¾¿å¯ç¡®å®šï¼Œä¸ºå¯¹è±¡åˆ†é…ç©ºé—´çš„ä»»åŠ¡ç­‰åŒäºæŠŠä¸€å—ç¡®å®šå¤§å°çš„å†…å­˜ä» Java å †ä¸­åˆ’åˆ†å‡ºæ¥ã€‚åˆ†é…æ–¹å¼æœ‰ â€œæŒ‡é’ˆç¢°æ’â€ å’Œ â€œç©ºé—²åˆ—è¡¨â€ ä¸¤ç§ï¼Œé€‰æ‹©é‚£ç§åˆ†é…æ–¹å¼ç”± Java å †æ˜¯å¦è§„æ•´å†³å®šï¼Œè€Œ Java å †æ˜¯å¦è§„æ•´åˆç”±æ‰€é‡‡ç”¨çš„åƒåœ¾æ”¶é›†å™¨æ˜¯å¦å¸¦æœ‰å‹ç¼©æ•´ç†åŠŸèƒ½å†³å®šã€‚ å†…å­˜åˆ†é…çš„ä¸¤ç§æ–¹å¼ï¼šï¼ˆè¡¥å……å†…å®¹ï¼Œéœ€è¦æŒæ¡ï¼‰ é€‰æ‹©ä»¥ä¸Šä¸¤ç§æ–¹å¼ä¸­çš„å“ªä¸€ç§ï¼Œå–å†³äº Java å †å†…å­˜æ˜¯å¦è§„æ•´ã€‚è€Œ Java å †å†…å­˜æ˜¯å¦è§„æ•´ï¼Œå–å†³äº GC æ”¶é›†å™¨çš„ç®—æ³•æ˜¯â€æ ‡è®°-æ¸…é™¤â€ï¼Œè¿˜æ˜¯â€æ ‡è®°-æ•´ç†â€ï¼ˆä¹Ÿç§°ä½œâ€æ ‡è®°-å‹ç¼©â€ï¼‰ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¤åˆ¶ç®—æ³•å†…å­˜ä¹Ÿæ˜¯è§„æ•´çš„ å†…å­˜åˆ†é…å¹¶å‘é—®é¢˜ï¼ˆè¡¥å……å†…å®¹ï¼Œéœ€è¦æŒæ¡ï¼‰ åœ¨åˆ›å»ºå¯¹è±¡çš„æ—¶å€™æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„é—®é¢˜ï¼Œå°±æ˜¯çº¿ç¨‹å®‰å…¨ï¼Œå› ä¸ºåœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­ï¼Œåˆ›å»ºå¯¹è±¡æ˜¯å¾ˆé¢‘ç¹çš„äº‹æƒ…ï¼Œä½œä¸ºè™šæ‹Ÿæœºæ¥è¯´ï¼Œå¿…é¡»è¦ä¿è¯çº¿ç¨‹æ˜¯å®‰å…¨çš„ï¼Œé€šå¸¸æ¥è®²ï¼Œè™šæ‹Ÿæœºé‡‡ç”¨ä¸¤ç§æ–¹å¼æ¥ä¿è¯çº¿ç¨‹å®‰å…¨ï¼š CAS+å¤±è´¥é‡è¯•ï¼š CAS æ˜¯ä¹è§‚é”çš„ä¸€ç§å®ç°æ–¹å¼ã€‚æ‰€è°“ä¹è§‚é”å°±æ˜¯ï¼Œæ¯æ¬¡ä¸åŠ é”è€Œæ˜¯å‡è®¾æ²¡æœ‰å†²çªè€Œå»å®ŒæˆæŸé¡¹æ“ä½œï¼Œå¦‚æœå› ä¸ºå†²çªå¤±è´¥å°±é‡è¯•ï¼Œç›´åˆ°æˆåŠŸä¸ºæ­¢ã€‚è™šæ‹Ÿæœºé‡‡ç”¨ CAS é…ä¸Šå¤±è´¥é‡è¯•çš„æ–¹å¼ä¿è¯æ›´æ–°æ“ä½œçš„åŸå­æ€§ã€‚ TLABï¼š ä¸ºæ¯ä¸€ä¸ªçº¿ç¨‹é¢„å…ˆåœ¨ Eden åŒºåˆ†é…ä¸€å—å„¿å†…å­˜ï¼ŒJVM åœ¨ç»™çº¿ç¨‹ä¸­çš„å¯¹è±¡åˆ†é…å†…å­˜æ—¶ï¼Œé¦–å…ˆåœ¨ TLAB åˆ†é…ï¼Œå½“å¯¹è±¡å¤§äº TLAB ä¸­çš„å‰©ä½™å†…å­˜æˆ– TLAB çš„å†…å­˜å·²ç”¨å°½æ—¶ï¼Œå†é‡‡ç”¨ä¸Šè¿°çš„ CAS è¿›è¡Œå†…å­˜åˆ†é… Step3:åˆå§‹åŒ–é›¶å€¼å†…å­˜åˆ†é…å®Œæˆåï¼Œè™šæ‹Ÿæœºéœ€è¦å°†åˆ†é…åˆ°çš„å†…å­˜ç©ºé—´éƒ½åˆå§‹åŒ–ä¸ºé›¶å€¼ï¼ˆä¸åŒ…æ‹¬å¯¹è±¡å¤´ï¼‰ï¼Œè¿™ä¸€æ­¥æ“ä½œä¿è¯äº†å¯¹è±¡çš„å®ä¾‹å­—æ®µåœ¨ Java ä»£ç ä¸­å¯ä»¥ä¸èµ‹åˆå§‹å€¼å°±ç›´æ¥ä½¿ç”¨ï¼Œç¨‹åºèƒ½è®¿é—®åˆ°è¿™äº›å­—æ®µçš„æ•°æ®ç±»å‹æ‰€å¯¹åº”çš„é›¶å€¼ã€‚ Step4:è®¾ç½®å¯¹è±¡å¤´åˆå§‹åŒ–é›¶å€¼å®Œæˆä¹‹åï¼Œè™šæ‹Ÿæœºè¦å¯¹å¯¹è±¡è¿›è¡Œå¿…è¦çš„è®¾ç½®ï¼Œä¾‹å¦‚è¿™ä¸ªå¯¹è±¡æ˜¯é‚£ä¸ªç±»çš„å®ä¾‹ã€å¦‚ä½•æ‰èƒ½æ‰¾åˆ°ç±»çš„å…ƒæ•°æ®ä¿¡æ¯ã€å¯¹è±¡çš„å“ˆå¸Œç ã€å¯¹è±¡çš„ GC åˆ†ä»£å¹´é¾„ç­‰ä¿¡æ¯ã€‚ è¿™äº›ä¿¡æ¯å­˜æ”¾åœ¨å¯¹è±¡å¤´ä¸­ã€‚ å¦å¤–ï¼Œæ ¹æ®è™šæ‹Ÿæœºå½“å‰è¿è¡ŒçŠ¶æ€çš„ä¸åŒï¼Œå¦‚æ˜¯å¦å¯ç”¨åå‘é”ç­‰ï¼Œå¯¹è±¡å¤´ä¼šæœ‰ä¸åŒçš„è®¾ç½®æ–¹å¼ã€‚ Step5:æ‰§è¡Œ init æ–¹æ³• åœ¨ä¸Šé¢å·¥ä½œéƒ½å®Œæˆä¹‹åï¼Œä»è™šæ‹Ÿæœºçš„è§†è§’æ¥çœ‹ï¼Œä¸€ä¸ªæ–°çš„å¯¹è±¡å·²ç»äº§ç”Ÿäº†ï¼Œä½†ä» Java ç¨‹åºçš„è§†è§’æ¥çœ‹ï¼Œå¯¹è±¡åˆ›å»ºæ‰åˆšå¼€å§‹ï¼Œ&lt;init&gt; æ–¹æ³•è¿˜æ²¡æœ‰æ‰§è¡Œï¼Œæ‰€æœ‰çš„å­—æ®µéƒ½è¿˜ä¸ºé›¶ã€‚æ‰€ä»¥ä¸€èˆ¬æ¥è¯´ï¼Œæ‰§è¡Œ new æŒ‡ä»¤ä¹‹åä¼šæ¥ç€æ‰§è¡Œ &lt;init&gt; æ–¹æ³•ï¼ŒæŠŠå¯¹è±¡æŒ‰ç…§ç¨‹åºå‘˜çš„æ„æ„¿è¿›è¡Œåˆå§‹åŒ–ï¼Œè¿™æ ·ä¸€ä¸ªçœŸæ­£å¯ç”¨çš„å¯¹è±¡æ‰ç®—å®Œå…¨äº§ç”Ÿå‡ºæ¥ã€‚ 3.2 å¯¹è±¡çš„å†…å­˜å¸ƒå±€åœ¨ Hotspot è™šæ‹Ÿæœºä¸­ï¼Œå¯¹è±¡åœ¨å†…å­˜ä¸­çš„å¸ƒå±€å¯ä»¥åˆ†ä¸º 3 å—åŒºåŸŸï¼šå¯¹è±¡å¤´ã€å®ä¾‹æ•°æ®å’Œå¯¹é½å¡«å……ã€‚ Hotspot è™šæ‹Ÿæœºçš„å¯¹è±¡å¤´åŒ…æ‹¬ä¸¤éƒ¨åˆ†ä¿¡æ¯ï¼Œç¬¬ä¸€éƒ¨åˆ†ç”¨äºå­˜å‚¨å¯¹è±¡è‡ªèº«çš„è¿è¡Œæ—¶æ•°æ®ï¼ˆå“ˆå¸Œç ã€GC åˆ†ä»£å¹´é¾„ã€é”çŠ¶æ€æ ‡å¿—ç­‰ç­‰ï¼‰ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯ç±»å‹æŒ‡é’ˆï¼Œå³å¯¹è±¡æŒ‡å‘å®ƒçš„ç±»å…ƒæ•°æ®çš„æŒ‡é’ˆï¼Œè™šæ‹Ÿæœºé€šè¿‡è¿™ä¸ªæŒ‡é’ˆæ¥ç¡®å®šè¿™ä¸ªå¯¹è±¡æ˜¯é‚£ä¸ªç±»çš„å®ä¾‹ã€‚ å®ä¾‹æ•°æ®éƒ¨åˆ†æ˜¯å¯¹è±¡çœŸæ­£å­˜å‚¨çš„æœ‰æ•ˆä¿¡æ¯ï¼Œä¹Ÿæ˜¯åœ¨ç¨‹åºä¸­æ‰€å®šä¹‰çš„å„ç§ç±»å‹çš„å­—æ®µå†…å®¹ã€‚ å¯¹é½å¡«å……éƒ¨åˆ†ä¸æ˜¯å¿…ç„¶å­˜åœ¨çš„ï¼Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„å«ä¹‰ï¼Œä»…ä»…èµ·å ä½ä½œç”¨ã€‚ å› ä¸º Hotspot è™šæ‹Ÿæœºçš„è‡ªåŠ¨å†…å­˜ç®¡ç†ç³»ç»Ÿè¦æ±‚å¯¹è±¡èµ·å§‹åœ°å€å¿…é¡»æ˜¯ 8 å­—èŠ‚çš„æ•´æ•°å€ï¼Œæ¢å¥è¯è¯´å°±æ˜¯å¯¹è±¡çš„å¤§å°å¿…é¡»æ˜¯ 8 å­—èŠ‚çš„æ•´æ•°å€ã€‚è€Œå¯¹è±¡å¤´éƒ¨åˆ†æ­£å¥½æ˜¯ 8 å­—èŠ‚çš„å€æ•°ï¼ˆ1 å€æˆ– 2 å€ï¼‰ï¼Œå› æ­¤ï¼Œå½“å¯¹è±¡å®ä¾‹æ•°æ®éƒ¨åˆ†æ²¡æœ‰å¯¹é½æ—¶ï¼Œå°±éœ€è¦é€šè¿‡å¯¹é½å¡«å……æ¥è¡¥å…¨ã€‚ 3.3 å¯¹è±¡çš„è®¿é—®å®šä½å»ºç«‹å¯¹è±¡å°±æ˜¯ä¸ºäº†ä½¿ç”¨å¯¹è±¡ï¼Œæˆ‘ä»¬çš„ Java ç¨‹åºé€šè¿‡æ ˆä¸Šçš„ reference æ•°æ®æ¥æ“ä½œå †ä¸Šçš„å…·ä½“å¯¹è±¡ã€‚å¯¹è±¡çš„è®¿é—®æ–¹å¼ç”±è™šæ‹Ÿæœºå®ç°è€Œå®šï¼Œç›®å‰ä¸»æµçš„è®¿é—®æ–¹å¼æœ‰â‘ ä½¿ç”¨å¥æŸ„å’Œâ‘¡ç›´æ¥æŒ‡é’ˆä¸¤ç§ï¼š å¥æŸ„ï¼š å¦‚æœä½¿ç”¨å¥æŸ„çš„è¯ï¼Œé‚£ä¹ˆ Java å †ä¸­å°†ä¼šåˆ’åˆ†å‡ºä¸€å—å†…å­˜æ¥ä½œä¸ºå¥æŸ„æ± ï¼Œreference ä¸­å­˜å‚¨çš„å°±æ˜¯å¯¹è±¡çš„å¥æŸ„åœ°å€ï¼Œè€Œå¥æŸ„ä¸­åŒ…å«äº†å¯¹è±¡å®ä¾‹æ•°æ®ä¸ç±»å‹æ•°æ®å„è‡ªçš„å…·ä½“åœ°å€ä¿¡æ¯ï¼› ç›´æ¥æŒ‡é’ˆï¼š å¦‚æœä½¿ç”¨ç›´æ¥æŒ‡é’ˆè®¿é—®ï¼Œé‚£ä¹ˆ Java å †å¯¹è±¡çš„å¸ƒå±€ä¸­å°±å¿…é¡»è€ƒè™‘å¦‚ä½•æ”¾ç½®è®¿é—®ç±»å‹æ•°æ®çš„ç›¸å…³ä¿¡æ¯ï¼Œè€Œ reference ä¸­å­˜å‚¨çš„ç›´æ¥å°±æ˜¯å¯¹è±¡çš„åœ°å€ã€‚ è¿™ä¸¤ç§å¯¹è±¡è®¿é—®æ–¹å¼å„æœ‰ä¼˜åŠ¿ã€‚ä½¿ç”¨å¥æŸ„æ¥è®¿é—®çš„æœ€å¤§å¥½å¤„æ˜¯ reference ä¸­å­˜å‚¨çš„æ˜¯ç¨³å®šçš„å¥æŸ„åœ°å€ï¼Œåœ¨å¯¹è±¡è¢«ç§»åŠ¨æ—¶åªä¼šæ”¹å˜å¥æŸ„ä¸­çš„å®ä¾‹æ•°æ®æŒ‡é’ˆï¼Œè€Œ reference æœ¬èº«ä¸éœ€è¦ä¿®æ”¹ã€‚ä½¿ç”¨ç›´æ¥æŒ‡é’ˆè®¿é—®æ–¹å¼æœ€å¤§çš„å¥½å¤„å°±æ˜¯é€Ÿåº¦å¿«ï¼Œå®ƒèŠ‚çœäº†ä¸€æ¬¡æŒ‡é’ˆå®šä½çš„æ—¶é—´å¼€é”€ã€‚ å›› é‡ç‚¹è¡¥å……å†…å®¹4.1 String ç±»å’Œå¸¸é‡æ± String å¯¹è±¡çš„ä¸¤ç§åˆ›å»ºæ–¹å¼ï¼š 12345String str1 = \"abcd\";//å…ˆæ£€æŸ¥å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­æœ‰æ²¡æœ‰\"abcd\"ï¼Œå¦‚æœå­—ç¬¦ä¸²å¸¸é‡æ± ä¸­æ²¡æœ‰ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªï¼Œç„¶å str1 æŒ‡å‘å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­çš„å¯¹è±¡ï¼Œå¦‚æœæœ‰ï¼Œåˆ™ç›´æ¥å°† str1 æŒ‡å‘\"abcd\"\"ï¼›String str2 = new String(\"abcd\");//å †ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡String str3 = new String(\"abcd\");//å †ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡System.out.println(str1==str2);//falseSystem.out.println(str2==str3);//false è¿™ä¸¤ç§ä¸åŒçš„åˆ›å»ºæ–¹æ³•æ˜¯æœ‰å·®åˆ«çš„ã€‚ ç¬¬ä¸€ç§æ–¹å¼æ˜¯åœ¨å¸¸é‡æ± ä¸­æ‹¿å¯¹è±¡ï¼› ç¬¬äºŒç§æ–¹å¼æ˜¯ç›´æ¥åœ¨å †å†…å­˜ç©ºé—´åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚ è®°ä½ä¸€ç‚¹ï¼šåªè¦ä½¿ç”¨ new æ–¹æ³•ï¼Œä¾¿éœ€è¦åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚ å†ç»™å¤§å®¶ä¸€ä¸ªå›¾åº”è¯¥æ›´å®¹æ˜“ç†è§£ï¼Œå›¾ç‰‡æ¥æºï¼šhttps://www.journaldev.com/797/what-is-java-string-poolï¼š String ç±»å‹çš„å¸¸é‡æ± æ¯”è¾ƒç‰¹æ®Šã€‚å®ƒçš„ä¸»è¦ä½¿ç”¨æ–¹æ³•æœ‰ä¸¤ç§ï¼š ç›´æ¥ä½¿ç”¨åŒå¼•å·å£°æ˜å‡ºæ¥çš„ String å¯¹è±¡ä¼šç›´æ¥å­˜å‚¨åœ¨å¸¸é‡æ± ä¸­ã€‚ å¦‚æœä¸æ˜¯ç”¨åŒå¼•å·å£°æ˜çš„ String å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨ String æä¾›çš„ intern æ–¹æ³•ã€‚String.intern() æ˜¯ä¸€ä¸ª Native æ–¹æ³•ï¼Œå®ƒçš„ä½œç”¨æ˜¯ï¼šå¦‚æœè¿è¡Œæ—¶å¸¸é‡æ± ä¸­å·²ç»åŒ…å«ä¸€ä¸ªç­‰äºæ­¤ String å¯¹è±¡å†…å®¹çš„å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å›å¸¸é‡æ± ä¸­è¯¥å­—ç¬¦ä¸²çš„å¼•ç”¨ï¼›å¦‚æœæ²¡æœ‰ï¼ŒJDK1.7ä¹‹å‰ï¼ˆä¸åŒ…å«1.7ï¼‰çš„å¤„ç†æ–¹å¼æ˜¯åœ¨å¸¸é‡æ± ä¸­åˆ›å»ºä¸æ­¤ String å†…å®¹ç›¸åŒçš„å­—ç¬¦ä¸²ï¼Œå¹¶è¿”å›å¸¸é‡æ± ä¸­åˆ›å»ºçš„å­—ç¬¦ä¸²çš„å¼•ç”¨ï¼ŒJDK1.7ä»¥åŠä¹‹åçš„å¤„ç†æ–¹å¼æ˜¯åœ¨å¸¸é‡æ± ä¸­è®°å½•æ­¤å­—ç¬¦ä¸²çš„å¼•ç”¨ï¼Œå¹¶è¿”å›è¯¥å¼•ç”¨ã€‚ 123456String s1 = new String(\"è®¡ç®—æœº\");String s2 = s1.intern();String s3 = \"è®¡ç®—æœº\";System.out.println(s2);//è®¡ç®—æœºSystem.out.println(s1 == s2);//falseï¼Œå› ä¸ºä¸€ä¸ªæ˜¯å †å†…å­˜ä¸­çš„ String å¯¹è±¡ä¸€ä¸ªæ˜¯å¸¸é‡æ± ä¸­çš„ String å¯¹è±¡ï¼ŒSystem.out.println(s3 == s2);//trueï¼Œå› ä¸ºä¸¤ä¸ªéƒ½æ˜¯å¸¸é‡æ± ä¸­çš„ String å¯¹è±¡ å­—ç¬¦ä¸²æ‹¼æ¥: 123456789String str1 = \"str\";String str2 = \"ing\"; String str3 = \"str\" + \"ing\";//å¸¸é‡æ± ä¸­çš„å¯¹è±¡String str4 = str1 + str2; //åœ¨å †ä¸Šåˆ›å»ºçš„æ–°çš„å¯¹è±¡ String str5 = \"string\";//å¸¸é‡æ± ä¸­çš„å¯¹è±¡System.out.println(str3 == str4);//falseSystem.out.println(str3 == str5);//trueSystem.out.println(str4 == str5);//false å°½é‡é¿å…å¤šä¸ªå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œå› ä¸ºè¿™æ ·ä¼šé‡æ–°åˆ›å»ºå¯¹è±¡ã€‚å¦‚æœéœ€è¦æ”¹å˜å­—ç¬¦ä¸²çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ StringBuilder æˆ–è€… StringBufferã€‚ 4.2 String s1 = new String(â€œabcâ€);è¿™å¥è¯åˆ›å»ºäº†å‡ ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ï¼Ÿå°†åˆ›å»º 1 æˆ– 2 ä¸ªå­—ç¬¦ä¸²ã€‚å¦‚æœæ± ä¸­å·²å­˜åœ¨å­—ç¬¦ä¸²å¸¸é‡â€œabcâ€ï¼Œåˆ™åªä¼šåœ¨å †ç©ºé—´åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡â€œabcâ€ã€‚å¦‚æœæ± ä¸­æ²¡æœ‰å­—ç¬¦ä¸²å¸¸é‡â€œabcâ€ï¼Œé‚£ä¹ˆå®ƒå°†é¦–å…ˆåœ¨æ± ä¸­åˆ›å»ºï¼Œç„¶ååœ¨å †ç©ºé—´ä¸­åˆ›å»ºï¼Œå› æ­¤å°†åˆ›å»ºæ€»å…± 2 ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ã€‚ éªŒè¯ï¼š 1234String s1 = new String(\"abc\");// å †å†…å­˜çš„åœ°å€å€¼String s2 = \"abc\";System.out.println(s1 == s2);// è¾“å‡º false,å› ä¸ºä¸€ä¸ªæ˜¯å †å†…å­˜ï¼Œä¸€ä¸ªæ˜¯å¸¸é‡æ± çš„å†…å­˜ï¼Œæ•…ä¸¤è€…æ˜¯ä¸åŒçš„ã€‚System.out.println(s1.equals(s2));// è¾“å‡º true ç»“æœï¼š 12falsetrue 4.3 8 ç§åŸºæœ¬ç±»å‹çš„åŒ…è£…ç±»å’Œå¸¸é‡æ± Java åŸºæœ¬ç±»å‹çš„åŒ…è£…ç±»çš„å¤§éƒ¨åˆ†éƒ½å®ç°äº†å¸¸é‡æ± æŠ€æœ¯ï¼Œå³ Byte,Short,Integer,Long,Character,Booleanï¼›å‰é¢ 4 ç§åŒ…è£…ç±»é»˜è®¤åˆ›å»ºäº†æ•°å€¼[-128ï¼Œ127] çš„ç›¸åº”ç±»å‹çš„ç¼“å­˜æ•°æ®ï¼ŒCharacteråˆ›å»ºäº†æ•°å€¼åœ¨[0,127]èŒƒå›´çš„ç¼“å­˜æ•°æ®ï¼ŒBoolean ç›´æ¥è¿”å›True Or Falseã€‚å¦‚æœè¶…å‡ºå¯¹åº”èŒƒå›´ä»ç„¶ä¼šå»åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚ ä¸ºå•¥æŠŠç¼“å­˜è®¾ç½®ä¸º[-128ï¼Œ127]åŒºé—´ï¼Ÿï¼ˆå‚è§issue/461ï¼‰æ€§èƒ½å’Œèµ„æºä¹‹é—´çš„æƒè¡¡ã€‚ 123public static Boolean valueOf(boolean b) &#123; return (b ? TRUE : FALSE);&#125; 123456789private static class CharacterCache &#123; private CharacterCache()&#123;&#125; static final Character cache[] = new Character[127 + 1]; static &#123; for (int i = 0; i &lt; cache.length; i++) cache[i] = new Character((char)i); &#125; &#125; ä¸¤ç§æµ®ç‚¹æ•°ç±»å‹çš„åŒ…è£…ç±» Float,Double å¹¶æ²¡æœ‰å®ç°å¸¸é‡æ± æŠ€æœ¯ã€‚** 123456789Integer i1 = 33;Integer i2 = 33;System.out.println(i1 == i2);// è¾“å‡º trueInteger i11 = 333;Integer i22 = 333;System.out.println(i11 == i22);// è¾“å‡º falseDouble i3 = 1.2;Double i4 = 1.2;System.out.println(i3 == i4);// è¾“å‡º false Integer ç¼“å­˜æºä»£ç ï¼š 12345678/***æ­¤æ–¹æ³•å°†å§‹ç»ˆç¼“å­˜-128 åˆ° 127ï¼ˆåŒ…æ‹¬ç«¯ç‚¹ï¼‰èŒƒå›´å†…çš„å€¼ï¼Œå¹¶å¯ä»¥ç¼“å­˜æ­¤èŒƒå›´ä¹‹å¤–çš„å…¶ä»–å€¼ã€‚*/ public static Integer valueOf(int i) &#123; if (i &gt;= IntegerCache.low &amp;&amp; i &lt;= IntegerCache.high) return IntegerCache.cache[i + (-IntegerCache.low)]; return new Integer(i); &#125; åº”ç”¨åœºæ™¯ï¼š Integer i1=40ï¼›Java åœ¨ç¼–è¯‘çš„æ—¶å€™ä¼šç›´æ¥å°†ä»£ç å°è£…æˆ Integer i1=Integer.valueOf(40);ï¼Œä»è€Œä½¿ç”¨å¸¸é‡æ± ä¸­çš„å¯¹è±¡ã€‚ Integer i1 = new Integer(40);è¿™ç§æƒ…å†µä¸‹ä¼šåˆ›å»ºæ–°çš„å¯¹è±¡ã€‚ 123Integer i1 = 40;Integer i2 = new Integer(40);System.out.println(i1==i2);//è¾“å‡º false Integer æ¯”è¾ƒæ›´ä¸°å¯Œçš„ä¸€ä¸ªä¾‹å­: 12345678910111213Integer i1 = 40;Integer i2 = 40;Integer i3 = 0;Integer i4 = new Integer(40);Integer i5 = new Integer(40);Integer i6 = new Integer(0);System.out.println(\"i1=i2 \" + (i1 == i2));System.out.println(\"i1=i2+i3 \" + (i1 == i2 + i3));System.out.println(\"i1=i4 \" + (i1 == i4));System.out.println(\"i4=i5 \" + (i4 == i5));System.out.println(\"i4=i5+i6 \" + (i4 == i5 + i6)); System.out.println(\"40=i5+i6 \" + (40 == i5 + i6)); ç»“æœï¼š 123456i1=i2 truei1=i2+i3 truei1=i4 falsei4=i5 falsei4=i5+i6 true40=i5+i6 true è§£é‡Šï¼š è¯­å¥ i4 == i5 + i6ï¼Œå› ä¸º+è¿™ä¸ªæ“ä½œç¬¦ä¸é€‚ç”¨äº Integer å¯¹è±¡ï¼Œé¦–å…ˆ i5 å’Œ i6 è¿›è¡Œè‡ªåŠ¨æ‹†ç®±æ“ä½œï¼Œè¿›è¡Œæ•°å€¼ç›¸åŠ ï¼Œå³ i4 == 40ã€‚ç„¶å Integer å¯¹è±¡æ— æ³•ä¸æ•°å€¼è¿›è¡Œç›´æ¥æ¯”è¾ƒï¼Œæ‰€ä»¥ i4 è‡ªåŠ¨æ‹†ç®±è½¬ä¸º int å€¼ 40ï¼Œæœ€ç»ˆè¿™æ¡è¯­å¥è½¬ä¸º 40 == 40 è¿›è¡Œæ•°å€¼æ¯”è¾ƒã€‚ å‚è€ƒ ã€Šæ·±å…¥ç†è§£ Java è™šæ‹Ÿæœºï¼šJVM é«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µï¼ˆç¬¬äºŒç‰ˆã€‹ ã€Šå®æˆ˜ java è™šæ‹Ÿæœºã€‹ https://docs.oracle.com/javase/specs/index.html http://www.pointsoftware.ch/en/under-the-hood-runtime-data-areas-javas-memory-model/ https://dzone.com/articles/jvm-permgen-%E2%80%93-where-art-thou https://stackoverflow.com/questions/9095748/method-area-and-permgen æ·±å…¥è§£æString#internhttps://tech.meituan.com/2014/03/06/in-depth-understanding-string-intern.html å…¬ä¼—å·å¦‚æœå¤§å®¶æƒ³è¦å®æ—¶å…³æ³¨æˆ‘æ›´æ–°çš„æ–‡ç« ä»¥åŠåˆ†äº«çš„å¹²è´§çš„è¯ï¼Œå¯ä»¥å…³æ³¨æˆ‘çš„å…¬ä¼—å·ã€‚ ã€ŠJavaé¢è¯•çªå‡»ã€‹: ç”±æœ¬æ–‡æ¡£è¡ç”Ÿçš„ä¸“ä¸ºé¢è¯•è€Œç”Ÿçš„ã€ŠJavaé¢è¯•çªå‡»ã€‹V2.0 PDF ç‰ˆæœ¬å…¬ä¼—å·åå°å›å¤ â€œJavaé¢è¯•çªå‡»â€ å³å¯å…è´¹é¢†å–ï¼ Javaå·¥ç¨‹å¸ˆå¿…å¤‡å­¦ä¹ èµ„æº: ä¸€äº›Javaå·¥ç¨‹å¸ˆå¸¸ç”¨å­¦ä¹ èµ„æºå…¬ä¼—å·åå°å›å¤å…³é”®å­— â€œ1â€ å³å¯å…è´¹æ— å¥—è·¯è·å–ã€‚","categories":[{"name":"JAVAå­¦ä¹ ","slug":"JAVAå­¦ä¹ ","permalink":"https://shang.at/categories/JAVAå­¦ä¹ /"}],"tags":[{"name":"JVM","slug":"JVM","permalink":"https://shang.at/tags/JVM/"}]},{"title":"Javaå­¦ä¹ -wait&notify","slug":"Javaå­¦ä¹ -wait-notify","date":"2020-05-22T05:09:37.000Z","updated":"2020-06-03T09:33:41.264Z","comments":true,"path":"post/Javaå­¦ä¹ -wait-notify/","link":"","permalink":"https://shang.at/post/Javaå­¦ä¹ -wait-notify/","excerpt":"","text":"","categories":[{"name":"JAVAå­¦ä¹ ","slug":"JAVAå­¦ä¹ ","permalink":"https://shang.at/categories/JAVAå­¦ä¹ /"}],"tags":[{"name":"wait&notify","slug":"wait-notify","permalink":"https://shang.at/tags/wait-notify/"}]},{"title":"Javaå­¦ä¹ -Timer","slug":"Javaå­¦ä¹ -Timer","date":"2020-05-22T02:31:16.000Z","updated":"2020-06-03T09:33:28.680Z","comments":true,"path":"post/Javaå­¦ä¹ -Timer/","link":"","permalink":"https://shang.at/post/Javaå­¦ä¹ -Timer/","excerpt":"","text":"","categories":[{"name":"JAVAå­¦ä¹ ","slug":"JAVAå­¦ä¹ ","permalink":"https://shang.at/categories/JAVAå­¦ä¹ /"}],"tags":[{"name":"Timer","slug":"Timer","permalink":"https://shang.at/tags/Timer/"}]},{"title":"Javaå­¦ä¹ -NIO","slug":"Javaå­¦ä¹ -NIO","date":"2020-05-19T18:46:53.000Z","updated":"2020-06-03T09:33:10.621Z","comments":true,"path":"post/Javaå­¦ä¹ -NIO/","link":"","permalink":"https://shang.at/post/Javaå­¦ä¹ -NIO/","excerpt":"","text":"Java NIOç³»åˆ—æ•™ç¨‹ï¼ˆå…­ï¼‰ å¤šè·¯å¤ç”¨å™¨Selector ServerSocketChannelï¼šä¸€ä¸ªé¢å‘æµçš„ä¾¦å¬å¥—æ¥å­— é€šé“ã€‚ç”¨äºç›‘å¬æ˜¯å¦æœ‰æ–°çš„è¿æ¥åˆ°æ¥ï¼Œå¯ä»¥è°ƒç”¨acceptå‡½æ•°è·å–åˆ°æ¥çš„è¿æ¥(SocketChannel) SocketChannelï¼šä¸€ä¸ªé¢å‘æµçš„è¿æ¥å¥—æ¥å­— é€šé“ã€‚ç”¨äºä»è¿æ¥ä¸­è¯»å–æ•°æ®ï¼Œå’Œå‘è¿æ¥å†™å…¥æ•°æ® Selectorï¼šé€‰æ‹©å™¨ï¼Œå¯ä»¥ç®¡ç†ä¸€æ‰¹æ³¨å†Œçš„é€šé“é›†åˆçš„ä¿¡æ¯å’Œå®ƒä»¬çš„å°±ç»ªçŠ¶æ€(OP_CONNECT|OP_ACCEPT|OP_READ|OP_WRITE) SelectionKeyï¼šé€‰æ‹©é”®å°è£…äº†ç‰¹å®šçš„é€šé“ä¸ç‰¹å®šçš„é€‰æ‹©å™¨çš„æ³¨å†Œå…³ç³»ï¼Œä¸€ä¸ªkeyå°±ä»£è¡¨äº†ä¸€ä¸ªchannel SelectableChannelå¯ä»¥è¢«æ³¨å†Œåˆ°Selectorå¯¹è±¡ä¸Šï¼Œç„¶åè°ƒç”¨Selector.select()æ–¹æ³•å¯ä»¥æ›´æ–°SelectionKeys(å³å¤„äºæŸç§å°±ç»ªçŠ¶æ€çš„é€šé“é›†åˆ)ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥éå†è¿™äº›é€šè¿‡å¤„ç†ç›¸åº”çš„äº‹ä»¶ã€‚æ¯”å¦‚è¿æ¥å°±ç»ªçš„é€šé“ï¼Œæˆ‘ä»¬ä¼šæŠŠä»–ä»¬æ³¨å†Œæˆè¯»çŠ¶æ€ï¼Œç­‰å¾…å®ƒè¯»å°±ç»ªï¼›è¿æ¥è¯»å°±ç»ªï¼Œæˆ‘ä»¬å°±å¯ä»¥ä»ä¸­è¯»å–æ•°æ®ï¼›è¿æ¥å†™å°±ç»ªï¼Œæˆ‘ä»¬å°±å¯ä»¥å‘è¿æ¥å†™æ•°æ®","categories":[{"name":"JAVAå­¦ä¹ ","slug":"JAVAå­¦ä¹ ","permalink":"https://shang.at/categories/JAVAå­¦ä¹ /"}],"tags":[{"name":"NIO","slug":"NIO","permalink":"https://shang.at/tags/NIO/"}]},{"title":"Javaå­¦ä¹ -çº¿ç¨‹å®‰å…¨çš„é›†åˆç±»","slug":"Javaå­¦ä¹ -çº¿ç¨‹å®‰å…¨çš„é›†åˆç±»","date":"2020-05-17T15:16:15.000Z","updated":"2020-05-17T15:16:15.157Z","comments":true,"path":"post/Javaå­¦ä¹ -çº¿ç¨‹å®‰å…¨çš„é›†åˆç±»/","link":"","permalink":"https://shang.at/post/Javaå­¦ä¹ -çº¿ç¨‹å®‰å…¨çš„é›†åˆç±»/","excerpt":"","text":"","categories":[],"tags":[]},{"title":"Javaå­¦ä¹ -Iterator","slug":"Javaå­¦ä¹ -Iterator","date":"2020-05-17T07:27:13.000Z","updated":"2021-05-13T00:10:50.389Z","comments":true,"path":"post/Javaå­¦ä¹ -Iterator/","link":"","permalink":"https://shang.at/post/Javaå­¦ä¹ -Iterator/","excerpt":"","text":"åœ¨çœ‹Iteratorä¹‹å‰ï¼Œå…ˆçœ‹ä¸€ä¸ªæ—©æœŸç‰ˆæœ¬çš„è¿­ä»£å™¨java.util.Enumeration 1234public interface Enumeration&lt;E&gt; &#123; boolean hasMoreElements(); E nextElement();&#125; 1234* NOTE: The functionality of this interface is duplicated by the Iterator* interface. In addition, Iterator adds an optional remove operation, and* has shorter method names. New implementations should consider using* Iterator in preference to Enumeration. ç°åœ¨æ¥çœ‹Iteratorï¼š 12345678910111213141516public interface Iterator&lt;E&gt; &#123; boolean hasNext(); E next(); default void remove() &#123; throw new UnsupportedOperationException(\"remove\"); &#125; default void forEachRemaining(Consumer&lt;? super E&gt; action) &#123; Objects.requireNonNull(action); while (hasNext()) action.accept(next()); &#125;&#125; æ³¨æ„çš„ç‚¹ï¼š Iteratoråœ¨å¥½çš„è®¾è®¡ä¸‹å¯ä»¥åœ¨éå†çš„è¿‡ç¨‹ä¸­å¯¹åˆ—è¡¨è¿›è¡Œå¢åŠ å’Œåˆ é™¤å’Œä¿®æ”¹å…ƒç´  Iteratoråœ¨éå†çš„è¿‡ç¨‹åªèƒ½è¿›è¡Œä¸€éï¼Œå³éå†å®Œçš„å¯¹è±¡ä¸èƒ½å†æ¬¡éå†ï¼Œ å› ä¸ºå¤§å¤šæ•°Iteratoråœ¨å®ç°çš„è¿‡ç¨‹ä¸­éƒ½æ˜¯ç»´æŠ¤äº†äº†cursoræŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆä¸€èˆ¬åªä¼šå¢åŠ ï¼Œä¸ä¼šå‡å°‘ åŒæ—¶å¤§éƒ½æ²¡æœ‰é‡ç½®cursoræŒ‡é’ˆçš„æ¥å£ å…³é”®æ˜¯çœ‹Iteratorçš„è®¾è®¡å¦‚ä½• ä¾‹å¦‚ä¸‹é¢çš„ListIterator 1234567891011public interface ListIterator&lt;E&gt; extends Iterator&lt;E&gt; &#123; boolean hasNext(); E next(); boolean hasPrevious(); E previous(); int nextIndex(); int previousIndex(); void remove(); void set(E e); void add(E e);&#125; ListIteratoråœ¨åŸæ¥çš„Iteratorçš„åŸºç¡€ä¸Šæ‰©å±•äº†ï¼Œä½¿ä¹‹å¯ä»¥å¾€å‰éå†ï¼ŒåŒæ—¶å¯ä»¥ä¿®æ”¹å’Œå¢åŠ å…ƒç´ ","categories":[{"name":"JAVAå­¦ä¹ ","slug":"JAVAå­¦ä¹ ","permalink":"https://shang.at/categories/JAVAå­¦ä¹ /"}],"tags":[{"name":"JAVA-Iterator","slug":"JAVA-Iterator","permalink":"https://shang.at/tags/JAVA-Iterator/"}]},{"title":"Javaå­¦ä¹ -å‡½æ•°å¼ç¼–ç¨‹","slug":"Javaå­¦ä¹ -å‡½æ•°å¼ç¼–ç¨‹","date":"2020-05-17T00:38:33.000Z","updated":"2020-06-03T09:32:49.333Z","comments":true,"path":"post/Javaå­¦ä¹ -å‡½æ•°å¼ç¼–ç¨‹/","link":"","permalink":"https://shang.at/post/Javaå­¦ä¹ -å‡½æ•°å¼ç¼–ç¨‹/","excerpt":"","text":"Java8ä¹‹ååŠ å…¥äº†ä¸€ç§å…¨æ–°çš„æ–¹å¼æ¥å®ç°æ–¹æ³•(åŠŸèƒ½)ä½œä¸ºå‚æ•°ä¼ é€’çš„æœºåˆ¶ï¼šlambdaè¡¨è¾¾å¼ åƒpythonè¯­è¨€ï¼Œå¤©ç”Ÿå°±æ”¯æŒå°†functionä½œä¸ºå‚æ•°ä¼ é€’ç»™å‡½æ•°. å¯ä»¥æƒ³è±¡ï¼Œæ—¢ç„¶æ˜¯ä¸€ç§å®ç°æ–¹æ³•ä½œä¸ºå‚æ•°ä¼ é€’çš„æœºåˆ¶ï¼Œjavaæ˜¯ä¸€ç§é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨javaä¸­é™¤äº†åŸå§‹æ•°æ®ç±»å‹ä¹‹å¤–ï¼Œéƒ½æ˜¯å¯¹è±¡ï¼š 1234567891011&gt; @FunctionalInterface&gt; interface CharBinaryOperator &#123;&gt; String applyAsChar(char left, char right);&gt; &#125;&gt; &gt; CharBinaryOperator charBinaryOperator = (char a, char b) -&gt; &#123;&gt; System.out.println(a);&gt; System.out.println(b);&gt; return String.valueOf(a + b);&gt; &#125;;&gt; &gt; charBinaryOperator instanceof CharBinaryOperator charBinaryOperatoræ˜¯CharBinaryOperatorçš„ä¸€ä¸ªå®ä¾‹ CharBinaryOperator.class instanceof Class CharBinaryOperator.classæ˜¯Classçš„ä¸€ä¸ªå®ä¾‹ Class.class instanceof Class Class.classåŒæ—¶ä¹Ÿæ˜¯Classçš„ä¸€ä¸ªå®ä¾‹ åœ¨javaä¸­ï¼Œä¼ é€’çš„å‚æ•°è¦ä¹ˆæ˜¯åŸå§‹æ•°æ®ç±»å‹ï¼Œè¦ä¹ˆæ˜¯å¯¹è±¡(ç±»å‹ä¹Ÿæ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥èƒ½å¤Ÿä¼ é€’)ï¼Œä¸èƒ½æ˜¯å…¶ä»–çš„ç±»å‹ã€‚åœ¨JDK8ä¹‹å‰ï¼Œè¦æƒ³å°†ä¸€ä¸ªåŠŸèƒ½ä¼ é€’åˆ°å‡½æ•°å†…éƒ¨(è¿™ä¸€èˆ¬ä¼šè¢«ç§°ä¸ºå‡½æ•°å›è°ƒï¼Œæ˜¯å¤§å¤šæ•°å¼‚æ­¥ç¼–ç¨‹çš„å¸¸ç”¨å¥—è·¯ï¼šåˆ°è¾¾æŸä¸ªæ—¶é—´èŠ‚ç‚¹æˆ–æ»¡è¶³æŸä¸­æƒ…å†µè§¦å‘ä¸€ä¸ªæ“ä½œ)ï¼Œé‚£ä¹ˆå°±åªèƒ½æ˜¾ç¤ºçš„å…ˆå®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªå®ç°äº†è¿™ä¸ªæ¥å£çš„ç±»ï¼Œç„¶åå†å®ä¾‹åŒ–è¿™ä¸ªç±»å¾—åˆ°ä¸€ä¸ªå¯¹è±¡ï¼Œæœ€åå°†è¿™ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ä¼ å…¥å‡½æ•°ï¼Œå‡½æ•°å†…éƒ¨è°ƒç”¨å¯¹è±¡å®ç°çš„æ–¹æ³•ï¼Œå¦‚ï¼š 123456789CharBinaryOperator charBinaryOperator1 = new CharBinaryOperator() &#123; @Override public String applyAsChar(char a, char b) &#123; System.out.println(a); System.out.println(b); return String.valueOf(a + b); &#125;&#125;;charBinaryOperator.applyAsChar('a', 'b'); åœ¨JDK8åŠä¹‹åï¼Œæˆ‘ä»¬ä¸éœ€è¦å†æ˜¾ç¤ºçš„åšè¿™ä¸€ç³»åˆ—çš„äº‹æƒ…(å½“ç„¶ä½ è¿™ä¹ˆåšä¹Ÿä¸ä¼šæœ‰é—®é¢˜)ã€‚ åœ¨JDK8åŠä¹‹åï¼Œæ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„interfaceéƒ½ä¼šè¢«è§£é‡Šå‡½æ•°å¼æ¥å£ï¼Œå³éƒ½å¯ä»¥é€šè¿‡lambdaè¡¨è¾¾å¼çš„å½¢å¼ä»£æ›¿ä¸Šè¿°æµç¨‹ ä»€ä¹ˆæ ·çš„interfaceæ‰ç®—æ»¡è¶³æ¡ä»¶å‘¢ï¼Ÿ åªå£°æ˜äº†ä¸€ä¸ªæœªå®ç°çš„å‡½æ•°çš„interfaceå°±å¯ä»¥ã€‚åœ¨JDK8åŠä»¥åï¼Œinterfaceä¸­å®šä¹‰çš„å‡½æ•°ä¹Ÿå¯ä»¥æœ‰é»˜è®¤çš„å®ç° åœ¨å£°æ˜æ¥å£çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨java.lang.FunctionalInterfaceæ³¨è§£ï¼Œè¡¨ç¤ºè¯¥interfaceæ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£(å½“ç„¶å¯ä»¥ä¸åŠ ï¼Œcompilerä¼šè‡ªåŠ¨åˆ¤æ–­) å¦‚æœåœ¨æœ‰å¤šä¸ªæœªå®ç°çš„å‡½æ•°çš„interfaceä¸ŠåŠ è¿™ä¸ªæ³¨è§£çš„æ—¶å€™ï¼Œç¼–è¯‘é˜¶æ®µå°±ä¼šæŠ¥é”™ï¼šMultiple non-overriding abstract methods found in interface OOXX lambdaè¡¨è¾¾å¼åªä¸è¿‡æ˜¯ä¸ºäº†å®ç°è¿™ä¸ªæœºåˆ¶çš„ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œå¯ä»¥æé«˜å¼€å‘æ•ˆç‡ï¼ŒåŒæ—¶éšè—äº†interfaceçš„å®šä¹‰ç»†èŠ‚ï¼Œcompilierå®Œå…¨æ˜¯æŒ‰ç…§å‚æ•°åˆ—è¡¨æ¥æ¨æ–­å½“å‰çš„lambdaè¡¨è¾¾å¼æ˜¯å’Œå“ªä¸€ä¸ªinterfaceç»‘å®šçš„(compilierç›´æ¥æ‰¾åˆ°æ¥å£çš„å®šä¹‰ï¼Œä¸æ˜¯æ¨æ–­çš„)ã€‚å¦‚æœæ²¡æœ‰é¢„å®šä¹‰çš„ï¼Œé‚£ä¹ˆå°±ä¼šåœ¨ç¼–è¯‘æœŸé—´æŠ¥é”™ï¼Œæ‰€ä»¥åœ¨javaä¸­lambdaè¡¨è¾¾å¼çš„ä½¿ç”¨æ˜¯æœ‰ä¸€å®šçš„é™åˆ¶çš„ã€‚ åŒæ—¶ï¼Œåœ¨ä½¿ç”¨JDKé¢„å®šä¹‰çš„æ“ä½œæ—¶ï¼Œåœ¨å†…éƒ¨æ˜¯è°ƒç”¨äº†æ¥å£å†…å®šä¹‰çš„é‚£ä¸ªå…·ä½“çš„å‡½æ•°çš„ï¼Œæ‰€ä»¥å¯¹äºå¼€å‘è€…æ¥è¯´ä¹Ÿæ˜¯é€æ˜çš„ï¼Œå¦‚åˆ—è¡¨çš„forEach()å‡½æ•° 12345678910111213&gt; default void forEach(Consumer&lt;? super T&gt; action) &#123;&gt; Objects.requireNonNull(action);&gt; for (T t : this) &#123;&gt; action.accept(t);&gt; &#125;&gt; &#125;&gt; // æˆ‘ä»¬åœ¨ä½¿ç”¨çš„æ—¶å€™æ˜¯è¿™æ ·çš„&gt; List&lt;Integer&gt; integers = new ArrayList&lt;&gt;();&gt; integers.add(1);&gt; integers.forEach(i -&gt; &#123;&gt; System.out.println(i);&gt; &#125;);&gt; &gt;&gt;&gt; æœ¬è´¨ä¸Šï¼Œè¿˜æ˜¯è¦å…ˆæœ‰interfaceçš„å®šä¹‰(åœ¨JDKä¸­å·²ç»é¢„å®šä¹‰äº†å¤§éƒ¨åˆ†çš„interfaceï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰ä¸ç”¨è‡ªå·±æ‰‹åŠ¨å®šä¹‰ï¼Œæˆ‘ä¸Šé¢çš„ä¾‹å­ä¸­å°±æ˜¯ä¸€ä¸ªæ²¡æœ‰è¢«é¢„å®šä¹‰çš„ä¾‹å­)ï¼Œè¿è¡Œç»“æœä¹Ÿæ˜¯åˆ›å»ºäº†ä¸€ä¸ªå®ç°äº†æŒ‡å®šæ¥å£çš„å¯¹è±¡ï¼Œç„¶åå°†å¯¹è±¡ä½œä¸ºå‚æ•°ä¼ é€’ç»™å‡½æ•° å¦‚æœæˆ‘ä»¬å®Œå…¨è„±ç¦»äº†JDKé¢„å®šä¹‰çš„æ“ä½œï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦è‡ªå·±å®šä¹‰innterfaceï¼Œå¹¶ä¸”åœ¨æˆ‘ä»¬ä½¿ç”¨è¯¥æ¥å£çš„åœ°æ–¹æ˜¾ç¤ºçš„å£°æ˜æ–¹æ³•çš„ä½¿ç”¨ï¼Œä½†æ˜¯åœ¨å¤–å±‚ä¼ é€’æ–¹æ³•å‚æ•°çš„è°ƒç”¨ï¼Œæˆ‘ä»¬ä»å¯ä»¥ä½¿ç”¨ç®€æ´æ˜äº†çš„lambdaè¡¨è¾¾å¼ï¼Œæ— è®ºæ€ä¹ˆè¯´ï¼Œlambdaè¡¨è¾¾å¼çš„è¿™ç§æœºåˆ¶æå¤§çš„æ–¹ä¾¿äº†å¼€å‘äººå‘˜ Lambda è¡¨è¾¾å¼å’ŒåŒ¿åç±»ä¹‹é—´çš„åŒºåˆ« this å…³é”®å­—ã€‚å¯¹äºåŒ¿åç±» this å…³é”®å­—è§£æä¸ºåŒ¿åç±»ï¼Œè€Œå¯¹äº Lambda è¡¨è¾¾å¼ï¼Œthis å…³é”®å­—è§£æä¸ºåŒ…å«å†™å…¥ Lambda çš„ç±»ã€‚ JDKä¸­é¢„å®šä¹‰çš„interfaceåœ¨java.util.functionå¯ä»¥çœ‹åˆ°å…¨éƒ¨çš„é¢„å®šä¹‰çš„interfaceï¼Œä»¥ä¸‹å››ç§æ˜¯æœ€æœ‰ä»£è¡¨æ€§çš„ Function R apply(T) Function compose(Function&lt;? super V, ? extends T&gt; before) Function andThen(Function&lt;? super R, ? extends V&gt; after) Function identity() Consumer void accept(T) Consumer&lt; T&gt; addThen(Consumer&lt;? super T&gt;) Predicate boolean test() Predicate&lt; T&gt; add(Predicate&lt;? super T&gt;) Predicate&lt; T&gt; negate() Predicate&lt; T&gt; or(Predicate&lt;? super T&gt;) Predicate&lt; T&gt; isEqual(Object) Supplier T get() Lambda è¡¨è¾¾å¼çš„ä¾‹å­1 çº¿ç¨‹åˆå§‹åŒ–çº¿ç¨‹å¯ä»¥åˆå§‹åŒ–å¦‚ä¸‹ï¼š 123456789101112// Old waynew Thread(new Runnable() &#123; @Override public void run() &#123; System.out.println(\"Hello world\"); &#125;&#125;).start();// New waynew Thread( () -&gt; System.out.println(\"Hello world\")).start(); 2 äº‹ä»¶å¤„ç†äº‹ä»¶å¤„ç†å¯ä»¥ç”¨ Java 8 ä½¿ç”¨ Lambda è¡¨è¾¾å¼æ¥å®Œæˆã€‚ä»¥ä¸‹ä»£ç æ˜¾ç¤ºäº†å°† ActionListener æ·»åŠ åˆ° UI ç»„ä»¶çš„æ–°æ—§æ–¹å¼ï¼š 123456789101112// Old waybutton.addActionListener(new ActionListener() &#123; @Override public void actionPerformed(ActionEvent e) &#123; System.out.println(\"Hello world\"); &#125;&#125;);// New waybutton.addActionListener( (e) -&gt; &#123; System.out.println(\"Hello world\");&#125;); 3 éä¾‹è¾“å‡ºï¼ˆæ–¹æ³•å¼•ç”¨ï¼‰è¾“å‡ºç»™å®šæ•°ç»„çš„æ‰€æœ‰å…ƒç´ çš„ç®€å•ä»£ç ã€‚è¯·æ³¨æ„ï¼Œè¿˜æœ‰ä¸€ç§ä½¿ç”¨ Lambda è¡¨è¾¾å¼çš„æ–¹å¼ã€‚ 1234567891011// old wayList&lt;Integer&gt; list = Arrays.asList(1, 2, 3, 4, 5, 6, 7);for (Integer n : list) &#123; System.out.println(n);&#125;// ä½¿ç”¨ -&gt; çš„ Lambda è¡¨è¾¾å¼list.forEach(n -&gt; System.out.println(n));// ä½¿ç”¨ :: çš„ Lambda è¡¨è¾¾å¼list.forEach(System.out::println); 6.4 é€»è¾‘æ“ä½œè¾“å‡ºé€šè¿‡é€»è¾‘åˆ¤æ–­çš„æ•°æ®ã€‚ 123456789101112131415161718192021222324252627282930313233343536package com.wuxianjiezh.demo.lambda;import java.util.Arrays;import java.util.List;import java.util.function.Predicate;public class Main &#123; public static void main(String[] args) &#123; List&lt;Integer&gt; list = Arrays.asList(1, 2, 3, 4, 5, 6, 7); System.out.print(\"è¾“å‡ºæ‰€æœ‰æ•°å­—ï¼š\"); evaluate(list, (n) -&gt; true); System.out.print(\"ä¸è¾“å‡ºï¼š\"); evaluate(list, (n) -&gt; false); System.out.print(\"è¾“å‡ºå¶æ•°ï¼š\"); evaluate(list, (n) -&gt; n % 2 == 0); System.out.print(\"è¾“å‡ºå¥‡æ•°ï¼š\"); evaluate(list, (n) -&gt; n % 2 == 1); System.out.print(\"è¾“å‡ºå¤§äº 5 çš„æ•°å­—ï¼š\"); evaluate(list, (n) -&gt; n &gt; 5); &#125; public static void evaluate(List&lt;Integer&gt; list, Predicate&lt;Integer&gt; predicate) &#123; for (Integer n : list) &#123; if (predicate.test(n)) &#123; System.out.print(n + \" \"); &#125; &#125; System.out.println(); &#125;&#125; è¿è¡Œç»“æœï¼š 12345è¾“å‡ºæ‰€æœ‰æ•°å­—ï¼š1 2 3 4 5 6 7 ä¸è¾“å‡ºï¼šè¾“å‡ºå¶æ•°ï¼š2 4 6 è¾“å‡ºå¥‡æ•°ï¼š1 3 5 7 è¾“å‡ºå¤§äº 5 çš„æ•°å­—ï¼š6 7 6.4 Stream API ç¤ºä¾‹java.util.stream.Streamæ¥å£ å’Œ Lambda è¡¨è¾¾å¼ä¸€æ ·ï¼Œéƒ½æ˜¯ Java 8 æ–°å¼•å…¥çš„ã€‚æ‰€æœ‰ Stream çš„æ“ä½œå¿…é¡»ä»¥ Lambda è¡¨è¾¾å¼ä¸ºå‚æ•°ã€‚Stream æ¥å£ä¸­å¸¦æœ‰å¤§é‡æœ‰ç”¨çš„æ–¹æ³•ï¼Œæ¯”å¦‚ map() çš„ä½œç”¨å°±æ˜¯å°† input Stream çš„æ¯ä¸ªå…ƒç´ ï¼Œæ˜ å°„æˆoutput Stream çš„å¦å¤–ä¸€ä¸ªå…ƒç´ ã€‚ ä¸‹é¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬å°† Lambda è¡¨è¾¾å¼ x -&gt; x*x ä¼ é€’ç»™ map() æ–¹æ³•ï¼Œå°†å…¶åº”ç”¨äºæµçš„æ‰€æœ‰å…ƒç´ ã€‚ä¹‹åï¼Œæˆ‘ä»¬ä½¿ç”¨ forEach æ‰“å°åˆ—è¡¨çš„æ‰€æœ‰å…ƒç´ ã€‚ 12345678910// old wayList&lt;Integer&gt; list = Arrays.asList(1,2,3,4,5,6,7);for(Integer n : list) &#123; int x = n * n; System.out.println(x);&#125;// new wayList&lt;Integer&gt; list = Arrays.asList(1,2,3,4,5,6,7);list.stream().map((x) -&gt; x*x).forEach(System.out::println); ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ç»™å®šä¸€ä¸ªåˆ—è¡¨ï¼Œç„¶åæ±‚åˆ—è¡¨ä¸­æ¯ä¸ªå…ƒç´ çš„å¹³æ–¹å’Œã€‚è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† reduce() æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•çš„ä¸»è¦ä½œç”¨æ˜¯æŠŠ Stream å…ƒç´ ç»„åˆèµ·æ¥ã€‚ 12345678910111213// old wayList&lt;Integer&gt; list = Arrays.asList(1,2,3,4,5,6,7);int sum = 0;for(Integer n : list) &#123; int x = n * n; sum = sum + x;&#125;System.out.println(sum);// new wayList&lt;Integer&gt; list = Arrays.asList(1,2,3,4,5,6,7);int sum = list.stream().map(x -&gt; x*x).reduce((x,y) -&gt; x + y).get();System.out.println(sum);","categories":[{"name":"JAVAå­¦ä¹ ","slug":"JAVAå­¦ä¹ ","permalink":"https://shang.at/categories/JAVAå­¦ä¹ /"}],"tags":[{"name":"å‡½æ•°å¼ç¼–ç¨‹","slug":"å‡½æ•°å¼ç¼–ç¨‹","permalink":"https://shang.at/tags/å‡½æ•°å¼ç¼–ç¨‹/"}]},{"title":"Javaå­¦ä¹ -é›†åˆç±»","slug":"Javaå­¦ä¹ -é›†åˆç±»","date":"2020-05-16T23:27:00.000Z","updated":"2020-06-03T09:32:54.364Z","comments":true,"path":"post/Javaå­¦ä¹ -é›†åˆç±»/","link":"","permalink":"https://shang.at/post/Javaå­¦ä¹ -é›†åˆç±»/","excerpt":"","text":"[TOC] æ€»è§ˆ æ³¨ï¼šè¿™é‡Œåªåˆ—ä¸¾äº†å•ä¸€çº¿çº¿ç¨‹ä½¿ç”¨çš„é›†åˆå¯¹è±¡(Vectoré™¤å¤–) JVAVä¸­åˆ—è¡¨ç±»é›†åˆï¼ŒæŒ‰ç…§æ•°æ®çš„å­˜å‚¨æ–¹å¼å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ï¼šåŸºäºæ•°ç»„å’ŒåŸºäºé“¾è¡¨ã€‚ä¸¤ç§æ–¹å¼å„æœ‰å¥½å¤„ï¼Œéœ€è¦æ ¹æ®å®é™…ä¸šåŠ¡åœºæ™¯åšå‡ºé€‰æ‹©ã€‚ æ•°ç»„ ä¼˜ç‚¹ æ”¯æŒéšæœºè®¿é—®ï¼Œç»™å®šä¸‹æ ‡çš„è®¿é—®æ˜¯O(1)çš„æ—¶é—´å¤æ‚åº¦ ç¼ºç‚¹ å†…å­˜å¿…é¡»æ˜¯è¿ç»­çš„ï¼Œå¦åˆ™ä¼šç”³è¯·ç©ºé—´å¤±è´¥ æŸ¥æ‰¾ã€æ’å…¥ã€æ‰©å®¹ã€åˆ é™¤éƒ½æ˜¯O(n)çš„æ—¶é—´å¤æ‚åº¦ æœ‰å®¹é‡çš„é™åˆ¶ï¼Œå¢åŠ èŠ‚ç‚¹æ—¶ï¼Œå¯èƒ½ä¼šå› ä¸ºæ•°ç»„å¤§å°ä¸å¤Ÿå¯¼è‡´æ‰©å®¹ï¼Œæ‰©å®¹çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(n)çš„ ä½¿ç”¨æ³¨æ„ æœ€å¥½èƒ½å¤Ÿé¢„ä¼°æ•°æ®çš„æœ€å¤§å®¹é‡ï¼Œå¯ä»¥é¢„å…ˆè®¾è®¡capacityï¼Œå°½é‡é¿å…æ‰©å®¹æ“ä½œ ä½†æ˜¯åœ¨ç‰¹åˆ«çš„ä½¿ç”¨åœºæ™¯ä¸‹ï¼ŒåŸºäºæ•°ç»„çš„å®ç°æ•ˆç‡ä¼šæ›´å¥½ï¼Œæ¯”å¦‚ä¸‹é¢è¦è¯´çš„ArrayDeque å…·ä½“å®ç° ArrayList Vector Stack ArrayDeque é“¾è¡¨ ä¼˜ç‚¹ å†…å­˜ä¸ç”¨æ˜¯è¿ç»­çš„ æ’å…¥ã€åˆ é™¤éƒ½æ˜¯O(1)çš„æ—¶é—´å¤æ‚åº¦ æ²¡æœ‰å®¹é‡çš„é™åˆ¶ï¼ŒæŒ‰ç†è¯´é™åˆ¶å°±æ˜¯JVAVå †çš„å¤§å°é™åˆ¶ ç¼ºç‚¹ æŸ¥æ‰¾æ˜¯O(n)çš„æ—¶é—´å¤æ‚åº¦ ä½¿ç”¨ å•ç‹¬ä½¿ç”¨é“¾è¡¨çš„æ—¶å€™ï¼Œè¿˜æŒºå°‘çš„ï¼Œæ¯•ç«Ÿä¸€ä¸ªæ²¡æœ‰é™„åŠ ç‰¹æ€§çš„é“¾è¡¨ç»“æ„ï¼Œä»…ä»…åªèƒ½å¤Ÿåšåˆ°æ–°å¢å’Œåˆ é™¤çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(1)ï¼Œä½†æ˜¯æŸ¥è¯¢å´éœ€è¦O(n)ï¼Œå¹¶ä¸”è¿˜éœ€è¦é¢å¤–çš„ç©ºé—´å­˜å‚¨é“¾è¡¨ç»“æ„ã€‚æ•°ç»„å¯ä»¥é€šè¿‡é¢„ä¼°å®¹é‡çš„æ–¹å¼å°½é‡å‡å°‘æ‰©å®¹çš„æ“ä½œï¼Œå¯¹æ¯”å‘ç°ï¼Œä½¿ç”¨åŸºäºæ•°ç»„çš„é›†åˆæ€§ä»·æ¯”æ›´é«˜ å…·ä½“å®ç° LinkList LinkListåœ¨å®šä½ä½indexä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œæœ‰ä¸ªä¼˜åŒ–çš„ç‚¹å¯ä»¥å­¦ä¹  123456789101112131415Node&lt;E&gt; node(int index) &#123; // assert isElementIndex(index); if (index &lt; (size &gt;&gt; 1)) &#123; Node&lt;E&gt; x = first; for (int i = 0; i &lt; index; i++) x = x.next; return x; &#125; else &#123; Node&lt;E&gt; x = last; for (int i = size - 1; i &gt; index; i--) x = x.prev; return x; &#125;&#125; æ€»ç»“ï¼šå¯ä»¥å‘ç°ï¼ŒåŸºäºæ•°ç»„å’ŒåŸºäºé“¾è¡¨çš„é›†åˆå®ç°æ–¹å¼ï¼Œæƒ³è¦ä»ä»–ä»¬ä¸­æŸ¥è¯¢åˆ°å…·ä½“çš„å…ƒç´ ï¼Œæ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(n)çš„ï¼Œè¿™æ˜¯å› ä¸ºï¼Œè¿™é‡Œä»…ä»…è€ƒè™‘äº†æ•°æ®çš„å­˜å‚¨æ–¹å¼ï¼Œå¹¶æ²¡æœ‰é¢å¤–çš„ä¿¡æ¯ç»™å‡ºæ¥ï¼Œæ‰€ä»¥æ˜¯æ²¡æœ‰åŠæ³•åŠ é€ŸæŸ¥è¯¢çš„ã€‚è¦æƒ³å®ç°åŠ é€ŸæŸ¥è¯¢ï¼Œé‚£ä¹ˆå°±å¿…é¡»åœ¨è¿™åŸºç¡€ä¸Šå¢åŠ æ–°çš„ç‰¹æ€§ï¼š æ•°ç»„ æœ‰åºæ€§ï¼šå¯ä»¥å€ŸåŠ©æœ‰åºæ€§ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾ï¼ŒæŠŠæŸ¥æ‰¾æ—¶é—´å¤æ‚åº¦é™åˆ°O(log n) é“¾è¡¨ å»ºç«‹æ ‘ç»“æ„ï¼š äºŒå‰æœç´¢æ ‘ï¼šå‰åºéå†å°±æ˜¯æ­£å‘æ’åºï¼Œå¯ä»¥æŠŠæŸ¥è¯¢çš„æ—¶é—´å¤æ‚åº¦é™åˆ°O(log n)ï¼Œä½†æ˜¯è¦ç»´æŠ¤äºŒå‰æœç´¢ï¼Œå°½é‡ä¿è¯ä»–æ˜¯å¹³è¡¡çš„(ä½†æ˜¯è¿™ä¸ªçš„æ—¶é—´å¤æ‚åº¦æ˜¯O(1)çš„) å †ï¼šæŸ¥æ‰¾æœ€å¤§(æœ€å°)å€¼æ˜¯O(1)çš„æ—¶é—´å¤æ‚åº¦ å‡ç»´ï¼šæ¯”å¦‚è·³è¡¨ï¼Œå°±æ˜¯åœ¨æœ‰åºçš„é“¾è¡¨ä¸Šå»ºç«‹å¤šçº§ç´¢å¼•æ¥å®ç°åŠ é€ŸæŸ¥è¯¢çš„ï¼Œå¯ä»¥æŠŠæŸ¥æ‰¾æ—¶é—´å¤æ‚åº¦é™åˆ°O(log n)ï¼Œä½†æ˜¯åœ¨æ–°å¢å’Œåˆ é™¤èŠ‚ç‚¹æ—¶éœ€è¦ç»´æŠ¤å¤šçº§ç´¢å¼•(ä½†æ˜¯è¿™ä¸ªçš„æ—¶é—´å¤æ‚åº¦æ˜¯O(1)çš„) List æ¥å£ä¿¡æ¯å¦‚ä¸‹ï¼š Method Return Comment Insert add(E) boolean å‘é˜Ÿåˆ—åŠ å…¥å…ƒç´ ï¼Œå¦‚æœç©ºé—´ä¸è¶³ï¼Œä¼šè§¦å‘æ‰©å®¹ Insert add(int, E) void å‘æŒ‡å®šä½ç½®æ’å…¥å…ƒç´ ï¼Œå¯èƒ½ä¼šæŠ›IndexOutOfBoundsException Remove remove(Object) boolean ç§»é™¤æŒ‡å®šçš„å…ƒç´ ï¼Œæ²¡æœ‰çš„è¯è¿”å›falseï¼Œæœ‰çš„è¯è¿”å›true Remove remove(int) E ç§»é™¤æŒ‡å®šindexçš„å…ƒç´ ï¼Œå¯èƒ½ä¼šæŠ›IndexOutOfBoundsException Examine get(int) E è¿”å›æŒ‡å®šindexçš„å…ƒç´ ï¼Œå¯èƒ½ä¼šæŠ›IndexOutOfBoundsException Update set(int, E) E æ›´æ–°æŒ‡å®šindexçš„å…ƒç´ ï¼Œå¯èƒ½ä¼šæŠ›IndexOutOfBoundsException åœ¨Listçš„æºç ä¸­å‘ç°å¤šå¤„è¿™æ ·çš„ä»£ç ï¼š 12345678910111213// åªè¿”å›ç¬¬ä¸€ä¸ªé‡åˆ°çš„oï¼Œå½“oä¸ºnullçš„æ—¶å€™ï¼Œo.equalsä¼šæŠ¥é”™public int indexOf(Object o) &#123; if (o == null) &#123; for (int i = 0; i &lt; size; i++) if (elementData[i]==null) return i; &#125; else &#123; for (int i = 0; i &lt; size; i++) if (o.equals(elementData[i])) return i; &#125; return -1;&#125; è¯¦çœ‹æ‰©å®¹æ“ä½œ 1234567891011121314151617181920212223242526272829303132333435363738394041424344public boolean add(E e) &#123; ensureCapacityInternal(size + 1); // Increments modCount!! elementData[size++] = e; return true;&#125;// DEFAULT_CAPACITY=10 private void ensureCapacityInternal(int minCapacity) &#123; if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) &#123; minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity); &#125; ensureExplicitCapacity(minCapacity); &#125; private void ensureExplicitCapacity(int minCapacity) &#123; modCount++; // overflow-conscious code if (minCapacity - elementData.length &gt; 0) grow(minCapacity); &#125; private void grow(int minCapacity) &#123; // overflow-conscious code int oldCapacity = elementData.length; // newCapacity = int(1.5*oldCapacity) int newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1); if (newCapacity - minCapacity &lt; 0) newCapacity = minCapacity; if (newCapacity - MAX_ARRAY_SIZE &gt; 0) newCapacity = hugeCapacity(minCapacity); // minCapacity is usually close to size, so this is a win: elementData = Arrays.copyOf(elementData, newCapacity); &#125; // æ•´å½¢æº¢å‡ºï¼šInteger.MAX_VALUE + 8&lt;0 private static int hugeCapacity(int minCapacity) &#123; if (minCapacity &lt; 0) // overflow throw new OutOfMemoryError(); return (minCapacity &gt; MAX_ARRAY_SIZE) ? Integer.MAX_VALUE : MAX_ARRAY_SIZE; &#125; Queue è®¾è®¡äº†ä¸€å¥—æ”¯æŒé˜Ÿåˆ—æ“ä½œçš„æ¥å£ï¼Œå¦‚ä¸‹ï¼š Method Return Comment Insert add(E) boolean å‘é˜Ÿåˆ—æ·»åŠ ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœæ²¡æœ‰ç©ºé—´ä¼šæŠ›å‡ºIllegalStateException Insert offer(E) boolean å‘é˜Ÿåˆ—æ·»åŠ ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœæ²¡æœ‰ç©ºé—´ä¼šè¿”å›false Remove remove() E ç§»é™¤å¹¶è¿”å›å¤´ç»“ç‚¹ï¼Œå¦‚æœé˜Ÿåˆ—ä¸ºç©ºçš„è¯ï¼Œä¼šæŠ›NoSuchElementException Remove poll() E ç§»é™¤å¹¶è¿”å›å¤´ç»“ç‚¹ï¼Œå¦‚æœé˜Ÿåˆ—ä¸ºç©ºçš„è¯ï¼Œä¼šè¿”å›null Examine element() E è¿”å›å¤´ç»“ç‚¹ï¼Œå¦‚æœé˜Ÿåˆ—ä¸ºç©ºçš„è¯ï¼Œä¼šæŠ›NoSuchElementException Examine peek() E è¿”å›å¤´ç»“ç‚¹ï¼Œå¦‚æœé˜Ÿåˆ—ä¸ºç©ºçš„è¯ï¼Œä¼šè¿”å›null Deque Stack æ€»ç»“ï¼šé€šå¸¸ä½¿ç”¨ArrayDequeæ¥ä½œä¸ºå…ˆè¿›å…ˆå‡ºçš„Queueï¼Œåè¿›å…ˆå‡ºçš„Stack","categories":[{"name":"JAVAå­¦ä¹ ","slug":"JAVAå­¦ä¹ ","permalink":"https://shang.at/categories/JAVAå­¦ä¹ /"}],"tags":[{"name":"JAVAé›†åˆç±»-åˆ—è¡¨","slug":"JAVAé›†åˆç±»-åˆ—è¡¨","permalink":"https://shang.at/tags/JAVAé›†åˆç±»-åˆ—è¡¨/"}]},{"title":"åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶-IPC&RPC","slug":"åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶-IPC-RPC","date":"2020-05-14T03:38:18.000Z","updated":"2020-06-02T22:35:24.864Z","comments":true,"path":"post/åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶-IPC-RPC/","link":"","permalink":"https://shang.at/post/åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶-IPC-RPC/","excerpt":"","text":"","categories":[{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","permalink":"https://shang.at/categories/åˆ†å¸ƒå¼/"}],"tags":[{"name":"IPC&RPC","slug":"IPC-RPC","permalink":"https://shang.at/tags/IPC-RPC/"}]},{"title":"Javaå­¦ä¹ -åŠ¨æ€ä»£ç†","slug":"Javaå­¦ä¹ -åŠ¨æ€ä»£ç†","date":"2020-05-14T03:34:00.000Z","updated":"2020-06-03T03:01:02.693Z","comments":true,"path":"post/Javaå­¦ä¹ -åŠ¨æ€ä»£ç†/","link":"","permalink":"https://shang.at/post/Javaå­¦ä¹ -åŠ¨æ€ä»£ç†/","excerpt":"","text":"","categories":[{"name":"JAVAå­¦ä¹ ","slug":"JAVAå­¦ä¹ ","permalink":"https://shang.at/categories/JAVAå­¦ä¹ /"}],"tags":[{"name":"åŠ¨æ€ä»£ç†","slug":"åŠ¨æ€ä»£ç†","permalink":"https://shang.at/tags/åŠ¨æ€ä»£ç†/"}]},{"title":"Mysqlå­¦ä¹ -äº‹åŠ¡å’Œéš”ç¦»çº§åˆ«","slug":"Mysqlå­¦ä¹ -äº‹åŠ¡å’Œéš”ç¦»çº§åˆ«","date":"2020-05-12T17:31:26.000Z","updated":"2020-06-25T01:16:15.635Z","comments":true,"path":"post/Mysqlå­¦ä¹ -äº‹åŠ¡å’Œéš”ç¦»çº§åˆ«/","link":"","permalink":"https://shang.at/post/Mysqlå­¦ä¹ -äº‹åŠ¡å’Œéš”ç¦»çº§åˆ«/","excerpt":"","text":"MYSQLäº‹åŠ¡å’Œéš”ç¦»çº§åˆ«ä¸€ã€äº‹åŠ¡äº‹åŠ¡æ˜¯ç”±ä¸€ç»„SQLè¯­å¥ç»„æˆçš„é€»è¾‘å¤„ç†å•å…ƒï¼Œæ˜¯æ»¡è¶³ ACID ç‰¹æ€§çš„ä¸€ç»„æ“ä½œï¼Œå¯ä»¥é€šè¿‡ Commit æäº¤ä¸€ä¸ªäº‹åŠ¡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ Rollback è¿›è¡Œå›æ»šã€‚äº‹åŠ¡å…·æœ‰ä»¥ä¸‹4ä¸ªå±æ€§ï¼Œé€šå¸¸ç®€ç§°ä¸ºäº‹åŠ¡çš„ACIDå±æ€§: åŸå­æ€§ï¼ˆAtomicityï¼‰ï¼šäº‹åŠ¡æ˜¯ä¸€ä¸ªåŸå­æ“ä½œå•å…ƒï¼Œå…¶å¯¹æ•°æ®çš„ä¿®æ”¹ï¼Œè¦ä¹ˆå…¨éƒ½æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ½ä¸æ‰§è¡Œã€‚æ¯”å¦‚åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­çš„SQLè¯­å¥ï¼Œè¦ä¹ˆå…¨éƒ¨æ‰§è¡ŒæˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œå¤±è´¥ã€‚å›æ»šå¯ä»¥ç”¨æ—¥å¿—æ¥å®ç°ï¼Œæ—¥å¿—è®°å½•ç€äº‹åŠ¡æ‰€æ‰§è¡Œçš„ä¿®æ”¹æ“ä½œï¼Œåœ¨å›æ»šæ—¶åå‘æ‰§è¡Œè¿™äº›ä¿®æ”¹æ“ä½œå³å¯ã€‚ ä¸€è‡´æ€§ï¼ˆConsistentï¼‰ï¼šåœ¨äº‹åŠ¡å¼€å§‹å’Œå®Œæˆæ—¶ï¼Œæ•°æ®éƒ½å¿…é¡»ä¿æŒä¸€è‡´çŠ¶æ€ã€‚è¿™æ„å‘³ç€æ‰€æœ‰ç›¸å…³çš„æ•°æ®è§„åˆ™éƒ½å¿…é¡»åº”ç”¨äºäº‹åŠ¡çš„ä¿®æ”¹ï¼Œä»¥ä¿æŒæ•°æ®çš„å®Œæ•´æ€§ï¼›äº‹åŠ¡ç»“æŸæ—¶ï¼Œæ‰€æœ‰çš„å†…éƒ¨æ•°æ®ç»“æ„ï¼ˆå¦‚Bæ ‘ç´¢å¼•æˆ–åŒå‘é“¾è¡¨ï¼‰ä¹Ÿéƒ½å¿…é¡»æ˜¯æ­£ç¡®çš„ã€‚ ä»¥è½¬è´¦ä¸ºä¾‹å­ï¼ŒAå‘Bè½¬è´¦ï¼Œå‡è®¾è½¬è´¦ä¹‹å‰è¿™ä¸¤ä¸ªç”¨æˆ·çš„é’±åŠ èµ·æ¥æ€»å…±æ˜¯2000ï¼Œé‚£ä¹ˆAå‘Bè½¬è´¦ä¹‹åï¼Œä¸ç®¡è¿™ä¸¤ä¸ªè´¦æˆ·æ€ä¹ˆè½¬ï¼ŒAç”¨æˆ·çš„é’±å’ŒBç”¨æˆ·çš„é’±åŠ èµ·æ¥çš„æ€»é¢è¿˜æ˜¯2000ï¼Œè¿™ä¸ªå°±æ˜¯äº‹åŠ¡çš„ä¸€è‡´æ€§ã€‚ éš”ç¦»æ€§ï¼ˆIsolationï¼‰ï¼šæ•°æ®åº“ç³»ç»Ÿæä¾›ä¸€å®šçš„éš”ç¦»æœºåˆ¶ï¼Œä¿è¯äº‹åŠ¡åœ¨ä¸å—å¤–éƒ¨å¹¶å‘æ“ä½œå½±å“çš„â€œç‹¬ç«‹â€ç¯å¢ƒæ‰§è¡Œã€‚ éš”ç¦»æ€§æ˜¯å½“å¤šä¸ªç”¨æˆ·å¹¶å‘è®¿é—®æ•°æ®åº“æ—¶ï¼Œæ¯”å¦‚æ“ä½œåŒä¸€å¼ è¡¨æ—¶ï¼Œæ•°æ®åº“ä¸ºæ¯ä¸€ä¸ªç”¨æˆ·å¼€å¯çš„äº‹åŠ¡ï¼Œä¸èƒ½è¢«å…¶ä»–äº‹åŠ¡çš„æ“ä½œæ‰€å¹²æ‰°ï¼Œå¤šä¸ªå¹¶å‘äº‹åŠ¡ä¹‹é—´è¦ç›¸äº’éš”ç¦»ã€‚å³è¦è¾¾åˆ°è¿™ä¹ˆä¸€ç§æ•ˆæœï¼šå¯¹äºä»»æ„ä¸¤ä¸ªå¹¶å‘çš„äº‹åŠ¡ T1 å’Œ T2ï¼Œåœ¨äº‹åŠ¡ T1 çœ‹æ¥ï¼ŒT2 è¦ä¹ˆåœ¨ T1 å¼€å§‹ä¹‹å‰å°±å·²ç»ç»“æŸï¼Œè¦ä¹ˆåœ¨ T1 ç»“æŸä¹‹åæ‰å¼€å§‹ï¼Œè¿™æ ·æ¯ä¸ªäº‹åŠ¡éƒ½æ„Ÿè§‰ä¸åˆ°æœ‰å…¶ä»–äº‹åŠ¡åœ¨å¹¶å‘åœ°æ‰§è¡Œã€‚ æŒä¹…æ€§ï¼ˆDurableï¼‰ï¼šäº‹åŠ¡å®Œæˆä¹‹åï¼Œå®ƒå¯¹äºæ•°æ®çš„ä¿®æ”¹æ˜¯æ°¸ä¹…æ€§çš„ï¼Œå³ä½¿å‡ºç°ç³»ç»Ÿæ•…éšœä¹Ÿèƒ½å¤Ÿä¿æŒã€‚ å¯ä»¥é€šè¿‡æ•°æ®åº“å¤‡ä»½å’Œæ¢å¤æ¥å®ç°ï¼Œåœ¨ç³»ç»Ÿå‘ç”Ÿå¥”æºƒæ—¶ï¼Œä½¿ç”¨å¤‡ä»½çš„æ•°æ®åº“è¿›è¡Œæ•°æ®æ¢å¤ã€‚ MySQL é»˜è®¤é‡‡ç”¨è‡ªåŠ¨æäº¤æ¨¡å¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä¸æ˜¾å¼ä½¿ç”¨ START TRANSACTION è¯­å¥æ¥å¼€å§‹ä¸€ä¸ªäº‹åŠ¡ï¼Œé‚£ä¹ˆæ¯ä¸ªæŸ¥è¯¢éƒ½ä¼šè¢«å½“åšä¸€ä¸ªäº‹åŠ¡è‡ªåŠ¨æäº¤ã€‚ è¿™å‡ ä¸ªç‰¹æ€§ä¸æ˜¯ä¸€ç§å¹³çº§å…³ç³»ï¼š åªæœ‰æ»¡è¶³ä¸€è‡´æ€§ï¼Œäº‹åŠ¡çš„æ‰§è¡Œç»“æœæ‰æ˜¯æ­£ç¡®çš„ã€‚ åœ¨æ— å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œäº‹åŠ¡ä¸²è¡Œæ‰§è¡Œï¼Œéš”ç¦»æ€§ä¸€å®šèƒ½å¤Ÿæ»¡è¶³ã€‚æ­¤æ—¶è¦åªè¦èƒ½æ»¡è¶³åŸå­æ€§ï¼Œå°±ä¸€å®šèƒ½æ»¡è¶³ä¸€è‡´æ€§ã€‚ åœ¨å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œå¤šä¸ªäº‹åŠ¡å¹¶å‘æ‰§è¡Œï¼Œäº‹åŠ¡ä¸ä»…è¦æ»¡è¶³åŸå­æ€§ï¼Œè¿˜éœ€è¦æ»¡è¶³éš”ç¦»æ€§ï¼Œæ‰èƒ½æ»¡è¶³ä¸€è‡´æ€§ã€‚ äº‹åŠ¡æ»¡è¶³æŒä¹…åŒ–æ˜¯ä¸ºäº†èƒ½åº”å¯¹æ•°æ®åº“å¥”æºƒçš„æƒ…å†µã€‚ äºŒã€å¹¶å‘ä¸€è‡´æ€§é—®é¢˜1ã€æ›´æ–°ä¸¢å¤±(Lost Update)T1 å’Œ T2 ä¸¤ä¸ªäº‹åŠ¡éƒ½å¯¹ä¸€ä¸ªæ•°æ®è¿›è¡Œä¿®æ”¹ï¼ŒT1 å…ˆä¿®æ”¹ï¼ŒT2 éšåä¿®æ”¹ï¼ŒT2 çš„ä¿®æ”¹è¦†ç›–äº† T1 çš„ä¿®æ”¹ã€‚ ä¾‹å¦‚ï¼Œä¸¤ä¸ªç¨‹åºå‘˜ä¿®æ”¹åŒä¸€javaæ–‡ä»¶ã€‚æ¯ç¨‹åºå‘˜ç‹¬ç«‹åœ°æ›´æ”¹å…¶å‰¯æœ¬ï¼Œç„¶åä¿å­˜æ›´æ”¹åçš„å‰¯æœ¬ï¼Œè¿™æ ·å°±è¦†ç›–äº†åŸå§‹æ–‡æ¡£ã€‚æœ€åä¿å­˜å…¶æ›´æ”¹å‰¯æœ¬çš„ç¼–è¾‘äººå‘˜è¦†ç›–å‰ä¸€ä¸ªç¨‹åºå‘˜æ‰€åšçš„æ›´æ”¹ã€‚ å¦‚æœåœ¨ä¸€ä¸ªç¨‹åºå‘˜å®Œæˆå¹¶æäº¤äº‹åŠ¡ä¹‹å‰ï¼Œå¦ä¸€ä¸ªç¨‹åºå‘˜ä¸èƒ½è®¿é—®åŒä¸€æ–‡ä»¶ï¼Œåˆ™å¯é¿å…æ­¤é—®é¢˜ã€‚ 2ã€è„è¯»ä¸€å¥è¯ï¼šäº‹åŠ¡Bè¯»å–åˆ°äº†äº‹åŠ¡Aå·²ä¿®æ”¹ä½†å°šæœªæäº¤çš„çš„æ•°æ®ï¼Œè¿˜åœ¨è¿™ä¸ªæ•°æ®åŸºç¡€ä¸Šåšäº†æ“ä½œã€‚æ­¤æ—¶ï¼Œå¦‚æœAäº‹åŠ¡å›æ»šRollbackï¼ŒBè¯»å–çš„æ•°æ®æ— æ•ˆï¼Œä¸ç¬¦åˆä¸€è‡´æ€§è¦æ±‚ã€‚ è§£å†³åŠæ³•: æŠŠæ•°æ®åº“çš„äº‹åŠ¡éš”ç¦»çº§åˆ«è°ƒæ•´åˆ° READ_COMMITTED T1 ä¿®æ”¹ä¸€ä¸ªæ•°æ®ï¼ŒT2 éšåè¯»å–è¿™ä¸ªæ•°æ®ã€‚å¦‚æœ T1 æ’¤é”€äº†è¿™æ¬¡ä¿®æ”¹ï¼Œé‚£ä¹ˆ T2 è¯»å–çš„æ•°æ®æ˜¯è„æ•°æ®ã€‚ 3ã€ä¸å¯é‡å¤è¯»(Non-Repeatable Reads) åœ¨ä¸€ä¸ªäº‹åŠ¡å†…ï¼Œå¤šæ¬¡è¯»åŒä¸€ä¸ªæ•°æ®ã€‚åœ¨è¿™ä¸ªäº‹åŠ¡è¿˜æ²¡æœ‰ç»“æŸæ—¶ï¼Œå¦ä¸€ä¸ªäº‹åŠ¡ä¹Ÿè®¿é—®è¯¥åŒä¸€æ•°æ®ã€‚é‚£ä¹ˆï¼Œåœ¨ç¬¬ä¸€ä¸ªäº‹åŠ¡çš„ä¸¤æ¬¡è¯»æ•°æ®ä¹‹é—´ã€‚ç”±äºç¬¬äºŒä¸ªäº‹åŠ¡çš„ä¿®æ”¹ï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªäº‹åŠ¡è¯»åˆ°çš„æ•°æ®å¯èƒ½ä¸ä¸€æ ·ï¼Œè¿™æ ·å°±å‘ç”Ÿäº†åœ¨ä¸€ä¸ªäº‹åŠ¡å†…ä¸¤æ¬¡è¯»åˆ°çš„æ•°æ®æ˜¯ä¸ä¸€æ ·çš„ï¼Œå› æ­¤ç§°ä¸ºä¸å¯é‡å¤è¯»ï¼Œå³åŸå§‹è¯»å–ä¸å¯é‡å¤ã€‚ ä¸€å¥è¯ï¼šä¸€ä¸ªäº‹åŠ¡èŒƒå›´å†…ä¸¤ä¸ªç›¸åŒçš„æŸ¥è¯¢å´è¿”å›äº†ä¸åŒæ•°æ®ã€‚ åŒæ—¶æ“ä½œï¼Œäº‹åŠ¡1åˆ†åˆ«è¯»å–äº‹åŠ¡2æ“ä½œæ—¶å’Œæäº¤åçš„æ•°æ®ï¼Œè¯»å–çš„è®°å½•å†…å®¹ä¸ä¸€è‡´ã€‚ä¸å¯é‡å¤è¯»æ˜¯æŒ‡åœ¨åŒä¸€ä¸ªäº‹åŠ¡å†…ï¼Œä¸¤ä¸ªç›¸åŒçš„æŸ¥è¯¢è¿”å›äº†ä¸åŒçš„ç»“æœã€‚ è§£å†³åŠæ³•: å¦‚æœåªæœ‰åœ¨ä¿®æ”¹äº‹åŠ¡å®Œå…¨æäº¤ä¹‹åæ‰å¯ä»¥è¯»å–æ•°æ®ï¼Œåˆ™å¯ä»¥é¿å…è¯¥é—®é¢˜ã€‚æŠŠæ•°æ®åº“çš„äº‹åŠ¡éš”ç¦»çº§åˆ«è°ƒæ•´åˆ°REPEATABLE_READ T2 è¯»å–ä¸€ä¸ªæ•°æ®ï¼ŒT1 å¯¹è¯¥æ•°æ®åšäº†ä¿®æ”¹ã€‚å¦‚æœ T2 å†æ¬¡è¯»å–è¿™ä¸ªæ•°æ®ï¼Œæ­¤æ—¶è¯»å–çš„ç»“æœå’Œç¬¬ä¸€æ¬¡è¯»å–çš„ç»“æœä¸åŒã€‚ 4ã€å¹»è¯»ä¸€ä¸ªäº‹åŠ¡T1æŒ‰ç›¸åŒçš„æŸ¥è¯¢æ¡ä»¶é‡æ–°è¯»å–ä»¥å‰æ£€ç´¢è¿‡çš„æ•°æ®ï¼Œå´å‘ç°å…¶ä»–äº‹åŠ¡T2æ’å…¥äº†æ»¡è¶³å…¶æŸ¥è¯¢æ¡ä»¶çš„æ–°æ•°æ®ï¼Œè¿™ç§ç°è±¡å°±ç§°ä¸ºâ€œå¹»è¯»â€ã€‚ï¼ˆå’Œå¯é‡å¤è¯»ç±»ä¼¼ï¼Œä½†æ˜¯äº‹åŠ¡ T2 çš„æ•°æ®æ“ä½œä»…ä»…æ˜¯æ’å…¥å’Œåˆ é™¤ï¼Œä¸æ˜¯ä¿®æ”¹æ•°æ®ï¼Œè¯»å–çš„è®°å½•æ•°é‡å‰åä¸ä¸€è‡´ï¼‰ ä¸€å¥è¯ï¼šäº‹åŠ¡A è¯»å–åˆ°äº†äº‹åŠ¡Bæäº¤çš„æ–°å¢æ•°æ®ï¼Œä¸ç¬¦åˆéš”ç¦»æ€§ã€‚ è§£å†³åŠæ³•: å¦‚æœåœ¨æ“ä½œäº‹åŠ¡å®Œæˆæ•°æ®å¤„ç†ä¹‹å‰ï¼Œä»»ä½•å…¶ä»–äº‹åŠ¡éƒ½ä¸å¯ä»¥æ·»åŠ æ–°æ•°æ®ï¼Œåˆ™å¯é¿å…è¯¥é—®é¢˜ã€‚æŠŠæ•°æ®åº“çš„äº‹åŠ¡éš”ç¦»çº§åˆ«è°ƒæ•´åˆ° SERIALIZABLE_READã€‚ T1 è¯»å–æŸä¸ªèŒƒå›´çš„æ•°æ®ï¼ŒT2 åœ¨è¿™ä¸ªèŒƒå›´å†…æ’å…¥æ–°çš„æ•°æ®ï¼ŒT1 å†æ¬¡è¯»å–è¿™ä¸ªèŒƒå›´çš„æ•°æ®ï¼Œæ­¤æ—¶è¯»å–çš„ç»“æœå’Œå’Œç¬¬ä¸€æ¬¡è¯»å–çš„ç»“æœä¸åŒã€‚ ä¸‰ã€äº‹åŠ¡éš”ç¦»çº§åˆ«â€œè„è¯»â€ã€â€ä¸å¯é‡å¤è¯»â€å’Œâ€å¹»è¯»â€ï¼Œå…¶å®éƒ½æ˜¯æ•°æ®åº“è¯»ä¸€è‡´æ€§é—®é¢˜ï¼Œå¿…é¡»ç”±æ•°æ®åº“æä¾›ä¸€å®šçš„äº‹åŠ¡éš”ç¦»æœºåˆ¶æ¥è§£å†³ã€‚ æ•°æ®åº“çš„äº‹åŠ¡éš”ç¦»è¶Šä¸¥æ ¼ï¼Œå¹¶å‘å‰¯ä½œç”¨è¶Šå°ï¼Œä½†ä»˜å‡ºçš„ä»£ä»·ä¹Ÿå°±è¶Šå¤§ï¼Œå› ä¸ºäº‹åŠ¡éš”ç¦»å®è´¨ä¸Šå°±æ˜¯ä½¿äº‹åŠ¡åœ¨ä¸€å®šç¨‹åº¦ä¸Š â€œä¸²è¡ŒåŒ–â€è¿›è¡Œï¼Œè¿™æ˜¾ç„¶ä¸â€œå¹¶å‘â€æ˜¯çŸ›ç›¾çš„ã€‚åŒæ—¶ï¼Œä¸åŒçš„åº”ç”¨å¯¹è¯»ä¸€è‡´æ€§å’Œäº‹åŠ¡éš”ç¦»ç¨‹åº¦çš„è¦æ±‚ä¹Ÿæ˜¯ä¸åŒçš„ï¼Œæ¯”å¦‚è®¸å¤šåº”ç”¨å¯¹â€œä¸å¯é‡å¤è¯»â€å’Œâ€œå¹»è¯»â€å¹¶ä¸æ•æ„Ÿï¼Œå¯èƒ½æ›´å…³å¿ƒæ•°æ®å¹¶å‘è®¿é—®çš„èƒ½åŠ›ã€‚ MYSQLå¸¸çœ‹å½“å‰æ•°æ®åº“çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼šshow variables like &#39;tx_isolation&#39;; 1ã€è¯»æœªæäº¤ (Read Uncommitted)æœ€ä½çš„éš”ç¦»ç­‰çº§ï¼Œå…è®¸å…¶ä»–äº‹åŠ¡çœ‹åˆ°æ²¡æœ‰æäº¤çš„æ•°æ®ï¼Œä¼šå¯¼è‡´è„è¯»ã€‚ 2ã€è¯»å·²æäº¤ (Read Committed)è¢«è¯»å–çš„æ•°æ®å¯ä»¥è¢«å…¶ä»–äº‹åŠ¡ä¿®æ”¹ï¼Œè¿™æ ·å¯èƒ½å¯¼è‡´ä¸å¯é‡å¤è¯»ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œäº‹åŠ¡è¯»å–çš„æ—¶å€™è·å–è¯»é”ï¼Œä½†æ˜¯åœ¨è¯»å®Œä¹‹åç«‹å³é‡Šæ”¾(ä¸éœ€è¦ç­‰äº‹åŠ¡ç»“æŸ)ï¼Œè€Œå†™é”åˆ™æ˜¯äº‹åŠ¡æäº¤ä¹‹åæ‰é‡Šæ”¾ï¼Œé‡Šæ”¾è¯»é”ä¹‹åï¼Œå°±å¯èƒ½è¢«å…¶ä»–äº‹åŠ¡ä¿®æ”¹æ•°æ®ã€‚è¯¥ç­‰çº§ä¹Ÿæ˜¯ SQL Server é»˜è®¤çš„éš”ç¦»ç­‰çº§ã€‚ 3ã€å¯é‡å¤è¯»(Repeatable Read)æ‰€æœ‰è¢« Select è·å–çš„æ•°æ®éƒ½ä¸èƒ½è¢«ä¿®æ”¹ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…ä¸€ä¸ªäº‹åŠ¡å‰åè¯»å–æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µã€‚ä½†æ˜¯å´æ²¡æœ‰åŠæ³•æ§åˆ¶å¹»è¯»ï¼Œå› ä¸ºè¿™ä¸ªæ—¶å€™å…¶ä»–äº‹åŠ¡ä¸èƒ½æ›´æ”¹æ‰€é€‰çš„æ•°æ®ï¼Œä½†æ˜¯å¯ä»¥å¢åŠ æ•°æ®ï¼Œå³å‰ä¸€ä¸ªäº‹åŠ¡æœ‰è¯»é”ä½†æ˜¯æ²¡æœ‰èŒƒå›´é”ï¼Œä¸ºä»€ä¹ˆå«åšå¯é‡å¤è¯»ç­‰çº§å‘¢ï¼Ÿé‚£æ˜¯å› ä¸ºè¯¥ç­‰çº§è§£å†³äº†ä¸‹é¢çš„ä¸å¯é‡å¤è¯»é—®é¢˜ã€‚(å¼•ç”³ï¼šç°åœ¨ä¸»æµæ•°æ®åº“éƒ½ä½¿ç”¨ MVCC å¹¶å‘æ§åˆ¶ï¼Œä½¿ç”¨ä¹‹åRRï¼ˆå¯é‡å¤è¯»ï¼‰éš”ç¦»çº§åˆ«ä¸‹æ˜¯ä¸ä¼šå‡ºç°å¹»è¯»çš„ç°è±¡ã€‚) MYSQLé»˜è®¤æ˜¯REPEATABLE-READã€‚ 4ã€ä¸²è¡ŒåŒ–(Serializable)æ‰€æœ‰äº‹åŠ¡ä¸€ä¸ªæ¥ç€ä¸€ä¸ªçš„æ‰§è¡Œï¼Œè¿™æ ·å¯ä»¥é¿å…å¹»è¯» (phantom read)ï¼Œå¯¹äºåŸºäºé”æ¥å®ç°å¹¶å‘æ§åˆ¶çš„æ•°æ®åº“æ¥è¯´ï¼Œä¸²è¡ŒåŒ–è¦æ±‚åœ¨æ‰§è¡ŒèŒƒå›´æŸ¥è¯¢çš„æ—¶å€™ï¼Œéœ€è¦è·å–èŒƒå›´é”ï¼Œå¦‚æœä¸æ˜¯åŸºäºé”å®ç°å¹¶å‘æ§åˆ¶çš„æ•°æ®åº“ï¼Œåˆ™æ£€æŸ¥åˆ°æœ‰è¿åä¸²è¡Œæ“ä½œçš„äº‹åŠ¡æ—¶ï¼Œéœ€å›æ»šè¯¥äº‹åŠ¡ã€‚ 5ã€æ€»ç»“ è¯»æœªæäº¤: ä¸€ä¸ªäº‹åŠ¡è¿˜æ²¡æäº¤æ—¶ï¼Œå®ƒåšçš„å˜æ›´å°±èƒ½è¢«åˆ«çš„äº‹åŠ¡çœ‹åˆ°ã€‚ è¯»æäº¤: ä¸€ä¸ªäº‹åŠ¡æäº¤ä¹‹åï¼Œå®ƒåšçš„å˜æ›´æ‰ä¼šè¢«å…¶ä»–äº‹åŠ¡çœ‹åˆ°ã€‚ å¯é‡å¤è¯» : ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­çœ‹åˆ°çš„æ•°æ®ï¼Œæ€»æ˜¯è·Ÿè¿™ä¸ªäº‹åŠ¡åœ¨å¯åŠ¨æ—¶çœ‹åˆ°çš„æ•°æ®æ˜¯ä¸€è‡´çš„ã€‚å½“ç„¶åœ¨å¯é‡å¤è¯»éš”ç¦»çº§åˆ«ä¸‹ï¼Œæœªæäº¤å˜æ›´å¯¹å…¶ä»–äº‹åŠ¡ä¹Ÿæ˜¯ä¸å¯è§çš„ã€‚ ä¸²è¡ŒåŒ–: é¡¾åæ€ä¹‰æ˜¯å¯¹äºåŒä¸€è¡Œè®°å½•ï¼Œâ€œå†™â€ä¼šåŠ â€œå†™é”â€ï¼Œâ€œè¯»â€ä¼šåŠ â€œè¯»é”â€ã€‚å½“å‡ºç°è¯»å†™é”å†²çªçš„æ—¶å€™ï¼Œåè®¿é—®çš„äº‹åŠ¡å¿…é¡»ç­‰å‰ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œå®Œæˆï¼Œæ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚ å››ä¸ªçº§åˆ«é€æ¸å¢å¼ºï¼Œæ¯ä¸ªçº§åˆ«è§£å†³ä¸€ä¸ªé—®é¢˜ï¼Œäº‹åŠ¡çº§åˆ«è¶Šé«˜ï¼Œæ€§èƒ½è¶Šå·®ï¼Œå¤§å¤šæ•°ç¯å¢ƒ(Read committed å°±å¯ä»¥ç”¨äº†) éš”ç¦»çº§åˆ« è¯»æ•°æ®ä¸€è‡´æ€§ è„è¯» ä¸å¯é‡å¤è¯» å¹»è¯» æœªæäº¤è¯» æœ€ä½çº§åˆ« âˆš âˆš âˆš æäº¤è¯» è¯­å¥çº§ Ã— âˆš âˆš å¯é‡å¤è¯» äº‹åŠ¡çº§ Ã— Ã— âˆš å¯ä¸²è¡ŒåŒ– æœ€é«˜çº§åˆ«,äº‹åŠ¡çº§ Ã— Ã— Ã— å‚è€ƒ","categories":[{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"https://shang.at/categories/æ•°æ®åº“/"}],"tags":[{"name":"mysqläº‹åŠ¡å’Œéš”ç¦»çº§åˆ«","slug":"mysqläº‹åŠ¡å’Œéš”ç¦»çº§åˆ«","permalink":"https://shang.at/tags/mysqläº‹åŠ¡å’Œéš”ç¦»çº§åˆ«/"}]},{"title":"Mysqlå­¦ä¹ -ç¬¬ä¸‰èŒƒå¼","slug":"Mysqlå­¦ä¹ -ç¬¬ä¸‰èŒƒå¼","date":"2020-05-12T17:19:15.000Z","updated":"2020-12-11T08:24:18.315Z","comments":true,"path":"post/Mysqlå­¦ä¹ -ç¬¬ä¸‰èŒƒå¼/","link":"","permalink":"https://shang.at/post/Mysqlå­¦ä¹ -ç¬¬ä¸‰èŒƒå¼/","excerpt":"","text":"ç¬¬ä¸€èŒƒå¼(1NF) æ•°æ®åº“è¡¨çš„æ¯ä¸€åˆ—éƒ½æ˜¯ä¸å¯åˆ†å‰²çš„åŸºæœ¬æ•°æ®é¡¹ï¼ŒåŒä¸€åˆ—ä¸­ä¸èƒ½æœ‰å¤šä¸ªå€¼ï¼Œå³å®ä½“ä¸­çš„æŸä¸ªå±æ€§ä¸èƒ½æœ‰å¤šä¸ªå€¼æˆ–è€…ä¸èƒ½æœ‰é‡å¤çš„å±æ€§ ç¬¦åˆ1NFçš„å…³ç³»ä¸­çš„æ¯ä¸ªå±æ€§éƒ½ä¸å¯å†åˆ† æœ‰ä¸¤ç‚¹è¦æ±‚ï¼š schemaå®šä¹‰ï¼šæ¯ä¸ªå±æ€§ä¸å¯å†åˆ†ï¼Œå³å­—æ®µçš„å«ä¹‰è¦æ˜ç¡®ï¼ŒåŒä¸€ä¸ªå­—æ®µä¸åº”è¯¥æœ‰å¤šäº1ä¸ªçš„å«ä¹‰ å›¾ä¸­çš„è¿™ç§schemaåœ¨RDBMSä¸­æ˜¯ä¸å¯èƒ½å­˜åœ¨çš„ï¼Œä¹Ÿå°±æ˜¯æ— æ³•åˆ›å»ºçš„ã€‚å¯ä»¥æ”¹æˆå¦‚ä¸‹çš„schema: å­˜å‚¨çš„æ•°æ®ï¼šåŒä¸€åˆ—ä¸­ä¸èƒ½æœ‰å¤šä¸ªå€¼ å›¾ä¸­çš„ä¸€ä¸ªå­—æ®µé‡Œé¢å­˜äº†å¤šä¸ªå€¼ï¼Œè¿™ç§æƒ…å†µåœ¨RDBMSä¸­æ˜¯å¯ä»¥å­˜åœ¨çš„ï¼Œä½†æ˜¯è¯¥å­—æ®µæ˜¯å¯å†åˆ†çš„ï¼Œåº”è¯¥ã€‚å¯ä»¥å°†æ•°æ®åˆ†æˆå¤šæ¡å­˜å‚¨ï¼Œå¦‚ä¸‹å›¾ ç¬¬äºŒèŒƒå¼(2NF) æ»¡è¶³ç¬¬ä¸€èŒƒå¼ æ²¡æœ‰éƒ¨åˆ†ä¾èµ– åœ¨åŒä¸€ä¸ªè¡¨ä¸­ï¼Œä¸èƒ½å­˜åœ¨æŸäº›å­—æ®µä¾èµ–ä¸€äº›é”®ï¼Œè€Œå¦ä¸€äº›å­—æ®µä¾èµ–å¦å¤–ä¸€äº›é”® å‘˜å·¥è¡¨çš„ä¸€ä¸ªå€™é€‰é”®æ˜¯{idï¼Œmobileï¼ŒdeptNo}ï¼Œè€ŒdeptNameä¾èµ–äºdeptNoï¼ŒåŒæ · name ä¾èµ–äº idï¼Œå› æ­¤ä¸æ˜¯ 2NFçš„ã€‚ä¸ºäº†æ»¡è¶³ç¬¬äºŒèŒƒå¼çš„æ¡ä»¶ï¼Œéœ€è¦å°†è¿™ä¸ªè¡¨æ‹†åˆ†æˆemployeeã€deptã€employee_deptã€employee_mobileå››ä¸ªè¡¨ ä¸æ»¡è¶³2NFçš„è¡¨ï¼Œå¯èƒ½å­˜åœ¨çš„é—®é¢˜ï¼šä¿®æ”¹å¼‚å¸¸ã€æ–°å¢å¼‚å¸¸ã€åˆ é™¤å¼‚å¸¸ ç¬¬ä¸‰èŒƒå¼(3NF) æ»¡è¶³ç¬¬äºŒèŒƒå¼ æ²¡æœ‰ä¼ é€’ä¾èµ– åœ¨åŒä¸€ä¸ªè¡¨ä¸­ï¼Œä¸è¦å­˜åœ¨å­—æ®µAä¾èµ–å­—æ®µBï¼ŒåŒæ—¶å­—æ®µBä¾èµ–å­—æ®µCï¼Œæ¨å¯¼å‡ºæ¥å­—æ®µAé—´æ¥ä¾èµ–å­—æ®µCçš„å…³ç³»ã€‚ å‘˜å·¥è¡¨çš„provinceã€cityã€districtä¾èµ–äºzipï¼Œè€Œzipä¾èµ–äºidï¼Œæ¢å¥è¯è¯´ï¼Œprovinceã€cityã€districtä¼ é€’ä¾èµ–äºidï¼Œè¿åäº† 3NF è§„åˆ™ã€‚ä¸ºäº†æ»¡è¶³ç¬¬ä¸‰èŒƒå¼çš„æ¡ä»¶ï¼Œå¯ä»¥å°†è¿™ä¸ªè¡¨æ‹†åˆ†æˆemployeeå’Œzipä¸¤ä¸ªè¡¨ ä½†æ˜¯è¿™ç§å…³ç³»ä¹Ÿä¸æ˜¯ä¸€å®šä¸èƒ½å­˜åœ¨ï¼Œè§†å…·ä½“çš„ä¸šåŠ¡è€Œå®šå§ ç¤ºä¾‹å‡è®¾æœ‰ä¸€ä¸ªåä¸ºemployeeçš„å‘˜å·¥è¡¨ï¼Œå®ƒæœ‰ä¹ä¸ªå±æ€§ï¼šid(å‘˜å·¥ç¼–å·)ã€name(å‘˜å·¥åç§°)ã€mobile(ç”µè¯)ã€zip(é‚®ç¼–)ã€province(çœä»½)ã€city(åŸå¸‚)ã€district(åŒºå¿)ã€deptNo(æ‰€å±éƒ¨é—¨ç¼–å·)ã€deptName(æ‰€å±éƒ¨é—¨åç§°)ã€è¡¨æ€»æ•°æ®å¦‚ä¸‹ï¼š id name mobile zip province city district deptNo deptName 101 å¼ ä¸‰ 1391000000113910000002 100001 åŒ—äº¬ åŒ—äº¬ æµ·æ·€åŒº D1 éƒ¨é—¨1 101 å¼ ä¸‰ 1391000000113910000002 100001 åŒ—äº¬ åŒ—äº¬ æµ·æ·€åŒº D2 éƒ¨é—¨2 102 æå›› 13910000003 200001 ä¸Šæµ· ä¸Šæµ· é™å®‰åŒº D3 éƒ¨é—¨3 103 ç‹äº” 13910000004 510001 å¹¿ä¸œçœ å¹¿å· ç™½äº‘åŒº D4 éƒ¨é—¨4 103 ç‹äº” 13910000004 510001 å¹¿ä¸œçœ å¹¿å· ç™½äº‘åŒº D5 éƒ¨é—¨ 5 å°†ä¸Šè¡¨æ”¹æˆæ»¡è¶³ç¬¬1èŒƒå¼ï¼Œå¦‚ä¸‹ï¼š id name mobile zip province city district deptNo deptName 101 å¼ ä¸‰ 13910000001 100001 åŒ—äº¬ åŒ—äº¬ æµ·æ·€åŒº D1 éƒ¨é—¨1 101 å¼ ä¸‰ 13910000002 100001 åŒ—äº¬ åŒ—äº¬ æµ·æ·€åŒº D1 éƒ¨é—¨1 101 å¼ ä¸‰ 13910000001 100001 åŒ—äº¬ åŒ—äº¬ æµ·æ·€åŒº D2 éƒ¨é—¨2 101 å¼ ä¸‰ 13910000002 100001 åŒ—äº¬ åŒ—äº¬ æµ·æ·€åŒº D2 éƒ¨é—¨2 102 æå›› 13910000003 200001 ä¸Šæµ· ä¸Šæµ· é™å®‰åŒº D3 éƒ¨é—¨3 103 ç‹äº” 13910000004 510001 å¹¿ä¸œçœ å¹¿å· ç™½äº‘åŒº D4 éƒ¨é—¨4 103 ç‹äº” 13910000004 510001 å¹¿ä¸œçœ å¹¿å· ç™½äº‘åŒº D5 éƒ¨é—¨5 ä»å­˜åœ¨çš„é—®é¢˜ ä¿®æ”¹å¼‚å¸¸ï¼šä¸Šè¡¨ä¸­å¼ ä¸‰ã€ç‹äº”éƒ½æœ‰å¤šæ¡è®°å½•ï¼Œå› ä¸ºä»–éš¶å±äºä¸¤ä¸ªéƒ¨é—¨ã€‚å¦‚æœæˆ‘ä»¬è¦ä¿®æ”¹ç‹äº”çš„åœ°å€ï¼Œå¿…ä¿®ä¿®æ”¹ä¸¤è¡Œè®°å½•ã€‚å‡å¦‚ä¸€ä¸ªéƒ¨é—¨å¾—åˆ°äº†ç‹äº”çš„æ–°åœ°å€å¹¶è¿›è¡Œäº†æ›´æ–°ï¼Œè€Œå¦ä¸€ä¸ªéƒ¨é—¨æ²¡æœ‰ï¼Œé‚£ä¹ˆæ­¤æ—¶ç‹äº”åœ¨è¡¨ä¸­ä¼šå­˜åœ¨ä¸¤ä¸ªä¸åŒçš„åœ°å€ï¼Œå¯¼è‡´äº†æ•°æ®ä¸ä¸€è‡´ æ–°å¢å¼‚å¸¸ï¼šå‡å¦‚ä¸€ä¸ªæ–°å‘˜å·¥å‡å¦‚å…¬å¸ï¼Œä»–æ­£å¤„äºå…¥èŒåŸ¹è®­é˜¶æ®µï¼Œè¿˜æ²¡æœ‰è¢«æ­£å¼åˆ†é…åˆ°æŸä¸ªéƒ¨é—¨ï¼Œå¦‚æœdeptNoå­—æ®µä¸å…è®¸ä¸ºç©ºï¼Œæˆ‘ä»¬å°±æ— æ³•å‘employeeè¡¨ä¸­æ–°å¢è¯¥å‘˜å·¥çš„æ•°æ®ã€‚ åˆ é™¤å¼‚å¸¸ï¼šå‡è®¾å…¬å¸æ’¤é”€äº†D3éƒ¨é—¨ï¼Œé‚£ä¹ˆåœ¨åˆ é™¤deptNoä¸ºD3çš„è¡Œæ—¶ï¼Œä¼šå°†æå››çš„ä¿¡æ¯ä¹Ÿä¸€å¹¶åˆ é™¤ã€‚å› ä¸ºä»–éš¶å±äºD3è¿™ä¸€éƒ¨é—¨ã€‚ ä¸ºäº†è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸Šè¿°è¡¨è®¾è®¡æˆæ»¡è¶³3NF åœ¨å…³ç³»æ•°æ®åº“æ¨¡å‹è®¾è®¡ä¸­ï¼Œä¸€èˆ¬éœ€è¦æ»¡è¶³ç¬¬ä¸‰èŒƒå¼çš„è¦æ±‚ã€‚å¦‚æœä¸€ä¸ªè¡¨å…·æœ‰è‰¯å¥½çš„ä¸»å¤–é”®è®¾è®¡ï¼Œå°±åº”è¯¥æ˜¯æ»¡è¶³3NFçš„è¡¨ã€‚è§„èŒƒåŒ–å¸¦æ¥çš„å¥½å¤„æ˜¯é€šè¿‡å‡å°‘æ•°æ®å†—ä½™æé«˜æ›´æ–°æ•°æ®çš„æ•ˆç‡ï¼ŒåŒæ—¶ä¿è¯æ•°æ®å®Œæ•´æ€§ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬åœ¨å®é™…åº”ç”¨ä¸­ä¹Ÿè¦é˜²æ­¢è¿‡åº¦è§„èŒƒåŒ–çš„é—®é¢˜ã€‚è§„èŒƒåŒ–ç¨‹åº¦è¶Šé«˜ï¼Œåˆ’åˆ†çš„è¡¨å°±è¶Šå¤šï¼Œåœ¨æŸ¥è¯¢æ•°æ®æ—¶è¶Šæœ‰å¯èƒ½ä½¿ç”¨è¡¨è¿æ¥æ“ä½œã€‚è€Œå¦‚æœè¿æ¥çš„è¡¨è¿‡å¤šï¼Œä¼šå½±å“æŸ¥è¯¢æ€§èƒ½ã€‚å…³é”®çš„é—®é¢˜æ˜¯è¦ä¾æ®ä¸šåŠ¡éœ€æ±‚ï¼Œä»”ç»†æƒè¡¡æ•°æ®æŸ¥è¯¢å’Œæ•°æ®æ›´æ–°å…³ç³»ï¼ŒæŒ‡å®šæœ€åˆé€‚çš„è§„èŒƒåŒ–ç¨‹åº¦ã€‚ä¸è¦ä¸ºäº†éµå¾ªä¸¥æ ¼çš„è§„èŒƒåŒ–è§„åˆ™è€Œä¿®æ”¹ä¸šåŠ¡éœ€æ±‚ã€‚ å‚è€ƒ","categories":[{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"https://shang.at/categories/æ•°æ®åº“/"}],"tags":[{"name":"mysqlç¬¬ä¸‰èŒƒå¼","slug":"mysqlç¬¬ä¸‰èŒƒå¼","permalink":"https://shang.at/tags/mysqlç¬¬ä¸‰èŒƒå¼/"}]},{"title":"Pythonå­¦ä¹ -å‡½æ•°å‚æ•°ä¼ é€’","slug":"Pythonå­¦ä¹ -å‡½æ•°å‚æ•°ä¼ é€’","date":"2020-04-19T04:00:49.000Z","updated":"2020-04-19T04:26:43.749Z","comments":true,"path":"post/Pythonå­¦ä¹ -å‡½æ•°å‚æ•°ä¼ é€’/","link":"","permalink":"https://shang.at/post/Pythonå­¦ä¹ -å‡½æ•°å‚æ•°ä¼ é€’/","excerpt":"","text":"åœ¨Python(ä¼°è®¡ä¹Ÿé€‚ç”¨äºå…¶ä»–çš„è¯­è¨€)ä¸­ï¼Œå‡½æ•°å‚æ•°çš„ä¼ é€’åˆ†ä¸ºä¸¤ç±» å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’ï¼Œå®é™…ä¸Šè¿™ä¸¤ç±»ä¼ é€’ç±»å‹éƒ½æ˜¯å±äºå˜é‡ä¼ å€¼ï¼Œå³ï¼š å€¼ä¼ é€’ï¼šå°†å®é™…å‚æ•°å€¼å¤åˆ¶ä¸€ä»½ä¼ é€’åˆ°å‡½æ•°å†…ï¼Œè¿™æ ·åœ¨å‡½æ•°å†…å¯¹å‚æ•°è¿›è¡Œä¿®æ”¹ï¼Œå°±ä¸ä¼šå½±å“åˆ°åŸå‚æ•° å¼•ç”¨ä¼ é€’ï¼šå°†å®é™…å‚æ•°çš„åœ°å€ç›´æ¥ä¼ é€’åˆ°å‡½æ•°å†…ï¼Œé‚£ä¹ˆåœ¨å‡½æ•°å†…å¯¹å‚æ•°æ‰€è¿›è¡Œçš„ä¿®æ”¹ï¼Œå°†å¯èƒ½ä¼šå½±å“åˆ°åŸå‚æ•° è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨å‡½æ•°å†…ä¿®æ”¹å‚æ•°ï¼Œå®é™…ä¸Šåˆåˆ†ä¸ºä¸¤ç§æƒ…å†µ(ä»…è¯´å¼•ç”¨ä¼ é€’)ï¼š 1ã€å¯¹å‚æ•°(a)é‡æ–°è¿›è¡Œèµ‹å€¼æ“ä½œ(a=new_obj)ï¼Œæ­¤æ—¶ï¼Œå®é™…ä¸Šä¿®æ”¹çš„å·²ç»ä¸æ˜¯ä¼ é€’ç»™å‡½æ•°çš„æœ€åˆçš„å‚æ•°(a)äº†ï¼Œå®ƒå·²ç»æŒ‡å‘äº†å…¶ä»–çš„å†…å­˜åœ°å€ï¼Œè¿™æ—¶å†ä¿®æ”¹aï¼Œå®é™…ä¸Šå°±å’Œä¹‹å‰çš„å¯¹è±¡æ²¡æœ‰ä»»ä½•å…³ç³»äº† 2ã€ç›´æ¥å¯¹aè¿›è¡Œä¿®æ”¹ï¼Œæ¯”å¦‚è¯´a.name=â€™sddâ€™ï¼Œè¿™æ—¶ï¼ŒåŸå§‹çš„å¯¹è±¡å°±ä¼šå‘ç”Ÿå˜åŒ–","categories":[{"name":"Python","slug":"Python","permalink":"https://shang.at/categories/Python/"}],"tags":[{"name":"pythonå­¦ä¹ ","slug":"pythonå­¦ä¹ ","permalink":"https://shang.at/tags/pythonå­¦ä¹ /"}]},{"title":"Pythonå­¦ä¹ -OrderedDict","slug":"Pythonå­¦ä¹ -OrderedDict","date":"2020-04-16T08:50:57.000Z","updated":"2020-07-01T09:20:30.458Z","comments":true,"path":"post/Pythonå­¦ä¹ -OrderedDict/","link":"","permalink":"https://shang.at/post/Pythonå­¦ä¹ -OrderedDict/","excerpt":"","text":"12from collections import OrderedDict # è®°å½•æ’å…¥é¡ºåºçš„dictï¼Œæ“ä½œæ–¹å¼å’Œdictä¸€æ ·ã€‚# æ˜¯åŸºäºdictå’ŒåŒç«¯é˜Ÿåˆ—å®ç°ï¼Œå¯ä»¥ç”¨æ¥å®ç°LRUcache","categories":[{"name":"Python","slug":"Python","permalink":"https://shang.at/categories/Python/"}],"tags":[{"name":"OrderedDict","slug":"OrderedDict","permalink":"https://shang.at/tags/OrderedDict/"}]},{"title":"Pythonå­¦ä¹ -bisect","slug":"Pythonå­¦ä¹ -bisect","date":"2020-04-16T08:47:50.000Z","updated":"2020-07-01T09:20:11.928Z","comments":true,"path":"post/Pythonå­¦ä¹ -bisect/","link":"","permalink":"https://shang.at/post/Pythonå­¦ä¹ -bisect/","excerpt":"","text":"è¿™ä¸ªæ¨¡å—å¯¹æœ‰åºåˆ—è¡¨æä¾›äº†æ”¯æŒï¼Œä½¿å¾—ä»–ä»¬å¯ä»¥åœ¨æ’å…¥æ–°æ•°æ®ä»ç„¶ä¿æŒæœ‰åºã€‚å¯¹äºé•¿åˆ—è¡¨ï¼Œå¦‚æœå…¶åŒ…å«å…ƒç´ çš„æ¯”è¾ƒæ“ä½œååˆ†æ˜‚è´µçš„è¯ï¼Œè¿™å¯ä»¥æ˜¯å¯¹æ›´å¸¸è§æ–¹æ³•çš„æ”¹è¿› 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192\"\"\"Bisection algorithms.\"\"\"def insort_right(a, x, lo=0, hi=None): \"\"\"Insert item x in list a, and keep it sorted assuming a is sorted. If x is already in a, insert it to the right of the rightmost x. Optional args lo (default 0) and hi (default len(a)) bound the slice of a to be searched. \"\"\" if lo &lt; 0: raise ValueError('lo must be non-negative') if hi is None: hi = len(a) while lo &lt; hi: mid = (lo+hi)//2 if x &lt; a[mid]: hi = mid else: lo = mid+1 a.insert(lo, x)insort = insort_right # backward compatibilitydef bisect_right(a, x, lo=0, hi=None): \"\"\"Return the index where to insert item x in list a, assuming a is sorted. The return value i is such that all e in a[:i] have e &lt;= x, and all e in a[i:] have e &gt; x. So if x already appears in the list, a.insert(x) will insert just after the rightmost x already there. Optional args lo (default 0) and hi (default len(a)) bound the slice of a to be searched. \"\"\" if lo &lt; 0: raise ValueError('lo must be non-negative') if hi is None: hi = len(a) while lo &lt; hi: mid = (lo+hi)//2 if x &lt; a[mid]: hi = mid else: lo = mid+1 return lobisect = bisect_right # backward compatibilitydef insort_left(a, x, lo=0, hi=None): \"\"\"Insert item x in list a, and keep it sorted assuming a is sorted. If x is already in a, insert it to the left of the leftmost x. Optional args lo (default 0) and hi (default len(a)) bound the slice of a to be searched. \"\"\" if lo &lt; 0: raise ValueError('lo must be non-negative') if hi is None: hi = len(a) while lo &lt; hi: mid = (lo+hi)//2 if a[mid] &lt; x: lo = mid+1 else: hi = mid a.insert(lo, x)def bisect_left(a, x, lo=0, hi=None): \"\"\"Return the index where to insert item x in list a, assuming a is sorted. The return value i is such that all e in a[:i] have e &lt; x, and all e in a[i:] have e &gt;= x. So if x already appears in the list, a.insert(x) will insert just before the leftmost x already there. Optional args lo (default 0) and hi (default len(a)) bound the slice of a to be searched. \"\"\" if lo &lt; 0: raise ValueError('lo must be non-negative') if hi is None: hi = len(a) while lo &lt; hi: mid = (lo+hi)//2 if a[mid] &lt; x: lo = mid+1 else: hi = mid return lo# Overwrite above definitions with a fast C implementationtry: from _bisect import *except ImportError: pass","categories":[{"name":"Python","slug":"Python","permalink":"https://shang.at/categories/Python/"}],"tags":[{"name":"bisect","slug":"bisect","permalink":"https://shang.at/tags/bisect/"}]},{"title":"æ•°æ®ç»“æ„ä¸ç®—æ³•å­¦ä¹ ç¬”è®°-æŸ¥æ‰¾ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•å­¦ä¹ ç¬”è®°-æŸ¥æ‰¾ç®—æ³•","date":"2020-04-10T00:58:45.000Z","updated":"2020-04-10T01:00:39.177Z","comments":true,"path":"post/æ•°æ®ç»“æ„ä¸ç®—æ³•å­¦ä¹ ç¬”è®°-æŸ¥æ‰¾ç®—æ³•/","link":"","permalink":"https://shang.at/post/æ•°æ®ç»“æ„ä¸ç®—æ³•å­¦ä¹ ç¬”è®°-æŸ¥æ‰¾ç®—æ³•/","excerpt":"","text":"æ€»ç»“ æŸ¥æ‰¾ç®—æ³• æ—¶é—´å¤æ‚åº¦ äºŒåˆ†æŸ¥æ‰¾ O(logn) O(logn)","categories":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://shang.at/categories/æ•°æ®ç»“æ„ä¸ç®—æ³•/"}],"tags":[{"name":"æŸ¥æ‰¾ç®—æ³•","slug":"æŸ¥æ‰¾ç®—æ³•","permalink":"https://shang.at/tags/æŸ¥æ‰¾ç®—æ³•/"}]},{"title":"Sparkåº”ç”¨ä¹‹import spark.implicits._","slug":"Sparkåº”ç”¨ä¹‹import-spark-implicits","date":"2020-03-25T09:10:54.000Z","updated":"2021-04-11T04:27:58.654Z","comments":true,"path":"post/Sparkåº”ç”¨ä¹‹import-spark-implicits/","link":"","permalink":"https://shang.at/post/Sparkåº”ç”¨ä¹‹import-spark-implicits/","excerpt":"ç®€ä»‹ï¼šSparkä¸­éšå¼è½¬æ¢çš„è§£é‡Š","text":"ç®€ä»‹ï¼šSparkä¸­éšå¼è½¬æ¢çš„è§£é‡Š åœ¨åˆæœŸä½¿ç”¨sparkçš„æ—¶å€™ï¼Œå¤§å®¶éƒ½ä¼šé‡è§ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„å†™æ³•import spark.implicits._ è¿™é‡Œé¢åŒ…å«äº†å››ä¸ªå…³é”®å­—ï¼šimportã€sparkã€implicitsã€_ importå’Œ_å®é™…ä¸Šæ˜¯Scalaä¸­åŒ…å¼•å…¥çš„å†™æ³•ï¼Œè¡¨ç¤ºå¼•å…¥æŒ‡å®šåŒ…å†…çš„æ‰€æœ‰æˆå‘˜ æœ¬æ–‡ä¸»è¦æƒ³è®°å½•ä¸€ä¸‹å¦å¤–ä¸¤ä¸ªå…³é”®å­—ï¼šsparkã€implicits å…³é”®å­—ä¸€ï¼šsparksparkåœ¨è¿™é‡Œæ˜¯è¿™æ ·äº§ç”Ÿçš„ï¼š 12345val conf: SparkConf = new SparkConf().setMaster(\"local\").setAppName(\"test\")val spark: SparkSession = SparkSession .builder() .config(conf) .getOrCreate() é‚£ä¹ˆè¿™å°±ä¼šæœ‰ç‚¹è®©äººå¥‡æ€ªçš„åœ°æ–¹äº†ï¼Œåœ¨scalaä¸­importåˆ°åº•æ˜¯å¦‚ä½•å·¥ä½œçš„å‘¢ï¼Ÿä¸ºä»€ä¹ˆå¯ä»¥importä¸€ä¸ªå®ä¾‹å¯¹è±¡å‘¢ï¼Ÿ ç»è¿‡æŸ¥è¯¢å‘ç°ï¼Œscalaç¡®å®èƒ½å¤Ÿå¯¼å…¥è¿è¡Œæ—¶å¯¹è±¡å®ä¾‹çš„æˆå‘˜ï¼Œä¸¾ä¾‹å¦‚ä¸‹ï¼š 1234567891011121314151617181920scala&gt; case class User(name:String, age:Int)defined class Userscala&gt; val a=User(\"zzz\",39)a: User = User(zzz,39)scala&gt; println(\"%s's age is %d\" format (a.name, a.age))zzz's age is 39scala&gt; import a._import a._scala&gt; println(\"%s's age is %d\" format (name, age))zzz's age is 39scala&gt; nameres3: String = zzzscala&gt; ageres4: Int = 39 å®šä¹‰äº†ä¸€ä¸ªcase class Userï¼Œç„¶åæ‰§è¡Œäº†ä¸€æ¬¡import a._ï¼Œç„¶åå‘ç°å¯ä»¥ç›´æ¥ä½¿ç”¨aå®ä¾‹å¯¹è±¡çš„å±æ€§å˜é‡ï¼Œè€Œä¸éœ€è¦åŠ a.çš„å‰ç¼€ã€‚ é‚£ä¹ˆä¸ºä»€ä¹ˆåœ¨sparkä¸­éœ€è¦è¿™ä¹ˆåšå‘¢ï¼Ÿæˆ‘ä»¬ç‚¹è¿›å»spark.implicitsï¼Œä¼šå‘ç°æºç æ˜¯è¿™æ ·çš„ï¼š 12345class SparkSession &#123; object implicits extends SQLImplicits with Serializable &#123; protected override def _sqlContext: SQLContext = SparkSession.this.sqlContext &#125;&#125; implicitsæ˜¯SparkSessionçš„ä¸€ä¸ªå†…éƒ¨å•ä¾‹å¯¹è±¡ï¼Œå®ƒæœ‰ä¸€ä¸ª_sqlContextçš„å‡½æ•°ï¼Œç”¨äºè·å–SQLContextï¼Œä½†æ˜¯å®ƒå¿…é¡»è°ƒç”¨å½“å‰æ­£åœ¨è¿è¡Œçš„SparkSessionå®ä¾‹ï¼Œé€šè¿‡è°ƒç”¨å®ƒçš„sqlContextå±æ€§æ¥è·å–ã€‚æºç ä¸­çš„SparkSession.thiså®é™…ä¸Šæ˜¯è°ƒç”¨äº†SparkSession classçš„ä¼´ç”Ÿå¯¹è±¡çš„.thisï¼Œè¿™ä¸ªthiså®é™…ä¸Šå°±æ˜¯æ­£åœ¨è¿è¡Œçš„SparkSessionå®ä¾‹ã€‚ å…·ä½“çš„éšå¼è½¬æ¢éƒ½å¯ä»¥åœ¨org.apache.spark.sql.SQLImplicitsä¸­çœ‹åˆ° è¿™é‡Œå®é™…ä¸Šæ˜¯scalaä¸­classä¸ä¼´ç”Ÿå¯¹è±¡çš„çˆ±æ¨çº ç¼ ä»¥åŠimportå…³é”®å­—çš„ä½¿ç”¨æŠ€å·§ ä¸‹é¢ç»™å‡ºä¸€ä¸ªæµ‹è¯•æ¡ˆä¾‹ï¼š 1234567891011121314151617181920212223// TestObject.scalaclass TestObject(name: String, age: Int) &#123; val user: User = new User(name, age) object innerObj &#123; val user1: User = TestObject.this.user def say(name: String) &#123; println(s\"$&#123;name&#125; innerObj say TestObject.this = $&#123;TestObject.this&#125;\") &#125; &#125; def say2(): Unit = &#123; println(s\"TestObject say2 TestObject.this = $&#123;TestObject.this&#125;\") &#125;&#125;object TestObject &#123;&#125; 1234567// User.scalaclass User(name: String, age: Int) &#123; def say(): Unit = &#123; println(\"%s's age is %d\" format(name, age)) &#125;&#125; 123456789101112131415161718192021222324252627// Test.scalaobject Test &#123; def main(args: Array[String]): Unit = &#123; val testObject = new TestObject(\"sfa\", 12) println(s\"testObject = $testObject\") // a testObject.say2() // b println(s\"testObject.user = $&#123;testObject.user&#125;\") // c import testObject.innerObj._ println(s\"user1 = $user1\") // d say(\"testObject\") // e println(\"------------------------------\")// val testObject1 = new TestObject(\"abc\", 24)// println(s\"testObject1 = $testObject1\")// testObject1.say2()// println(s\"testObject1.user = $&#123;testObject1.user&#125;\")// import testObject1.innerObj._//// println(s\"testObject1 user1 = $user1\")// say(\"testObject1\") &#125;&#125; æ‰“å°ç»“æœå¦‚ä¸‹ï¼š 123456testObject = com.msb.bigdata.scala.test_object.TestObject@5702b3b1TestObject say2 TestObject.this = com.msb.bigdata.scala.test_object.TestObject@5702b3b1testObject.user = com.msb.bigdata.scala.test_object.User@192b07fduser1 = com.msb.bigdata.scala.test_object.User@192b07fdtestObject innerObj say TestObject.this = com.msb.bigdata.scala.test_object.TestObject@5702b3b1------------------------------ é€šè¿‡æ‰“å°ç»“æœå¯ä»¥çœ‹åˆ°ï¼š aã€bã€eä¸‰å¤„æ‰“å°çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡å®ä¾‹ï¼Œæ‰€ä»¥å¯ä»¥æ–­å®šåœ¨class TestObjectçš„å†…éƒ¨ä¸­å¦‚æœè°ƒç”¨äº†TestObject.thiså®é™…ä¸Šæ˜¯æŒ‡å‘çš„æ­£åœ¨è¿è¡Œä¸­çš„testObjectå¯¹è±¡ TestObject.thisåªèƒ½åœ¨class TestObjectçš„å†…éƒ¨è°ƒç”¨ï¼Œä¸èƒ½åœ¨å¤–éƒ¨è°ƒç”¨ Test.scalaä¸­æ³¨æ‰çš„é‚£ä¸€éƒ¨åˆ†ï¼Œè¿™ä¸€å¥import testObject1.innerObj._ä¼šåœ¨ç¼–è¯‘æœŸé—´æŠ¥é”™ï¼Œå¦‚ä¸‹ 1234567891011Error:(29, 36) reference to user1 is ambiguous;it is imported twice in the same scope byimport testObject1.innerObj._and import testObject.innerObj._ println(s&quot;testObject1 user1 Error:(30, 5) reference to say is ambiguous;it is imported twice in the same scope byimport testObject1.innerObj._and import testObject.innerObj._ say(&quot;testObject1&quot;)= $user1&quot;) import å®ä¾‹å¯¹è±¡çš„è¡Œä¸ºä¸èƒ½è¢«å¤šæ¬¡ä½¿ç”¨ï¼Œè¯´çš„æ˜¯user1å˜é‡å’Œsayå‡½æ•°è¢«é‡å¤importåœ¨åŒä¸€ä¸ªä½œç”¨åŸŸå†…ï¼Œå¼•å‘äº†æ­§ä¹‰ åœ¨sparké‚£é‡Œï¼Œä¸å…è®¸ä»¥ä¸‹çš„å†™æ³•ï¼š 1234567891011121314151617181920212223242526272829303132333435object lesson02_sql_api01_1 &#123; def main(args: Array[String]): Unit = &#123; val conf: SparkConf = new SparkConf().setMaster(\"local\").setAppName(\"test\") val session: SparkSession = SparkSession .builder() .config(conf) .getOrCreate() import session.implicits._ println(session) val session1: SparkSession = SparkSession .builder() .config(conf) .getOrCreate() println(session1) import session1.implicits._ val dataDF: DataFrame = List( \"hello world\", \"hello world\", \"hello msb\", \"hello world\", \"hello world\", \"hello spark\", \"hello world\", \"hello spark\" ).toDF(\"line\") dataDF.show() &#125;&#125;// import session.implicits._ å’Œ import session1.implicits._å¯ä»¥åŒæ—¶å‡ºç°ï¼Œä½†æ˜¯å¦‚æœç”¨åˆ°äº†å…¶ä¸­çš„éšå¼è½¬æ¢ï¼Œå°±ä¼šæŠ¥é”™ï¼Œä¸€èˆ¬ä¹Ÿæ²¡äººä¼šè¿™ä¹ˆå†™ å°†Test.scalaæ›¿æ¢æˆå¦‚ä¸‹çš„å†™æ³•ï¼š 1234567891011121314151617181920212223242526272829object Test &#123; def main(args: Array[String]): Unit = &#123; val testObject = new TestObject(\"sfa\", 12) println(s\"testObject = $testObject\") // a testObject.say2() // b println(s\"testObject.user = $&#123;testObject.user&#125;\") // c import testObject.innerObj._ println(s\"user1 = $user1\") // d say(\"testObject\") // e println(\"------------------------------\") val testObject1 = new TestObject(\"abc\", 24) println(s\"testObject1 = $testObject1\") testObject1.say2() println(s\"testObject1.user = $&#123;testObject1.user&#125;\")// import testObject1.innerObj._//// println(s\"testObject1 user1 = $user1\")// say(\"testObject1\") println(s\"testObject.innerObj.user1 = $&#123;testObject.innerObj.user1&#125;\") println(s\"testObject.innerObj.say = $&#123;testObject.innerObj.say(\"testObject1\")&#125;\") &#125;&#125; æ‰“å°ç»“æœå¦‚ä¸‹ï¼š 123456789101112testObject = com.msb.bigdata.scala.test_object.TestObject@5702b3b1TestObject say2 TestObject.this = com.msb.bigdata.scala.test_object.TestObject@5702b3b1testObject.user = com.msb.bigdata.scala.test_object.User@192b07fduser1 = com.msb.bigdata.scala.test_object.User@192b07fdtestObject innerObj say TestObject.this = com.msb.bigdata.scala.test_object.TestObject@5702b3b1------------------------------testObject1 = com.msb.bigdata.scala.test_object.TestObject@64bfbc86TestObject say2 TestObject.this = com.msb.bigdata.scala.test_object.TestObject@64bfbc86testObject1.user = com.msb.bigdata.scala.test_object.User@64bf3bbftestObject1.innerObj.user1 = com.msb.bigdata.scala.test_object.User@64bf3bbftestObject1 innerObj say TestObject.this = com.msb.bigdata.scala.test_object.TestObject@64bfbc86testObject1.innerObj.say = () æˆ‘ä»¬ä¼šå‘ç°ï¼Œå°±æ²¡é—®é¢˜äº†ã€‚è€Œä¸”testObject1çš„InnerObjectè°ƒç”¨çš„TestObject.thiså®é™…ä¸Šæ˜¯æŒ‡å‘çš„testObject1å¯¹è±¡ã€‚ å…³é”®å­—äºŒï¼šimplicitsimport spark.implicits._ä¸­çš„implicitså…³é”®å­—å®é™…ä¸Šæ˜¯SparkSessionçš„å†…éƒ¨objectï¼Œå®ƒç»§æ‰¿äº†SQLImplicits 123object implicits extends SQLImplicits with Serializable &#123; protected override def _sqlContext: SQLContext = SparkSession.this.sqlContext&#125; org.apache.spark.sql.SQLImplicitsï¼šA collection of implicit methods for converting common Scala objects into Datasets. ä»ä»¥ä¸Šçš„æ¡ˆä¾‹ä¸­å¯ä»¥å¾—åˆ°ï¼š SparkSession.thisæ˜¯å½“å‰è¿è¡Œçš„SparkSessionå®ä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®ä¾‹å¯¹è±¡å°†SparkSessionçš„å†…éƒ¨objectå¼•å…¥è¿›æ¥ã€‚è¿™é‡Œä¸ºä»€ä¹ˆä¸€å®šè¦ä½¿ç”¨SparkSessionå®ä¾‹çš„è¿™ç§æ–¹å¼å¼•å…¥éšå¼è½¬æ¢å‘¢ï¼Ÿæ ¹æ®æºç å¯ä»¥çŸ¥é“ï¼Œåœ¨è¿›è¡Œéšå¼è½¬æ¢çš„æ—¶å€™éœ€è¦ç”¨åˆ°sqlContextï¼Œå®ƒæ˜¯sparkSessionçš„ä¸€ä¸ªå±æ€§ï¼Œåªæœ‰åœ¨SparkSessionåˆ›å»ºå®Œæˆä¹‹åï¼Œå®ƒæ‰æœ‰å€¼ã€‚ å¯ä»¥çœ‹åˆ°åœ¨org.apache.spark.sql.SQLImplicitsä¸­è¿™é‡Œç”¨åˆ°äº†_sqlContextå¯¹è±¡ 12345678910111213141516/** * Creates a [[Dataset]] from an RDD. * * @since 1.6.0 */implicit def rddToDatasetHolder[T : Encoder](rdd: RDD[T]): DatasetHolder[T] = &#123; DatasetHolder(_sqlContext.createDataset(rdd))&#125;/** * Creates a [[Dataset]] from a local Seq. * @since 1.6.0 */implicit def localSeqToDatasetHolder[T : Encoder](s: Seq[T]): DatasetHolder[T] = &#123; DatasetHolder(_sqlContext.createDataset(s))&#125; ä»org.apache.spark.sql.SQLImplicitsä¸­ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å‡ ä¸ªéå¸¸æ¼‚äº®çš„éšå¼è½¬æ¢ï¼Œå¦‚ä¸‹ï¼š 12345678910111213141516/** * Converts $\"col name\" into a [[Column]]. * * @since 2.0.0 */implicit class StringToColumn(val sc: StringContext) &#123; def $(args: Any*): ColumnName = &#123; new ColumnName(sc.s(args: _*)) &#125;&#125;/** * An implicit conversion that turns a Scala `Symbol` into a [[Column]]. * @since 1.3.0 */implicit def symbolToColumn(s: Symbol): ColumnName = new ColumnName(s.name) è¿™å°±æ˜¯æˆ‘ä»¬å¹³æ—¶å¯ä»¥ç›´æ¥ä¸‹å¦‚ä¸‹çš„è„šæœ¬çš„å…³é”®æ‰€åœ¨ï¼š 1df.select(\"a\", \"b\", $\"c\", $\"d\"+1, 'e, 'f)","categories":[{"name":"Sparkåº”ç”¨","slug":"Sparkåº”ç”¨","permalink":"https://shang.at/categories/Sparkåº”ç”¨/"}],"tags":[{"name":"Sparkä¸­çš„éšå¼è½¬æ¢","slug":"Sparkä¸­çš„éšå¼è½¬æ¢","permalink":"https://shang.at/tags/Sparkä¸­çš„éšå¼è½¬æ¢/"}]},{"title":"hadoopæºç å­¦ä¹ ","slug":"hadoopæºç å­¦ä¹ ä¸€","date":"2019-07-10T03:03:43.000Z","updated":"2020-12-18T10:02:12.432Z","comments":true,"path":"post/hadoopæºç å­¦ä¹ ä¸€/","link":"","permalink":"https://shang.at/post/hadoopæºç å­¦ä¹ ä¸€/","excerpt":"","text":"å…ˆå¯¼çŸ¥è¯† JAVA-åŠ¨æ€ä»£ç† IPC/RPC hadoopä¸€å…±åŒ…å«ä»¥ä¸‹å‡ ä¸ªç»„æˆéƒ¨åˆ† hadoop-common fs io ipcï¼šæ˜¯hadoopçš„çµé­‚ï¼Œè¿æ¥äº†é›†ç¾¤çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ hdfs fs NNï¼šNameNodeï¼ŒNN server+filesystem manager DNï¼šDataNodeï¼Œç®¡ç†æ•°æ®blockçš„å­˜å‚¨ å®šæ—¶å‘NNæ±‡æŠ¥ yarn RM NM tools Hadoop ä¸­çš„ IPCæ¡†æ¶Server æµç¨‹å›¾ çº¿ç¨‹æ¨¡å‹ æˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹çš„ä»£ç ï¼Œæ¥åˆ›å»ºä¸€ä¸ªIPC Server 123456 // Get RPC server for server side implementation server = new RPC.Builder(conf).setProtocol(TestRpcService.class) .setNumHandlers(4) // .setnumReaders(4) .setInstance(service).setBindAddress(ADDRESS).setPort(PORT).build();server.start() å¯åŠ¨Serverï¼Œåˆ™ä¼šå¾—åˆ°å¦‚ä¸‹çš„çº¿ç¨‹æ¨¡å‹ Client æµç¨‹å›¾ çº¿ç¨‹æ¨¡å‹ å¯åŠ¨ä¸€ä¸ªhadoop jar jobï¼šorg.apache.hadoop.util.RunJar","categories":[{"name":"Hadoopå­¦ä¹ ","slug":"Hadoopå­¦ä¹ ","permalink":"https://shang.at/categories/Hadoopå­¦ä¹ /"}],"tags":[{"name":"Hadoop-IPC","slug":"Hadoop-IPC","permalink":"https://shang.at/tags/Hadoop-IPC/"}]},{"title":"Pandas-å­¦ä¹ ","slug":"Pythonæ•°æ®åˆ†æ-Pandaså­¦ä¹ ","date":"2019-06-11T01:53:35.000Z","updated":"2021-05-19T02:24:17.311Z","comments":true,"path":"post/Pythonæ•°æ®åˆ†æ-Pandaså­¦ä¹ /","link":"","permalink":"https://shang.at/post/Pythonæ•°æ®åˆ†æ-Pandaså­¦ä¹ /","excerpt":"","text":"pandasçš„DataFrameæ€ä¹ˆæŠŠå‡ åˆ—æ•°æ®åˆå¹¶æˆä¸ºæ–°çš„ä¸€åˆ—: https://blog.csdn.net/gangyin5071/article/details/79601386 https://blog.csdn.net/python_Allen/article/details/106646415 è®²çš„å¾ˆå¥½ï¼šhttps://blog.csdn.net/W_weiying/article/details/80393524 https://zhuanlan.zhihu.com/p/31974169 pandas dataframe to json: https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_json.html pythonï¼šhttps://www.cnblogs.com/bigberg/p/6430095.html pythonä¸­åˆ†ç»„æ’åºâ€”groupby(),rank()ï¼š https://blog.csdn.net/baidu_38409988/article/details/102668006 ã€Pythonã€‘groupby å’Œ agg å®ç°stringèšåˆï¼ˆcollect_setï¼‰ï¼š https://blog.csdn.net/qq_34105362/article/details/84345044 to_dict:https://blog.csdn.net/m0_37804518/article/details/78444110","categories":[{"name":"Pythonæ•°æ®åˆ†æ","slug":"Pythonæ•°æ®åˆ†æ","permalink":"https://shang.at/categories/Pythonæ•°æ®åˆ†æ/"}],"tags":[{"name":"Pandas","slug":"Pandas","permalink":"https://shang.at/tags/Pandas/"}]},{"title":"Pythonå­¦ä¹ -æ—¶é—´å¤„ç†","slug":"Pythonå­¦ä¹ -æ—¶é—´å¤„ç†","date":"2019-06-06T08:37:46.000Z","updated":"2019-08-03T02:17:49.584Z","comments":true,"path":"post/Pythonå­¦ä¹ -æ—¶é—´å¤„ç†/","link":"","permalink":"https://shang.at/post/Pythonå­¦ä¹ -æ—¶é—´å¤„ç†/","excerpt":"","text":"å…³äºæ—¶é—´æˆ³çš„å‡ ä¸ªæ¦‚å¿µæ—¶é—´æˆ³ï¼Œæ ¹æ®1970å¹´1æœˆ1æ—¥00:00:00å¼€å§‹æŒ‰ç§’è®¡ç®—çš„åç§»é‡ã€‚æ—¶é—´å…ƒç»„ï¼ˆstruct_timeï¼‰ï¼ŒåŒ…å«9ä¸ªå…ƒç´ ã€‚ 1time.struct_time(tm_year=2017, tm_mon=10, tm_mday=1, tm_hour=14, tm_min=21, tm_sec=57, tm_wday=6, tm_yday=274, tm_isdst=0) æ—¶é—´æ ¼å¼å­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²å½¢å¼çš„æ—¶é—´ã€‚timeæ¨¡å—ä¸æ—¶é—´æˆ³å’Œæ—¶é—´ç›¸å…³çš„é‡è¦å‡½æ•° 12345time.time() # ç”Ÿæˆå½“å‰çš„æ—¶é—´æˆ³ï¼Œæ ¼å¼ä¸º10ä½æ•´æ•°çš„æµ®ç‚¹æ•°ã€‚time.strftime() # æ ¹æ®æ—¶é—´å…ƒç»„ç”Ÿæˆæ—¶é—´æ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚time.strptime() # æ ¹æ®æ—¶é—´æ ¼å¼åŒ–å­—ç¬¦ä¸²ç”Ÿæˆæ—¶é—´å…ƒç»„ã€‚time.strptime()ä¸time.strftime()ä¸ºäº’æ“ä½œã€‚time.localtime() # æ ¹æ®æ—¶é—´æˆ³ç”Ÿæˆå½“å‰æ—¶åŒºçš„æ—¶é—´å…ƒç»„ã€‚time.mktime() # æ ¹æ®æ—¶é—´å…ƒç»„ç”Ÿæˆæ—¶é—´æˆ³ã€‚ ç¤ºä¾‹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344import time##ç”Ÿæˆå½“å‰æ—¶é—´çš„æ—¶é—´æˆ³ï¼Œåªæœ‰ä¸€ä¸ªå‚æ•°å³æ—¶é—´æˆ³çš„ä½æ•°ï¼Œé»˜è®¤ä¸º10ä½ï¼Œè¾“å…¥ä½æ•°å³ç”Ÿæˆç›¸åº”ä½æ•°çš„æ—¶é—´æˆ³ï¼Œæ¯”å¦‚å¯ä»¥ç”Ÿæˆå¸¸ç”¨çš„13ä½æ—¶é—´æˆ³def now_to_timestamp(digits = 10): time_stamp = time.time() digits = 10 ** (digits -10) time_stamp = int(round(time_stamp*digits)) return time_stamp##å°†æ—¶é—´æˆ³è§„èŒƒä¸º10ä½æ—¶é—´æˆ³def timestamp_to_timestamp10(time_stamp): time_stamp = int (time_stamp* (10 ** (10-len(str(time_stamp))))) return time_stamp##å°†å½“å‰æ—¶é—´è½¬æ¢ä¸ºæ—¶é—´å­—ç¬¦ä¸²ï¼Œé»˜è®¤ä¸º2017-10-01 13:37:04æ ¼å¼def now_to_date(format_string=\"%Y-%m-%d %H:%M:%S\"): time_stamp = int(time.time()) time_array = time.localtime(time_stamp) str_date = time.strftime(format_string, time_array) return str_date##å°†10ä½æ—¶é—´æˆ³è½¬æ¢ä¸ºæ—¶é—´å­—ç¬¦ä¸²ï¼Œé»˜è®¤ä¸º2017-10-01 13:37:04æ ¼å¼def timestamp_to_date(time_stamp, format_string=\"%Y-%m-%d %H:%M:%S\"): time_array = time.localtime(time_stamp) str_date = time.strftime(format_string, time_array) return str_date##å°†æ—¶é—´å­—ç¬¦ä¸²è½¬æ¢ä¸º10ä½æ—¶é—´æˆ³ï¼Œæ—¶é—´å­—ç¬¦ä¸²é»˜è®¤ä¸º2017-10-01 13:37:04æ ¼å¼def date_to_timestamp(date, format_string=\"%Y-%m-%d %H:%M:%S\"): time_array = time.strptime(date, format_string) time_stamp = int(time.mktime(time_array)) return time_stamp##ä¸åŒæ—¶é—´æ ¼å¼å­—ç¬¦ä¸²çš„è½¬æ¢def date_style_transfomation(date, format_string1=\"%Y-%m-%d %H:%M:%S\",format_string2=\"%Y-%m-%d %H-%M-%S\"): time_array = time.strptime(date, format_string1) str_date = time.strftime(format_string2, time_array) return str_dateprint(now_to_date())print(timestamp_to_date(1506816572))print(date_to_timestamp('2017-10-01 08:09:32'))print(timestamp_to_timestamp10(1506816572546))print(date_style_transfomation('2017-10-01 08:09:32')) ç»“æœä¸º 1234515068362240002017-10-01 13:37:042017-10-01 08:09:3215068165721506816572","categories":[{"name":"Python","slug":"Python","permalink":"https://shang.at/categories/Python/"}],"tags":[{"name":"pythonä¸­çš„æ—¶é—´å¤„ç†","slug":"pythonä¸­çš„æ—¶é—´å¤„ç†","permalink":"https://shang.at/tags/pythonä¸­çš„æ—¶é—´å¤„ç†/"}]},{"title":"Sparkå­¦ä¹ ç¬”è®°-Configuration","slug":"Sparkå­¦ä¹ ç¬”è®°-Configuration","date":"2019-06-03T09:32:33.000Z","updated":"2020-07-01T09:10:09.964Z","comments":true,"path":"post/Sparkå­¦ä¹ ç¬”è®°-Configuration/","link":"","permalink":"https://shang.at/post/Sparkå­¦ä¹ ç¬”è®°-Configuration/","excerpt":"","text":"submit å‚æ•° è¿è¡Œæ—¶å¯é…ç½®å‚æ•°ï¼šåœ¨ä»£ç ä¸­ä½¿ç”¨spark.conf.set(â€˜â€™ï¼Œ â€˜â€™)çš„æ–¹å¼è®¾ç½®ã€‚è¿è¡Œæ—¶è®¾ç½®çš„å‚æ•°ä¸ä¼šåœ¨WebUIä¸­æ˜¾ç¤º","categories":[{"name":"Sparkå­¦ä¹ ","slug":"Sparkå­¦ä¹ ","permalink":"https://shang.at/categories/Sparkå­¦ä¹ /"}],"tags":[{"name":"Configuration","slug":"Configuration","permalink":"https://shang.at/tags/Configuration/"}]},{"title":"Pythonå­¦ä¹ -é˜Ÿåˆ—","slug":"Pythonå­¦ä¹ -é˜Ÿåˆ—","date":"2019-06-03T02:10:48.000Z","updated":"2020-07-01T09:21:20.616Z","comments":true,"path":"post/Pythonå­¦ä¹ -é˜Ÿåˆ—/","link":"","permalink":"https://shang.at/post/Pythonå­¦ä¹ -é˜Ÿåˆ—/","excerpt":"","text":"é˜Ÿåˆ—123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051from queue import Queue #LILOé˜Ÿåˆ—q = Queue() #åˆ›å»ºé˜Ÿåˆ—å¯¹è±¡q.put(0) #åœ¨é˜Ÿåˆ—å°¾éƒ¨æ’å…¥å…ƒç´ q.put(1)q.put(2)print('LILOé˜Ÿåˆ—',q.queue) #æŸ¥çœ‹é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å…ƒç´ print(q.get()) #è¿”å›å¹¶åˆ é™¤é˜Ÿåˆ—å¤´éƒ¨å…ƒç´ print(q.queue)from queue import LifoQueue #LIFOé˜Ÿåˆ—lifoQueue = LifoQueue()lifoQueue.put(1)lifoQueue.put(2)lifoQueue.put(3)print('LIFOé˜Ÿåˆ—',lifoQueue.queue)lifoQueue.get() #è¿”å›å¹¶åˆ é™¤é˜Ÿåˆ—å°¾éƒ¨å…ƒç´ lifoQueue.get()print(lifoQueue.queue)from queue import PriorityQueue #ä¼˜å…ˆé˜Ÿåˆ—priorityQueue = PriorityQueue() #åˆ›å»ºä¼˜å…ˆé˜Ÿåˆ—å¯¹è±¡priorityQueue.put(3) #æ’å…¥å…ƒç´ priorityQueue.put(78) #æ’å…¥å…ƒç´ priorityQueue.put(100) #æ’å…¥å…ƒç´ print(priorityQueue.queue) #æŸ¥çœ‹ä¼˜å…ˆçº§é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å…ƒç´ priorityQueue.put(1) #æ’å…¥å…ƒç´ priorityQueue.put(2) #æ’å…¥å…ƒç´ print('ä¼˜å…ˆçº§é˜Ÿåˆ—:',priorityQueue.queue) #æŸ¥çœ‹ä¼˜å…ˆçº§é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å…ƒç´ priorityQueue.get() #è¿”å›å¹¶åˆ é™¤ä¼˜å…ˆçº§æœ€ä½çš„å…ƒç´ print('åˆ é™¤åå‰©ä½™å…ƒç´ ',priorityQueue.queue)priorityQueue.get() #è¿”å›å¹¶åˆ é™¤ä¼˜å…ˆçº§æœ€ä½çš„å…ƒç´ print('åˆ é™¤åå‰©ä½™å…ƒç´ ',priorityQueue.queue) #åˆ é™¤åå‰©ä½™å…ƒç´ priorityQueue.get() #è¿”å›å¹¶åˆ é™¤ä¼˜å…ˆçº§æœ€ä½çš„å…ƒç´ print('åˆ é™¤åå‰©ä½™å…ƒç´ ',priorityQueue.queue) #åˆ é™¤åå‰©ä½™å…ƒç´ priorityQueue.get() #è¿”å›å¹¶åˆ é™¤ä¼˜å…ˆçº§æœ€ä½çš„å…ƒç´ print('åˆ é™¤åå‰©ä½™å…ƒç´ ',priorityQueue.queue) #åˆ é™¤åå‰©ä½™å…ƒç´ priorityQueue.get() #è¿”å›å¹¶åˆ é™¤ä¼˜å…ˆçº§æœ€ä½çš„å…ƒç´ print('å…¨éƒ¨è¢«åˆ é™¤å:',priorityQueue.queue) #æŸ¥çœ‹ä¼˜å…ˆçº§é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å…ƒç´ from collections import deque #åŒç«¯é˜Ÿåˆ—dequeQueue = deque(['Eric','John','Smith'])print(dequeQueue)dequeQueue.append('Tom') #åœ¨å³ä¾§æ’å…¥æ–°å…ƒç´ dequeQueue.appendleft('Terry') #åœ¨å·¦ä¾§æ’å…¥æ–°å…ƒç´ print(dequeQueue)dequeQueue.rotate(2) #å¾ªç¯å³ç§»2æ¬¡print('å¾ªç¯å³ç§»2æ¬¡åçš„é˜Ÿåˆ—',dequeQueue)dequeQueue.popleft() #è¿”å›å¹¶åˆ é™¤é˜Ÿåˆ—æœ€å·¦ç«¯å…ƒç´ print('åˆ é™¤æœ€å·¦ç«¯å…ƒç´ åçš„é˜Ÿåˆ—ï¼š',dequeQueue)dequeQueue.pop() #è¿”å›å¹¶åˆ é™¤é˜Ÿåˆ—æœ€å³ç«¯å…ƒç´ print('åˆ é™¤æœ€å³ç«¯å…ƒç´ åçš„é˜Ÿåˆ—ï¼š',dequeQueue)","categories":[{"name":"Python","slug":"Python","permalink":"https://shang.at/categories/Python/"}],"tags":[{"name":"é˜Ÿåˆ—","slug":"é˜Ÿåˆ—","permalink":"https://shang.at/tags/é˜Ÿåˆ—/"}]},{"title":"Sparkå­¦ä¹ ç¬”è®°-å¹¿æ’­å˜é‡","slug":"Sparkå­¦ä¹ ç¬”è®°-å¹¿æ’­å˜é‡","date":"2019-05-28T08:19:03.000Z","updated":"2020-07-01T09:09:58.493Z","comments":true,"path":"post/Sparkå­¦ä¹ ç¬”è®°-å¹¿æ’­å˜é‡/","link":"","permalink":"https://shang.at/post/Sparkå­¦ä¹ ç¬”è®°-å¹¿æ’­å˜é‡/","excerpt":"","text":"Shared Variablesé€šå¸¸ï¼Œå½“åœ¨è¿œç¨‹é›†ç¾¤èŠ‚ç‚¹ä¸Šæ‰§è¡Œä¼ é€’ç»™Sparkæ“ä½œï¼ˆä¾‹å¦‚mapor reduceï¼‰çš„å‡½æ•°æ—¶ï¼Œå®ƒå°†åœ¨å‡½æ•°ä¸­ä½¿ç”¨çš„æ‰€æœ‰å˜é‡çš„å•ç‹¬å‰¯æœ¬ä¸Šå·¥ä½œã€‚è¿™äº›å˜é‡å°†å¤åˆ¶åˆ°æ¯å°è®¡ç®—æœºï¼Œå¹¶ä¸”è¿œç¨‹è®¡ç®—æœºä¸Šçš„å˜é‡çš„æ›´æ–°ä¸ä¼šä¼ æ’­å›é©±åŠ¨ç¨‹åºã€‚æ”¯æŒè·¨ä»»åŠ¡çš„é€šç”¨ï¼Œè¯»å†™å…±äº«å˜é‡æ•ˆç‡ä½ä¸‹ã€‚ä½†æ˜¯ï¼ŒSparkç¡®å®ä¸ºä¸¤ç§å¸¸è§çš„ä½¿ç”¨æ¨¡å¼æä¾›äº†ä¸¤ç§æœ‰é™ç±»å‹çš„å…±äº«å˜é‡ï¼šå¹¿æ’­å˜é‡å’Œç´¯åŠ å™¨ã€‚ Broadcastå¹¿æ’­å˜é‡å…è®¸ç¨‹åºå‘˜åœ¨æ¯å°æœºå™¨ä¸Šä¿ç•™ä¸€ä¸ªåªè¯»å˜é‡ï¼Œè€Œä¸æ˜¯éšå‰¯æœ¬ä¸€èµ·å‘é€å®ƒçš„å‰¯æœ¬ã€‚ä¾‹å¦‚ï¼Œå®ƒä»¬å¯ç”¨äºä»¥æœ‰æ•ˆçš„æ–¹å¼ä¸ºæ¯ä¸ªèŠ‚ç‚¹æä¾›å¤§è¾“å…¥æ•°æ®é›†çš„å‰¯æœ¬ã€‚Sparkè¿˜å°è¯•ä½¿ç”¨æœ‰æ•ˆçš„å¹¿æ’­ç®—æ³•æ¥åˆ†å‘å¹¿æ’­å˜é‡ï¼Œä»¥é™ä½é€šä¿¡æˆæœ¬ã€‚ SparkåŠ¨ä½œé€šè¿‡ä¸€ç»„é˜¶æ®µæ‰§è¡Œï¼Œç”±åˆ†å¸ƒå¼â€œshuffleâ€æ“ä½œåˆ†éš”ã€‚Sparkè‡ªåŠ¨å¹¿æ’­æ¯ä¸ªé˜¶æ®µä¸­ä»»åŠ¡æ‰€éœ€çš„å…¬å…±æ•°æ®ã€‚ä»¥è¿™ç§æ–¹å¼å¹¿æ’­çš„æ•°æ®ä»¥åºåˆ—åŒ–å½¢å¼ç¼“å­˜å¹¶åœ¨è¿è¡Œæ¯ä¸ªä»»åŠ¡ä¹‹å‰ååºåˆ—åŒ–ã€‚è¿™æ„å‘³ç€æ˜¾å¼åˆ›å»ºå¹¿æ’­å˜é‡ä»…åœ¨è·¨å¤šä¸ªé˜¶æ®µçš„ä»»åŠ¡éœ€è¦ç›¸åŒæ•°æ®æˆ–ä»¥ååºåˆ—åŒ–å½¢å¼ç¼“å­˜æ•°æ®å¾ˆé‡è¦æ—¶æ‰æœ‰ç”¨ã€‚ å¹¿æ’­å˜é‡æ˜¯vé€šè¿‡è°ƒç”¨ä»å˜é‡åˆ›å»ºçš„SparkContext.broadcast(v)ã€‚å¹¿æ’­å˜é‡æ˜¯ä¸€ä¸ªåŒ…è£…å™¨vï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨è¯¥value æ–¹æ³•æ¥è®¿é—®å®ƒçš„å€¼ã€‚ä¸‹é¢çš„ä»£ç æ˜¾ç¤ºäº†è¿™ä¸ªï¼š 12345&gt;&gt;&gt; broadcastVar = sc.broadcast([1, 2, 3])&lt;pyspark.broadcast.Broadcast object at 0x102789f10&gt;&gt;&gt;&gt; broadcastVar.value[1, 2, 3] åˆ›å»ºå¹¿æ’­å˜é‡åï¼Œåº”è¯¥ä½¿ç”¨å®ƒæ¥ä»£æ›¿vç¾¤é›†ä¸Šè¿è¡Œçš„ä»»ä½•å‡½æ•°ä¸­çš„å€¼ï¼Œè¿™æ ·vå°±ä¸ä¼šå¤šæ¬¡ä¼ é€åˆ°èŠ‚ç‚¹ã€‚æ­¤å¤–ï¼Œåœ¨vå¹¿æ’­ä¹‹åä¸åº”ä¿®æ”¹å¯¹è±¡ ï¼Œä»¥ç¡®ä¿æ‰€æœ‰èŠ‚ç‚¹è·å¾—ç›¸åŒçš„å¹¿æ’­å˜é‡å€¼ï¼ˆä¾‹å¦‚ï¼Œå¦‚æœç¨åå°†å˜é‡å‘é€åˆ°æ–°èŠ‚ç‚¹ï¼‰ã€‚ Performance Tuning 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108== Physical Plan ==InMemoryTableScan [bill_create_date#4955, week_last_day#5015, month_last_day#5075, total_outstanding_amount_ex_dp90#6075] +- InMemoryRelation [bill_create_date#4955, week_last_day#5015, month_last_day#5075, total_outstanding_amount_ex_dp90#6075], true, 10000, StorageLevel(disk, 1 replicas) +- *(34) Project [bill_create_date#4955, week_last_day#5015, month_last_day#5075, ((coalesce(nanvl(total_disburse_amount#5203, null), 0.0) - cast(coalesce(total_repay_principal_amount#5974, 0) as double)) - coalesce(nanvl(total_write_off_principal#5986, null), 0.0)) AS total_outstanding_amount_ex_dp90#6075] +- SortMergeJoin [bill_create_date#4955], [write_off_date#4776], LeftOuter :- *(23) Project [bill_create_date#4955, week_last_day#5015, month_last_day#5075, total_disburse_amount#5203, total_repay_principal_amount#5974] : +- SortMergeJoin [bill_create_date#4955], [repay_date#5789], LeftOuter : :- *(6) Sort [bill_create_date#4955 ASC NULLS FIRST], false, 0 : : +- Exchange hashpartitioning(bill_create_date#4955, 200) : : +- *(5) Project [bill_create_date#4955, week_last_day#5015, month_last_day#5075, total_disburse_amount#5203] : : +- Window [sum(disburse_amount#5197) windowspecdefinition(1, bill_create_date#4955 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, unboundedpreceding$(), currentrow$())) AS total_disburse_amount#5203], [1], [bill_create_date#4955 ASC NULLS FIRST] : : +- *(4) Sort [1 ASC NULLS FIRST, bill_create_date#4955 ASC NULLS FIRST], false, 0 : : +- Exchange hashpartitioning(1, 200) : : +- *(3) HashAggregate(keys=[bill_create_date#4955, week_last_day#5015, month_last_day#5075], functions=[sum(cast(principal#615 as double))]) : : +- Exchange hashpartitioning(bill_create_date#4955, week_last_day#5015, month_last_day#5075, 200) : : +- *(2) HashAggregate(keys=[bill_create_date#4955, week_last_day#5015, month_last_day#5075], functions=[partial_sum(cast(principal#615 as double))]) : : +- *(2) Project [principal#615, cast(from_utc_timestamp(cast(from_unixtime(cast((cast(create_time#632L as double) / 1000.0) as bigint), yyyy-MM-dd HH:mm:ss, Some(UTC)) as timestamp), Asia/Ho_Chi_Minh) as date) AS bill_create_date#4955, next_day(cast(from_utc_timestamp(cast(from_unixtime(cast((cast(create_time#632L as double) / 1000.0) as bigint), yyyy-MM-dd HH:mm:ss, Some(UTC)) as timestamp), Asia/Ho_Chi_Minh) as date), Sun) AS week_last_day#5015, last_day(cast(from_utc_timestamp(cast(from_unixtime(cast((cast(create_time#632L as double) / 1000.0) as bigint), yyyy-MM-dd HH:mm:ss, Some(UTC)) as timestamp), Asia/Ho_Chi_Minh) as date)) AS month_last_day#5075] : : +- *(2) BroadcastHashJoin [id#392], [loan_id#609], Inner, BuildRight : : :- *(2) Project [id#392] : : : +- *(2) Filter (status#397 IN (COMPLETED,CURRENT,LATE) &amp;&amp; isnotnull(id#392)) : : : +- *(2) FileScan parquet [id#392,status#397] Batched: true, Format: Parquet, Location: InMemoryFileIndex[...], PartitionFilters: [], PushedFilters: [In(status, [COMPLETED,CURRENT,LATE]), IsNotNull(id)], ReadSchema: struct&lt;id:string,status:string&gt; : : +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, true])) : : +- *(1) Project [loan_id#609, principal#615, create_time#632L] : : +- *(1) Filter ((cast(from_utc_timestamp(cast(from_unixtime(cast((cast(create_time#632L as double) / 1000.0) as bigint), yyyy-MM-dd HH:mm:ss, Some(UTC)) as timestamp), Asia/Ho_Chi_Minh) as date) &lt;= 18043) &amp;&amp; isnotnull(loan_id#609)) : : +- *(1) FileScan parquet [loan_id#609,principal#615,create_time#632L] Batched: true, Format: Parquet, Location: InMemoryFileIndex[...], PartitionFilters: [], PushedFilters: [IsNotNull(loan_id)], ReadSchema: struct&lt;loan_id:string,principal:string,create_time:bigint&gt; : +- *(22) Sort [repay_date#5789 ASC NULLS FIRST], false, 0 : +- Exchange hashpartitioning(repay_date#5789, 200) : +- *(21) Project [repay_date#5789, total_repay_principal_amount#5974] : +- Window [sum(repay_principal_amount#5970) windowspecdefinition(1, repay_date#5789 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, unboundedpreceding$(), currentrow$())) AS total_repay_principal_amount#5974], [1], [repay_date#5789 ASC NULLS FIRST] : +- *(20) Sort [1 ASC NULLS FIRST, repay_date#5789 ASC NULLS FIRST], false, 0 : +- Exchange hashpartitioning(1, 200) : +- *(19) HashAggregate(keys=[repay_date#5789], functions=[sum(CASE WHEN (isnull(write_off_date#4776) || (write_off_date#4776 &gt; repay_date#5789)) THEN repaid_principal#684 END)]) : +- Exchange hashpartitioning(repay_date#5789, 200) : +- *(18) HashAggregate(keys=[repay_date#5789], functions=[partial_sum(CASE WHEN (isnull(write_off_date#4776) || (write_off_date#4776 &gt; repay_date#5789)) THEN repaid_principal#684 END)]) : +- *(18) Project [repaid_principal#684, write_off_date#4776, cast(from_utc_timestamp(repay_time#692, Asia/Ho_Chi_Minh) as date) AS repay_date#5789] : +- SortMergeJoin [loan_id#609], [loan_id#5672], LeftOuter : :- *(12) Sort [loan_id#609 ASC NULLS FIRST], false, 0 : : +- Exchange hashpartitioning(loan_id#609, 200) : : +- *(11) Project [loan_id#609, repaid_principal#684, repay_time#692] : : +- *(11) BroadcastHashJoin [id#608], [bill_id#670], Inner, BuildRight : : :- *(11) Project [id#608, loan_id#609] : : : +- *(11) BroadcastHashJoin [id#392], [loan_id#609], Inner, BuildRight : : : :- *(11) Project [id#392] : : : : +- *(11) Filter (status#397 IN (COMPLETED,CURRENT,LATE) &amp;&amp; isnotnull(id#392)) : : : : +- *(11) FileScan parquet [id#392,status#397] Batched: true, Format: Parquet, Location: InMemoryFileIndex[...], PartitionFilters: [], PushedFilters: [In(status, [COMPLETED,CURRENT,LATE]), IsNotNull(id)], ReadSchema: struct&lt;id:string,status:string&gt; : : : +- BroadcastExchange HashedRelationBroadcastMode(List(input[1, string, true])) : : : +- *(7) Project [id#608, loan_id#609] : : : +- *(7) Filter (isnotnull(loan_id#609) &amp;&amp; isnotnull(id#608)) : : : +- *(7) FileScan parquet [id#608,loan_id#609] Batched: true, Format: Parquet, Location: InMemoryFileIndex[...], PartitionFilters: [], PushedFilters: [IsNotNull(loan_id), IsNotNull(id)], ReadSchema: struct&lt;id:string,loan_id:string&gt; : : +- BroadcastExchange HashedRelationBroadcastMode(ArrayBuffer(input[0, string, true])) : : +- *(10) Project [bill_id#670, repaid_principal#684, repay_time#692] : : +- *(10) Filter ((isnotnull(rn#5382) &amp;&amp; (rn#5382 = 1)) &amp;&amp; (cast(from_utc_timestamp(repay_time#692, Asia/Ho_Chi_Minh) as date) &lt;= 18043)) : : +- Window [row_number() windowspecdefinition(bill_id#670, repay_time#692 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#5382], [bill_id#670], [repay_time#692 DESC NULLS LAST] : : +- *(9) Sort [bill_id#670 ASC NULLS FIRST, repay_time#692 DESC NULLS LAST], false, 0 : : +- Exchange hashpartitioning(bill_id#670, 200) : : +- *(8) Project [bill_id#670, repaid_principal#684, repay_time#692] : : +- *(8) Filter isnotnull(bill_id#670) : : +- *(8) FileScan parquet [bill_id#670,repaid_principal#684,repay_time#692] Batched: true, Format: Parquet, Location: InMemoryFileIndex[...], PartitionFilters: [], PushedFilters: [IsNotNull(bill_id)], ReadSchema: struct&lt;bill_id:string,repaid_principal:decimal(20,0),repay_time:timestamp&gt; : +- *(17) Sort [loan_id#5672 ASC NULLS FIRST], false, 0 : +- *(17) HashAggregate(keys=[loan_id#5672], functions=[first(write_off_date#4705, true)]) : +- *(17) HashAggregate(keys=[loan_id#5672], functions=[partial_first(write_off_date#4705, true)]) : +- *(17) Project [loan_id#5672, write_off_date#4705] : +- *(17) BroadcastHashJoin [bill_id#4714], [bill_id#670], LeftOuter, BuildRight : :- *(17) Project [loan_id#5672, write_off_date#4705, bill_id#4714] : : +- *(17) BroadcastHashJoin [loan_id#5672], [loan_id#4718], LeftOuter, BuildRight : : :- *(17) Project [loan_id#5672, write_off_date#4705] : : : +- *(17) BroadcastHashJoin [loan_id#5672], [loan_id#4708], LeftOuter, BuildRight : : : :- *(17) HashAggregate(keys=[loan_id#5672], functions=[min(CASE WHEN is_write_off_bill#4594 THEN write_off_date#4630 END)]) : : : : +- Exchange hashpartitioning(loan_id#5672, 200) : : : : +- *(13) HashAggregate(keys=[loan_id#5672], functions=[partial_min(CASE WHEN is_write_off_bill#4594 THEN write_off_date#4630 END)]) : : : : +- *(13) Project [loan_id#5672, (CASE WHEN isnotnull(CASE WHEN (status#5676 = OVERDUE) THEN datediff(18044, cast(due_date#5686 as date)) END) THEN CASE WHEN (status#5676 = OVERDUE) THEN datediff(18044, cast(due_date#5686 as date)) END WHEN isnotnull(CASE WHEN (status#5676 IN (REBALANCED,REPAID) &amp;&amp; (cast(cast(from_utc_timestamp(cast(from_unixtime(cast((cast(repay_time#5694L as double) / 1000.0) as bigint), yyyy-MM-dd HH:mm:ss, Some(UTC)) as timestamp), Asia/Ho_Chi_Minh) as date) as string) &gt; due_date#5686)) THEN datediff(cast(from_utc_timestamp(cast(from_unixtime(cast((cast(repay_time#5694L as double) / 1000.0) as bigint), yyyy-MM-dd HH:mm:ss, Some(UTC)) as timestamp), Asia/Ho_Chi_Minh) as date), cast(due_date#5686 as date)) END) THEN CASE WHEN (status#5676 IN (REBALANCED,REPAID) &amp;&amp; (cast(cast(from_utc_timestamp(cast(from_unixtime(cast((cast(repay_time#5694L as double) / 1000.0) as bigint), yyyy-MM-dd HH:mm:ss, Some(UTC)) as timestamp), Asia/Ho_Chi_Minh) as date) as string) &gt; due_date#5686)) THEN datediff(cast(from_utc_timestamp(cast(from_unixtime(cast((cast(repay_time#5694L as double) / 1000.0) as bigint), yyyy-MM-dd HH:mm:ss, Some(UTC)) as timestamp), Asia/Ho_Chi_Minh) as date), cast(due_date#5686 as date)) END ELSE 0 END &gt;= 91) AS is_write_off_bill#4594, date_add(cast(due_date#5686 as date), 91) AS write_off_date#4630] : : : : +- *(13) Filter (CASE WHEN isnotnull(CASE WHEN (status#5676 = OVERDUE) THEN datediff(18044, cast(due_date#5686 as date)) END) THEN CASE WHEN (status#5676 = OVERDUE) THEN datediff(18044, cast(due_date#5686 as date)) END WHEN isnotnull(CASE WHEN (status#5676 IN (REBALANCED,REPAID) &amp;&amp; (cast(cast(from_utc_timestamp(cast(from_unixtime(cast((cast(repay_time#5694L as double) / 1000.0) as bigint), yyyy-MM-dd HH:mm:ss, Some(UTC)) as timestamp), Asia/Ho_Chi_Minh) as date) as string) &gt; due_date#5686)) THEN datediff(cast(from_utc_timestamp(cast(from_unixtime(cast((cast(repay_time#5694L as double) / 1000.0) as bigint), yyyy-MM-dd HH:mm:ss, Some(UTC)) as timestamp), Asia/Ho_Chi_Minh) as date), cast(due_date#5686 as date)) END) THEN CASE WHEN (status#5676 IN (REBALANCED,REPAID) &amp;&amp; (cast(cast(from_utc_timestamp(cast(from_unixtime(cast((cast(repay_time#5694L as double) / 1000.0) as bigint), yyyy-MM-dd HH:mm:ss, Some(UTC)) as timestamp), Asia/Ho_Chi_Minh) as date) as string) &gt; due_date#5686)) THEN datediff(cast(from_utc_timestamp(cast(from_unixtime(cast((cast(repay_time#5694L as double) / 1000.0) as bigint), yyyy-MM-dd HH:mm:ss, Some(UTC)) as timestamp), Asia/Ho_Chi_Minh) as date), cast(due_date#5686 as date)) END ELSE 0 END &gt;= 91) : : : : +- *(13) FileScan parquet [loan_id#5672,status#5676,due_date#5686,repay_time#5694L] Batched: true, Format: Parquet, Location: InMemoryFileIndex[...], PartitionFilters: [], PushedFilters: [], ReadSchema: struct&lt;loan_id:string,status:string,due_date:string,repay_time:bigint&gt; : : : +- BroadcastExchange HashedRelationBroadcastMode(ArrayBuffer(input[0, string, true])) : : : +- *(14) Project [id#392 AS loan_id#4708] : : : +- *(14) FileScan parquet [id#392] Batched: true, Format: Parquet, Location: InMemoryFileIndex[...], PartitionFilters: [], PushedFilters: [], ReadSchema: struct&lt;id:string&gt; : : +- BroadcastExchange HashedRelationBroadcastMode(ArrayBuffer(input[1, string, true])) : : +- *(15) Project [id#4717 AS bill_id#4714, loan_id#4718] : : +- *(15) FileScan parquet [id#4717,loan_id#4718] Batched: true, Format: Parquet, Location: InMemoryFileIndex[...], PartitionFilters: [], PushedFilters: [], ReadSchema: struct&lt;id:string,loan_id:string&gt; : +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, true])) : +- *(16) FileScan parquet [bill_id#670] Batched: true, Format: Parquet, Location: InMemoryFileIndex[...], PartitionFilters: [], PushedFilters: [], ReadSchema: struct&lt;bill_id:string&gt; +- *(33) Sort [write_off_date#4776 ASC NULLS FIRST], false, 0 +- Exchange hashpartitioning(write_off_date#4776, 200) +- *(32) Project [write_off_date#4776, total_write_off_principal#5986] +- Window [sum(write_off_principal#5982) windowspecdefinition(1, write_off_date#4776 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, unboundedpreceding$(), currentrow$())) AS total_write_off_principal#5986], [1], [write_off_date#4776 ASC NULLS FIRST] +- *(31) Sort [1 ASC NULLS FIRST, write_off_date#4776 ASC NULLS FIRST], false, 0 +- Exchange hashpartitioning(1, 200) +- *(30) HashAggregate(keys=[write_off_date#4776], functions=[sum(write_off_principal#4779)]) +- Exchange hashpartitioning(write_off_date#4776, 200) +- *(29) HashAggregate(keys=[write_off_date#4776], functions=[partial_sum(write_off_principal#4779)]) +- SortAggregate(key=[loan_id#609], functions=[first(write_off_date#4705, true), first(amount#398, true), sum(CASE WHEN (isnotnull(repayment_date#4760) &amp;&amp; (repayment_date#4760 &lt; write_off_date#4705)) THEN repaid_principal#684 ELSE 0 END)]) +- SortAggregate(key=[loan_id#609], functions=[partial_first(write_off_date#4705, true), partial_first(amount#398, true), partial_sum(CASE WHEN (isnotnull(repayment_date#4760) &amp;&amp; (repayment_date#4760 &lt; write_off_date#4705)) THEN repaid_principal#684 ELSE 0 END)]) +- *(28) Sort [loan_id#609 ASC NULLS FIRST], false, 0 +- *(28) Project [loan_id#609, write_off_date#4705, amount#398, repaid_principal#684, cast(from_utc_timestamp(repay_time#692, Asia/Ho_Chi_Minh) as date) AS repayment_date#4760] +- *(28) BroadcastHashJoin [bill_id#4714], [bill_id#670], LeftOuter, BuildRight :- *(28) Project [loan_id#609, write_off_date#4705, amount#398, bill_id#4714] : +- *(28) BroadcastHashJoin [loan_id#609], [loan_id#4718], LeftOuter, BuildRight : :- *(28) Project [loan_id#609, write_off_date#4705, amount#398] : : +- *(28) BroadcastHashJoin [loan_id#609], [loan_id#4708], LeftOuter, BuildRight : : :- *(28) HashAggregate(keys=[loan_id#609], functions=[min(CASE WHEN is_write_off_bill#4594 THEN write_off_date#4630 END)]) : : : +- ReusedExchange [loan_id#609, min#6101], Exchange hashpartitioning(loan_id#5672, 200) : : +- BroadcastExchange HashedRelationBroadcastMode(ArrayBuffer(input[0, string, true])) : : +- *(25) Project [id#392 AS loan_id#4708, amount#398] : : +- *(25) FileScan parquet [id#392,amount#398] Batched: true, Format: Parquet, Location: InMemoryFileIndex[...], PartitionFilters: [], PushedFilters: [], ReadSchema: struct&lt;id:string,amount:string&gt; : +- ReusedExchange [bill_id#4714, loan_id#4718], BroadcastExchange HashedRelationBroadcastMode(ArrayBuffer(input[1, string, true])) +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, true])) +- *(27) Project [bill_id#670, repay_time#692, repaid_principal#684] +- *(27) FileScan parquet [bill_id#670,repaid_principal#684,repay_time#692] Batched: true, Format: Parquet, Location: InMemoryFileIndex[...], PartitionFilters: [], PushedFilters: [], ReadSchema: struct&lt;bill_id:string,repaid_principal:decimal(20,0),repay_time:timestamp&gt;","categories":[{"name":"Sparkå­¦ä¹ ","slug":"Sparkå­¦ä¹ ","permalink":"https://shang.at/categories/Sparkå­¦ä¹ /"}],"tags":[{"name":"å¹¿æ’­å˜é‡","slug":"å¹¿æ’­å˜é‡","permalink":"https://shang.at/tags/å¹¿æ’­å˜é‡/"}]},{"title":"æ•°æ®ç»“æ„å­¦ä¹ ç¬”è®°äºŒ-ç®—æ³•","slug":"æ•°æ®ç»“æ„å­¦ä¹ ç¬”è®°äºŒ-ç®—æ³•","date":"2019-05-16T09:54:29.000Z","updated":"2019-05-16T14:39:58.762Z","comments":true,"path":"post/æ•°æ®ç»“æ„å­¦ä¹ ç¬”è®°äºŒ-ç®—æ³•/","link":"","permalink":"https://shang.at/post/æ•°æ®ç»“æ„å­¦ä¹ ç¬”è®°äºŒ-ç®—æ³•/","excerpt":"","text":"é€’å½’äºŒåˆ†æŸ¥æ‰¾å“ˆå¸Œç®—æ³•å †æ’åºæ·±åº¦å’Œå¹¿åº¦ä¼˜å…ˆæœç´¢å­—ç¬¦ä¸²åŒ¹é…è´ªå¿ƒç®—æ³•åˆ†æ²»ç®—æ³•å›æº¯ç®—æ³•åŠ¨æ€è§„åˆ’æ‹“æ‰‘æ’åºæœ€çŸ­è·¯å¾„å¹¶è¡Œç®—æ³•","categories":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://shang.at/categories/æ•°æ®ç»“æ„ä¸ç®—æ³•/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://shang.at/tags/ç®—æ³•/"}]},{"title":"Sparkå­¦ä¹ ç¬”è®°-pivoté€è§†å›¾","slug":"Sparkå­¦ä¹ ç¬”è®°-pivoté€è§†å›¾","date":"2019-05-09T02:52:07.000Z","updated":"2021-02-25T03:53:22.926Z","comments":true,"path":"post/Sparkå­¦ä¹ ç¬”è®°-pivoté€è§†å›¾/","link":"","permalink":"https://shang.at/post/Sparkå­¦ä¹ ç¬”è®°-pivoté€è§†å›¾/","excerpt":"","text":"12345678910df = spark.createDataFrame([ ('2018-01','é¡¹ç›®1',100, 'xm'), ('2018-01','é¡¹ç›®1',100, 'xl'), ('2018-01','é¡¹ç›®1',100, 'xp'), ('2018-01','é¡¹ç›®2',200, 'ch'), ('2018-01','é¡¹ç›®3',300, 'xl'), ('2018-02','é¡¹ç›®1',1000, 'xp'), ('2018-02','é¡¹ç›®2',2000, 'xl'), ('2018-03','é¡¹ç›®x',999, 'xm')], ['date','project','income', 'saler']) 1df.toPandas() date project income saler 0 2018-01 é¡¹ç›®1 100 xm 1 2018-01 é¡¹ç›®1 100 xl 2 2018-01 é¡¹ç›®1 100 xp 3 2018-01 é¡¹ç›®2 200 ch 4 2018-01 é¡¹ç›®3 300 xl 5 2018-02 é¡¹ç›®1 1000 xp 6 2018-02 é¡¹ç›®2 2000 xl 7 2018-03 é¡¹ç›®x 999 xm pivot1234567df_pivot = df.groupBy('date').pivot( 'project', ['é¡¹ç›®1', 'é¡¹ç›®2', 'é¡¹ç›®3', 'é¡¹ç›®x']).agg( sum('income')).na.fill(0)df_pivot.toPandas() date é¡¹ç›®1 é¡¹ç›®2 é¡¹ç›®3 é¡¹ç›®x 0 2018-03 0 0 0 999 1 2018-02 1000 2000 0 0 2 2018-01 300 200 300 0 12345df.groupBy('project').pivot( 'date').agg( sum('income')).na.fill(0).toPandas() project 2018-01 2018-02 2018-03 0 é¡¹ç›®2 200 2000 0 1 é¡¹ç›®x 0 0 999 2 é¡¹ç›®1 300 1000 0 3 é¡¹ç›®3 300 0 0 unpivot12345df_pivot.selectExpr(\"date\", \"stack(4, 'é¡¹ç›®11', `é¡¹ç›®1`, 'é¡¹ç›®22', `é¡¹ç›®2`, 'é¡¹ç›®33', `é¡¹ç›®3`, 'é¡¹ç›®xx', `é¡¹ç›®x`) as (`project`,`income`)\")\\ .filter(\"income &gt; 0 \")\\ .orderBy([\"date\", \"project\"])\\ .toPandas() date project income 0 2018-01 é¡¹ç›®11 300 1 2018-01 é¡¹ç›®22 200 2 2018-01 é¡¹ç›®33 300 3 2018-02 é¡¹ç›®11 1000 4 2018-02 é¡¹ç›®22 2000 5 2018-03 é¡¹ç›®xx 999 1stack(n, expr1, ..., exprk) å°†kä¸ª[expr1, ..., exprk]æ‹†è§£æˆn rows pandaså®ç°pivot","categories":[{"name":"Sparkå­¦ä¹ ","slug":"Sparkå­¦ä¹ ","permalink":"https://shang.at/categories/Sparkå­¦ä¹ /"}],"tags":[{"name":"pivoté€è§†å›¾","slug":"pivoté€è§†å›¾","permalink":"https://shang.at/tags/pivoté€è§†å›¾/"}]},{"title":"Sparkå­¦ä¹ ç¬”è®°-tips","slug":"Sparkå­¦ä¹ ç¬”è®°-tips","date":"2019-04-15T05:50:00.000Z","updated":"2020-08-31T02:19:01.831Z","comments":true,"path":"post/Sparkå­¦ä¹ ç¬”è®°-tips/","link":"","permalink":"https://shang.at/post/Sparkå­¦ä¹ ç¬”è®°-tips/","excerpt":"","text":"ä½¿ç”¨jdbcä¿å­˜æ•°æ®çš„æ—¶å€™ï¼Œéœ€è¦æ³¨æ„ä¸€ä¸ªé‡è¦çš„é—®é¢˜ï¼šå¦‚æœæ˜¯åŸºäºåŸå§‹çš„æ•°æ®æ›´æ”¹ä¸€äº›å†…å®¹ï¼Œç„¶åè¦†ç›–åŸæ¥çš„è¡¨ï¼Œé‚£ä¹ˆåŸå§‹çš„è¡¨æ•°æ®ä¼šè¢« truncateï¼Œ æ‰€ä»¥åœ¨åŒä¸€ä¸ªspark sessionä¸­ä½ å¦‚æœå…ˆè°ƒç”¨äº†è¯»å–å’Œoverwriteæ“ä½œï¼Œé‚£ä¹ˆè¯·æ³¨æ„äº†ï¼Œåœ¨çœŸæ­£è¯»å–æ•°æ®ä¹‹å‰ï¼Œæ•°æ®å°±ä¼šè¢«truncateæ‰ï¼Œæ‰€ä»¥åŸå§‹æ•°æ®æ— æ³•è¢«ä¿å­˜ã€‚ åŸå› æ˜¯sparkçš„rddæ˜¯ä¸ä¿å­˜æ•°æ®çš„ï¼Œè‡ªç”±çœŸæ­£è°ƒç”¨actionç®—å­çš„æ—¶å€™ï¼Œæ‰ä¼šè§¦å‘è®¡ç®—ï¼Œä½†æ˜¯å¦‚æœé€‰æ‹©äº†overwritemodeï¼Œå°±ä¼šæŠŠæ•°æ®truncateæ‰äº†ï¼Œå› ä¸ºè¿™æ˜¯åœ¨Driverç«¯æ‰§è¡Œçš„ï¼Œæ­¤æ—¶è¿˜æ²¡æœ‰å‘ç”Ÿè®¡ç®— å¦‚ä½•è§£å†³ï¼š å¿…é¡»è¦ç”¨mysqlè¡¨è¿›è¡Œæ•°æ®å­˜å‚¨ï¼Œé‚£å°±è€ƒè™‘ä¸è¦ä½¿ç”¨sparkçš„jdbc APIäº† å¦‚æœå¿…é¡»è¦ç”¨sparkçš„jdbc apiï¼Œæ˜¯æ²¡åŠæ³•åšåˆ°çš„ã€‚å› ä¸ºtruncateæ“ä½œæ˜¯åœ¨actionç®—å­ä¹‹å‰å°±å·²ç»å®Œæˆçš„ã€‚ å¦‚ä½•å±è”½Sparkçš„æ—¥å¿—ï¼š 12345678// è·å–SparkContextå¯¹è±¡val conf: SparkConf = new SparkConf().setMaster(\"local\").setAppName(\"test01\")val sc = new SparkContext(conf)sc.setLogLevel(\"ERROR\")// æˆ–è€…é€šè¿‡SparkSessionä¹Ÿå¯ä»¥è·å–ï¼šval sc = sparkSession.sparkContextsc.setLogLevel(\"ERROR\") å†™spark dataframeçš„æ—¶å€™ï¼Œæœ€å¥½ç”¨å“ªäº›å­—æ®µå°±å–å“ªäº›å­—æ®µï¼Œå¦åˆ™sparkä¼šé»˜è®¤æŠŠæ‰€æœ‰å­—æ®µéƒ½è¯»è¿›å†…å­˜ï¼Œå¦‚æœè¿›è¡Œcacheæ“ä½œï¼Œå°±ä¼šæ— æ•…å ç”¨å¤§é‡å†…å­˜ å°½é‡ä¸è¦ä½¿ç”¨jsonç±»å‹çš„å­—æ®µå­˜å‚¨æ•°æ®ï¼Œå› ä¸ºjsonå­—ç¬¦ä¸²ä¼šå­˜å‚¨å¤§é‡çš„æ— ç”¨æ•°æ®ï¼Œå­—æ®µåï¼Œæœ€å¥½è®¾è®¡æœ‰æ•ˆçš„structç»“æ„ä½“æ¥å­˜å‚¨ æ²¡æœ‰è¢«æ˜ç¡®selectçš„å­—æ®µä¾ç„¶å¯ä»¥ä½œä¸ºfilterçš„æ¡ä»¶ è·å–å‘¨çš„ç¬¬ä¸€å¤©æ—¥æœŸå’Œå½“å‰æ—¥æœŸä½äºå‘¨çš„ç¬¬å‡ å¤©ï¼Œå‘¨çš„ç¬¬ä¸€å¤©å®šä¹‰ä¸åŒ å‘¨æ—¥ å‘¨ä¸€ Spark Shuffle spill (Memory) and (Disk) on SPARK UI? What do they mean? https://community.hortonworks.com/questions/202809/spark-shuffle-spill-memory.html çª—å£å‡½æ•°ä¼šå¼•èµ·é‡åˆ†åŒºå—ï¼Ÿåˆ†åŒºæ•°(200)æ˜¯å›ºå®šçš„å—ï¼Ÿ 1234567891011test_df = kreditpintar.spark.range(0, end=100, numPartitions=5).toDF(&apos;input&apos;)test_df.rdd.getNumPartitions() # 5test_1_df = test_df.withColumn(&apos;id&apos;, row_number().over(Window.partitionBy(lit(1)).orderBy(&apos;input&apos;)))test_1_df.rdd.getNumPartitions() # 200test_2_df = test_df.withColumn(&apos;id&apos;, monotonically_increasing_id())test_2_df.rdd.getNumPartitions() # 5 é€šè¿‡withColumn(â€˜groupâ€™, lit(â€˜aaaabbbâ€™))æ·»åŠ çš„æ–°åˆ—ï¼Œä¸èƒ½æœ€ä¸ºåç»­çš„joinæ“ä½œçš„condition expressionï¼Ÿ groupBy å’Œ çª—å£å‡½æ•°çš„å®ç°åŸç† å“ªä¸€ä¸ªæ•ˆç‡æ›´é«˜ groupby ã€çª—å£å‡½æ•°ã€distinctä¸‰ç§æ–¹å¼å»é‡ å“ªä¸ªæ•ˆç‡é«˜ 1distinct&gt;groupby&gt;çª—å£å‡½æ•° å¾ªç¯çš„å»è·‘è„šæœ¬ï¼Œç„¶åunionæ¯æ¬¡å¾ªç¯çš„ç»“æœã€‚ è¿™æ ·çš„ä½¿ç”¨ taskå¯èƒ½ä¼šå¤±è´¥ï¼Œéœ€è¦ä¼˜åŒ– è½¬åŒ–longåˆ—ç±»å‹åˆ°æ—¶é—´æˆ³ï¼Œä¿ç•™æ¯«ç§’ä¿¡æ¯ 12345a_df = spark.createDataFrame([[1556613225852]], ['a'])a_df.select((col('a')/1000.0).cast('timestamp')).toPandas()#CAST((a / 1000.0) AS TIMESTAMP)#0 2019-04-30 08:33:45.852 sparkè¿›è¡Œè®¡ç®—çš„è¿‡ç¨‹ä¸­é—´æ£€æŸ¥æ•°æ®æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯æ‰§è¡Œcollectåå‡ºç°æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µ(ä¸¢å¤±æ•°æ®å’Œunionåçš„æ•°æ®é‡å¤)","categories":[{"name":"Sparkå­¦ä¹ ","slug":"Sparkå­¦ä¹ ","permalink":"https://shang.at/categories/Sparkå­¦ä¹ /"}],"tags":[{"name":"Spark-tips","slug":"Spark-tips","permalink":"https://shang.at/tags/Spark-tips/"}]},{"title":"BIå·¥å…·ä½¿ç”¨ä¹‹Tableauä¸€","slug":"BIå·¥å…·ä½¿ç”¨ä¹‹Tableauä¸€","date":"2019-04-11T07:08:39.000Z","updated":"2019-05-12T00:22:00.389Z","comments":true,"path":"post/BIå·¥å…·ä½¿ç”¨ä¹‹Tableauä¸€/","link":"","permalink":"https://shang.at/post/BIå·¥å…·ä½¿ç”¨ä¹‹Tableauä¸€/","excerpt":"","text":"","categories":[{"name":"BI","slug":"BI","permalink":"https://shang.at/categories/BI/"}],"tags":[{"name":"Tableau","slug":"Tableau","permalink":"https://shang.at/tags/Tableau/"}]},{"title":"Sparkå­¦ä¹ ç¬”è®°-DSLè¯­æ³•","slug":"Sparkå­¦ä¹ ç¬”è®°-DSLè¯­æ³•","date":"2019-03-31T02:20:06.000Z","updated":"2020-07-01T09:10:14.978Z","comments":true,"path":"post/Sparkå­¦ä¹ ç¬”è®°-DSLè¯­æ³•/","link":"","permalink":"https://shang.at/post/Sparkå­¦ä¹ ç¬”è®°-DSLè¯­æ³•/","excerpt":"","text":"","categories":[{"name":"Sparkå­¦ä¹ ","slug":"Sparkå­¦ä¹ ","permalink":"https://shang.at/categories/Sparkå­¦ä¹ /"}],"tags":[{"name":"sparkSql-DSLè¯­æ³•","slug":"sparkSql-DSLè¯­æ³•","permalink":"https://shang.at/tags/sparkSql-DSLè¯­æ³•/"}]},{"title":"æ•°æ®ç»“æ„ä¸ç®—æ³•å­¦ä¹ ç¬”è®°-æ’åºç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•å­¦ä¹ ç¬”è®°-æ’åºç®—æ³•","date":"2019-03-29T00:49:58.000Z","updated":"2020-06-29T17:51:40.125Z","comments":true,"path":"post/æ•°æ®ç»“æ„ä¸ç®—æ³•å­¦ä¹ ç¬”è®°-æ’åºç®—æ³•/","link":"","permalink":"https://shang.at/post/æ•°æ®ç»“æ„ä¸ç®—æ³•å­¦ä¹ ç¬”è®°-æ’åºç®—æ³•/","excerpt":"","text":"ç®—æ³•åˆ†ç±»åç§å¸¸è§æ’åºç®—æ³•å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ï¼š æ¯”è¾ƒç±»æ’åºï¼šé€šè¿‡æ¯”è¾ƒæ¥å†³å®šå…ƒç´ é—´çš„ç›¸å¯¹æ¬¡åºï¼Œç”±äºå…¶æ—¶é—´å¤æ‚åº¦ä¸èƒ½çªç ´O(nlogn)ï¼Œå› æ­¤ä¹Ÿç§°ä¸ºéçº¿æ€§æ—¶é—´æ¯”è¾ƒç±»æ’åºã€‚ éæ¯”è¾ƒç±»æ’åºï¼šä¸é€šè¿‡æ¯”è¾ƒæ¥å†³å®šå…ƒç´ é—´çš„ç›¸å¯¹æ¬¡åºï¼Œå®ƒå¯ä»¥çªç ´åŸºäºæ¯”è¾ƒæ’åºçš„æ—¶é—´ä¸‹ç•Œï¼Œä»¥çº¿æ€§æ—¶é—´è¿è¡Œï¼Œå› æ­¤ä¹Ÿç§°ä¸ºçº¿æ€§æ—¶é—´éæ¯”è¾ƒç±»æ’åºã€‚ ç®—æ³•å¤æ‚åº¦ ç›¸å…³æ¦‚å¿µ ç¨³å®šï¼šå¦‚æœaåŸæœ¬åœ¨bå‰é¢ï¼Œè€Œa=bï¼Œæ’åºä¹‹åaä»ç„¶åœ¨bçš„å‰é¢ã€‚ ä¸ç¨³å®šï¼šå¦‚æœaåŸæœ¬åœ¨bçš„å‰é¢ï¼Œè€Œa=bï¼Œæ’åºä¹‹å a å¯èƒ½ä¼šå‡ºç°åœ¨ b çš„åé¢ã€‚ æ—¶é—´å¤æ‚åº¦ï¼šå¯¹æ’åºæ•°æ®çš„æ€»çš„æ“ä½œæ¬¡æ•°ã€‚åæ˜ å½“nå˜åŒ–æ—¶ï¼Œæ“ä½œæ¬¡æ•°å‘ˆç°ä»€ä¹ˆè§„å¾‹ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šæ˜¯æŒ‡ç®—æ³•åœ¨è®¡ç®—æœºå†…æ‰§è¡Œæ—¶æ‰€éœ€å­˜å‚¨ç©ºé—´çš„åº¦é‡ï¼Œå®ƒä¹Ÿæ˜¯æ•°æ®è§„æ¨¡nçš„å‡½æ•° å‚è€ƒ O($n^2$)å†’æ³¡æ’åº(Bubble Sort) ç®—æ³•æè¿° å†’æ³¡æ’åºåªä¼šæ“ä½œç›¸é‚»çš„ä¸¤ä¸ªæ•°æ®ã€‚æ¯æ¬¡å†’æ³¡æ“ä½œéƒ½ä¼šå¯¹ç›¸é‚»çš„ä¸¤ä¸ªå…ƒç´ è¿›è¡Œæ¯”è¾ƒï¼Œçœ‹æ˜¯å¦ç¬¦åˆå¤§å°å…³ç³»è¦æ±‚ã€‚å¦‚æœä¸æ»¡è¶³å°±äº’æ¢ä½ç½®ã€‚ä¸€æ¬¡å†’æ³¡è‡³å°‘ä¼šè®©ä¸€ä¸ªå…ƒç´ ç§»åŠ¨åˆ°å®ƒåº”è¯¥åœ¨çš„ä½ç½®ï¼Œé‡å¤næ¬¡ï¼Œå°±å®Œæˆäº†nä¸ªå…ƒç´ çš„æ’åºå·¥ä½œã€‚ ç®—æ³•å®ç° 12345678910111213141516171819202122232425262728def bubble_sort(nums): \"\"\" å†’æ³¡æ’åºï¼šä»å°åˆ°å¤§ :param nums: :return: \"\"\" if len(nums) &lt;= 1: return nums for i in range(len(nums) - 1): for j in range(i + 1, len(nums)): if nums[i] &gt; nums[j]: nums[i], nums[j] = nums[j], nums[i] return nums def bubble_sort1(nums): if len(nums) &lt;= 1: return nums for i in range(len(nums) - 1): for j in range(len(nums) - 1 - i): if nums[j] &gt; nums[j + i]: nums[j], nums[j + 1] = nums[j + 1], nums[j] return numsif __name__ == '__main__': nums = [-23, 0, 6, -4, 34] print(bubble_sort(nums)) æ’å…¥æ’åº ç®—æ³•æè¿° å°†ä¸€ä¸ªå…ƒç´ æ’å…¥ä¸€ä¸ªå·²ç»æœ‰åºçš„åºåˆ—ï¼Œä½¿å…¶ä¾ç„¶æœ‰åºã€‚é¦–å…ˆï¼Œå°†åŸå§‹çš„åºåˆ—åˆ†ä¸ºä¸¤ä¸ªå­åºåˆ—ï¼Œæœ‰åºçš„å’Œæ— åºçš„ï¼Œç„¶åï¼Œä»æ— åºçš„åºåˆ—ä¸­ä¾æ¬¡æ‹¿å‡ºä¸€ä¸ªå…ƒç´ ï¼Œæ’å…¥åˆ°æœ‰åºçš„åºåˆ—çš„åˆé€‚ä½ç½®ï¼Œå¹¶ä¿æŒæœ‰åºçš„åºåˆ—ä¾ç„¶æœ‰åºï¼Œç›´åˆ°æ— åºçš„åºåˆ—ä¸­æ²¡æœ‰å…ƒç´ äº†ã€‚ ç®—æ³•å®ç° 1234567891011121314151617def insert_sort(nums): if len(nums) &lt;= 1: return nums for i in range(1, len(nums)): # éå†æ— åºæ•°ç»„çš„æ¯ä¸€ä¸ªå…ƒç´  tmp = nums[i] # å¾…æ’å…¥å…ƒç´  j = i - 1 # å¾…æ’å…¥å­æ•°ç»„ for j in range(i - 1, -1, -1): # ä»åå¾€å‰éå†å¾…æ’å…¥å­æ•°ç»„ if tmp &gt;= nums[j]: break # tmpå¤§äºç­‰äºå½“å‰å…ƒç´ ï¼Œåœæ­¢éå† # ç›¸ç­‰å…ƒç´ ä¸ä¼šæ”¹å˜å…¶ç›¸å¯¹ä½ç½®ï¼Œæ•…æ˜¯ç¨³å®šçš„ nums[j + 1] = nums[j] # å°†nums[j]åç§»1ä¸ªä½ç½® nums[j + 1] = tmp # æ’å…¥å¾…æ’å…¥å…ƒç´  tmp return nums if __name__ == '__main__': nums = [-23, 0, 6, -4, 34, 2] print(insert_sort(nums)) é€‰æ‹©æ’åº ç®—æ³•æè¿° é€‰æ‹©æ’åºæ˜¯é€‰æ‹©æ— åºåºåˆ—ä¸­çš„æœ€å°çš„å…ƒç´ æ”¾åˆ°æœ‰åºåºåˆ—çš„æœ«å°¾ï¼Œç›´åˆ°æ— åºåºåˆ—æ²¡æœ‰å…ƒç´ ã€‚ ç®—æ³•å®ç° 123456789101112131415161718def selection_sort(nums): if len(nums) &lt;= 1: return nums for i in range(len(nums) - 1): # éå†æ— åºæ•°ç»„çš„æ¯ä¸€ä¸ªå…ƒç´  # iå’Œnums[i] min_val = nums[i] min_j = i for j in range(i + 1, len(nums)): # å¯»æ‰¾å‰©ä½™å¾…æ’æ•°ç»„çš„æœ€å°å…ƒç´  if min_val &gt; nums[j]: min_val = nums[j] min_j = j nums[i], nums[min_j] = nums[min_j], nums[i] # äº¤æ¢æœ€å°å…ƒç´ å’Œ return numsif __name__ == '__main__': nums = [-23, 0, 6, -4, 34, 2] print(selection_sort(nums)) å¸Œå°”æ’åº ç®—æ³•æè¿° 123456å¸Œå°”æ’åºæ˜¯å¯¹æ’å…¥æ’åºçš„ä¼˜åŒ–ã€‚å¸Œå°”æ’åºï¼Œé€šè¿‡å°†åŸå§‹åºåˆ—æŒ‰ç…§ä¸€å®šçš„æ­¥é•¿åˆ’åˆ†ä¸ºå¤šä¸ªå­åºåˆ— å°†åŸå§‹çš„ä¸€ç»´æ•°ç»„æ˜ å°„æˆäºŒç»´æ•°ç»„ï¼Œ ç„¶åæŒ‰åˆ—è¿›è¡Œæ’å…¥æ’åºï¼Œè¿™æ ·çš„è¯ï¼Œå¯ä»¥è®©ä¸€ä¸ªå…ƒç´ åœ¨ä¸€æ¬¡æ¯”è¾ƒä¸­è·¨è¶Šè¾ƒå¤§çš„åŒºé—´ï¼Œéšåç®—æ³•åœ¨ä½¿ç”¨è¾ƒå°çš„æ­¥é•¿ï¼Œä¸€ç›´åˆ°æ­¥é•¿ä¸º1(å·²çŸ¥å½“å¯¹æœ‰åºåº¦è¾ƒé«˜æ•°ç»„è¿›è¡Œæ’åºæ—¶ï¼Œæ’å…¥æ’åºçš„æ—¶é—´å¤æ‚åº¦æ¥è¿‘O(N)ï¼Œå› æ­¤å¯ä»¥å¤§å¹…åº¦æé«˜æ’å…¥æ’åºçš„æ•ˆç‡)ã€‚ ç»´åŸºç™¾ç§‘ï¼šhttps://zh.wikipedia.org/wiki/%E5%B8%8C%E5%B0%94%E6%8E%92%E5%BA%8F ç®—æ³•å®ç° 12345678910111213141516171819202122232425262728293031323334353637383940414243def shell_sort(list): n = len(list) # åˆå§‹æ­¥é•¿ gap = n // 2 while gap &gt; 0: print(gap) for i in range(gap, n): # æ¯ä¸ªæ­¥é•¿è¿›è¡Œæ’å…¥æ’åº temp = list[i] j = i # æ’å…¥æ’åº while j &gt;= gap and list[j - gap] &gt; temp: list[j] = list[j - gap] j -= gap print('inner=', list) list[j] = temp print(list) # å¾—åˆ°æ–°çš„æ­¥é•¿ gap = gap // 2 return listdef shell_sort1(collection): # Marcin Ciura's gap sequence gaps = [701, 301, 132, 57, 23, 10, 4, 1] for gap in gaps: i = gap while i &lt; len(collection): temp = collection[i] j = i while j &gt;= gap and collection[j - gap] &gt; temp: collection[j] = collection[j - gap] j -= gap collection[j] = temp i += 1 return collectionif __name__ == '__main__': nums = [-23, 0, 6, -4, 34, 2] print('\\n', shell_sort1(nums)) O($nlogn$)å½’å¹¶æ’åº ç®—æ³•æè¿° å°†æ•°ç»„åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œåˆ†åˆ«æ’åºï¼Œæœ€åå°†ä¸¤éƒ¨åˆ†æ’å¥½åºçš„æ•°ç»„åˆå¹¶æˆä¸€ä¸ªæœ‰åºçš„æ•°ç»„ã€‚åˆ©ç”¨é€’å½’çš„æ–¹å¼ï¼Œé‡å¤ä¸Šè¿°è¿‡ç¨‹ã€‚ å½’å¹¶æ’åºä¸ºä»€ä¹ˆä¼šé«˜æ•ˆï¼šåˆå¹¶ä¸¤ä¸ªæœ‰åºæ•°ç»„çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(N)çš„ï¼Œå°†ä¸€ä¸ªå®Œæ•´çš„æ•°ç»„é€’å½’çš„ä¸€åˆ†ä¸ºäºŒï¼Œé‚£ä¹ˆåˆ†è§£åˆ°æ•°ç»„ä¸­åªæœ‰ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œåˆ†è§£çš„æ¬¡æ•°ä¸ºlognï¼Œæ•…æ•´ä½“çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(nlogn)ã€‚ ç®—æ³•å®ç° 1234567891011121314151617181920212223242526272829303132333435363738def merge_sort(nums): print('before=', nums) length = len(nums) if length &gt; 1: midpoint = length // 2 left_half = merge_sort(nums[:midpoint]) right_half = merge_sort(nums[midpoint:]) i = 0 j = 0 k = 0 left_length = len(left_half) right_length = len(right_half) while i &lt; left_length and j &lt; right_length: if left_half[i] &lt; right_half[j]: nums[k] = left_half[i] i += 1 else: nums[k] = right_half[j] j += 1 k += 1 while i &lt; left_length: nums[k] = left_half[i] i += 1 k += 1 while j &lt; right_length: nums[k] = right_half[j] j += 1 k += 1 print('after=', nums) return numsif __name__ == '__main__': nums = [-23, 0, 6, -4, 34, 2] print('\\n', merge_sort(nums)) 1234567891011121314151617181920212223def merge_sort(nums, left, right): if left &gt;= right: return mid = (left + right) &gt;&gt; 1 # äºŒåˆ† merge_sort(nums, left, mid) # æ’åˆ—å·¦åŠéƒ¨åˆ† merge_sort(nums, mid + 1, right) # æ’åˆ—å³åŠéƒ¨åˆ† merge(nums, left, mid, right) # åˆå¹¶å·¦å³ä¸¤ä¸ªå·²ç»æœ‰åºçš„æ•°ç»„def merge(nums, left, mid, right): tmp = [0] * (right - left + 1) i, j, k = left, mid + 1, 0 while i &lt;= mid and j &lt;= right: if nums[i] &lt; nums[j]: tmp[k], i = nums[i], i + 1 else: tmp[k], j = nums[j], j + 1 k += 1 while i &lt;= mid: tmp[k], k, i = nums[i], k + 1, i + 1 while j &lt;= right: tmp[k], k, j = nums[j], k + 1, j + 1 nums[left:right+1] = tmp[:]nums = [-23, 0, 6, -4, 34, 2]merge_sort(nums, 0, len(nums) - 1)print(nums) 12345678910111213141516171819202122232425def merge_sort(nums, left, right): if left &gt;= right: return mid = (left + right) &gt;&gt; 1 # äºŒåˆ† merge_sort(nums, left, mid) # æ’åˆ—å·¦åŠéƒ¨åˆ† merge_sort(nums, mid + 1, right) # æ’åˆ—å³åŠéƒ¨åˆ† merge(nums, left, mid, right) # åˆå¹¶å·¦å³ä¸¤ä¸ªå·²ç»æœ‰åºçš„æ•°ç»„def merge(nums, left, mid, right): tmp = [] i, j = left, mid + 1 while i &lt;= mid and j &lt;= right: if nums[i] &lt; nums[j]: tmp.append(nums[i]) i += 1 else: tmp.append(nums[j]) j += 1 tmp.extend(nums[i:mid + 1] if i &lt;= mid else nums[j:right + 1]) nums[left:right + 1] = tmp[:]nums = [-23, 88, 4, 2, 99, 12, 0, 6, -4, 34, 2]merge_sort(nums, 0, len(nums) - 1)print(nums) 123456789101112131415161718192021222324252627282930313233343536373839404142// Javapublic static void mergeSort(int[] array, int left, int right) &#123; if (right &lt;= left) return; int mid = (left + right) &gt;&gt; 1; // (left + right) / 2 mergeSort(array, left, mid); mergeSort(array, mid + 1, right); merge(array, left, mid, right);&#125;public static void merge(int[] arr, int left, int mid, int right) &#123; int[] temp = new int[right - left + 1]; // ä¸­é—´æ•°ç»„ int i = left, j = mid + 1, k = 0; while (i &lt;= mid &amp;&amp; j &lt;= right) &#123; temp[k++] = arr[i] &lt;= arr[j] ? arr[i++] : arr[j++]; &#125; while (i &lt;= mid) temp[k++] = arr[i++]; while (j &lt;= right) temp[k++] = arr[j++]; for (int p = 0; p &lt; temp.length; p++) &#123; arr[left + p] = temp[p]; &#125; // ä¹Ÿå¯ä»¥ç”¨ System.arraycopy(a, start1, b, start2, length)&#125;public static void merge(int[] arr, int left, int mid, int right) &#123; int[] temp = new int[right - left + 1]; // ä¸­é—´æ•°ç»„ int i = left, j = mid + 1, k = 0; while (i &lt;= mid &amp;&amp; j &lt;= right) &#123; temp[k++] = arr[i] &lt;= arr[j] ? arr[i++] : arr[j++]; &#125; if (i&lt;=mid) System.arraycopy(arr, i, temp, k, mid-i+1); if (j&lt;=right) System.arraycopy(arr, j, temp, k, right-j+1); System.arraycopy(temp, 0, arr, left, temp.length);&#125; å¿«é€Ÿæ’åº ç®—æ³•æè¿° éšæœºé€‰æ‹©ä¸€ä¸ªpivotèŠ‚ç‚¹ï¼Œç„¶åå°†æ•°ç»„ä¸­çš„æ•°æ®åˆ†æˆå¤§äºpivotå’Œå°äºpivotçš„ä¸¤éƒ¨åˆ†ï¼Œç„¶åé€’å½’åœ°å°†å¤§äºpivotå’Œå°äºpivotçš„éƒ¨åˆ†å†æŒ‰ç…§ç›¸åŒçš„æ€è·¯å¤„ç†ï¼Œç›´åˆ°æ¯ä¸ªpivotä¸¤ç«¯çš„éƒ¨åˆ†éƒ½åªæœ‰æœ€å¤šä¸€ä¸ªå…ƒç´  ç®—æ³•å®ç° 123456789def quick_sort(collection): length = len(collection) if length &lt;= 1: return collection else: pivot = collection[0] greater = [element for element in collection[1:] if element &gt; pivot] lesser = [element for element in collection[1:] if element &lt;= pivot] return quick_sort(lesser) + [pivot] + quick_sort(greater) O(n) æ—¶é—´å¤æ‚åº¦å†…æ±‚æ— åºæ•°ç»„ä¸­çš„ç¬¬ K å¤§å…ƒç´  1234567891011121314151617# é€‰æ‹©æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œä½œä¸ºpivotï¼Œç„¶åå°†æ•°ç»„çš„æ‰€æœ‰å…ƒç´ åˆ†ä¸ºå¤§äºpivotå’Œå°äºpivotçš„ä¸¤éƒ¨åˆ†ï¼Œ# å¦‚æœ len(lesser) == k - 1ï¼Œåˆ™è¿”å›pivot# å¦‚æœ len(lesser) &gt;= kï¼Œåˆ™è¯´æ˜è¦æŸ¥æ‰¾çš„å…ƒç´ åœ¨å°äºpivotçš„éƒ¨åˆ†ï¼Œé‚£ä¹ˆç»§ç»­åœ¨lesserä¸­æŸ¥æ‰¾# å¦åˆ™çš„è¯ï¼Œè¯´æ˜è¦æŸ¥æ‰¾çš„å…ƒç´ åœ¨å¤§äºpivotçš„éƒ¨åˆ†ï¼Œé‚£ä¹ˆç»§ç»­åœ¨greaterä¸­æŸ¥æ‰¾def find_k_max(nums, k): length = len(nums) if length &lt; k: return None pivot = nums[length - 1] greater = [element for element in nums[:length - 1] if element &gt; pivot] lesser = [element for element in nums[:length - 1] if element &lt;= pivot] if len(lesser) == k - 1: return pivot elif len(lesser) &gt;= k: return find_k_max(lesser, k) else: return find_k_max(greater, k - len(lesser) - 1) In-placeç®—æ³•å®ç° 1234567891011121314151617181920212223def quick_sort(nums, begin, end): if begin&gt;=end: return pivot = partition(nums, begin, end) # æ‰¾åˆ°[begin,end]çš„pivotç‚¹ï¼Œpivotç‚¹å·²ç»å›ºå®šäº†ï¼Œæ˜¯ä¸éœ€è¦å¯¹å®ƒè¿›è¡Œæ’åºçš„ quick_sort(nums, begin, pivot-1) # é€’å½’è°ƒç”¨nums[begin, pivot-1] quick_sort(nums, pivot+1, end) # é€’å½’è°ƒç”¨nums[pivot+1, end] return numsdef partition(nums, begin, end): # pivotæ˜¯ä½œä¸ºå¯¹æ¯”çš„å€¼ # last_smalleræ˜¯æŒ‡å‘å°äºpivotçš„å­æ•°ç»„çš„ä¸‹ä¸€ä¸ªä½ç½®çš„æŒ‡é’ˆ ç±»ä¼¼äºleetcode [ç§»åŠ¨é›¶] é‚£ä¸€é¢˜çš„è§£æ³• pivot, last_smaller = end, begin for i in range(begin, end): # ä»å‰å¾€åéå†å¾…æ’æ•°ç»„ if nums[i]&lt;nums[pivot]: # å¦‚æœå½“å‰å…ƒç´ å°äºpivotï¼Œé‚£ä¹ˆè°ƒæ¢å½“å‰å…ƒç´ å’Œlast_smallerä½ç½®çš„å…ƒç´  nums[i], nums[last_smaller] = nums[last_smaller], nums[i] last_smaller+=1 # last_smaller å‘åç§»åŠ¨ä¸€ä½ # æŠŠpivotçš„å€¼ç§»åŠ¨åˆ°last_smallerä½ç½® nums[last_smaller], nums[pivot] = nums[pivot], nums[last_smaller] return last_smaller nums = []quick_sort(nums, 0, len(nums)-1) 123456789101112131415161718192021// Javapublic static void quickSort(int[] array, int begin, int end) &#123; if (end &lt;= begin) return; int pivot = partition(array, begin, end); quickSort(array, begin, pivot - 1); quickSort(array, pivot + 1, end);&#125;static int partition(int[] a, int begin, int end) &#123; // pivot: æ ‡æ†ä½ç½® // last_smalleræ˜¯æŒ‡å‘å°äºpivotçš„å­æ•°ç»„çš„ä¸‹ä¸€ä¸ªä½ç½®çš„æŒ‡é’ˆ ç±»ä¼¼äºleetcode [ç§»åŠ¨é›¶] é‚£ä¸€é¢˜çš„è§£æ³• int pivot = end, last_smaller = begin; for (int i = begin; i &lt; end; i++) &#123; if (a[i] &lt; a[pivot]) &#123; int temp = a[last_smaller]; a[last_smaller] = a[i]; a[i] = temp; last_smaller++; &#125; &#125; int temp = a[pivot]; a[pivot] = a[last_smaller]; a[last_smaller] = temp; return counter;&#125; å †æ’åº ç®—æ³•æè¿° ä½¿ç”¨å¤§é¡¶å †å’Œå°é¡¶å †çš„æ•°æ®ç»“æ„ï¼Œè¿›è¡Œæ’åºï¼šå¤§é¡¶å †ï¼Œæ¯æ¬¡å–å †é¡¶å…ƒç´ ï¼Œéå†å®Œåˆ™å¾—åˆ°ä»å¤§åˆ°å°çš„åºåˆ—ï¼›å°é¡¶å †åˆ™ç›¸åã€‚ å †æœ‰å¾ˆå¤šç§å®ç°ï¼Œè¿™é‡Œåªçœ‹äºŒå‰å †ã€‚äºŒå‰å †æ˜¯ä¸€ç§è¿‘ä¼¼å®Œå…¨äºŒå‰æ ‘ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨æ•°ç»„å­˜å‚¨ï¼Œæ¯ä¸ªçˆ¶äº²èŠ‚ç‚¹éƒ½è¦æ¯”å…¶å­©å­èŠ‚ç‚¹å¤§(å¤§é¡¶å †ï¼Œå°é¡¶å †ç›¸å) åˆ©ç”¨å †è¿›è¡Œæ’åºï¼ŒåŒ…å«ä¸¤ä¸ªæ­¥éª¤ï¼šç¬¬ä¸€ã€å°†æ•°æ®æ”¾å…¥å †ä¸­ä»¥æ»¡è¶³å †çš„æ¡ä»¶ï¼›ç¬¬äºŒã€å°†æ•°æ®ä»å †ä¸­å–å‡ºã€‚å³ä¸ºæœ‰åºæ•°ç»„ ç®—æ³•å®ç° 1234567891011121314151617181920212223242526#Pythondef heapify(parent_index, length, nums): temp = nums[parent_index] child_index = 2*parent_index+1 # å–åˆ°å·¦å­©å­ while child_index &lt; length: # å…ˆæ£€æŸ¥å³å­©å­ï¼Œçœ‹å³å­©å­æ˜¯ä¸æ˜¯æ¯”å·¦å­©å­å¤§ï¼Œæ˜¯çš„è¯æ›´æ–°å­©å­èŠ‚ç‚¹ç´¢å¼•åˆ° å³å­©å­ if child_index+1 &lt; length and nums[child_index+1] &gt; nums[child_index]: child_index = child_index+1 # å¦‚æœçˆ¶ç»“ç‚¹å¤§äºå­©å­èŠ‚ç‚¹ï¼Œé‚£ä¹ˆåœæ­¢å¾ªç¯ if temp &gt; nums[child_index]: break # å°†çˆ¶ç»“ç‚¹æ›´æ–°åˆ°æ–°æ£€æŸ¥çš„å­©å­èŠ‚ç‚¹ï¼Œé‡å¤ä¸Šé¢çš„æ“ä½œ nums[parent_index] = nums[child_index] parent_index = child_index child_index = 2*parent_index + 1 nums[parent_index] = temp # æœ€åï¼ŒæŠŠçˆ¶ç»“ç‚¹å…ƒç´ å½’ä½def heapsort(nums): ## start from (len(nums)-2)//2:çœ‹ä¸€ä¸‹å›¾å°±çŸ¥é“äº† for i in range((len(nums)-2)//2, -1, -1): heapify(i, len(nums), nums) for j in range(len(nums)-1, 0, -1): nums[j], nums[0] = nums[0], nums[j] heapify(0, j, nums) å½“len=12ï¼Œé‚£ä¹ˆä»æ•°ç»„ä¸‹æ ‡ä¸º5å¼€å§‹è°ƒæ•´ï¼Œå›¾ä¸­çš„6ä½ç½® å½“len=11ï¼Œé‚£ä¹ˆä»æ•°ç»„ä¸‹æ ‡ä¸º4å¼€å§‹è°ƒæ•´ï¼Œå›¾ä¸­çš„5ä½ç½® ä¾æ¬¡ç±»æ¨ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374// Javastatic void heapify(int[] array, int length, int i) &#123; int left = 2 * i + 1, right = 2 * i + 2ï¼› int largest = i; if (left &lt; length &amp;&amp; array[left] &gt; array[largest]) &#123; largest = left; &#125; if (right &lt; length &amp;&amp; array[right] &gt; array[largest]) &#123; largest = right; &#125; if (largest != i) &#123; int temp = array[i]; array[i] = array[largest]; array[largest] = temp; heapify(array, length, largest); &#125;&#125;public static void heapSort(int[] array) &#123; if (array.length == 0) return; int length = array.length; for (int i = length / 2-1; i &gt;= 0; i--) heapify(array, length, i); for (int i = length - 1; i &gt;= 0; i--) &#123; int temp = array[0]; array[0] = array[i]; array[i] = temp; heapify(array, i, 0); &#125;&#125;// æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´ class Solution &#123; public int findKthLargest(int[] nums, int k) &#123; int heapSize = nums.length; buildMaxHeap(nums, heapSize); for (int i = nums.length - 1; i &gt;= nums.length - k + 1; --i) &#123; swap(nums, 0, i); --heapSize; maxHeapify(nums, 0, heapSize); &#125; return nums[0]; &#125; public void buildMaxHeap(int[] a, int heapSize) &#123; for (int i = heapSize / 2; i &gt;= 0; --i) &#123; maxHeapify(a, i, heapSize); &#125; &#125; public void maxHeapify(int[] a, int i, int heapSize) &#123; int l = i * 2 + 1, r = i * 2 + 2, largest = i; if (l &lt; heapSize &amp;&amp; a[l] &gt; a[largest]) &#123; largest = l; &#125; if (r &lt; heapSize &amp;&amp; a[r] &gt; a[largest]) &#123; largest = r; &#125; if (largest != i) &#123; swap(a, i, largest); maxHeapify(a, largest, heapSize); &#125; &#125; public void swap(int[] a, int i, int j) &#123; int temp = a[i]; a[i] = a[j]; a[j] = temp; &#125;&#125; O($n$)è®¡æ•°æ’åº ç®—æ³•æè¿° è®¡æ•°æ’åºä¸æ˜¯åŸºäºæ¯”è¾ƒçš„æ’åºç®—æ³•ï¼Œå…¶æ ¸å¿ƒåœ¨äºå°†è¾“å…¥çš„æ•°æ®å€¼è½¬åŒ–ä¸ºé”®å­˜å‚¨åœ¨é¢å¤–å¼€è¾Ÿçš„æ•°ç»„ç©ºé—´ä¸­ã€‚ ä½œä¸ºä¸€ç§çº¿æ€§æ—¶é—´å¤æ‚åº¦çš„æ’åºï¼Œè®¡æ•°æ’åºè¦æ±‚è¾“å…¥çš„æ•°æ®å¿…é¡»æ˜¯æœ‰ç¡®å®šèŒƒå›´çš„æ•´æ•°ã€‚ è®¡æ•°æ’åºæ˜¯ä¸€ä¸ªç¨³å®šçš„æ’åºç®—æ³•ã€‚å½“è¾“å…¥çš„å…ƒç´ æ˜¯ n ä¸ª 0åˆ° k ä¹‹é—´çš„æ•´æ•°æ—¶ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯O(n+k)ï¼Œç©ºé—´å¤æ‚åº¦ä¹Ÿæ˜¯O(n+k)ï¼Œå…¶æ’åºé€Ÿåº¦å¿«äºä»»ä½•æ¯”è¾ƒæ’åºç®—æ³•ã€‚å½“kä¸æ˜¯å¾ˆå¤§å¹¶ä¸”åºåˆ—æ¯”è¾ƒé›†ä¸­æ—¶ï¼Œè®¡æ•°æ’åºæ˜¯ä¸€ä¸ªå¾ˆæœ‰æ•ˆçš„æ’åºç®—æ³•ã€‚ æ­¥éª¤ æ‰¾å‡ºå¾…æ’åºçš„æ•°ç»„ä¸­æœ€å¤§å’Œæœ€å°çš„å…ƒç´ ï¼› ç»Ÿè®¡æ•°ç»„ä¸­æ¯ä¸ªå€¼ä¸ºiçš„å…ƒç´ å‡ºç°çš„æ¬¡æ•°ï¼Œå­˜å…¥æ•°ç»„Cçš„ç¬¬ié¡¹ï¼› å¯¹æ‰€æœ‰çš„è®¡æ•°ç´¯åŠ ï¼ˆä»Cä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹ï¼Œæ¯ä¸€é¡¹å’Œå‰ä¸€é¡¹ç›¸åŠ ï¼‰ï¼› åå‘å¡«å……ç›®æ ‡æ•°ç»„ï¼šå°†æ¯ä¸ªå…ƒç´ iæ”¾åœ¨æ–°æ•°ç»„çš„ç¬¬C(i)é¡¹ï¼Œæ¯æ”¾ä¸€ä¸ªå…ƒç´ å°±å°†C(i)å‡å»1ã€‚ ä½¿ç”¨çš„å±€é™æ€§ï¼š å¾…æ’åºçš„æ•°ç»„å…ƒç´ åªèƒ½ä¸ºæœ‰ç¡®å®šèŒƒå›´çš„æ•´æ•°ï¼Œå› ä¸ºè¦ä½¿ç”¨æ•°ç»„çš„ç´¢å¼•æ¥æ ‡è¯†å…ƒç´ çš„é¡ºåº æœ‰æ—¶å€™ï¼Œå°æ•°å’Œè´Ÿæ•°ï¼Œå¯ä»¥é€šè¿‡ä¹˜ä»¥ä¸€ä¸ªå€æ•°æˆ–è€…åŠ ä¸Šä¸€ä¸ªæ­£æ•°ï¼Œæ¥è°ƒæ•´æˆå¯ä»¥ä½¿ç”¨è®¡æ•°æ’åºçš„å½¢å¼ å¾…æ’åºæ•°ç»„çš„èŒƒå›´ä¸èƒ½å¤ªå¤§ï¼Œå¦åˆ™ä¼šå ç”¨å¤§é‡çš„å†…å­˜ï¼Œå¦‚æœæ•°æ®å€¾æ–œä¸¥é‡ï¼Œå¯èƒ½åªä¼šä½¿ç”¨åˆ°ä¸€å°éƒ¨åˆ†çš„ä½ç½®ï¼Œä¼šé€ æˆå¤§é‡çš„å†…å­˜ç™½ç™½æ¶ˆè€— å‡çº§ï¼š å¯ä»¥ä½¿ç”¨ä¸‹é¢è¦è®²çš„æ¡¶æ’åºï¼Œæ¥å¼¥è¡¥è®¡æ•°æ’åºçš„ä¸¤ç‚¹ä¸è¶³ ç®—æ³•å®ç° 1234567891011121314151617max_value = 1000def count_sort(nums): bucket = [0] * max_value for num in nums: bucket[num] += 1 j = 0 for i in range(max_value): nums[j:j + bucket[i]] = ([i] * bucket[i])[:] j += bucket[i] return numsnums = [9, 2, 3, 1, 12, 3, 0, 3, 3, 3, 3, 3, 3, 4, 4, 4, 5, 56, 6, 7, 7, 78, 8, 8, 8, 8]count_sort(nums)print(nums) åŸºæ•°æ’åº ç®—æ³•æè¿° åŸºæ•°æ’åºæ˜¯æŒ‰ç…§ä½ä½å…ˆæ’åºï¼Œç„¶åæ”¶é›†ï¼›å†æŒ‰ç…§é«˜ä½æ’åºï¼Œç„¶åå†æ”¶é›†ï¼›ä¾æ¬¡ç±»æ¨ï¼Œç›´åˆ°æœ€é«˜ä½ã€‚æœ‰æ—¶å€™æœ‰äº›å±æ€§æ˜¯æœ‰ä¼˜å…ˆçº§é¡ºåºçš„ï¼Œå…ˆæŒ‰ä½ä¼˜å…ˆçº§æ’åºï¼Œå†æŒ‰é«˜ä¼˜å…ˆçº§æ’åºã€‚æœ€åçš„æ¬¡åºå°±æ˜¯é«˜ä¼˜å…ˆçº§é«˜çš„åœ¨å‰ï¼Œé«˜ä¼˜å…ˆçº§ç›¸åŒçš„ä½ä¼˜å…ˆçº§é«˜çš„åœ¨å‰ã€‚ æ­¥éª¤ å–å¾—æ•°ç»„ä¸­çš„æœ€å¤§æ•°ï¼Œå¹¶å–å¾—ä½æ•°ï¼› arrä¸ºåŸå§‹æ•°ç»„ï¼Œä»æœ€ä½ä½å¼€å§‹å–æ¯ä¸ªä½ç»„æˆradixæ•°ç»„ï¼› å¯¹radixè¿›è¡Œè®¡æ•°æ’åºï¼ˆåˆ©ç”¨è®¡æ•°æ’åºé€‚ç”¨äºå°èŒƒå›´æ•°çš„ç‰¹ç‚¹ï¼‰ï¼› åŸºæ•°æ’åºåŸºäºåˆ†åˆ«æ’åºï¼Œåˆ†åˆ«æ”¶é›†ï¼Œæ‰€ä»¥æ˜¯ç¨³å®šçš„ã€‚ä½†åŸºæ•°æ’åºçš„æ€§èƒ½æ¯”æ¡¶æ’åºè¦ç•¥å·®ï¼Œæ¯ä¸€æ¬¡å…³é”®å­—çš„æ¡¶åˆ†é…éƒ½éœ€è¦O(n)çš„æ—¶é—´å¤æ‚åº¦ï¼Œè€Œä¸”åˆ†é…ä¹‹åå¾—åˆ°æ–°çš„å…³é”®å­—åºåˆ—åˆéœ€è¦O(n)çš„æ—¶é—´å¤æ‚åº¦ã€‚å‡å¦‚å¾…æ’æ•°æ®å¯ä»¥åˆ†ä¸ºdä¸ªå…³é”®å­—ï¼Œåˆ™åŸºæ•°æ’åºçš„æ—¶é—´å¤æ‚åº¦å°†æ˜¯O(d*2n) ï¼Œå½“ç„¶dè¦è¿œè¿œå°äºnï¼Œå› æ­¤åŸºæœ¬ä¸Šè¿˜æ˜¯çº¿æ€§çº§åˆ«çš„ã€‚ åŸºæ•°æ’åºçš„ç©ºé—´å¤æ‚åº¦ä¸ºO(n+k)ï¼Œå…¶ä¸­kä¸ºæ¡¶çš„æ•°é‡ã€‚ä¸€èˆ¬æ¥è¯´n&gt;&gt;kï¼Œå› æ­¤é¢å¤–ç©ºé—´éœ€è¦å¤§æ¦‚nä¸ªå·¦å³ã€‚ ç®—æ³•å®ç° 1234567891011121314151617181920def radix_sort(nums, max_digit): \"\"\" max_digit è¡¨ç¤ºæœ€å¤§çš„ä½æ•° \"\"\" bucket = [[] for _ in range(10)] # åè¿›åˆ¶æ•°æ¯ä½åªèƒ½æœ‰10ä¸ªé€‰æ‹©ï¼š0-9 for digit in range(max_digit): # ä»ä½ä½å¼€å§‹åˆ†æ¡¶ for num in nums: # å¯¹æ¯ä¸ªæ•°æ•´é™¤10çš„å€æ•° å–ä½™ï¼Œå¡«å…¥å¯¹ä¸€ä¸ªçš„å‘ä½ bucket[(num // (10 ** digit)) % 10].append(num) j = 0 for i in range(10): # éå†10ä¸ªå‘ä½ï¼ŒæŠŠæ•°æ®å›å¡«å…¥nums nums[j:j + len(bucket[i])] = bucket[i][:] j += len(bucket[i]) bucket = [[] for _ in range(10)] # ä¸€è½®ç»“æŸåï¼Œæ¸…ç©ºåŸæ¥çš„bucket return numsres = radix_sort([32, 43, 4, 54, 24, 1, 34, 3, 1, 13, 4, 4, 134, 4, 53, 34, 1, 34, 3, 3, 4, 2, 1, 4, ], 3)print(res) æ¡¶æ’åº ç®—æ³•æè¿° æ¡¶æ’åºæ˜¯è®¡æ•°æ’åºçš„å‡çº§ç‰ˆã€‚å®ƒåˆ©ç”¨äº†å‡½æ•°çš„æ˜ å°„å…³ç³»ï¼Œé«˜æ•ˆä¸å¦çš„å…³é”®å°±åœ¨äºè¿™ä¸ªæ˜ å°„å‡½æ•°çš„ç¡®å®šã€‚æ¡¶æ’åº (Bucket sort)çš„å·¥ä½œçš„åŸç†ï¼šå‡è®¾è¾“å…¥æ•°æ®æœä»å‡åŒ€åˆ†å¸ƒï¼Œå°†æ•°æ®åˆ†åˆ°æœ‰é™æ•°é‡çš„æ¡¶é‡Œï¼Œæ¯ä¸ªæ¡¶å†åˆ†åˆ«æ’åºï¼ˆæœ‰å¯èƒ½å†ä½¿ç”¨åˆ«çš„æ’åºç®—æ³•æˆ–æ˜¯ä»¥é€’å½’æ–¹å¼ç»§ç»­ä½¿ç”¨æ¡¶æ’åºè¿›è¡Œæ’ï¼‰ã€‚ æ¡¶æ’åºæœ€å¥½æƒ…å†µä¸‹ä½¿ç”¨çº¿æ€§æ—¶é—´O(n)ï¼Œæ¡¶æ’åºçš„æ—¶é—´å¤æ‚åº¦ï¼Œå–å†³ä¸å¯¹å„ä¸ªæ¡¶ä¹‹é—´æ•°æ®è¿›è¡Œæ’åºçš„æ—¶é—´å¤æ‚åº¦ï¼Œå› ä¸ºå…¶å®ƒéƒ¨åˆ†çš„æ—¶é—´å¤æ‚åº¦éƒ½ä¸ºO(n)ã€‚å¾ˆæ˜¾ç„¶ï¼Œæ¡¶åˆ’åˆ†çš„è¶Šå°ï¼Œå„ä¸ªæ¡¶ä¹‹é—´çš„æ•°æ®è¶Šå°‘ï¼Œæ’åºæ‰€ç”¨çš„æ—¶é—´ä¹Ÿä¼šè¶Šå°‘ã€‚ä½†ç›¸åº”çš„ç©ºé—´æ¶ˆè€—å°±ä¼šå¢å¤§ ç®—æ³•å®ç° 1234567891011121314151617181920212223242526272829303132333435363738394041424344import mathfrom TheAlgorithms.sorts.insert_sort import insert_sort1DEFAULT_BUCKET_SIZE = 5def bucket_sort(my_list, bucket_size=DEFAULT_BUCKET_SIZE): if len(my_list) == 0: print('You don\\'t have any elements in array!') minValue = my_list[0] maxValue = my_list[0] # For finding minimum and maximum values for i in range(0, len(my_list)): if my_list[i] &lt; minValue: minValue = my_list[i] elif my_list[i] &gt; maxValue: maxValue = my_list[i] # Initialize buckets bucketCount = math.floor((maxValue - minValue) / bucket_size) + 1 buckets = [] for i in range(0, bucketCount): buckets.append([]) # For putting values in buckets for i in range(0, len(my_list)): buckets[math.floor((my_list[i] - minValue) / bucket_size)].append(my_list[i]) # Sort buckets and place back into input array sorted_array = [] for i in range(0, len(buckets)): insert_sort1(buckets[i]) for j in range(0, len(buckets[i])): sorted_array.append(buckets[i][j]) return sorted_arrayif __name__ == '__main__': sorted_array = bucket_sort([12, 23, 4, 5, 3, 2, 12, 81, 56, 95]) print(sorted_array)","categories":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://shang.at/categories/æ•°æ®ç»“æ„ä¸ç®—æ³•/"}],"tags":[{"name":"æ’åºç®—æ³•","slug":"æ’åºç®—æ³•","permalink":"https://shang.at/tags/æ’åºç®—æ³•/"}]},{"title":"æ•°æ®åˆ†æ-reduceå‡½æ•°å¼•å‘çš„","slug":"æ•°æ®åˆ†æ-reduceå‡½æ•°å¼•å‘çš„","date":"2019-03-28T05:35:25.000Z","updated":"2019-04-10T15:36:43.244Z","comments":true,"path":"post/æ•°æ®åˆ†æ-reduceå‡½æ•°å¼•å‘çš„/","link":"","permalink":"https://shang.at/post/æ•°æ®åˆ†æ-reduceå‡½æ•°å¼•å‘çš„/","excerpt":"","text":"reduce in python12345678910111213141516# _functools.reducedef reduce(function, sequence, initial=None): \"\"\" reduce(function, sequence[, initial]) -&gt; value Apply a function of two arguments cumulatively to the items of a sequence, from left to right, so as to reduce the sequence to a single value. For example, reduce(lambda x, y: x+y, [1, 2, 3, 4, 5]) calculates ((((1+2)+3)+4)+5). If initial is present, it is placed before the items of the sequence in the calculation, and serves as a default when the sequence is empty. :param function:ç»™å®šçš„ä¸€ä¸ªfuncï¼Œfuncå…·æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œå‚æ•°1æ˜¯ä¸´æ—¶èšåˆå€¼ï¼Œå‚æ•°2æ˜¯åºåˆ—ä¸­ä¸‹ä¸€ä¸ªå¾…èšåˆçš„å€¼ :param sequence:å¾…å¤„ç†çš„å¯è¿­ä»£çš„åºåˆ— :param initial:èšåˆæ•°æ®çš„åˆå§‹å€¼ \"\"\" pass å·¥ä½œåŸç†ï¼šreduceå‡½æ•°å¯¹ç»™å®šçš„åºåˆ—éå†è°ƒç”¨funcå‡½æ•°ï¼Œæ¯æ¬¡è°ƒç”¨è¿”å›ä¸€ä¸ªä¸´æ—¶èšåˆå€¼ï¼Œç›´åˆ°æ•´ä¸ªåºåˆ—éå†ç»“æŸã€‚å¦‚æœè®¾ç½®äº†åˆå§‹å€¼ï¼Œé‚£ä¹ˆåœ¨ç¬¬ä¸€æ¬¡æ‰§è¡Œfuncå‡½æ•°çš„æ—¶å€™ï¼Œä¼šå°†funcçš„å‚æ•°1è®¾ç½®ä¸ºåˆå§‹å€¼ã€‚ ä¾‹å­ï¼š 1234567&gt;&gt;&gt; from functools import reduce&gt;&gt;&gt; reduce(lambda x, y: x+y, [1, 2, 3, 4, 5])15&gt;&gt;&gt; reduce(lambda x, y: x+y, [1, 2, 3, 4, 5], 100)115&gt;&gt;&gt; reduce(lambda x, y: str(x)+str(y), [1, 2, 3, 4, 5], '')'12345' reduceå‡½æ•°ä¸ä»…å¯ä»¥å®Œæˆè¿™ç§èšåˆçš„åŠŸèƒ½ï¼Œè¿˜å¯ä»¥å®Œæˆæ›´åŠ å¤æ‚çš„æ“ä½œï¼Œ reduce&amp;foldLeft&amp;foldRight&amp;reduce in scala hiveçš„UDAFsparkçš„UDAF","categories":[{"name":"æ•°æ®åˆ†æ","slug":"æ•°æ®åˆ†æ","permalink":"https://shang.at/categories/æ•°æ®åˆ†æ/"}],"tags":[{"name":"reduce","slug":"reduce","permalink":"https://shang.at/tags/reduce/"},{"name":"æ•°æ®åˆ†ææŠ€å·§","slug":"æ•°æ®åˆ†ææŠ€å·§","permalink":"https://shang.at/tags/æ•°æ®åˆ†ææŠ€å·§/"},{"name":"æœ‰åˆå§‹å€¼çš„èšåˆæ“ä½œ","slug":"æœ‰åˆå§‹å€¼çš„èšåˆæ“ä½œ","permalink":"https://shang.at/tags/æœ‰åˆå§‹å€¼çš„èšåˆæ“ä½œ/"}]},{"title":"ä¿¡è´·æ•°æ®ç»Ÿè®¡çš„ç›¸å…³æŒ‡æ ‡","slug":"ä¿¡è´·æ•°æ®ç»Ÿè®¡çš„ç›¸å…³æŒ‡æ ‡","date":"2019-03-22T11:19:47.000Z","updated":"2019-03-28T14:24:24.845Z","comments":true,"path":"post/ä¿¡è´·æ•°æ®ç»Ÿè®¡çš„ç›¸å…³æŒ‡æ ‡/","link":"","permalink":"https://shang.at/post/ä¿¡è´·æ•°æ®ç»Ÿè®¡çš„ç›¸å…³æŒ‡æ ‡/","excerpt":"","text":"è´·æ¬¾ç±»å‹ ç­‰é¢æœ¬æ¯è´·æ¬¾ æ ¹æ®å›ºå®šçš„è¿˜æ¬¾æ—¶é—´ï¼Œè®¡ç®—å‡ºåº”è¿˜çš„æ€»åˆ©æ¯ï¼Œå†åŠ ä¸Šæœ¬é‡‘ï¼Œç„¶åæ¯ä¸ªæœˆå¹³å‡ç­‰é¢çš„è¿˜æ¬¾ã€‚ ç­‰é¢æœ¬é‡‘è´·æ¬¾ ç­‰é¢æœ¬é‡‘ç›¸å¯¹æ¥è¯´è¦ç®€å•ä¸€äº›ï¼Œæ¯æœˆæ‰€è¿˜çš„æœ¬é‡‘æ˜¯ç›¸åŒçš„ï¼Œåˆ©æ¯ç”±æ¯ä¸ªæœˆçš„å‰©ä½™æœ¬é‡‘è®¡ç®—å¾—å‡ºã€‚ å›ºå®šç‚¹æ•°è´·æ¬¾ æŒ‰ç…§å®šä¹‰ï¼Œæˆ‘ä»¬åœ¨é¦–æ¬¡è¿˜æ¬¾æ—¶å…ˆæŒ‰å›ºå®šçš„ç‚¹æ•°è¿˜ä¸€éƒ¨åˆ†è´·æ¬¾ï¼Œç„¶åå†æŒ‰è¾ƒä½çš„åˆ©ç‡è¿˜å®Œå‰©ä½™çš„è´·æ¬¾ã€‚ åŒåˆ©ç‡è´·æ¬¾ å‰xä¸ªæœˆä»¥è¾ƒä½çš„r1åˆ©ç‡è¿˜æ¬¾ï¼Œåm-xä¸ªæœˆä»¥è¾ƒé«˜çš„r2åˆ©ç‡è¿˜æ¬¾ï¼ˆå‡è®¾è¿˜æ¬¾æ€»æœˆæ•°ä¸ºmï¼‰ ç›¸å…³æŒ‡æ ‡ åŒæ¯”å¢é•¿ ç¯æ¯”å¢é•¿","categories":[{"name":"æ•°æ®åˆ†æ","slug":"æ•°æ®åˆ†æ","permalink":"https://shang.at/categories/æ•°æ®åˆ†æ/"}],"tags":[{"name":"åˆ†ææŒ‡æ ‡","slug":"åˆ†ææŒ‡æ ‡","permalink":"https://shang.at/tags/åˆ†ææŒ‡æ ‡/"}]},{"title":"airflowå®‰è£…","slug":"airflowå®‰è£…","date":"2019-03-19T11:24:02.000Z","updated":"2019-03-24T01:33:47.230Z","comments":true,"path":"post/airflowå®‰è£…/","link":"","permalink":"https://shang.at/post/airflowå®‰è£…/","excerpt":"","text":"123456789101112131415161718# airflow needs a home, ~/airflow is the default,# but you can lay foundation somewhere else if you prefer# (optional)export AIRFLOW_HOME=~/airflow# install from pypi using pippip install apache-airflow# initialize the databaseairflow initdb# start the web server, default port is 8080airflow webserver -p 8080# start the schedulerairflow scheduler# visit localhost:8080 in the browser and enable the example dag in the home page USE Mysql123vim $AIRFLOW_HOME/airflow.cfg sql_alchemy_conn = mysql+pymysql://root:123456@localhost:3306/airflow éœ€è¦pip install pymysql å¯åŠ¨å¤±è´¥1234567891011121314151617181920ERROR [airflow.models.DagBag] Failed to import: /anaconda3/lib/python3.7/site-packages/airflow/example_dags/example_http_operator.pyTraceback (most recent call last): File &quot;/anaconda3/lib/python3.7/site-packages/airflow/models.py&quot;, line 374, in process_file m = imp.load_source(mod_name, filepath) File &quot;/anaconda3/lib/python3.7/imp.py&quot;, line 171, in load_source module = _load(spec) File &quot;&lt;frozen importlib._bootstrap&gt;&quot;, line 696, in _load File &quot;&lt;frozen importlib._bootstrap&gt;&quot;, line 677, in _load_unlocked File &quot;&lt;frozen importlib._bootstrap_external&gt;&quot;, line 728, in exec_module File &quot;&lt;frozen importlib._bootstrap&gt;&quot;, line 219, in _call_with_frames_removed File &quot;/anaconda3/lib/python3.7/site-packages/airflow/example_dags/example_http_operator.py&quot;, line 27, in &lt;module&gt; from airflow.operators.http_operator import SimpleHttpOperator File &quot;/anaconda3/lib/python3.7/site-packages/airflow/operators/http_operator.py&quot;, line 21, in &lt;module&gt; from airflow.hooks.http_hook import HttpHook File &quot;/anaconda3/lib/python3.7/site-packages/airflow/hooks/http_hook.py&quot;, line 23, in &lt;module&gt; import tenacity File &quot;/anaconda3/lib/python3.7/site-packages/tenacity/__init__.py&quot;, line 352 from tenacity.async import AsyncRetrying ^SyntaxError: invalid syntax ä¿®å¤æ–¹å¼ï¼šä¿®æ”¹from tenacity.async import AsyncRetryingä¸ºfrom tenacity.async_a import AsyncRetryingï¼ŒåŒæ—¶tenacityåŒ…ä¸‹çš„asyncæ–‡ä»¶åä¸ºasync_a","categories":[],"tags":[]},{"title":"Sparkå­¦ä¹ ç¬”è®°-æŠ½æ ·æ–¹æ³•å’Œè‡ªå¢ID","slug":"Sparkå­¦ä¹ ç¬”è®°-æŠ½æ ·æ–¹æ³•å’Œè‡ªå¢ID","date":"2019-03-19T08:33:24.000Z","updated":"2020-07-01T09:09:37.773Z","comments":true,"path":"post/Sparkå­¦ä¹ ç¬”è®°-æŠ½æ ·æ–¹æ³•å’Œè‡ªå¢ID/","link":"","permalink":"https://shang.at/post/Sparkå­¦ä¹ ç¬”è®°-æŠ½æ ·æ–¹æ³•å’Œè‡ªå¢ID/","excerpt":"","text":"æŠ½æ ·æ–¹æ³•sample(withReplacement=None, fraction=None, seed=None) Returns a sampled subset of this DataFrame. withReplacement â€“ Sample with replacement or not (default False). trueæ—¶ä¼šå°†æŠ½æ ·çš„æ•°æ®æ”¾å›æ•°æ®é›†ï¼Œå¯¼è‡´æŠ½æ ·æ•°æ®æœ‰é‡å¤çš„ falseæ—¶ä¸ä¼šæ”¾å› fraction â€“ Fraction of rows to generate, range [0.0, 1.0]. è¡¨ç¤ºå­é›†å æ•°æ®é›†çš„å æ¯” seed â€“ Seed for sampling (default a random seed). fractionå¹¶ä¸èƒ½ä¿è¯å®Œå…¨æŒ‰ç…§å æ¯”æŠ½æ ·æ•°æ® è‡ªå¢IDmonotonically_increasing_id() æ¯ä¸ªåˆ†åŒºåˆ†åˆ«æ’åºç”Ÿæˆä¸€ä¸ª64ä½çš„æ•´æ•°ï¼Œä½†ä¸æ˜¯è¿ç»­çš„ã€‚ä¼šå°†åˆ†åŒºå€¼æ”¾åˆ°é«˜31ä½ï¼Œç„¶åå°†æ¯æ¡è®°å½•çš„åºåˆ—æ”¾åˆ°ä½33ä½ã€‚é™åˆ¶ï¼šåˆ†åŒºæ•°ä¸èƒ½å¤§äº10äº¿ï¼Œæ¯ä¸ªåˆ†åŒºçš„æ•°æ®é‡ä¸èƒ½å¤§äº80äº¿ã€‚","categories":[{"name":"Sparkå­¦ä¹ ","slug":"Sparkå­¦ä¹ ","permalink":"https://shang.at/categories/Sparkå­¦ä¹ /"}],"tags":[{"name":"æŠ½æ ·æ–¹æ³•å’Œè‡ªå¢ID","slug":"æŠ½æ ·æ–¹æ³•å’Œè‡ªå¢ID","permalink":"https://shang.at/tags/æŠ½æ ·æ–¹æ³•å’Œè‡ªå¢ID/"}]},{"title":"Sparkå­¦ä¹ ç¬”è®°-SparkSQLå†…ç½®å‡½æ•°","slug":"Sparkå­¦ä¹ ç¬”è®°-SparkSQLå†…ç½®å‡½æ•°","date":"2019-03-19T01:27:01.000Z","updated":"2021-02-24T10:55:03.002Z","comments":true,"path":"post/Sparkå­¦ä¹ ç¬”è®°-SparkSQLå†…ç½®å‡½æ•°/","link":"","permalink":"https://shang.at/post/Sparkå­¦ä¹ ç¬”è®°-SparkSQLå†…ç½®å‡½æ•°/","excerpt":"","text":"å­¦ä¹ SparkSQLä¸­çš„ä¸€äº›å†…ç½®å‡½æ•° æ—¥æœŸå‡½æ•° è·å–é»˜è®¤æ—¶åŒº 123spark.conf.get('spark.sql.session.timeZone')&gt;&gt; 'Asia/Shanghai' è·å–å½“å‰æ—¶é—´ è·å–å½“å‰æ—¥æœŸï¼šcurrent_date() 12345spark.sql(\"\"\" select current_date()\"\"\").toPandas()&gt;&gt; 2019-03-19 è·å–å½“å‰æ—¶é—´ï¼šcurrent_timestamp()/now() 12345spark.sql(\"\"\" select current_timestamp()\"\"\").toPandas()&gt;&gt; 2019-03-19 13:54:22.236 ä»æ—¥æœŸä¸­æˆªå–å­—æ®µ æˆªå–å¹´æœˆæ—¥ã€æ—¶åˆ†ç§’:year,month,day/dayofmonth,hour,minute,second dayofweek ,dayofyear 11 = Sunday, 2 = Monday, ..., 7 = Saturday weekofyear 1Extract the week number of a given date as integer. truncæˆªå–æŸéƒ¨åˆ†çš„æ—¥æœŸï¼Œå…¶ä»–éƒ¨åˆ†é»˜è®¤ä¸º01 123Returns date truncated to the unit specified by the format.Parameters: format â€“ â€˜yearâ€™, â€˜yyyyâ€™, â€˜yyâ€™ or â€˜monthâ€™, â€˜monâ€™, â€˜mmâ€™ date_trunc [â€œYEARâ€, â€œYYYYâ€, â€œYYâ€, â€œMONâ€, â€œMONTHâ€, â€œMMâ€, â€œDAYâ€, â€œDDâ€, â€œHOURâ€, â€œMINUTEâ€, â€œSECONDâ€, â€œWEEKâ€, â€œQUARTERâ€] 123Returns timestamp truncated to the unit specified by the format.Parameters: format â€“ â€˜yearâ€™, â€˜yyyyâ€™, â€˜yyâ€™, â€˜monthâ€™, â€˜monâ€™, â€˜mmâ€™, â€˜dayâ€™, â€˜ddâ€™, â€˜hourâ€™, â€˜minuteâ€™, â€˜secondâ€™, â€˜weekâ€™, â€˜quarterâ€™ date_formatå°†æ—¶é—´è½¬åŒ–ä¸ºæŸç§æ ¼å¼çš„å­—ç¬¦ä¸² 123Converts a date/timestamp/string to a value of string in the format specified by the date format given by the second argument.A pattern could be for instance dd.MM.yyyy and could return a string like â€˜18.03.1993â€™. All pattern letters of the Java class java.text.SimpleDateFormat can be used. æ—¥æœŸæ—¶é—´è½¬æ¢ unix_timestampè¿”å›å½“å‰æ—¶é—´çš„unixæ—¶é—´æˆ³ 123Convert time string with given pattern (â€˜yyyy-MM-dd HH:mm:ssâ€™, by default) to Unix time stamp (in seconds), using the default timezone and the default locale, return null if fail.if timestamp is None, then it returns current timestamp. from_unixtimeå°†æ—¶é—´æˆ³æ¢ç®—æˆå½“å‰æ—¶é—´ï¼Œto_unix_timestampå°†æ—¶é—´è½¬åŒ–ä¸ºæ—¶é—´æˆ³ 1Converts the number of seconds from unix epoch (1970-01-01 00:00:00 UTC) to a string representing the timestamp of that moment in the current system time zone in the given format. to_date/dateå°†å­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ—¥æœŸæ ¼å¼ï¼Œto_timestampï¼ˆSince: 2.2.0ï¼‰ 123Converts a Column of pyspark.sql.types.StringType or pyspark.sql.types.TimestampType into pyspark.sql.types.DateType using the optionally specified format. Specify formats according to SimpleDateFormats. By default, it follows casting rules to pyspark.sql.types.DateType if the format is omitted (equivalent to col.cast(&quot;date&quot;)).Converts a Column of pyspark.sql.types.StringType or pyspark.sql.types.TimestampType into pyspark.sql.types.DateType using the optionally specified format. Specify formats according to SimpleDateFormats. By default, it follows casting rules to pyspark.sql.types.TimestampType if the format is omitted (equivalent to col.cast(&quot;timestamp&quot;)). quarter å°†1å¹´4ç­‰åˆ†(range 1 to 4) 1Extract the quarter of a given date as integer. æ—¥æœŸã€æ—¶é—´è®¡ç®— months_betweenä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„æœˆæ•° add_monthsè¿”å›æ—¥æœŸånä¸ªæœˆåçš„æ—¥æœŸ last_day(date),next_day(start_date, day_of_week) date_add,date_sub(å‡) datediffï¼ˆä¸¤ä¸ªæ—¥æœŸé—´çš„å¤©æ•°ï¼‰ utc åœ¨é›†ç¾¤ä¸­å¯¹äºæ—¶é—´æˆ³çš„è½¬æ¢ï¼Œå¦‚æœä¸æŒ‡å®šæ—¶åŒºï¼Œé»˜è®¤ä¼šé‡‡ç”¨é›†ç¾¤é…ç½®çš„æ—¶åŒºï¼Œé›†ç¾¤é»˜è®¤æ—¶åŒºå¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼è·å–ï¼šspark.conf.get(â€˜spark.sql.session.timeZoneâ€™)ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œè¿™ä¸ªå€¼åº”è¯¥æ˜¯é›†ç¾¤ç»Ÿä¸€è®¾ç½®ï¼Œç‹¬ç«‹æäº¤jobçš„æ—¶å€™ï¼Œä¸éœ€è¦è®¾ç½®ã€‚ to_utc_timestamp(timestamp, tz) 1å°†timestampæŒ‰ç…§ç»™å®šçš„tzè§£é‡Šï¼Œè¿”å›utc timestamp from_utc_timestamp(timestamp, tz) 1å°†timestampæŒ‰ç…§utcè§£é‡Šï¼Œè¿”å›ç»™å®štzçš„timestamp å¯¹äºæœ‰æ—¶åŒºç›¸å…³çš„æ•°æ®ç»Ÿè®¡æ—¶ï¼Œéœ€è¦æ³¨æ„ã€‚æ¯”å¦‚ï¼šé›†ç¾¤é»˜è®¤æ—¶åŒºè®¾ç½®ä¸ºUTCï¼Œä¸€èˆ¬å°†æ•°æ®å­˜åˆ°é›†ç¾¤ä¸­çš„æ—¶å€™ä¼šå°†æ—¶é—´æˆ³è½¬ä¸ºutc timestampä»¥ä¾¿åç»­çš„æ“ä½œã€‚æ­¤æ—¶å¦‚æœæœ‰ä¸€ä¸ªéœ€æ±‚æ˜¯ç»Ÿè®¡åŒ—äº¬æ—¶é—´çš„å½“å¤©çš„æ•°æ®ï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªæƒ³åˆ°çš„æ–¹å¼æ˜¯ä½¿ç”¨current_date()è·å–å½“å‰æ—¥æœŸï¼Œç„¶åå°†æ•°æ®ä¸­çš„æ—¶é—´æˆ³ä½¿ç”¨to_date(from_utc_timestamp(from_unixtime(ts), â€˜Asia/Beijingâ€™))ï¼Œç„¶åè¿›è¡Œæ¯”è¾ƒã€‚ä½†æ˜¯current_date()è·å–çš„æ—¥æœŸï¼Œæ˜¯æ ¹æ®é›†ç¾¤é»˜è®¤æ—¶åŒºå¾—æ¥çš„ï¼Œå› æ­¤ä¼šæœ‰æ—¶åŒºçš„ä¸åŒå¯¼è‡´çš„æ•°æ®ç»Ÿè®¡é”™è¯¯ï¼Œå› æ­¤ï¼Œè¿™ç§æƒ…å†µä¸èƒ½ç›´æ¥ä½¿ç”¨current_date()ï¼Œæ­£ç¡®çš„ä½¿ç”¨æ–¹å¼æ˜¯ï¼što_date(from_utc_timestamp(current_timestamp(), â€˜Asia/Beijingâ€™))ï¼Œç„¶ååœ¨è¿›è¡Œæ¯”è¾ƒã€‚ è¡¨å…³è” Join(other, on=None, how=None) onï¼ša string for the join column name, a list of column names, a join expression (Column), or a list of Columns. If on is a string or a list of strings indicating the name of the join column(s), the column(s) must exist on both sides, and this performs an equi-join. howï¼šstr, default inner. Must be one of: inner, cross, outer, full, full_outer, left, left_outer, right, right_outer, left_semi, and left_anti inner:å†…è¿ï¼Œè¿”å›joinDF1å’ŒjoinDF2åˆå¹¶çš„rowsï¼Œå¦‚æœjoinDF2ä¸­æœ‰å¤šæ¡è®°å½•å¯¹åº”äºjoinDF1çš„åŒä¸€æ¡è®°å½•ï¼Œé‚£ä¹ˆè¿”å›çš„row numberä¼šå¤§äºjoinDF1çš„row number outer,full,full_outerï¼šå…¨è¿ left, left_outerï¼šå·¦è¿ rightï¼Œright_outer:å³è¿ left_semiï¼šè¿‡æ»¤å‡ºjoinDF1ä¸­å’ŒjoinDF2å…±æœ‰çš„éƒ¨åˆ†ï¼Œåªè¿”å›joinDF1ä¸­çš„rows left_antiï¼šè¿‡æ»¤å‡ºjoinDF1ä¸­joinDF2æ²¡æœ‰çš„éƒ¨åˆ†ï¼Œåªè¿”å›joinDF1ä¸­çš„rows crossJoin(other) è¿”å›ä¸¤ä¸ªDFçš„ç¬›å¡å°”ç§¯ï¼šç¬›å¡å°”ç§¯ä¼šæå¤§çš„é™ä½ä»»åŠ¡æ‰§è¡Œçš„æ•ˆç‡ joinä¼˜åŒ–ï¼Œsparkä¼šé»˜è®¤å°†å°è¡¨å¹¿æ’­ï¼ŒæŒ‰ç…§å¦‚ä¸‹çš„å‚æ•°è®¾ç½®ï¼Œæ»¡è¶³æ¡ä»¶å°±ä¼šå¹¿æ’­ å‚æ•°ä¼˜åŒ–ï¼š spark.sql.broadcastTimeoutï¼šbroadcastçš„åŠ å¤§è¶…æ—¶çš„æ—¶é—´é™åˆ¶ spark.sql.autoBroadcastJoinThresholdï¼šé»˜è®¤æ˜¯10Mï¼Œå¤§å°ä½äºè¯¥å‚æ•°è®¾ç½®çš„é˜ˆå€¼æ—¶ï¼Œä¼šè¢«å¹¿æ’­ï¼Œä½†æ˜¯é»˜è®¤çš„BroadCastJoinä¼šå°†å°è¡¨çš„å†…å®¹ï¼Œå…¨éƒ¨æ”¶é›†åˆ°Driverä¸­ï¼Œå¯¼è‡´Driverå‹åŠ›å˜å¤§ spark.sql.bigdata.useExecutorBroadcastï¼šè®¾ç½®ä¸ºtrueæ—¶ï¼Œä½¿ç”¨Executorå¹¿æ’­ï¼Œå°†è¡¨æ•°æ®ç¼“å­˜åœ¨Executorä¸­ï¼Œè€Œä¸æ˜¯æ”¾åœ¨Driverä¹‹ä¸­ï¼Œå‡å°‘Spark Driverå†…å­˜çš„å‹åŠ›ã€‚ åœ¨joinä¸­ä½¿ç”¨orè¿æ¥å…³é”®å­—ï¼Œä¼šå¯¼è‡´ç¬›å¡å°”ç§¯çš„äº§ç”ŸCartesianProduct(å½“joinå¤šä¸ªè¡¨)|BroadcastNestedLoopJoin(åªjoinä¸€ä¸ªtable)ï¼Œæ•…ä¸å»ºè®®è¿™æ ·åšï¼Œå»ºè®®ä½¿ç”¨å¤šæ¬¡joinï¼Œå–ä¸ä¸ºç©ºçš„ç»“æœï¼Œæ¯”å¦‚ï¼š 12345678910111213141516-- é”™è¯¯çš„ç¤ºèŒƒselect e.device_id , e,user_id , ab.branchfrom app_event eleft join ab_test ab on e.device_id=ab.admin_id or e.user_id=ab.admin_id-- æ­£ç¡®çš„å†™æ³•select e.device_id , e,user_id , COALESCE(ab.branch, ab1.branch) branchfrom app_event eleft join ab_test ab on e.device_id=ab.admin_idleft join ab_test ab1 on e.user_id=ab.admin_id Parses the expression expr å°†å­—ç¬¦ä¸²è¡¨ç¤ºçš„è¡¨è¾¾å¼ï¼Œç¿»è¯‘æˆDSL 123expr(\"length(name)\")expr(\"array_contains(user_id_set, user_id)\")","categories":[{"name":"Sparkå­¦ä¹ ","slug":"Sparkå­¦ä¹ ","permalink":"https://shang.at/categories/Sparkå­¦ä¹ /"}],"tags":[{"name":"sparkSqlå†…ç½®å‡½æ•°","slug":"sparkSqlå†…ç½®å‡½æ•°","permalink":"https://shang.at/tags/sparkSqlå†…ç½®å‡½æ•°/"}]},{"title":"æ•°æ®åˆ†æå°çŸ¥è¯†ç‚¹","slug":"æ•°æ®åˆ†æå°çŸ¥è¯†ç‚¹","date":"2019-03-19T01:25:56.000Z","updated":"2021-02-26T09:10:16.159Z","comments":true,"path":"post/æ•°æ®åˆ†æå°çŸ¥è¯†ç‚¹/","link":"","permalink":"https://shang.at/post/æ•°æ®åˆ†æå°çŸ¥è¯†ç‚¹/","excerpt":"","text":"æ€»ç»“ä¸€ä¸‹åœ¨æ•°æ®åˆ†æä¸­éœ€è¦æ³¨æ„çš„ä¸€äº›tipsï¼ŒæŒç»­æ›´æ–° Tip1 æ—¶åŒºåœ¨è¿›è¡Œè·¨å¢ƒä¸šåŠ¡å¤„ç†çš„æ—¶å€™ï¼Œæ—¶åŒºçš„æ§åˆ¶æ˜¯ååˆ†å¿…è¦çš„ã€‚å¹³æ—¶å¯¹äºå›½å†…çš„ä¸šåŠ¡ï¼Œéƒ¨ç½²åœ¨å›½å†…çš„æœåŠ¡å™¨ï¼Œä½¿ç”¨çš„æ—¶åŒºä¸€èˆ¬éƒ½æ˜¯åŒ—äº¬æ—¶é—´(åŒ—äº¬æ—¶é—´æ˜¯UTC+8:00æ—¶åŒºçš„æ—¶é—´ï¼Œè€ŒUTCæ—¶é—´æŒ‡UTC+0:00æ—¶åŒºçš„æ—¶é—´)ï¼Œåœ¨æ•°æ®åº“ä¸­ä¸€èˆ¬å­˜å‚¨ç›¸å¯¹äºunix epoch (1970-01-01 00:00:00 UTC)çš„æ¯«ç§’æ—¶é—´æˆ³ï¼ŒåšæŸä¸ªåœ°åŒºçš„æ•°æ®ç»Ÿè®¡æ—¶ï¼Œéœ€è¦å°†æ—¶é—´æˆ³è½¬æ¢æˆå½“åœ°çš„æ—¶é—´(å³åŠ ä¸€ä¸ªæ—¶åŒºçš„å±æ€§) https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/001431937554888869fb52b812243dda6103214cd61d0c2000 mysqlæ•°æ®åº“ä¸­ datetimeç±»å‹çš„å­—æ®µæ˜¯æ²¡æœ‰æ—¶åŒºä¿¡æ¯çš„ï¼Œåªæ˜¯ä¸€ä¸ªæ—¥æœŸæ—¶é—´çš„å­—ç¬¦ä¸²ï¼Œå¦‚æœä½¿ç”¨è€…æå‰ä¸çŸ¥é“å­˜å…¥çš„æ•°æ®æ˜¯ä»€ä¹ˆæ—¶åŒºï¼Œé‚£ä¹ˆè¿™ä¸ªå­—æ®µå°±æ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚ Tip 2 Excelå‡½æ•° å»é‡è®¡æ•°ï¼šSUMPRODUCT(1/COUNTIF(A2:A20,A2:A20)) VLOOKUP(è¦æŸ¥æ‰¾çš„å€¼,æŸ¥æ‰¾è¿”å›,è¿”å›æŸ¥æ‰¾åˆ°çš„ç¬¬å‡ åˆ—,æ˜¯å¦ç²¾ç¡®æŸ¥æ‰¾[1]) æ¦‚å¿µè½åœ°é¡µï¼Œä¹Ÿç§°ï¼šç€é™†é¡µã€å¼•å¯¼é¡µï¼Œæ˜¯æŒ‡è®¿é—®è€…åœ¨å…¶ä»–åœ°æ–¹çœ‹åˆ°å‘å‡ºçš„æŸä¸ªå…·æœ‰æ˜ç¡®ä¸»é¢˜çš„ç‰¹å®šè¥é”€æ´»åŠ¨â€”â€”é€šè¿‡Emailã€ç¤¾äº¤åª’ä½“æˆ–å¹¿å‘Šå‘å¸ƒçš„è¯±äººä¼˜æƒ ä¿¡æ¯ç­‰ï¼Œç‚¹å‡»åè¢«é“¾æ¥åˆ°ä½ ç½‘ç«™ä¸Šçš„ç¬¬ä¸€ä¸ªé¡µé¢ PRDï¼šäº§å“éœ€æ±‚æ–‡æ¡£ï¼Œäº§å“éœ€æ±‚æ–‡æ¡£æ˜¯å°†å•†ä¸šéœ€æ±‚æ–‡æ¡£ï¼ˆBRDï¼‰å’Œå¸‚åœºéœ€æ±‚æ–‡æ¡£ï¼ˆMRDï¼‰ç”¨æ›´åŠ ä¸“ä¸šçš„è¯­è¨€è¿›è¡Œæè¿°","categories":[{"name":"æ•°æ®åˆ†æ","slug":"æ•°æ®åˆ†æ","permalink":"https://shang.at/categories/æ•°æ®åˆ†æ/"}],"tags":[{"name":"æ•°æ®åˆ†æTips","slug":"æ•°æ®åˆ†æTips","permalink":"https://shang.at/tags/æ•°æ®åˆ†æTips/"}]},{"title":"Sparkå­¦ä¹ ç¬”è®°-çª—å£å‡½æ•°","slug":"Sparkå­¦ä¹ ç¬”è®°-çª—å£å‡½æ•°","date":"2019-03-12T02:15:03.000Z","updated":"2021-06-01T11:13:10.117Z","comments":true,"path":"post/Sparkå­¦ä¹ ç¬”è®°-çª—å£å‡½æ•°/","link":"","permalink":"https://shang.at/post/Sparkå­¦ä¹ ç¬”è®°-çª—å£å‡½æ•°/","excerpt":"","text":"åˆå§‹åŒ–ç¯å¢ƒ1234567891011from pyspark.sql import SparkSessionfrom pyspark.sql.functions import *from pyspark.sql import Windowfrom pyspark.sql.types import StructType, StringType, StructField, IntegerTypeschema = StructType([ StructField('shop_id', StringType()), StructField('date', StringType()), StructField('amount', IntegerType())]) 12345spark = SparkSession \\ .builder \\ .master('local[*]') \\ .enableHiveSupport() \\ .getOrCreate() 123456data = [ &#123;'shop_id': '10006', 'date': '201501120030', 'amount': 2313&#125;, &#123;'shop_id': '10006', 'date': '201501120100', 'amount': 23112&#125;, &#123;'shop_id': '10006', 'date': '201501120130', 'amount': 23112&#125;, &#123;'shop_id': '10006', 'date': '201501120200', 'amount': 24234&#125;, ] 1df = spark.createDataFrame(data, schema) 1df.printSchema() 1234root |-- shop_id: string (nullable = true) |-- date: string (nullable = true) |-- amount: integer (nullable = true) å…³äºå­çª—å£å­çª—å£éœ€è¦æŒ‡å®šä¸€ä¸ªè¾¹ç•Œï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼š ROWS between CURRENT ROW | UNBOUNDED PRECEDING | [num] PRECEDING AND UNBOUNDED FOLLOWING | [num] FOLLOWING| CURRENT ROW RANGE between [num] PRECEDING AND [num] FOLLOWING çª—å£çš„å«ä¹‰ ROWSæ˜¯ç‰©ç†çª—å£ï¼Œä»è¡Œæ•°ä¸Šæ§åˆ¶çª—å£çš„å°ºå¯¸çš„ï¼›RANGEæ˜¯é€»è¾‘çª—å£ï¼Œä»åˆ—å€¼ä¸Šæ§åˆ¶çª—å£çš„å°ºå¯¸ é€šå¸¸ä¼šç»“åˆorder byå­å¥ä½¿ç”¨ï¼Œå¦‚æœåœ¨order byå­å¥åé¢æ²¡æœ‰æŒ‡å®šçª—å£å­å¥ï¼Œåˆ™é»˜è®¤ä¸ºï¼šrows between unbounded preceding and current row 12345678910111213141516171819202122sparkä¸­å…³äºWindowå‡½æ•°çš„å­¦ä¹ åœ¨sparkä¸­æ¶‰åŠWindowå‡½æ•°çš„ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ä¸ªç±»å’Œä¸€ä¸ªColumnçš„æ–¹æ³•pyspark.sql.column.Column#over åœ¨çª—å£ä¸Šåº”ç”¨æŸä¸€ç§åˆ†æå‡½æ•°pyspark.sql.window.Window åˆ›å»ºWindowSpecçš„å·¥å…·ç±» pyspark.sql.window.Window.unboundedPreceding pyspark.sql.window.Window.unboundedFollowing pyspark.sql.window.Window.currentRow pyspark.sql.window.Window#partitionBy pyspark.sql.window.Window#orderBy pyspark.sql.window.Window#rowsBetween(start, end) pyspark.sql.window.Window#rangeBetween(start, end)pyspark.sql.window.WindowSpec çª—å£çš„è§„èŒƒpyspark.sql.window.Window#rowsBetween(start, end)å®šä¹‰çª—å£çš„è¾¹ç•Œï¼Œ[start, end]ï¼Œåœ¨è¾¹ç•Œå¤„æ˜¯é—­åŒºé—´startå’Œendéƒ½æ˜¯ç›¸å¯¹äºå½“å‰rowçš„ç›¸å¯¹ä½ç½®ï¼Œä¾‹å¦‚ï¼š- 0ï¼šå½“å‰row- -1ï¼šå½“å‰è¡Œçš„å‰1row- 5ï¼šå½“å‰è¡Œçš„å5row- (-1, 5)ï¼šçª—å£çš„èŒƒå›´ä¸ºï¼Œå½“å‰row+å½“å‰è¡Œçš„å‰1row+å½“å‰è¡Œçš„å5row = 7rows ä½¿ç”¨åœºæ™¯ç»Ÿè®¡æˆªæ­¢åˆ°å½“å‰æ—¶é—´æ®µçš„åº—é“ºç´¯è®¡é”€å”®é‡‘é¢123456df.withColumn( 't_amount', sum('amount').over(Window.partitionBy('shop_id').orderBy(asc('date')))).select( 'shop_id', 'date', 't_amount').show(50, truncate=False) åˆ†æï¼šæ ¹æ®shop_idåˆ†ç»„ï¼Œæ ¹æ®dateæ­£åºæ’åˆ—ï¼Œç”±äºorderByåé¢æ²¡æœ‰è¿½åŠ rowsBetween()ï¼Œåˆ™é»˜è®¤çš„rowsBetweenä¸ºï¼š[Window.unboundedPrecedingï¼ŒWindow.currentRow]ã€‚å³ä¼šç»Ÿè®¡æ ¹æ®dateæ’åºåï¼Œä»ç¬¬ä¸€è¡Œè®¡ç®—åˆ°å½“å‰è¡Œï¼Œä»è€Œè¾¾åˆ°äº†ç»Ÿè®¡æˆªæ­¢åˆ°å½“å‰æ—¶é—´æ®µçš„åº—é“ºç´¯è®¡é”€å”®é‡‘é¢çš„æ•ˆæœ ç»Ÿè®¡æ¯ä¸ªæ—¶é—´æ®µçš„é”€å”®å æ¯”123456df.withColumn( 't_amount', col('amount')/sum('amount').over(Window.partitionBy('shop_id'))).select( 'shop_id', 'date', 'amount','t_amount').show(50, truncate=False) åˆ†æï¼šæ ¹æ®shop_idåˆ†ç»„ï¼Œä¸æ’åºï¼Œçª—å£å¤§å°é»˜è®¤å°±æ˜¯æ•´ä¸ªåˆ†ç»„ã€‚ æ‰¾å‡º2ç‚¹çš„é”€å”®é‡‘é¢åŠå‰åŠå°æ—¶çš„é”€å”®é‡‘é¢å’Œå1ä¸ªå°æ—¶çš„é”€å”®é‡‘é¢1234567891011121314151617df.withColumn( 'pre_half_hour', lag('date', 1).over(Window.partitionBy('shop_id').orderBy(asc('date')))).withColumn( 'pre_half_hour_amount', lag('amount', 1).over(Window.partitionBy('shop_id').orderBy(asc('date')))).withColumn( 'follow_one_hour', lead('date', 2).over(Window.partitionBy('shop_id').orderBy(asc('date')))).withColumn( 'follow_one_hour_amount', lead('amount', 2).over(Window.partitionBy('shop_id').orderBy(asc('date')))).filter( col('date') == '201501120200').select( 'shop_id', 'date', 'amount','pre_half_hour', 'pre_half_hour_amount', 'follow_one_hour', 'follow_one_hour_amount').show(truncate=False) 12345+-------+------------+------+-------------+--------------------+---------------+----------------------+|shop_id|date |amount|pre_half_hour|pre_half_hour_amount|follow_one_hour|follow_one_hour_amount|+-------+------------+------+-------------+--------------------+---------------+----------------------+|10006 |201501120200|24234 |201501120130 |2342 |201501120300 |31232 |+-------+------------+------+-------------+--------------------+---------------+----------------------+ 123456åˆ†æï¼špyspark.sql.functions.lag(col, count=1, default=none)æ˜¯å–å‰Nè¡Œçš„å€¼pyspark.sql.functions.lead(col, count=1, default=none)æ˜¯å–åNè¡Œçš„å€¼ã€‚ æŒ‰ç…§é”€å”®é‡‘é¢è¿›è¡Œæ’åï¼Œé‡‘é¢æœ€å¤§çš„æ’æœ€å‰ï¼ˆlimitå¯ä»¥å–topnçš„æ•°ï¼‰123456df.withColumn( 'rn', dense_rank().over(Window.partitionBy('shop_id').orderBy(desc('amount')))).select( 'shop_id', 'date', 'amount', 'rn' ).show(50, truncate=False) 123456df.withColumn( 'rn', rank().over(Window.partitionBy('shop_id').orderBy(desc('amount')))).select( 'shop_id', 'date', 'amount', 'rn' ).show(50, truncate=False) 123456df.withColumn( 'rn', row_number().over(Window.partitionBy('shop_id').orderBy(desc('amount')))).select( 'shop_id', 'date', 'amount', 'rn' ).show(50, truncate=False) åˆ†æï¼šdense_rankå’Œrankéƒ½æ˜¯æ’åå‡½æ•°ï¼ŒåŒºåˆ«åœ¨äºdense_rankæ˜¯è¿ç»­æ’åï¼Œranké‡åˆ°æ’åå¹¶åˆ—æ—¶ï¼Œä¸‹ä¸€åˆ—æ’åè·³ç©ºã€‚row_numberæ˜¯åŠ è¡Œå·ï¼Œæ¬¡åºæ˜¯è¿ç»­çš„ï¼Œä¸ä¼šå­˜åœ¨é‡å¤çš„è¡Œå· æŒ‰é”€å”®é‡‘é¢æ’åºï¼Œå–å‡ºå‰20%çš„æ—¶é—´æ®µå’Œç›¸åº”é‡‘é¢123456df.withColumn( 'tile', ntile(5).over(Window.partitionBy('shop_id').orderBy(desc('amount')))).select( 'shop_id', 'date', 'amount', 'tile' ).show(50, truncate=False) åˆ†æï¼š NTILEå°±æ˜¯æŠŠæœ‰åºåˆ†åŒºä¸­çš„è¡Œåˆ†å‘åˆ°æŒ‡å®šæ•°æ®çš„ç»„ä¸­ï¼Œå„ä¸ªç»„æœ‰ç¼–å·ï¼Œç¼–å·ä»1å¼€å§‹ï¼Œå¯¹äºæ¯ä¸€è¡Œï¼ŒNTILEè¿”å›æ­¤è¡Œæ‰€å±çš„ç»„çš„ç¼–å· è®¾ç½®n=5ï¼Œé‚£ä¹ˆntileå°±ä¼šæŠŠæ’å¥½åºçš„æ•°æ®å‡åˆ†æˆnä¸ªç»„ï¼Œntileå‡½æ•°ä¼šè¿”å›æ¯æ¡æ•°æ®æ‰€åœ¨ç»„çš„ç»„ç¼–å·ï¼Œä»è€Œå¯ä»¥è¾¾åˆ°å–å‰ç™¾åˆ†æ¯”çš„æ•°æ® å†™åœ¨åé¢æ€è€ƒï¼šåœ¨ä½¿ç”¨row_numberå‡½æ•°çš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰æŒ‡å®šrowsBetweenï¼Œé‚£ä¹ˆé»˜è®¤åº”è¯¥æ˜¯rows between unbounded preceding and current rowã€‚ä½†æ˜¯ï¼Œç»“æœå´æ˜¯æŠŠç»„å†…çš„æ‰€æœ‰å…ƒç´ éƒ½è¿›è¡Œäº†æ ‡å· rowsBetweenåº”è¯¥æ˜¯é’ˆå¯¹äºå…·æœ‰èšåˆæ€§è´¨çš„å‡½æ•°èµ·ä½œç”¨","categories":[{"name":"Sparkå­¦ä¹ ","slug":"Sparkå­¦ä¹ ","permalink":"https://shang.at/categories/Sparkå­¦ä¹ /"}],"tags":[{"name":"çª—å£å‡½æ•°","slug":"çª—å£å‡½æ•°","permalink":"https://shang.at/tags/çª—å£å‡½æ•°/"}]},{"title":"Sparkå­¦ä¹ ç¬”è®°-unionæ–¹æ³•","slug":"Sparkå­¦ä¹ ç¬”è®°-unionæ–¹æ³•","date":"2019-03-12T01:53:56.000Z","updated":"2020-07-01T09:10:57.726Z","comments":true,"path":"post/Sparkå­¦ä¹ ç¬”è®°-unionæ–¹æ³•/","link":"","permalink":"https://shang.at/post/Sparkå­¦ä¹ ç¬”è®°-unionæ–¹æ³•/","excerpt":"","text":"æ–¹æ³•ç®€ä»‹pyspark.sql.dataframe.DataFrame#union(other) 1unionä¸¤ä¸ªdfï¼Œæ•ˆæœç›¸å½“äºunion all(pyspark.sql.dataframe.DataFrame#unionAllåœ¨2.0ä»¥åå°±è¢«Deprecatedäº†)ã€‚ unionæ–¹æ³•çš„ç‰¹ç‚¹æ˜¯ï¼š schemaä¼šä½¿ç”¨å‰é¢dfçš„schemaï¼Œ åªæœ‰ä¸¤ä¸ªæœ‰ç›¸åŒæ•°é‡åˆ—çš„dfæ‰èƒ½è¿›è¡Œunionï¼Œ unionçš„æ—¶å€™ä¼šæ ¹æ®åˆ—çš„é¡ºåºè¿›è¡Œunionï¼Œä¸å±æ€§åæ— å…³ æ¡ˆä¾‹æµ‹è¯•123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778from pyspark.sql import SparkSessionfrom pyspark.sql.functions import *spark = SparkSession \\ .builder \\ .master('local[*]') \\ .enableHiveSupport() \\ .getOrCreate() df1 = spark.createDataFrame([&#123;'name':'cc', 'age':24&#125;, &#123;'name':'aa', 'age':25&#125;])df1.printSchema() root |-- age: long (nullable = true) |-- name: string (nullable = true)df2 = spark.createDataFrame([&#123;'name1':'bb', 'age1':2&#125;, &#123;'name1':'dd', 'age1':3&#125;])df2.printSchema() root |-- age1: long (nullable = true) |-- name1: string (nullable = true)df1.union(df2) DataFrame[age: bigint, name: string]union_df = df1.union(df2)union_df.printSchema() root |-- age: long (nullable = true) |-- name: string (nullable = true)union_df.show() +---+----+ |age|name| +---+----+ | 24| cc| | 25| aa| | 2| bb| | 3| dd| +---+----+select_union_df = df1.select('name').union(df2.select('age1'))select_union_df.printSchema() root |-- name: string (nullable = true)select_union_df.show() +----+ |name| +----+ | cc| | aa| | 2| | 3| +----+select_union_df = df1.select('name', 'age').union(df2.select('age1')) pyspark.sql.utils.AnalysisException: \"Union can only be performed on tables with the same number of columns, but the first table has 2 columns and the second table has 1 columns;;\\n'Union\\n:- Project [name#1, age#0L]\\n: +- LogicalRDD [age#0L, name#1], false\\n+- Project [age1#4L]\\n +- LogicalRDD [age1#4L, name1#5], false\\n\"select_union_df = df1.select('age').union(df2.select('name1'))select_union_df.show() +---+ |age| +---+ | 24| | 25| | bb| | dd| +---+select_union_df.printSchema() root |-- age: string (nullable = true)select_union_df = df1.select('name', 'age').union(df2.select('age1', 'name1'))select_union_df.printSchema() root |-- name: string (nullable = true) |-- age: string (nullable = true)select_union_df.show() +----+---+ |name|age| +----+---+ | cc| 24| | aa| 25| | 2| bb| | 3| dd| +----+---+ å…¶ä»–æ¡ˆä¾‹è¦æƒ³å®ç°sqlä¸­unionçš„æ•ˆæœï¼Œéœ€è¦ç»“åˆdistinct()æ¥ä½¿ç”¨: 12345678910111213141516171819df1 = spark.createDataFrame([&#123;'name':'cc', 'age':24&#125;, &#123;'name':'aa', 'age':25&#125;])df2 = spark.createDataFrame([&#123;'name1':'cc', 'age1':24&#125;, &#123;'name1':'dd', 'age1':3&#125;])df1.union(df2).show() +---+----+ |age|name| +---+----+ | 24| cc| | 25| aa| | 24| cc| | 3| dd| +---+----+df1.union(df2).distinct().show() +---+----+ |age|name| +---+----+ | 24| cc| | 3| dd| | 25| aa| +---+----+","categories":[{"name":"Sparkå­¦ä¹ ","slug":"Sparkå­¦ä¹ ","permalink":"https://shang.at/categories/Sparkå­¦ä¹ /"}],"tags":[{"name":"union","slug":"union","permalink":"https://shang.at/tags/union/"}]},{"title":"Sparkå­¦ä¹ ç¬”è®°ä¸€","slug":"Sparkå­¦ä¹ ç¬”è®°ä¸€","date":"2019-03-10T10:45:03.000Z","updated":"2019-03-24T01:33:47.230Z","comments":true,"path":"post/Sparkå­¦ä¹ ç¬”è®°ä¸€/","link":"","permalink":"https://shang.at/post/Sparkå­¦ä¹ ç¬”è®°ä¸€/","excerpt":"","text":"ç‰ˆæœ¬ï¼špyspark 2.4.0 ä¸»è¦åŒ… pyspark pyspark.sql module pyspark.streaming module pyspark.ml package pyspark.mllib package pyspark pyspark.SparkConf(loadDefaults=True, _jvm=None, _jconf=None) æ˜¯sparkåº”ç”¨çš„é…ç½®ç±»ï¼Œé»˜è®¤loadDefaults=Trueï¼Œä¼šè‡ªåŠ¨åŠ è½½javaç³»ç»Ÿå‚æ•°ä¸­çš„spark.*çš„å‚æ•°ï¼Œ_jconfæ˜¯ä¸€ä¸ªå·²ç»å­˜åœ¨çš„sparkConfå¥æŸ„ ä¸»è¦apiï¼š setMaster() è®¾ç½®åº”ç”¨çš„æäº¤ç±»å‹ï¼šlocal|local[n]|local[*] or ä¸å¡«ï¼Œæœ¬åœ°æµ‹è¯•æ—¶å¯ä»¥å¡«localç³»åˆ—ï¼Œæäº¤åˆ°é›†ç¾¤è¿è¡Œæ—¶å¯ä»¥ä¸ç”¨å¡«ï¼Œæäº¤ä»»åŠ¡çš„æ—¶å€™ä¼šæ ¹æ®é›†ç¾¤çš„é…ç½®ï¼Œè‡ªåŠ¨é€‰æ‹©æäº¤çš„ç±»å‹ï¼šstandaloneæˆ–è€…yarnæ¨¡å¼ setAppName() è®¾ç½®åº”ç”¨çš„åç§° pyspark.SparkContext(master=None, appName=None, sparkHome=None, pyFiles=None, environment=None, batchSize=0, serializer=PickleSerializer(), conf=None, gateway=None, jsc=None, profiler_cls=) sparkåº”ç”¨ä¸Šä¸‹æ–‡ï¼Œæ˜¯sparkåº”ç”¨çš„ä¸»è¦å…¥å£ã€‚ä»£è¡¨äº†ä¸spark clusterçš„é“¾æ¥ï¼Œå¯ä»¥ç”¨æ¥åœ¨é›†ç¾¤ä¸­åˆ›å»ºRDDå’Œå¹¿æ’­å˜é‡ã€‚ ä¸»è¦apiè®²è§£ï¼š addFile(self, path, recursive=False) ä¸ºspark jobæ·»åŠ ä¸€ä¸ªå¯ä¸‹è½½æ–‡ä»¶ï¼Œsparkçš„æ¯ä¸€ä¸ªnodeéƒ½ä¼šä¸‹è½½ä¸€ä»½ï¼Œå¯ä»¥æ˜¯local fileã€hdfs fileã€http fileã€https fileæˆ–ftp fileã€‚å¯ä»¥ä½¿ç”¨SparkFilesé€šè¿‡æ–‡ä»¶åæ¥è¯»å–è®¾ç½®çš„æ–‡ä»¶ï¼Œ æ³¨æ„ï¼Œæ¯ä¸ªåº”ç”¨ä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶ååªèƒ½è®¾ç½®ä¸€æ¬¡ã€‚recursiveè®¾ç½®ä¸ºTrueæ—¶ï¼Œä¼ é€’çš„pathå¯ä»¥æ˜¯ç›®å½•ï¼Œä½†æ˜¯ç›®å‰åªæ”¯æŒhdfs fileçš„åœºæ™¯ 12345678910111213141516171819202122232425262728import osfrom tempfile import gettempdirfrom pyspark import SparkConffrom pyspark import SparkContextif __name__ == '__main__': from pyspark import SparkFiles conf = SparkConf() conf.setMaster(\"local\").setAppName(\"My app\") sc = SparkContext(conf=conf) path = os.path.join(gettempdir(), \"test.txt\") print(path) with open(path, \"w\") as testFile: _ = testFile.write(\"100\") sc.addFile(path) def func(iterator): with open(SparkFiles.get('test.txt')) as testFile: fileVal = int(testFile.readline()) print(fileVal) return [x * fileVal for x in iterator] result = sc.parallelize([1, 2, 3, 4]).mapPartitions(func).collect() print(result) accumulator(value, accum_param=None) åˆ›å»ºä¸€ä¸ªç´¯åŠ å™¨ã€‚ä¸€ä¸ªå…¨å±€å…±äº«çš„å¯ä»¥è¿›è¡Œç´¯åŠ çš„å˜é‡ï¼Œåªèƒ½åœ¨workerä¸Šè¿›è¡Œupdateæ“ä½œï¼Œåœ¨driverä¸Šè·å–ç»“æœå€¼å¾—æ“ä½œã€‚å€¼ç±»å‹é»˜è®¤æ˜¯intå’Œfloatç±»å‹ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨accum_paramå‚æ•°è®¾ç½®ä¸ºè‡ªå®šä¹‰çš„æ•°æ®ç±»å‹ 1# ä»£ç ååŠ  broadcast(value) åœ¨é›†ç¾¤ä¸­å¹¿æ’­ä¸€ä¸ªåªè¯»çš„å€¼ï¼Œè¿”å›ä¸€ä¸ªBroadcastå¯¹è±¡ï¼Œä»¥ä¾¿åœ¨åˆ†å¸ƒå¼æ–¹æ³•ä¸­è°ƒç”¨ã€‚è¢«å¹¿æ’­çš„å˜é‡åªä¼šè¢«å‘é€åˆ°é›†ç¾¤çš„å„ä¸ªnodeä¸Šä¸€æ¬¡","categories":[{"name":"Spark","slug":"Spark","permalink":"https://shang.at/categories/Spark/"}],"tags":[{"name":"pysparkå®˜æ–¹æ–‡æ¡£å­¦ä¹ ","slug":"pysparkå®˜æ–¹æ–‡æ¡£å­¦ä¹ ","permalink":"https://shang.at/tags/pysparkå®˜æ–¹æ–‡æ¡£å­¦ä¹ /"}]},{"title":"æ•°æ®ä»“åº“å­¦ä¹ ç¬”è®°äºŒ-å»ºæ¨¡æµç¨‹","slug":"æ•°æ®ä»“åº“å­¦ä¹ ç¬”è®°äºŒ-å»ºæ¨¡æµç¨‹","date":"2019-03-03T11:36:50.000Z","updated":"2020-12-11T08:13:52.504Z","comments":true,"path":"post/æ•°æ®ä»“åº“å­¦ä¹ ç¬”è®°äºŒ-å»ºæ¨¡æµç¨‹/","link":"","permalink":"https://shang.at/post/æ•°æ®ä»“åº“å­¦ä¹ ç¬”è®°äºŒ-å»ºæ¨¡æµç¨‹/","excerpt":"","text":"æ•°æ®å»ºæ¨¡çš„åŸºæœ¬æµç¨‹åœ¨å»ºæ¨¡çš„ä¸åŒé˜¶æ®µï¼Œå°†æ•°æ®æ¨¡å‹åˆ†ä¸ºä¸‰ä¸ªå±‚æ¬¡ï¼Œæ¯å±‚çš„ä½œç”¨å„ä¸ç›¸åŒã€‚ æ¦‚å¿µæ¨¡å‹:ç¡®å®šç³»ç»Ÿçš„æ ¸å¿ƒä»¥åŠåˆ’æ¸…ç³»ç»ŸèŒƒå›´å’Œ è¾¹ç•Œ é€»è¾‘æ¨¡å‹:æ¢³ç†ä¸šåŠ¡è§„åˆ™ä»¥åŠå¯¹æ¦‚å¿µæ¨¡å‹çš„æ±‚ç²¾ ç‰©ç†æ¨¡å‹:ä»æ€§èƒ½ã€è®¿é—®ã€å¼€å‘ç­‰å¤šæ–¹é¢è€ƒè™‘ï¼Œ åšç³»ç»Ÿçš„å®ç° æ¦‚å¿µæ¨¡å‹æ¦‚å¿µå»ºæ¨¡å°è´´å£«1 æ³¨é‡å…¨å±€çš„ç†è§£è€Œéç»†èŠ‚ åœ¨æ¦‚å¿µæ¨¡å‹é˜¶æ®µï¼Œå³éœ€è¦å¯¹æ•´ä½“æ¶æ„åšæ€è€ƒ æ¦‚å¿µæ¨¡å‹é€šå¸¸æ˜¯è‡ªä¸Šè€Œä¸‹çš„æ¨¡å¼ï¼Œé€šè¿‡ä¼šè®®ç­‰æ¨¡å¼åå¤æ²Ÿé€šï¼Œæ¾„æ¸…éœ€æ±‚ åœ¨æ­¤é˜¶æ®µï¼Œåº”ç²—ç•¥åœ°ä¼°ç®—å‡ºæ•´ä¸ªé¡¹ç›®éœ€è¦çš„æ—¶é—´ä»¥åŠé¡¹ç›®è®¡åˆ’è‰æ¡ˆ æ ¹æ®è®¡åˆ’ç²—ç•¥åœ°ä¼°ç®—å‡ºé¡¹ç›®çš„è´¹ç”¨ æ˜¯æ•°æ®æ¨¡å‹å·¥ç¨‹å¸ˆä¸å®¢æˆ·æ²Ÿé€šçš„ç ´å†°ä¹‹æ—…ï¼Œä½¿ä»–ä»¬åœ¨æ­¤æœŸé—´è¾¾æˆå…±è¯†å¹¶å¥ å®šæœªæ¥è‰¯å¥½çš„æ²Ÿé€šåŸºç¡€ä»¥åŠç§äººå…³ç³» å‡ºå“çš„æ¦‚å¿µæ¨¡å‹å¯ä»¥å¸®åŠ©åˆ’å®šç³»ç»Ÿè¾¹ç•Œä»¥åŠé¿å…æ–¹å‘æ€§çš„é”™è¯¯ å•†ä¸šä¸»å¯¼ï¼Œç›¸æ¯”æŠ€æœ¯ä¸“å®¶è€Œè¨€ï¼Œæ›´éœ€è¦å•†ä¸šä¸“å®¶ æ˜¯æœªæ¥é€»è¾‘æ¨¡å‹çš„æ²Ÿé€šåŸºç¡€ï¼Œä»¥åŠé€æ­¥æ±‚ç²¾çš„ä¾æ® æ¦‚å¿µæ¨¡å‹äº¤ä»˜å“é€šå¸¸å…·å¤‡å¦‚ä¸‹ç‰¹ç‚¹: ä¸å®¢æˆ·ä¸€è‡´çš„å•†ä¸šè¯­è¨€ å°½é‡ä¸€é¡µçº¸æè¿°æ¸…æ¥šæ•´ä¸ªæ¨¡å‹ é€šå¸¸ç”¨å®ä½“å…³ç³»å‹å›¾è¡¨ç¤ºï¼Œä½†ä¸éœ€æ·»åŠ å®ä½“çš„å±æ€§ å…è®¸å¤šå¯¹å¤šçš„å…³ç³»å­˜åœ¨ é€»è¾‘æ¨¡å‹é€»è¾‘å»ºæ¨¡å°æç¤º1 åº”æ›´ç²¾ç¡®ä¼°ç®—å‡ºæ•´ä¸ªé¡¹ç›®éœ€è¦çš„æ—¶é—´ä»¥åŠé¡¹ç›®è®¡åˆ’è‰æ¡ˆ å¹¶ä¸”æ ¹æ®è®¡åˆ’æ›´ç²¾ç¡®åœ°ä¼°ç®—å‡ºé¡¹ç›®çš„è´¹ç”¨ å½“å®ä½“æ•°é‡è¶…è¿‡100æ—¶ï¼Œéœ€è¦å®šä¹‰æœ¯è¯­è¡¨ è§„èŒƒåŒ– å…ˆè§„èŒƒåŒ–å†é€†è§„èŒƒåŒ–ï¼Œä¸å¯ä¸€æ­¥åˆ°ä½ ä¸å¯ç¼ºå°‘çº¦æŸçš„å®šä¹‰ ä½¿ç”¨CASEå·¥å…·åšé€»è¾‘æ¨¡å‹ å¤šå¯¹å¤šå…³ç³»éœ€è¦è§£å†³ éœ€è¦åŒçº§è¯„å®¡(Peer Review) ç¡®å®šå¯ä¿¡èµ–æ•°æ®æºï¼Œå…³é”®å±æ€§éœ€ç”¨çœŸå®æ•°æ®éªŒè¯ åº”ç”¨æˆç†Ÿçš„å»ºæ¨¡æ¨¡å¼(Pattern) ä¸€å®šç¨‹åº¦çš„æŠ½è±¡åŒ–ï¼Œå†³å®šäº†æœªæ¥æ¨¡å‹çš„å¼¹æ€§ é«˜è´¨é‡çš„æ¨¡å‹å®šä¹‰ é‡è¦å…³è”å…³ç³»éœ€è¦å¼ºåˆ¶å»ºç«‹ ä¸æ¦‚å¿µæ¨¡å‹ä¿æŒä¸€è‡´ æ³¨æ„æ¨¡å‹çš„ç‰ˆæœ¬ç®¡ç† éå¸¸éå¸¸æ³¨æ„ç»†èŠ‚ æ•°æ®åº“ä¸“å®¶æ·±åº¦ä»‹å…¥ å æ®æ•´ä¸ªæ•°æ®å»ºæ¨¡80%ä»¥ä¸Šæ—¶é—´ ä¸è¦å¿½è§†å±æ€§çš„é•¿åº¦å®šä¹‰å’Œçº¦æŸå®šä¹‰ ä¸è¦å¿½è§†å±æ€§çš„é»˜è®¤å€¼(Default Value) ä½¿ç”¨æ§åˆ¶æ•°æ®èŒƒå›´çš„åŸŸ(Domain) é€»è¾‘å»ºæ¨¡äº¤ä»˜å“çš„ç‰¹ç‚¹ è¦åƒä¸€æœ¬ä¹¦ï¼Œè€Œéä¸€é¡µçº¸ æ‰€æœ‰å®ä½“å±æ€§å‡éœ€æ·»åŠ  å®ä½“é—´å…³ç³»è¦æ¸…æ™°æè¿° ä½¿ç”¨æœ¯è¯­è¡¨ éµå¾ªå‘½åè§„èŒƒ é‡‡ç”¨CASEå·¥å…·åˆ›å»ºé¡¹ç›®æ–‡ä»¶ å¯¹å„ä¸ªå®ä½“å¿…é¡»æœ‰æ¸…æ™°æè¿° å¯¹å…³é”®å±æ€§å¿…é¡»æœ‰æ¸…æ™°æè¿° ç‰©ç†æ¨¡å‹ç‰©ç†å»ºæ¨¡å°è´´å£«1 ä½¿ç”¨CASEå·¥å…·ç”±é€»è¾‘æ¨¡å‹è‡ªåŠ¨ç”Ÿæˆ åº”ç”¨æœ¯è¯­è¡¨è‡ªåŠ¨è½¬æ¢ç”Ÿæˆå­—æ®µåç§° å¯¹è¡¨ç©ºé—´ã€ç´¢å¼•ã€è§†å›¾ã€ç‰©åŒ–è§†å›¾ã€ä¸»é”®ã€å¤–é”®ç­‰éƒ½æœ‰å‘½åè§„åˆ™ é€†è§„èŒƒåŒ–åœ¨é€»è¾‘å±‚å®Œæˆï¼Œè€Œéæœ¬å±‚ æ•°æ®åº“DBAæ·±åº¦ä»‹å…¥ï¼Œéœ€è¦DBAçš„è¯„å®¡(Peer Review) å’Œæ•°æ®åº“çš„DDLä¿æŒä¸€è‡´ æ³¨æ„ç‰ˆæœ¬ç®¡ç† æ³¨æ„å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ä¸‰ä¸ªä¸åŒç‰ˆæœ¬çš„æ¨¡å‹ç®¡ç† æ³¨æ„æ€§èƒ½ ä¼°ç®—æ•°æ®è§„æ¨¡ è€ƒè™‘æ•°æ®å½’æ¡£ å……åˆ†è€ƒè™‘æœªæ¥ä½¿ç”¨æ•°æ®åº“çš„ä¼˜ç‚¹å’Œç¼ºç‚¹ ç‰©ç†å»ºæ¨¡äº¤ä»˜å“çš„ç‰¹ç‚¹ è‡ªåŠ¨ç”ŸæˆåŸºç¡€åº“è¡¨ç»“æ„ï¼Œä¹‹åé€‚åº¦æ‰‹åŠ¨è°ƒæ•´ ä¸æœªæ¥è¦ä½¿ç”¨çš„æ•°æ®åº“ç±»å‹æ¯æ¯ç›¸å…³ ç”Ÿæˆæ•°æ®å­—å…¸å¹¶å‘å¸ƒ å¯ç›´æ¥ç”¨äºç”ŸæˆDDL DDLä¸­æ³¨æ„æ³¨é‡Šçš„ç”Ÿæˆ å¦‚ä½•è¿›è¡Œé«˜è´¨é‡æ•°æ®å»ºæ¨¡ä»€ä¹ˆæ ·çš„æ¨¡å‹ç®—æ˜¯é«˜è´¨é‡æ•°æ®æ¨¡å‹? å¯¹çœŸå®ä¸–ç•Œçš„æŠ½è±¡æ­£ç¡®è€Œå®Œæ•´ ç”¨å»ºæ¨¡è¯­è¨€è¡¨è¾¾æ¸…æ™°è€Œå‡†ç¡® æ¡†æ¶ç¨³å®šä¸”çµæ´»ï¼Œæ»¡è¶³å½“ä¸‹çš„éœ€æ±‚å¹¶èƒ½å¤Ÿä¸€å®šç¨‹åº¦å®¹çº³æœªæ¥çš„å˜åŒ– æ ¹æ®éœ€æ±‚å°½å¯èƒ½å‡å°‘æ•°æ®å†—ä½™ å……åˆ†è€ƒè™‘æ½œåœ¨çš„æ€§èƒ½é—®é¢˜ ä»ä¼ä¸šå…¨å±€çš„è§†è§’å‡ºå‘æ„ç­‘æ¨¡å‹","categories":[{"name":"æ•°æ®ä»“åº“","slug":"æ•°æ®ä»“åº“","permalink":"https://shang.at/categories/æ•°æ®ä»“åº“/"}],"tags":[]},{"title":"æ•°æ®ä»“åº“å­¦ä¹ ç¬”è®°äºŒ-é‡è¦æ„ä¹‰","slug":"æ•°æ®ä»“åº“å­¦ä¹ ç¬”è®°äºŒ-é‡è¦æ„ä¹‰","date":"2019-03-03T10:55:58.000Z","updated":"2020-12-11T08:14:13.139Z","comments":true,"path":"post/æ•°æ®ä»“åº“å­¦ä¹ ç¬”è®°äºŒ-é‡è¦æ„ä¹‰/","link":"","permalink":"https://shang.at/post/æ•°æ®ä»“åº“å­¦ä¹ ç¬”è®°äºŒ-é‡è¦æ„ä¹‰/","excerpt":"","text":"æ•°æ®æ—¶ä»£çš„æ¼”åŒ–DIKWdataæ•°æ® + informationä¿¡æ¯ + knowledgeçŸ¥è¯† + wisdomæ™ºæ…§ æè¿°æ•°æ®çš„æ•°æ®è¢«ç§°ä¸ºå…ƒæ•°æ®(metadata) ä¿¡æ¯ï¼ˆinformationï¼‰= å…ƒæ•°æ®ï¼ˆmetadataï¼‰+æ•°æ®ï¼ˆdataï¼‰ ä»€ä¹ˆæ˜¯æ•°æ®æ¨¡å‹æ•°æ®æ¨¡å‹å®é™…ä¸Šå°±æ˜¯ä¸ºäº†è£…è½½æ•°æ®ï¼Œç”¨å…ƒæ•°æ®æ­å»ºèµ·æ¥çš„æ¡†å­ æ•°æ®æ¨¡å‹æ˜¯å°†æ•°æ®å…ƒç´ ä»¥æ ‡å‡†åŒ–çš„æ¨¡å¼ç»„ç»‡èµ·æ¥, ç”¨æ¥æ¨¡æ‹Ÿç°å®ä¸–ç•Œçš„ä¿¡æ¯æ¡†æ¶è“å›¾ã€‚ æ•°æ®æ¨¡å‹çš„è¦æ±‚: ç›´è§‚åœ°æ¨¡æ‹Ÿä¸–ç•Œ å®¹æ˜“ä¸ºäººæ‰€ç†è§£ ä¾¿äºè®¡ç®—æœºå®ç° æ•°æ®æ¨¡å‹æ˜¯æ•´ä¸ªæ•°æ®åº”ç”¨çš„åŸºçŸ³ï¼Œç‰µä¸€å‘è€ŒåŠ¨å…¨èº«ã€‚æ•°æ®æ¨¡å‹çš„å°å°æ”¹åŠ¨å°†ä¼šå¯¼è‡´ä¸Šå±‚æ•°æ®åº”ç”¨çš„å¤§å¹…åº¦å˜åŒ– å»ºè®¾é«˜è´¨é‡æ•°æ®æ¨¡å‹çš„æ„ä¹‰ä½è´¨é‡æ•°æ®æ¨¡å‹çš„åå®—ç½ª æ²¡æœ‰å‡†ç¡®çš„æ•è·åˆ°éœ€æ±‚ æ•°æ®æ¨¡å‹ä¸å®Œæ•´ å„å±‚æ¨¡å‹ä¸å…¶æ‰®æ¼”è§’è‰²ä¸åŒ¹é… æ•°æ®ç»“æ„ä¸åˆç† æŠ½è±¡åŒ–ä¸å¤Ÿï¼Œé€ æˆæ¨¡å‹ä¸çµæ´» æ²¡æœ‰æˆ–è€…ä¸éµå¾ªå‘½åè§„èŒƒ ç¼ºå°‘æ•°æ®æ¨¡å‹çš„å®šä¹‰å’Œæè¿° æ•°æ®æ¨¡å‹å¯è¯»æ€§å·® å…ƒæ•°æ®ä¸æ•°æ®ä¸åŒ¹é… æ•°æ®æ¨¡å‹ä¸ä¼ä¸šæ ‡å‡†ä¸ä¸€è‡´ ä½è´¨é‡æ•°æ®æ¨¡å‹çš„å½±å“ å¤§é‡ä¿®æ”¹å’Œé‡åš é‡å¤å»ºè®¾ çŸ¥è¯†ä¸¢å¤± ä¸‹æ¸¸å¼€å‘å›°éš¾ é«˜æˆæœ¬ æ•°æ®è´¨é‡ä½ä¸‹ æ–°ä¸šåŠ¡æ— æ³•å±•å¼€ æ„ä¹‰","categories":[{"name":"æ•°æ®ä»“åº“","slug":"æ•°æ®ä»“åº“","permalink":"https://shang.at/categories/æ•°æ®ä»“åº“/"}],"tags":[]},{"title":"æ•°æ®ä»“åº“å­¦ä¹ ç¬”è®°ä¸€","slug":"æ•°æ®ä»“åº“å­¦ä¹ ç¬”è®°ä¸€","date":"2019-03-03T10:24:23.000Z","updated":"2020-12-11T08:14:35.221Z","comments":true,"path":"post/æ•°æ®ä»“åº“å­¦ä¹ ç¬”è®°ä¸€/","link":"","permalink":"https://shang.at/post/æ•°æ®ä»“åº“å­¦ä¹ ç¬”è®°ä¸€/","excerpt":"","text":"å­¦ä¹ è·¯çº¿ï¼š","categories":[{"name":"æ•°æ®ä»“åº“","slug":"æ•°æ®ä»“åº“","permalink":"https://shang.at/categories/æ•°æ®ä»“åº“/"}],"tags":[]},{"title":"æ•°æ®ç»“æ„å­¦ä¹ ç¬”è®°äºŒ-å¤æ‚åº¦åˆ†æ","slug":"æ•°æ®ç»“æ„å­¦ä¹ ç¬”è®°äºŒ-å¤æ‚åº¦åˆ†æ","date":"2019-03-03T10:22:47.000Z","updated":"2020-04-10T00:41:06.625Z","comments":true,"path":"post/æ•°æ®ç»“æ„å­¦ä¹ ç¬”è®°äºŒ-å¤æ‚åº¦åˆ†æ/","link":"","permalink":"https://shang.at/post/æ•°æ®ç»“æ„å­¦ä¹ ç¬”è®°äºŒ-å¤æ‚åº¦åˆ†æ/","excerpt":"","text":"æ—¶é—´å¤æ‚åº¦ é€šå¸¸ä½¿ç”¨å¤§Oæ—¶é—´å¤æ‚åº¦è¡¨ç¤ºæ³•ï¼šå®ƒè¡¨ç¤ºäº†ä»£ç æ‰§è¡Œæ—¶é—´éšæ•°æ®è§„æ¨¡å¢é•¿çš„å˜åŒ–è¶‹åŠ¿ï¼Œ äº¦å¯ç§°ä¸º æ¸è¿›å¼æ—¶é—´å¤æ‚åº¦ å‡ ç§å¸¸è§æ—¶é—´å¤æ‚åº¦å®ä¾‹åˆ†æ å„ç§æ—¶é—´å¤æ‚åº¦æ‰§è¡Œæ—¶é—´æ¯”è¾ƒ æ•…å¯ä»¥çœ‹å‡ºæ¥O(logn)çš„ç®—æ³•è¦æ¯”O(n)çš„ç®—æ³•æ•ˆç‡ä¸Šå¿«ä¸Šä¸å°‘ å¸¸è§æ’åºç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ ç©ºé—´å¤æ‚åº¦ äº¦å¯ç§°ä¸º æ¸è¿›ç©ºé—´å¤æ‚åº¦ï¼Œè¡¨ç¤ºç®—æ³•çš„å­˜å‚¨ç©ºé—´ä¸æ•°æ®è§„æ¨¡ä¹‹é—´çš„å¢é•¿å…³ç³» ç©ºé—´å¤æ‚åº¦åŸºæœ¬å°±åªæœ‰O(1)ã€O(n)ã€O(n^2) æ—¶é—´å¤æ‚åº¦è¿›é˜¶å®é™…ä¸Šæˆ‘ä»¬å‰é¢è¯´çš„å¤§Oè¡¨ç¤ºæ³•åªæ˜¯ä¸€ä¸ªåˆçº§çš„åˆ¤æ–­æ–¹å¼ï¼Œæ­¤å¤–è¿˜æœ‰æœ€å¥½æƒ…å†µæ—¶é—´å¤æ‚åº¦ã€æœ€åæƒ…å†µæ—¶é—´å¤æ‚åº¦ã€å¹³å‡æ—¶é—´å¤æ‚åº¦ã€å‡æ‘Šæ—¶é—´å¤æ‚åº¦ã€‚ åœ¨å¤§éƒ¨åˆ†çš„æ—¶é—´å¤§Oè¡¨ç¤ºæ³•å·²ç»èƒ½å¤Ÿåˆ†è¾¨å‡ºå„ç§ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦äº†ã€‚åªæœ‰åœ¨ç‰¹æ®Šæƒ…å†µä¸‹ï¼ˆåŒä¸€å—ä»£ç (æˆ–åˆ†æå‡ºçš„ç›¸åŒçš„å¤§Oç­‰çº§)åœ¨ä¸åŒçš„æƒ…å†µä¸‹ï¼Œæ—¶é—´å¤æ‚åº¦æœ‰é‡çº§çš„å·®è·ï¼‰ï¼Œæ‰éœ€è¦ä½¿ç”¨æœ€å¥½ã€æœ€åã€å¹³å‡ä¸‰ç§æ–¹æ³•æ¥åŒºåˆ†ã€‚å‡æ‘Šçš„æƒ…å†µå°±æ›´åŠ ç‰¹æ®Šäº†ï¼Œæ¯”å¦‚å‘æ•°ç»„åŠ å…¥ä¸€ä¸ªå…ƒç´ ï¼Œå½“æ•°ç»„é•¿åº¦ä¸è¶³æ—¶ï¼Œæ‰©å……æ•°ç»„å†æ·»åŠ å…ƒç´ ã€‚","categories":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://shang.at/categories/æ•°æ®ç»“æ„ä¸ç®—æ³•/"}],"tags":[{"name":"å¤æ‚åº¦åˆ†æ","slug":"å¤æ‚åº¦åˆ†æ","permalink":"https://shang.at/tags/å¤æ‚åº¦åˆ†æ/"}]},{"title":"æ•°æ®ç»“æ„å­¦ä¹ ç¬”è®°ä¸€","slug":"æ•°æ®ç»“æ„å­¦ä¹ ç¬”è®°ä¸€","date":"2019-03-03T09:34:30.000Z","updated":"2020-07-01T09:21:51.746Z","comments":true,"path":"post/æ•°æ®ç»“æ„å­¦ä¹ ç¬”è®°ä¸€/","link":"","permalink":"https://shang.at/post/æ•°æ®ç»“æ„å­¦ä¹ ç¬”è®°ä¸€/","excerpt":"","text":"åŸºç¡€çŸ¥è¯†æ•°ç»„ä¸ºä»€ä¹ˆä»0å¼€å§‹ç¼–å· æ•°ç»„çš„éšæœºè®¿é—®çš„å¯»å€å…¬å¼ï¼š a[i]_address = base_address + i * data_type_size å¸¸è§æ•°æ®ç±»å‹çš„å ç”¨å†…å­˜å¤§å° ç±»å‹ å­—èŠ‚å¤§å° ä½æ•° è¡¨ç¤ºèŒƒå›´ æœ€å¤§å­˜å‚¨é‡ byte 1byte 8bits -2^7~2^7-1 2^8-1=255 int 4bytes 4*8bits -2^{31}~2^{31}-1 short 2bytes 2*8bits -2^{15}~2^{15}-1 long 8bytes 8*8bits -2^{63}~2^{63}-1 float 4bytes 4*8bits double 8bytes 8*8bits char 2bytes 2*bits äºŒè¿›åˆ¶-åè¿›åˆ¶è®¡ç®—æœºå†…éƒ¨çš„äºŒè¿›åˆ¶è¡¨ç¤ºæ³•ï¼šåŸç ã€åç ã€è¡¥ç  æ•°ç»„é“¾è¡¨æ ˆé˜Ÿåˆ—è·³è¡¨æ•£åˆ—è¡¨å…³é”®ç‚¹ æ•£åˆ—æ€æƒ³ æ•£åˆ—è¡¨æ˜¯åˆ©ç”¨äº†æ•°ç»„å¯ä»¥æ ¹æ®ä¸‹æ ‡éšæœºè®¿é—®çš„ç‰¹æ€§ï¼Œè€Œäº§ç”Ÿçš„ä¸€ç§é«˜æ€§èƒ½çš„æ•°æ®ç»“æ„(æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(1))ã€‚æ•£åˆ—è¡¨å…¶å®å°±æ˜¯æ•°ç»„çš„ä¸€ç§æ‹“å±•ï¼Œæ˜¯ç”±æ•°ç»„æ¼”åŒ–è€Œæ¥ã€‚ å…¶å…³é”®çš„æ¦‚å¿µæœ‰ é”®-keyã€ å°†é”®æ˜ å°„åˆ°æ•°ç»„ä¸‹æ ‡çš„æ–¹æ³•-æ•£åˆ—å‡½æ•°(å“ˆå¸Œå‡½æ•°)ã€ æ•£åˆ—å‡½æ•°è®¡ç®—æ¥çš„å€¼-æ•£åˆ—å€¼(å“ˆå¸Œå€¼) æ•£åˆ—å‡½æ•° æ•£åˆ—å†²çª å¼€æ”¾å¯»å€ é“¾è¡¨æ³• è¿›é˜¶ï¼šé“¾è¡¨ä½¿ç”¨çº¢é»‘æ ‘æˆ–è€…è·³è¡¨å®ç° å…·ä½“å®ç°|æ‰“é€ ä¸€ä¸ªå·¥ä¸šçº§æ•£åˆ—è¡¨ æ•£åˆ—å‡½æ•° è£…è½½å› å­ æ•£åˆ—å†²çªè§£å†³æ–¹æ³• äºŒå‰æ ‘çº¢é»‘æ ‘é€’å½’æ ‘å †å›¾Trieæ•°ACè‡ªåŠ¨æœºä½å›¾å¸ƒéš†è¿‡æ»¤å™¨B+æ•°ç´¢å¼•","categories":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://shang.at/categories/æ•°æ®ç»“æ„ä¸ç®—æ³•/"}],"tags":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://shang.at/tags/æ•°æ®ç»“æ„/"}]},{"title":"Pythonæ•°æ®ç§‘å­¦å­¦ä¹ ç¬”è®°ä¸€","slug":"Pythonæ•°æ®ç§‘å­¦å­¦ä¹ ç¬”è®°ä¸€","date":"2019-03-03T09:19:14.000Z","updated":"2019-08-03T11:51:48.061Z","comments":true,"path":"post/Pythonæ•°æ®ç§‘å­¦å­¦ä¹ ç¬”è®°ä¸€/","link":"","permalink":"https://shang.at/post/Pythonæ•°æ®ç§‘å­¦å­¦ä¹ ç¬”è®°ä¸€/","excerpt":"","text":"æè¿°æ€§ç»Ÿè®¡å’Œæ¢ç´¢å‹æ•°æ®åˆ†æå˜é‡ç±»å‹ åä¹‰å˜é‡ ç­‰çº§å˜é‡ è¿ç»­å˜é‡ æè¿°åä¹‰å˜é‡çš„åˆ†å¸ƒä¸¤ä¸ªç»Ÿè®¡é‡ é¢‘æ•° ç™¾åˆ†æ¯” å¯è§†åŒ– æŸ±çŠ¶å›¾","categories":[{"name":"Pythonæ•°æ®åˆ†æ","slug":"Pythonæ•°æ®åˆ†æ","permalink":"https://shang.at/categories/Pythonæ•°æ®åˆ†æ/"}],"tags":[{"name":"æè¿°æ€§ç»Ÿè®¡å’Œæ¢ç´¢å‹æ•°æ®åˆ†æ","slug":"æè¿°æ€§ç»Ÿè®¡å’Œæ¢ç´¢å‹æ•°æ®åˆ†æ","permalink":"https://shang.at/tags/æè¿°æ€§ç»Ÿè®¡å’Œæ¢ç´¢å‹æ•°æ®åˆ†æ/"}]},{"title":"è®°ä¸€æ¬¡çº¿ä¸ŠJVMé—®é¢˜è°ƒè¯•","slug":"è®°ä¸€æ¬¡çº¿ä¸ŠJVMé—®é¢˜è°ƒè¯•","date":"2019-02-27T03:21:32.000Z","updated":"2020-06-03T03:02:27.348Z","comments":true,"path":"post/è®°ä¸€æ¬¡çº¿ä¸ŠJVMé—®é¢˜è°ƒè¯•/","link":"","permalink":"https://shang.at/post/è®°ä¸€æ¬¡çº¿ä¸ŠJVMé—®é¢˜è°ƒè¯•/","excerpt":"å‘ç°javaè¿›ç¨‹ ä½¿ç”¨linuxå‘½ä»¤ï¼šps 1234ps -ef | grep prcessName[root@YZSJHL81-35 ~]# ps -ef | grep Bootstraproot 118271 1 99 00:10 ? 3-16:08:07 Bootstrap startroot 197682 197016 0 17:08 pts/0 00:00:00 grep Bootstrap ä½¿ç”¨javaè‡ªå¸¦çš„æ£€æµ‹å·¥å…· jps 123[root@YZSJHL81-35 ~]# jps118271 Bootstrap197101 Jps","text":"å‘ç°javaè¿›ç¨‹ ä½¿ç”¨linuxå‘½ä»¤ï¼šps 1234ps -ef | grep prcessName[root@YZSJHL81-35 ~]# ps -ef | grep Bootstraproot 118271 1 99 00:10 ? 3-16:08:07 Bootstrap startroot 197682 197016 0 17:08 pts/0 00:00:00 grep Bootstrap ä½¿ç”¨javaè‡ªå¸¦çš„æ£€æµ‹å·¥å…· jps 123[root@YZSJHL81-35 ~]# jps118271 Bootstrap197101 Jps æ£€æµ‹javaè¿›ç¨‹å¯åŠ¨çš„æ—¶é—´ 12ps -p 118271 -o etimeps -p 118271 -o etime= æ£€æµ‹è¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶æ•° 1lsof -n -p 118271 | wc -l æ£€æµ‹ç³»ç»Ÿçš„è¿›ç¨‹ top 12345678910top - 17:11:21 up 132 days, 2:14, 1 user, load average: 0.12, 0.21, 0.18Tasks: 298 total, 1 running, 297 sleeping, 0 stopped, 0 zombieCpu(s): 1.0%us, 0.6%sy, 0.0%ni, 98.0%id, 0.3%wa, 0.0%hi, 0.1%si, 0.0%stMem: 99009860k total, 90554384k used, 8455476k free, 333672k buffersSwap: 0k total, 0k used, 0k free, 81820024k cachedPID USER PR NI VIRT RES SHR S %CPU %MEM TIME+ COMMANDq-é€€å‡º1-æ˜¾ç¤ºæ‰€æœ‰çš„cpuåŠå…¶çŠ¶æ€ æŸ¥çœ‹æŒ‡å®šè¿›ç¨‹ä¸‹æ‰€æœ‰çº¿ç¨‹çš„çŠ¶æ€ 1top -Hp pid æŸ¥çœ‹JVMçš„GCçŠ¶æ€1jstat -gcutil -t pid 1000 100 ---æŸ¥çœ‹pidè¿›ç¨‹çš„GCçŠ¶æ€æ¯éš”1000msä¸€æ¬¡ï¼Œä¸€å…±100æ¬¡ â€‹ æŸ¥çœ‹JVMæ ˆä¿¡æ¯1234printf '%x\\n' tid -- æ‰“å°æŒ‡å®šçº¿ç¨‹idçš„åå…­è¿›åˆ¶è¡¨ç¤ºjstack pid | grep 'tidåå…­è¿›åˆ¶' -C20 -color -- æŸ¥çœ‹è¿›ç¨‹çš„æ ˆä¿¡æ¯jmap -histo:live pid --æŸ¥çœ‹è¿›ç¨‹æ‰€æœ‰å­˜æ´»çš„å®ä¾‹jmap -dumap:format=b,file=dump.hprof pid --å¯¼å‡ºJVMçš„dumpæ–‡ä»¶","categories":[{"name":"JAVAå­¦ä¹ ","slug":"JAVAå­¦ä¹ ","permalink":"https://shang.at/categories/JAVAå­¦ä¹ /"}],"tags":[{"name":"JVMé—®é¢˜è°ƒè¯•","slug":"JVMé—®é¢˜è°ƒè¯•","permalink":"https://shang.at/tags/JVMé—®é¢˜è°ƒè¯•/"}]}],"categories":[{"name":"Pythonæ•°æ®åˆ†æ","slug":"Pythonæ•°æ®åˆ†æ","permalink":"https://shang.at/categories/Pythonæ•°æ®åˆ†æ/"},{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"https://shang.at/categories/æœºå™¨å­¦ä¹ /"},{"name":"Sparkå­¦ä¹ ","slug":"Sparkå­¦ä¹ ","permalink":"https://shang.at/categories/Sparkå­¦ä¹ /"},{"name":"æ“ä½œç³»ç»Ÿ","slug":"æ“ä½œç³»ç»Ÿ","permalink":"https://shang.at/categories/æ“ä½œç³»ç»Ÿ/"},{"name":"å¤§æ•°æ®","slug":"å¤§æ•°æ®","permalink":"https://shang.at/categories/å¤§æ•°æ®/"},{"name":"Mysql","slug":"Mysql","permalink":"https://shang.at/categories/Mysql/"},{"name":"æ­£åˆ™","slug":"æ­£åˆ™","permalink":"https://shang.at/categories/æ­£åˆ™/"},{"name":"python-lsi","slug":"python-lsi","permalink":"https://shang.at/categories/python-lsi/"},{"name":"jupyter","slug":"jupyter","permalink":"https://shang.at/categories/jupyter/"},{"name":"idea","slug":"idea","permalink":"https://shang.at/categories/idea/"},{"name":"æ± åŒ–","slug":"æ± åŒ–","permalink":"https://shang.at/categories/æ± åŒ–/"},{"name":"JAVAå­¦ä¹ ","slug":"JAVAå­¦ä¹ ","permalink":"https://shang.at/categories/JAVAå­¦ä¹ /"},{"name":"å·¥å…·ä½¿ç”¨","slug":"å·¥å…·ä½¿ç”¨","permalink":"https://shang.at/categories/å·¥å…·ä½¿ç”¨/"},{"name":"Linux","slug":"Linux","permalink":"https://shang.at/categories/Linux/"},{"name":"IO","slug":"IO","permalink":"https://shang.at/categories/IO/"},{"name":"Scalaå­¦ä¹ ","slug":"Scalaå­¦ä¹ ","permalink":"https://shang.at/categories/Scalaå­¦ä¹ /"},{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://shang.at/categories/æ•°æ®ç»“æ„ä¸ç®—æ³•/"},{"name":"Python","slug":"Python","permalink":"https://shang.at/categories/Python/"},{"name":"å®¹å™¨","slug":"å®¹å™¨","permalink":"https://shang.at/categories/å®¹å™¨/"},{"name":"Sparkåº”ç”¨","slug":"Sparkåº”ç”¨","permalink":"https://shang.at/categories/Sparkåº”ç”¨/"},{"name":"Hadoopå­¦ä¹ ","slug":"Hadoopå­¦ä¹ ","permalink":"https://shang.at/categories/Hadoopå­¦ä¹ /"},{"name":"Hiveå­¦ä¹ ","slug":"Hiveå­¦ä¹ ","permalink":"https://shang.at/categories/Hiveå­¦ä¹ /"},{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"https://shang.at/categories/æ•°æ®åº“/"},{"name":"Shellç¼–ç¨‹","slug":"Shellç¼–ç¨‹","permalink":"https://shang.at/categories/Shellç¼–ç¨‹/"},{"name":"å¤§æ•°æ®ç”Ÿæ€","slug":"å¤§æ•°æ®ç”Ÿæ€","permalink":"https://shang.at/categories/å¤§æ•°æ®ç”Ÿæ€/"},{"name":"è™šæ‹Ÿæœº","slug":"è™šæ‹Ÿæœº","permalink":"https://shang.at/categories/è™šæ‹Ÿæœº/"},{"name":"JAVAå¹¶å‘ç¼–ç¨‹","slug":"JAVAå¹¶å‘ç¼–ç¨‹","permalink":"https://shang.at/categories/JAVAå¹¶å‘ç¼–ç¨‹/"},{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","permalink":"https://shang.at/categories/åˆ†å¸ƒå¼/"},{"name":"BI","slug":"BI","permalink":"https://shang.at/categories/BI/"},{"name":"æ•°æ®åˆ†æ","slug":"æ•°æ®åˆ†æ","permalink":"https://shang.at/categories/æ•°æ®åˆ†æ/"},{"name":"Spark","slug":"Spark","permalink":"https://shang.at/categories/Spark/"},{"name":"æ•°æ®ä»“åº“","slug":"æ•°æ®ä»“åº“","permalink":"https://shang.at/categories/æ•°æ®ä»“åº“/"}],"tags":[{"name":"Matplotlib","slug":"Matplotlib","permalink":"https://shang.at/tags/Matplotlib/"},{"name":"Numpy","slug":"Numpy","permalink":"https://shang.at/tags/Numpy/"},{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"https://shang.at/tags/æœºå™¨å­¦ä¹ /"},{"name":"jsonæ•°æ®æ“ä½œ","slug":"jsonæ•°æ®æ“ä½œ","permalink":"https://shang.at/tags/jsonæ•°æ®æ“ä½œ/"},{"name":"æ“ä½œç³»ç»Ÿ","slug":"æ“ä½œç³»ç»Ÿ","permalink":"https://shang.at/tags/æ“ä½œç³»ç»Ÿ/"},{"name":"zookeeper","slug":"zookeeper","permalink":"https://shang.at/tags/zookeeper/"},{"name":"mysqlä¼˜åŒ–","slug":"mysqlä¼˜åŒ–","permalink":"https://shang.at/tags/mysqlä¼˜åŒ–/"},{"name":"ç´¢å¼•","slug":"ç´¢å¼•","permalink":"https://shang.at/tags/ç´¢å¼•/"},{"name":"æ­£åˆ™","slug":"æ­£åˆ™","permalink":"https://shang.at/tags/æ­£åˆ™/"},{"name":"python-lsi","slug":"python-lsi","permalink":"https://shang.at/tags/python-lsi/"},{"name":"flink","slug":"flink","permalink":"https://shang.at/tags/flink/"},{"name":"å·¥å…·ä½¿ç”¨","slug":"å·¥å…·ä½¿ç”¨","permalink":"https://shang.at/tags/å·¥å…·ä½¿ç”¨/"},{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://shang.at/tags/å·¥å…·/"},{"name":"ç¨‹åºè®¾è®¡","slug":"ç¨‹åºè®¾è®¡","permalink":"https://shang.at/tags/ç¨‹åºè®¾è®¡/"},{"name":"å¯¹è±¡å†…å­˜å¸ƒå±€","slug":"å¯¹è±¡å†…å­˜å¸ƒå±€","permalink":"https://shang.at/tags/å¯¹è±¡å†…å­˜å¸ƒå±€/"},{"name":"gitlab","slug":"gitlab","permalink":"https://shang.at/tags/gitlab/"},{"name":"Linux","slug":"Linux","permalink":"https://shang.at/tags/Linux/"},{"name":"Classçš„åŠ è½½è¿‡ç¨‹","slug":"Classçš„åŠ è½½è¿‡ç¨‹","permalink":"https://shang.at/tags/Classçš„åŠ è½½è¿‡ç¨‹/"},{"name":"IO","slug":"IO","permalink":"https://shang.at/tags/IO/"},{"name":"JAVA-IO","slug":"JAVA-IO","permalink":"https://shang.at/tags/JAVA-IO/"},{"name":"Epoll","slug":"Epoll","permalink":"https://shang.at/tags/Epoll/"},{"name":"Scalaæ³›å‹","slug":"Scalaæ³›å‹","permalink":"https://shang.at/tags/Scalaæ³›å‹/"},{"name":"Scala-import","slug":"Scala-import","permalink":"https://shang.at/tags/Scala-import/"},{"name":"Encoder","slug":"Encoder","permalink":"https://shang.at/tags/Encoder/"},{"name":"String","slug":"String","permalink":"https://shang.at/tags/String/"},{"name":"å‡½æ•°å¼ç¼–ç¨‹","slug":"å‡½æ•°å¼ç¼–ç¨‹","permalink":"https://shang.at/tags/å‡½æ•°å¼ç¼–ç¨‹/"},{"name":"Scalaç¼–ç¨‹Tips","slug":"Scalaç¼–ç¨‹Tips","permalink":"https://shang.at/tags/Scalaç¼–ç¨‹Tips/"},{"name":"Scala-Iteratorè®¾è®¡æ¨¡å¼","slug":"Scala-Iteratorè®¾è®¡æ¨¡å¼","permalink":"https://shang.at/tags/Scala-Iteratorè®¾è®¡æ¨¡å¼/"},{"name":"Scalaéšå¼è½¬æ¢","slug":"Scalaéšå¼è½¬æ¢","permalink":"https://shang.at/tags/Scalaéšå¼è½¬æ¢/"},{"name":"Scalaåå‡½æ•°","slug":"Scalaåå‡½æ•°","permalink":"https://shang.at/tags/Scalaåå‡½æ•°/"},{"name":"Scalaæ¨¡å¼åŒ¹é…","slug":"Scalaæ¨¡å¼åŒ¹é…","permalink":"https://shang.at/tags/Scalaæ¨¡å¼åŒ¹é…/"},{"name":"Scalaæ¡ˆä¾‹ç±»","slug":"Scalaæ¡ˆä¾‹ç±»","permalink":"https://shang.at/tags/Scalaæ¡ˆä¾‹ç±»/"},{"name":"Scalaç‰¹è´¨å’ŒæŠ½è±¡ç±»å‹","slug":"Scalaç‰¹è´¨å’ŒæŠ½è±¡ç±»å‹","permalink":"https://shang.at/tags/Scalaç‰¹è´¨å’ŒæŠ½è±¡ç±»å‹/"},{"name":"Scalaé›†åˆ","slug":"Scalaé›†åˆ","permalink":"https://shang.at/tags/Scalaé›†åˆ/"},{"name":"Scalaæ–¹æ³•","slug":"Scalaæ–¹æ³•","permalink":"https://shang.at/tags/Scalaæ–¹æ³•/"},{"name":"Scala-for-yield","slug":"Scala-for-yield","permalink":"https://shang.at/tags/Scala-for-yield/"},{"name":"Scalaç±»å‹","slug":"Scalaç±»å‹","permalink":"https://shang.at/tags/Scalaç±»å‹/"},{"name":"maven","slug":"maven","permalink":"https://shang.at/tags/maven/"},{"name":"å·¦ç¥å­¦ä¹ ç¬”è®°","slug":"å·¦ç¥å­¦ä¹ ç¬”è®°","permalink":"https://shang.at/tags/å·¦ç¥å­¦ä¹ ç¬”è®°/"},{"name":"aws","slug":"aws","permalink":"https://shang.at/tags/aws/"},{"name":"æ–‡ä»¶æ“ä½œ","slug":"æ–‡ä»¶æ“ä½œ","permalink":"https://shang.at/tags/æ–‡ä»¶æ“ä½œ/"},{"name":"ç½‘ç»œçš„é…ç½®","slug":"ç½‘ç»œçš„é…ç½®","permalink":"https://shang.at/tags/ç½‘ç»œçš„é…ç½®/"},{"name":"UML","slug":"UML","permalink":"https://shang.at/tags/UML/"},{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://shang.at/tags/è®¾è®¡æ¨¡å¼/"},{"name":"Docker","slug":"Docker","permalink":"https://shang.at/tags/Docker/"},{"name":"Centoså¼€å‘ç¯å¢ƒ","slug":"Centoså¼€å‘ç¯å¢ƒ","permalink":"https://shang.at/tags/Centoså¼€å‘ç¯å¢ƒ/"},{"name":"centos7æ—¶åŒºè®¾ç½®","slug":"centos7æ—¶åŒºè®¾ç½®","permalink":"https://shang.at/tags/centos7æ—¶åŒºè®¾ç½®/"},{"name":"ssh","slug":"ssh","permalink":"https://shang.at/tags/ssh/"},{"name":"deque","slug":"deque","permalink":"https://shang.at/tags/deque/"},{"name":"Pythonæ ‡å‡†åº“","slug":"Pythonæ ‡å‡†åº“","permalink":"https://shang.at/tags/Pythonæ ‡å‡†åº“/"},{"name":"itertools","slug":"itertools","permalink":"https://shang.at/tags/itertools/"},{"name":"Sparkå¤§æ•°æ®é›†é˜²æ­¢driver OOM","slug":"Sparkå¤§æ•°æ®é›†é˜²æ­¢driver-OOM","permalink":"https://shang.at/tags/Sparkå¤§æ•°æ®é›†é˜²æ­¢driver-OOM/"},{"name":"Pythonç±»çš„ç‰¹æ®Šæ–¹æ³•","slug":"Pythonç±»çš„ç‰¹æ®Šæ–¹æ³•","permalink":"https://shang.at/tags/Pythonç±»çš„ç‰¹æ®Šæ–¹æ³•/"},{"name":"JAVA-JMH","slug":"JAVA-JMH","permalink":"https://shang.at/tags/JAVA-JMH/"},{"name":"åŠ¨æ€è§„åˆ’","slug":"åŠ¨æ€è§„åˆ’","permalink":"https://shang.at/tags/åŠ¨æ€è§„åˆ’/"},{"name":"pythonçš„dict","slug":"pythonçš„dict","permalink":"https://shang.at/tags/pythonçš„dict/"},{"name":"Hadoop","slug":"Hadoop","permalink":"https://shang.at/tags/Hadoop/"},{"name":"Yarn-Scheduler","slug":"Yarn-Scheduler","permalink":"https://shang.at/tags/Yarn-Scheduler/"},{"name":"Yarn-Container","slug":"Yarn-Container","permalink":"https://shang.at/tags/Yarn-Container/"},{"name":"å®ç°ä¸€ä¸ªåœ¨Yarnä¸Šçš„Application","slug":"å®ç°ä¸€ä¸ªåœ¨Yarnä¸Šçš„Application","permalink":"https://shang.at/tags/å®ç°ä¸€ä¸ªåœ¨Yarnä¸Šçš„Application/"},{"name":"Mapreduceç¼–ç¨‹æ¨¡å¼","slug":"Mapreduceç¼–ç¨‹æ¨¡å¼","permalink":"https://shang.at/tags/Mapreduceç¼–ç¨‹æ¨¡å¼/"},{"name":"Hiveå®‰è£…","slug":"Hiveå®‰è£…","permalink":"https://shang.at/tags/Hiveå®‰è£…/"},{"name":"mysqlç¯å¢ƒé…ç½®","slug":"mysqlç¯å¢ƒé…ç½®","permalink":"https://shang.at/tags/mysqlç¯å¢ƒé…ç½®/"},{"name":"Hadoop-Shell","slug":"Hadoop-Shell","permalink":"https://shang.at/tags/Hadoop-Shell/"},{"name":"iterm2","slug":"iterm2","permalink":"https://shang.at/tags/iterm2/"},{"name":"Hadoopæºç ç¼–è¯‘","slug":"Hadoopæºç ç¼–è¯‘","permalink":"https://shang.at/tags/Hadoopæºç ç¼–è¯‘/"},{"name":"Hadoopé›†ç¾¤æ­å»º","slug":"Hadoopé›†ç¾¤æ­å»º","permalink":"https://shang.at/tags/Hadoopé›†ç¾¤æ­å»º/"},{"name":"Hadoopé…ç½®è¯¦è§£","slug":"Hadoopé…ç½®è¯¦è§£","permalink":"https://shang.at/tags/Hadoopé…ç½®è¯¦è§£/"},{"name":"å¸¸è§å‘½ä»¤","slug":"å¸¸è§å‘½ä»¤","permalink":"https://shang.at/tags/å¸¸è§å‘½ä»¤/"},{"name":"centos7ä¿®æ”¹hostname","slug":"centos7ä¿®æ”¹hostname","permalink":"https://shang.at/tags/centos7ä¿®æ”¹hostname/"},{"name":"vim","slug":"vim","permalink":"https://shang.at/tags/vim/"},{"name":"å¤§æ•°æ®ç«¯å£","slug":"å¤§æ•°æ®ç«¯å£","permalink":"https://shang.at/tags/å¤§æ•°æ®ç«¯å£/"},{"name":"å¤§æ•°æ®ç¯å¢ƒ","slug":"å¤§æ•°æ®ç¯å¢ƒ","permalink":"https://shang.at/tags/å¤§æ•°æ®ç¯å¢ƒ/"},{"name":"Vagrant","slug":"Vagrant","permalink":"https://shang.at/tags/Vagrant/"},{"name":"Kafka","slug":"Kafka","permalink":"https://shang.at/tags/Kafka/"},{"name":"å¤§æ•°æ®ç”Ÿæ€","slug":"å¤§æ•°æ®ç”Ÿæ€","permalink":"https://shang.at/tags/å¤§æ•°æ®ç”Ÿæ€/"},{"name":"javaåº•å±‚","slug":"javaåº•å±‚","permalink":"https://shang.at/tags/javaåº•å±‚/"},{"name":"classæ–‡ä»¶æ ¼å¼","slug":"classæ–‡ä»¶æ ¼å¼","permalink":"https://shang.at/tags/classæ–‡ä»¶æ ¼å¼/"},{"name":"è¿è¡Œæ—¶çº¿ç¨‹","slug":"è¿è¡Œæ—¶çº¿ç¨‹","permalink":"https://shang.at/tags/è¿è¡Œæ—¶çº¿ç¨‹/"},{"name":"JOINçš„ç®—æ³•å®ç°","slug":"JOINçš„ç®—æ³•å®ç°","permalink":"https://shang.at/tags/JOINçš„ç®—æ³•å®ç°/"},{"name":"JDKç¯å¢ƒåˆ‡æ¢","slug":"JDKç¯å¢ƒåˆ‡æ¢","permalink":"https://shang.at/tags/JDKç¯å¢ƒåˆ‡æ¢/"},{"name":"JVMè™šæ‹Ÿæœºæ ˆ","slug":"JVMè™šæ‹Ÿæœºæ ˆ","permalink":"https://shang.at/tags/JVMè™šæ‹Ÿæœºæ ˆ/"},{"name":"JVMç–‘é—®","slug":"JVMç–‘é—®","permalink":"https://shang.at/tags/JVMç–‘é—®/"},{"name":"åŸºæœ¬ç±»å‹å’ŒåŒ…è£…ç±»å‹","slug":"åŸºæœ¬ç±»å‹å’ŒåŒ…è£…ç±»å‹","permalink":"https://shang.at/tags/åŸºæœ¬ç±»å‹å’ŒåŒ…è£…ç±»å‹/"},{"name":"ç½‘ç»œç¼–ç¨‹-é›¶æ‹·è´","slug":"ç½‘ç»œç¼–ç¨‹-é›¶æ‹·è´","permalink":"https://shang.at/tags/ç½‘ç»œç¼–ç¨‹-é›¶æ‹·è´/"},{"name":"JVMå‚æ•°","slug":"JVMå‚æ•°","permalink":"https://shang.at/tags/JVMå‚æ•°/"},{"name":"å¸¸è§å¼‚å¸¸","slug":"å¸¸è§å¼‚å¸¸","permalink":"https://shang.at/tags/å¸¸è§å¼‚å¸¸/"},{"name":"Disruptor","slug":"Disruptor","permalink":"https://shang.at/tags/Disruptor/"},{"name":"RxJava","slug":"RxJava","permalink":"https://shang.at/tags/RxJava/"},{"name":"åç¨‹","slug":"åç¨‹","permalink":"https://shang.at/tags/åç¨‹/"},{"name":"çº¿ç¨‹æ± ","slug":"çº¿ç¨‹æ± ","permalink":"https://shang.at/tags/çº¿ç¨‹æ± /"},{"name":"é˜»å¡é˜Ÿåˆ—","slug":"é˜»å¡é˜Ÿåˆ—","permalink":"https://shang.at/tags/é˜»å¡é˜Ÿåˆ—/"},{"name":"Atomic","slug":"Atomic","permalink":"https://shang.at/tags/Atomic/"},{"name":"å¹¶å‘é›†åˆ","slug":"å¹¶å‘é›†åˆ","permalink":"https://shang.at/tags/å¹¶å‘é›†åˆ/"},{"name":"ThreadLocal-Fork&Join","slug":"ThreadLocal-Fork-Join","permalink":"https://shang.at/tags/ThreadLocal-Fork-Join/"},{"name":"å¹¶å‘å·¥å…·ç±»","slug":"å¹¶å‘å·¥å…·ç±»","permalink":"https://shang.at/tags/å¹¶å‘å·¥å…·ç±»/"},{"name":"é”","slug":"é”","permalink":"https://shang.at/tags/é”/"},{"name":"å¹¶å‘åŸºç¡€","slug":"å¹¶å‘åŸºç¡€","permalink":"https://shang.at/tags/å¹¶å‘åŸºç¡€/"},{"name":"å†…å­˜æ¨¡å‹JMM","slug":"å†…å­˜æ¨¡å‹JMM","permalink":"https://shang.at/tags/å†…å­˜æ¨¡å‹JMM/"},{"name":"Scheduler","slug":"Scheduler","permalink":"https://shang.at/tags/Scheduler/"},{"name":"BloomFilter","slug":"BloomFilter","permalink":"https://shang.at/tags/BloomFilter/"},{"name":"å¤–æ’-åˆ†ç»„å½’å¹¶-æ¡¶æ’åº","slug":"å¤–æ’-åˆ†ç»„å½’å¹¶-æ¡¶æ’åº","permalink":"https://shang.at/tags/å¤–æ’-åˆ†ç»„å½’å¹¶-æ¡¶æ’åº/"},{"name":"å¹¶å‘ç¼–ç¨‹-Future","slug":"å¹¶å‘ç¼–ç¨‹-Future","permalink":"https://shang.at/tags/å¹¶å‘ç¼–ç¨‹-Future/"},{"name":"å¸¸è§æ“ä½œæŠ€å·§","slug":"å¸¸è§æ“ä½œæŠ€å·§","permalink":"https://shang.at/tags/å¸¸è§æ“ä½œæŠ€å·§/"},{"name":"lru_cache","slug":"lru-cache","permalink":"https://shang.at/tags/lru-cache/"},{"name":"å¹¶å‘ç¼–ç¨‹-Thread","slug":"å¹¶å‘ç¼–ç¨‹-Thread","permalink":"https://shang.at/tags/å¹¶å‘ç¼–ç¨‹-Thread/"},{"name":"å¹¶å‘ç¼–ç¨‹","slug":"å¹¶å‘ç¼–ç¨‹","permalink":"https://shang.at/tags/å¹¶å‘ç¼–ç¨‹/"},{"name":"JVM","slug":"JVM","permalink":"https://shang.at/tags/JVM/"},{"name":"wait&notify","slug":"wait-notify","permalink":"https://shang.at/tags/wait-notify/"},{"name":"Timer","slug":"Timer","permalink":"https://shang.at/tags/Timer/"},{"name":"NIO","slug":"NIO","permalink":"https://shang.at/tags/NIO/"},{"name":"JAVA-Iterator","slug":"JAVA-Iterator","permalink":"https://shang.at/tags/JAVA-Iterator/"},{"name":"JAVAé›†åˆç±»-åˆ—è¡¨","slug":"JAVAé›†åˆç±»-åˆ—è¡¨","permalink":"https://shang.at/tags/JAVAé›†åˆç±»-åˆ—è¡¨/"},{"name":"IPC&RPC","slug":"IPC-RPC","permalink":"https://shang.at/tags/IPC-RPC/"},{"name":"åŠ¨æ€ä»£ç†","slug":"åŠ¨æ€ä»£ç†","permalink":"https://shang.at/tags/åŠ¨æ€ä»£ç†/"},{"name":"mysqläº‹åŠ¡å’Œéš”ç¦»çº§åˆ«","slug":"mysqläº‹åŠ¡å’Œéš”ç¦»çº§åˆ«","permalink":"https://shang.at/tags/mysqläº‹åŠ¡å’Œéš”ç¦»çº§åˆ«/"},{"name":"mysqlç¬¬ä¸‰èŒƒå¼","slug":"mysqlç¬¬ä¸‰èŒƒå¼","permalink":"https://shang.at/tags/mysqlç¬¬ä¸‰èŒƒå¼/"},{"name":"pythonå­¦ä¹ ","slug":"pythonå­¦ä¹ ","permalink":"https://shang.at/tags/pythonå­¦ä¹ /"},{"name":"OrderedDict","slug":"OrderedDict","permalink":"https://shang.at/tags/OrderedDict/"},{"name":"bisect","slug":"bisect","permalink":"https://shang.at/tags/bisect/"},{"name":"æŸ¥æ‰¾ç®—æ³•","slug":"æŸ¥æ‰¾ç®—æ³•","permalink":"https://shang.at/tags/æŸ¥æ‰¾ç®—æ³•/"},{"name":"Sparkä¸­çš„éšå¼è½¬æ¢","slug":"Sparkä¸­çš„éšå¼è½¬æ¢","permalink":"https://shang.at/tags/Sparkä¸­çš„éšå¼è½¬æ¢/"},{"name":"Hadoop-IPC","slug":"Hadoop-IPC","permalink":"https://shang.at/tags/Hadoop-IPC/"},{"name":"Pandas","slug":"Pandas","permalink":"https://shang.at/tags/Pandas/"},{"name":"pythonä¸­çš„æ—¶é—´å¤„ç†","slug":"pythonä¸­çš„æ—¶é—´å¤„ç†","permalink":"https://shang.at/tags/pythonä¸­çš„æ—¶é—´å¤„ç†/"},{"name":"Configuration","slug":"Configuration","permalink":"https://shang.at/tags/Configuration/"},{"name":"é˜Ÿåˆ—","slug":"é˜Ÿåˆ—","permalink":"https://shang.at/tags/é˜Ÿåˆ—/"},{"name":"å¹¿æ’­å˜é‡","slug":"å¹¿æ’­å˜é‡","permalink":"https://shang.at/tags/å¹¿æ’­å˜é‡/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://shang.at/tags/ç®—æ³•/"},{"name":"pivoté€è§†å›¾","slug":"pivoté€è§†å›¾","permalink":"https://shang.at/tags/pivoté€è§†å›¾/"},{"name":"Spark-tips","slug":"Spark-tips","permalink":"https://shang.at/tags/Spark-tips/"},{"name":"Tableau","slug":"Tableau","permalink":"https://shang.at/tags/Tableau/"},{"name":"sparkSql-DSLè¯­æ³•","slug":"sparkSql-DSLè¯­æ³•","permalink":"https://shang.at/tags/sparkSql-DSLè¯­æ³•/"},{"name":"æ’åºç®—æ³•","slug":"æ’åºç®—æ³•","permalink":"https://shang.at/tags/æ’åºç®—æ³•/"},{"name":"reduce","slug":"reduce","permalink":"https://shang.at/tags/reduce/"},{"name":"æ•°æ®åˆ†ææŠ€å·§","slug":"æ•°æ®åˆ†ææŠ€å·§","permalink":"https://shang.at/tags/æ•°æ®åˆ†ææŠ€å·§/"},{"name":"æœ‰åˆå§‹å€¼çš„èšåˆæ“ä½œ","slug":"æœ‰åˆå§‹å€¼çš„èšåˆæ“ä½œ","permalink":"https://shang.at/tags/æœ‰åˆå§‹å€¼çš„èšåˆæ“ä½œ/"},{"name":"åˆ†ææŒ‡æ ‡","slug":"åˆ†ææŒ‡æ ‡","permalink":"https://shang.at/tags/åˆ†ææŒ‡æ ‡/"},{"name":"æŠ½æ ·æ–¹æ³•å’Œè‡ªå¢ID","slug":"æŠ½æ ·æ–¹æ³•å’Œè‡ªå¢ID","permalink":"https://shang.at/tags/æŠ½æ ·æ–¹æ³•å’Œè‡ªå¢ID/"},{"name":"sparkSqlå†…ç½®å‡½æ•°","slug":"sparkSqlå†…ç½®å‡½æ•°","permalink":"https://shang.at/tags/sparkSqlå†…ç½®å‡½æ•°/"},{"name":"æ•°æ®åˆ†æTips","slug":"æ•°æ®åˆ†æTips","permalink":"https://shang.at/tags/æ•°æ®åˆ†æTips/"},{"name":"çª—å£å‡½æ•°","slug":"çª—å£å‡½æ•°","permalink":"https://shang.at/tags/çª—å£å‡½æ•°/"},{"name":"union","slug":"union","permalink":"https://shang.at/tags/union/"},{"name":"pysparkå®˜æ–¹æ–‡æ¡£å­¦ä¹ ","slug":"pysparkå®˜æ–¹æ–‡æ¡£å­¦ä¹ ","permalink":"https://shang.at/tags/pysparkå®˜æ–¹æ–‡æ¡£å­¦ä¹ /"},{"name":"å¤æ‚åº¦åˆ†æ","slug":"å¤æ‚åº¦åˆ†æ","permalink":"https://shang.at/tags/å¤æ‚åº¦åˆ†æ/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://shang.at/tags/æ•°æ®ç»“æ„/"},{"name":"æè¿°æ€§ç»Ÿè®¡å’Œæ¢ç´¢å‹æ•°æ®åˆ†æ","slug":"æè¿°æ€§ç»Ÿè®¡å’Œæ¢ç´¢å‹æ•°æ®åˆ†æ","permalink":"https://shang.at/tags/æè¿°æ€§ç»Ÿè®¡å’Œæ¢ç´¢å‹æ•°æ®åˆ†æ/"},{"name":"JVMé—®é¢˜è°ƒè¯•","slug":"JVMé—®é¢˜è°ƒè¯•","permalink":"https://shang.at/tags/JVMé—®é¢˜è°ƒè¯•/"}]}